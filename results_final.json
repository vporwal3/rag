{
    "1": {
        "1.1": [
            "What is the primary goal of financial problems?\nWhat does Net present value (NPV) mean?\nWhat is the function of \"Internal rate of return (IRR)\" in finance?\nCan you explain the term \"Payment schedules and loan tables\"?\nWhat does the term \"Future value\" imply in financial modelling?\nWhat are Pension and accumulation problems?\nCan you explain the concept of \"Continuously compounded interest\"?\nHow does one compute Time-dated cash flows using Excel functions XNPV and XIRR?\nHow is the discount rate adjusted in financial calculations?\nDescribe the concept of opportunity cost in finance.\nCan you differentiate between discount rate, cost of capital, and interest rate?\nCan you define risk-adjusted discount rate (RADR) and weighted average cost of capital (WACC)?\nHow is opportunity cost used in net present value calculations?\nWhat is its usage in the calculation of internal rate of return?\nWhat is the significance of opportunity cost in finance?",
            "1.1 Overview\n\nT his chapter aims to give you some fi nance basics and their Excel implementa-\ntion. If you have had a good introductory course in fi nance, this chapter is\nlikely to be at best a refresher. 1\nThis chapter covers:\n\u2022 Net present value (NPV)\n\u2022 Internal rate of return (IRR)\n\u2022 Payment schedules and loan tables\n\u2022 Future value\n\u2022 Pension and accumulation problems\n\u2022 Continuously compounded interest\n\u2022 Time-dated cash fl ows (Excel functions XNPV and XIRR )\nAlmost all fi nancial problems are centered on fi nding the v alue today of a\nseries of cash receipts over time . The cash receipts (or cash fl ows, as we will\ncall them) may be certain or uncertain. The present value of a cash fl ow CF\nt\nCF\nanticipated to be received at time t is t . The numerator of this\n( 1+r)t\nexpression is usually understood to be the expected time t cash fl ow , and the\ndiscount rate r in the denominator is adjusted for the riskiness of this expected\ncash fl ow\u2014the higher the risk, the higher the discount rate.\nT he basic concept in present value calculations is the concept of opportunity\ncost . Opportunity cost is the return which would be required of an investment\nto make it a viable alternative to other, similar investments. In the fi nancial\nliterature there are many synonyms for opportunity cost, among them: discount\nrate, cost of capital, and interest rate. When applied to risky cash fl ows, we\nwill sometimes call the opportunity cost the risk-adjusted discount rate (RADR)\nor the weighted average cost of capital (WACC). It goes without saying that\nthis discount rate should be risk-adjusted, and much of the standard fi nance\nliterature discusses how to do this. As illustrated below, when we calculate the\nnet present value, we use the investment\u2019 s opportunity cost as a discount rate.\nWhen we calculate the internal rate of return, we compare the calculated return\nto the investment \u2019 s opportunity cost to judge its value.\n1. In my book Principles of Finance with Excel (Oxford University Press, 2nd edition, 2008) I\n14 Chapter 1"
        ],
        "1.2": [
            "What is present value in financial modeling?\nWhat is net present value and how is it utilized in financial modeling?\nWhat are the three ways of calculating the present value of an investment shown in this text?\nWhy does the PV function in Excel return a negative value for positive cash flows?\nWhat is the difference between Excel\u2019s PV and NPV functions?\nWhat is the financial use of Excel's NPV function?\nWhat is the net present value, or NPV, of an investment?\nHow do you calculate the net present value of an investment, utilizing cash flows and a discount rate?\nCan you explain how the net present value represents the wealth increment of the purchaser of the cash flows?\nHow does the net present value relate to the market price of cash flows?\nWhat is an annuity in finance and how is it calculated?\nHow does one compute the present value of an infinite annuity using a periodic payment and a discount rate?\nWhat does the term 'growing annuity' refer to in finance?\nHow do you calculate the present value of a finite growing annuity?\nWhat is the Gordon Formula and how is it used in financial modeling?\nWhat does the Gordon Formula calculate in relation to stock values?\nCan you explain how to use the Gordon Formula to model a firm's cost of equity? \nWhat is the expected wealth increment of a purchaser who buys a series of cash flows for a certain amount? \nWhat is the criteria for the use of Excel's PV and NPV functions respectively in financial modeling?\nHow does the present value of an annuity get calculated using a finite or infinite series of payments? \nWhat is the value today of a growing annuity and how is it calculated? \nWhat is the financial concept of a security which pays a constant sum in each period in the future?\nIn financial modeling, how do you determine the value today of a set of anticipated future cash flows?",
            "1.2 Present Value and Net Present Value\n\nBoth of these concepts are related to the value t oday of a set of future antici-\npated cash fl ows. As an example, suppose we are valuing an investment which\npromises $100 per year at the end of this and the next 4 years. We suppose\nthat these cash fl ows are risk free: There is no doubt that this series of 5 pay-\nments of $100 each will actually be paid. If a bank pays an annual interest\nrate of 10% on a 5-year deposit, then this 10% is the investment \u2019 s opportunity\ncost, the alternative benchmark return to which we want to compare the invest-\nment. We can calculate the value of the investment by discounting its cash\nfl ows using this opportunity cost as a discount rate:\nA B C D\n1 COMPUTING THE PRESENT VALUE\n2 Discount rate 10%\n3\nPresent\n4 Year Cash flow value\n5 1 100 90.9091 <-- =B5/(1+$B$2)^A5\n6 2 100 82.6446 <-- =B6/(1+$B$2)^A6\n7 3 100 75.1315 <-- =B7/(1+$B$2)^A7\n8 4 100 68.3013 <-- =B8/(1+$B$2)^A8\n9 5 100 62.0921 <-- =B9/(1+$B$2)^A9\n10\n11 Net present value\n12 Summing cells C5:C9 379.08 <-- =SUM(C5:C9)\n13 Using Excel's NPV function 379.08 <-- =NPV(B2,B5:B9)\n14 Using Excel's PV function 379.08 <-- =PV(B2,5,-100)\nThe present value, 379.08, is the v alue today of the investment. In a competi-\ntive market, the present value should correspond to the market price of the\ncash fl ows. The spreadsheet illustrates three ways of obtaining this value:\n\u2022 S umming the individual present values in cells C5:C9. To simplify the\ncopying, note the use of \u201c \u2227\u201d to represent the power and the use of both the\nrelative and absolute references; for example: = B5/(1 + $B$2) \u2227 A5 in cell C5.\n\u2022 Using the Excel NPV function. As we show on the next page, Excel \u2019 s N PV\nfunction is unfortunately misnamed\u2014it actually computes the present value\n15 Basic Financial Calculations\n\u2022 Using the Excel PV function. This function computes the present value of\na series of constant payments. P V(B2,5,-100) is the present value of 5 pay-\nments of 100 each at the discount rate in cell B2. The PV function returns a\nnegative value for positive cash fl ows; to prevent this unfortunate occurrence,\nwe have made the cash fl ows negative.2\nThe Difference Between Excel \u2019 s PV and NPV Functions\nT he above spreadsheet may leave the misimpression that PV and NPV perform\nexactly the same computation. But this is not true\u2014whereas NPV can handle\nany series of cash fl ows, PV can handle only constant cash fl ows:\nA B C D\nCOMPUTING THE PRESENT VALUE\nIn this example the cash flows are not equal\nEither discount each cash flow separately or use Excel's NPV\nfunction\n1 Excel's PV doesn't work for this case\n2 Discount rate 10%\n3\nCash Present Present value\n4 Year flow value of each cash flow\n5 1 100 90.9091 <-- =B5/(1+$B$2)^A5\n6 2 200 165.2893 <-- =B6/(1+$B$2)^A6\n7 3 300 225.3944 <-- =B7/(1+$B$2)^A7\n8 4 400 273.2054 <-- =B8/(1+$B$2)^A8\n9 5 500 310.4607 <-- =B9/(1+$B$2)^A9\n10\n11 Net present value\n12 Summing cells C5:C9 1065.26 <-- =SUM(C5:C9)\n13 Using Excel's NPV function 1065.26 <-- =NPV(B2,B5:B9)\nExcel \u2019 s NPV Function Is Misnamed!\nIn standard fi nance terminology, the p resent value of a series of cash fl ows is\nthe value today of the future cash fl ows:\nPresentvalue=\u2211N CF\nt\n( 1+r)t\nt=1\n2. This strange property\u2014returning negative values for positive cash fl ows\u2014is shared by a\nnumber of otherwise impeccable Excel functions such as PMT and PV. The somewhat convoluted\n16 Chapter 1\nThe net present value is the present value minus the cost of acquiring the asset\n(the cash fl ow at time zero):\nNet presentvalue=\u2211 tN\n=0(\n1C +F rt\n)t\n= C(cid:2) \u2191F\n0\n+ \u2211 (cid:3)tN\n=1(cid:5)(\n(cid:4)11C\n+\n(cid:5)F r(cid:6)t\n)t\nprth iC ca eF tI 0 pn it a m < r ide a 0 p n f, r oy em r s c teea hnaas en te sis a n t shg see t. vaT luh ei ,s g i is v t eh n\u2191 e b p yr e Es xe cn et l\u2032s\nNPV ffunction.\nE xcel\u2019 s language about discounted cash fl ows differs somewhat from the\nstandard fi nance nomenclature. To calculate the fi nance net present value of a\nseries of cash fl ows using Excel, we have to calculate the present value of the\nfuture cash fl ows (using the Excel N PV function), taking into account the\ntime-zero cash fl ow (this is often the cost of the asset in question).\nThe Net Present Value, NPV\nSuppose that the above investment is sold for $400. Clearly it would not be\nworth its purchase price, since\u2014given the alternative return (discount rate) of\n10%\u2014the investment is worth only $379.08. The net present value (NPV) is\nthe applicable concept here. Denoting by r the discount rate applicable to the\ninvestment, the NPV is calculated as follows:\nNPV =CF\n+\u2211N CF\nt\n0 ( 1+r)t\nt=1\nwhere CF is the investment\u2019 s cash fl ow at time t and C F is today\u2019 s cash fl ow.\nt 0\nS uppose, for example, that the series of 5 cash fl ows of $100 is sold for\n$250. Then, as shown below, the NPV = 129.08.\nA B C D\n1 COMPUTING THE NET PRESENT VALUE\n2 Discount rate 10%\n3\nPresent\n4 Year Cash flow value\n5 0 -250 -250.00<-- =B5/(1+$B$2)^A5\n6 1 100 90.91<-- =B6/(1+$B$2)^A6\n7 2 100 82.64<-- =B7/(1+$B$2)^A7\n8 3 100 75.13<-- =B8/(1+$B$2)^A8\n9 4 100 68.30<-- =B9/(1+$B$2)^A9\n10 5 100 62.09<-- =B10/(1+$B$2)^A10\n11\n12 Net present value\n13 Summing cells C5:C10 129.08<-- =SUM(C5:C10)\n17 Basic Financial Calculations\nThe NPV represents the wealth increment of the purchaser of the cash fl ows.\nIf you buy the series of 5 cash fl ows of 100 for 250, then you have gained\n129.08 in wealth today. In a competitive market the NPV of a series of cash\nfl ows ought to be zero: Since the present value should correspond to the market\nprice of the cash fl ows, the NPV should be zero. In other words, the market\nprice of our 5 cash fl ows of 100 ought\u2014in a competitive market, assuming\nthat 10% is the correct risk-adjusted discount rate\u2014be 379.08.\nThe Present Value of an Annuity\u2014Some Useful Formulas3\nAn annuity is a security which pays a constant sum in each period in the future.\nAnnuities may have a fi nite or infi nite series of payments. If the annuity is\nfi nite, and the appropriate discount rate is r, then the value today of the annuity\nis its present value:\nC C C\nPV of finiteannuity= + +\u2026+\n1+r ( 1+r)2 ( 1+r)n\n\u239b 1 \u239e\n1\u2212\n\u239c ( 1+r)n\u239f\n=C\u239c \u239f\n\u239c r \u239f\n\u239d \u23a0\u23a0\nI f the annuity promises an infi nite series of constant future payments, then\nthis formula reduces to:\nC C C\nPV of infiniteannuity= + +\u2026=\n1+r ( 1+r)2 r\nB oth of these formulas can be computed with Excel. Below we compute\nthe value of a fi nite annuity in three ways: using the formula (cell B6), using\nExcel \u2019 s PV function (cell B7), and using Excel \u2019 s N PV function:\n3 . A ll the formulas in this subsection depend on some well-known but oft-forgotten high school\n18 Chapter 1\nA B C\n1 COMPUTING THE VALUE OF A FINITE ANNUITY\n2 Periodic payment, C 1,000\n3 Number of future periods paid, n 5\n4 Discount rate, r 12%\n5 Present value of annuity\n6 Using formula 3,604.78 <-- =B2*(1-1/(1+B4)^B3)/B4\n7 Using Excel's PV function 3,604.78 <-- =PV(B4,B3,-B2)\n8\nAnnuity\n9 Period payment\n10 1 1,000.00 <-- =B2\n11 2 1,000.00\n12 3 1,000.00\n13 4 1,000.00\n14 5 1,000.00\n15\n16 Present value using Excel's NPV function 3,604.78 <-- =NPV(B4,B10:B14)\nComputing the value of an infi nite annuity is even simpler:\nA B C\n1 COMPUTING THE VALUE OF AN INFINITE ANNUITY\n2 Periodic payment, C 1,000\n3 Discount rate, r 12%\n4 Present value of annuity 8,333.33 <-- =B2/B3\nThe Value of a Growing Annuity\nA growing annuity pays out a sum C , which grows at a periodic growth rate\ng . If the annuity is fi nite, its value today is given by:\nC\nC( 1+g) C( 1+g)2\nPV of finitegrowingannuity= + +\n1+r ( 1+r)2 ( 1+r)3\nC( 1+g)n\u22121\n+\u2026++\n( 1+r)n\n\u239b \u239b1+g\u239en\u239e\nC \u239d\u239c1\u2212 \u239d 1+r\u23a0 \u23a0\u239f\n=\n19 Basic Financial Calculations\nTaking this formula and letting n \u2192 \u221e , we can compute the value ofi n fi nite\ngrowing annuity :\nC\nC( 1+g) C( 1+g)2\nPV of infinite growingannuity= + + ++\u2026\n1+r ( 1+r)2 ( 1+r)3\nC 1+g\n= ,provided <1\nr\u2212g 1+r\nT hese formulas can easily be implemented in Excel. Below we compute the\nvalue of a fi nite growing annuity using the formula above and using Excel \u2019 s\nNPV function:\nA B C\n1 COMPUTING THE VALUE OF A FINITE GROWING ANNUITY\n2 First payment, C 1,000\n3 Growth rate of payments, g 6%\n4 Number of future periods paid, n 5\n5 Discount rate, r 12%\n6 Present value of annuity\n7 Using formula 4,010.91 <-- =B2*(1-((1+B3)/(1+B5))^B4)/(B5-B3)\n8\nAnnuity\n9 Period payment\n10 1 1,000.00 <-- =B2\n11 2 1,060.00 <-- =$B$2*(1+$B$3)^(A11-1)\n12 3 1,123.60 <-- =$B$2*(1+$B$3)^(A12-1)\n13 4 1,191.02 <-- =$B$2*(1+$B$3)^(A13-1)\n14 5 1,262.48 <-- =$B$2*(1+$B$3)^(A14-1)\n15\n16 Present value using Excel's NPV function 4,010.91 <-- =NPV(B5,B10:B14)\nWhen the growing annuity has an infi nite life:\nA B C\n1 COMPUTING THE VALUE OF AN INFINITE GROWING ANNUITY\n2 Periodic payment, C 1,000 <-- Starting at date 1\n3 Growth rate of payments, g 6%\n4 Discount rate, r 12%\n20 Chapter 1\nThe Gordon Formula\nThe Gordon formula values a stock by discounting its future anticipated\ndividends at the cost of equity r . Letting P be the current stock\nE 0\nprice, Div the current dividend, and g the growth rate of future dividends,\n0\nthen\nP\n=\u2211\u221e Div 0( 1+g)t\n=\nDiv 0( 1+g)\n0 ( 1+r )t r \u2212g\nt=1 E E\nUsing the formula for an infi nite growing annuity, we can write this as\nDiv\n( 1+g)\nP = 0 provided g < r\n0 r \u2212g E\nE\nInverting this formula shows that\nDiv\n( 1+g)\nr = 0 +g\nE P\n0\nThe Gordon formula is used in Financial Modeling \u2019 s Chapters 2, 4, 5, and\n6 to model the fi rm\u2019 s terminal value and in Chapter 3 to model the fi rm \u2019 s cost\nof equity r .\nE"
        ],
        "1.3": [
            "What is the definition of the Internal Rate of Return (IRR)?\nHow is the IRR computed according to the text?\nWhy is the compound rate of return also known as the Internal Rate of Return?\nCan you explain the role of cash flows in the computation of IRR?\nWhy is Net Present Value (NPV) required to be zero for calculating IRR?\nWhat is the role of Excel's IRR function in financial modelling?\nHow does Excel's IRR function use trial and error method to determine IRR?\nWhat is the concept of 'Discount Rate' in financial modelling?\nWhat is the role of Excel's 'Goal Seek' function in determining the IRR?\nHow are cash flows divided between investment income and the return of the investment principal?\nWhat is the concept of 'Loan Table' in financial calculations?\nWhy does the income component at the end of each year is given by IRR times the principal balance at the beginning of that year?\nHow can loan tables be used to find the IRR?\nWhat is meant by the principal balance in financial calculations?\nHow does Excel\u2019s Rate function compute the IRR of a series of constant future payments?\nWhy does Excel's Rate function require a sign change between the initial investment and the periodic cash flow?\nWhat is the concept of 'Periodic cash flow' in Excel's Rate function?",
            "1.3 The Internal Rate of Return (IRR) and Loan Tables\n\nThe internal rate of return (IRR) is defi ned as the compound rate of return r\nwhich makes the NPV equal to zero:\nCF\n+\u2211N CF\nt =0\n0 ( 1+r)t\nt=1\nT o illustrate, consider the example given in rows 2\u201310 below: A project\ncosting 800 in year zero returns a variable series of cash fl ows at the end of\n21 Basic Financial Calculations\nA B C\n1 INTERNAL RATE OF RETURN\nCash\n2 Year flow\n3 0 -800\n4 1 200\n5 2 250\n6 3 300\n7 4 350\n8 5 400\n9\n10 Internal rate of return 22.16% <-- =IRR(B3:B8)\nNote that the Excel IRR function includes as arguments all of the cash fl ows\nof the investment, including the fi rst\u2014in this case negative\u2014cash fl ow\nof \u2013800.\nDetermining the IRR by Trial and Error\nT here is no simple formula to compute the IRR. Excel\u2019 s IRR function uses\ntrial and error, which can be simulated by using trial and error in a spreadsheet\nas illustrated below:\nA B C\n1 INTERNAL RATE OF RETURN\n2 Discount rate 12%\n3\n4 Year Cash flow\n5 0 -800\n6 1 200\n7 2 250\n8 3 300\n9 4 350\n10 5 400\n11\n12 Net present value (NPV) 240.81<-- =B5+NPV(B2,B6:B10)\nBy playing with the discount rate or by using Excel \u2019 s G oal Seek (found under\nData|What-if analysis, see Chapter 31), we can determine that at 22.16% the\n22 Chapter 1\nA B C\n1 INTERNAL RATE OF RETURN\n2 Discount rate 22.16%\n3\n4 Year Cash flow\n5 0 -800\n6 1 200\n7 2 250\n8 3 300\n9 4 350\n10 5 400\n11\n12 Net present value (NPV) 0.00 <-- =B5+NPV(B2,B6:B10)\nHere \u2019 s the way the Goal Seek screen looked before we got the correct\n23 Basic Financial Calculations\nLoan Tables and the Internal Rate of Return\nThe IRR is the compound r ate of return paid by the investment . To understand\nthis fully, it helps to make a l oan table, which shows the division of the invest-\nment \u2019 s cash fl ows between investment income and the return of the investment\nprincipal:\nA B C D E F\n1 INTERNAL RATE OF RETURN\n2 Year Cash flow\n3 0 -800\n4 1 200\n5 2 250\n6 3 300\n7 4 350\n8 5 400\n9\n10 Internal rate of return 22.16%<-- =IRR(B3:B8)\n11\n12 USING THE IRR IN A LOAN TABLE\nDivision of cash flow\nbetween investment\nincome and return of\n=-B3 =$B$10*B15\n13 principal\nInvestment at\nbeginning of Cash flow Return of\n14 Year year at end of year Income principal\n15 1 800.00 200.00 177.28 22.72 <-- =C15-D15\n16 2 777.28 250.00 172.25 77.75\n17 3 699.53 300.00 155.02 144.98\n18 4 554.55 350.00 122.89 227.11\n19 5 327.44 400.00 72.56 327.44\n20 6 0.00\n21 =B15-E15\n22 The remaining investment principal\n23 in the year after the last cash flow is\n24 zero, indicating that all the principal\n25 has been repaid.\n24 Chapter 1\nThe loan table divides each of the cash fl ows of the asset into an income\ncomponent and a return-of-principal component. The income component at\nthe end of each year is IRR times the principal balance at the beginning of\nthat year. Notice that the principal at the beginning of the last year (327.44 in\nthe example) exactly equals the return of principal at the end of that year.\nW e can use the loan table to fi nd the internal rate of return. Consider an\ninvestment costing 1,000 today that pays off the cash fl ows indicated below\nat the end of years 1, 2, \u2026 5. At a rate of 15% (cell B2), the principal at the\nbeginning of year 6 is negative, indicating that too little has been paid out in\nincome. Thus the IRR must be larger than 15%:\nA B C D E F\n1 USING A LOAN TABLE TO FIND THE IRR\n2 IRR? 15.00%\n3\nDivision of cash flow\nbetween investment\nincome and return of\n4 principal\nPrincipal Cash flow\nat beginning at end of\n5 Year of year year Income Principal\n6 1 1,000.00 300 150.00 150.00 <-- =C6-D6\n7 2 850.00 200 127.50 72.50\n8 3 777.50 150 116.63 33.38\n9 4 744.13 600 111.62 488.38\n10 5 255.74 900 38.36 861.64\n11 6 -605.89\n12 =$B$2*B6\n=B6-E6\n13\nI f the interest rate in cell B3 is indeed the IRR, then cell B11 should be 0. We\ncan use Excel \u2019 s G oal Seek (found under D ata|What-if analysis ) to calculate\n25 Basic Financial Calculations\nAs shown below, the IRR is 24.44%:\nA B C D E F\n1 USING A LOAN TABLE TO FIND THE IRR\n2 IRR? 24.44%\n3\nDivision of cash flow\nbetween investment\nincome and return of\n4 principal\nPrincipal Cash flow\nat beginning at end of\n5 Year of year year Income Principal\n6 1 1,000.00 300 244.36 55.64 <-- =C6-D6\n7 2 944.36 200 230.76 -30.76\n8 3 975.13 150 238.28 -88.28\n9 4 1,063.41 600 259.86 340.14\n10 5 723.26 900 176.74 723.26\n11 6 0.00\n12 =$B$2*B6\n=B6-E6\n26 Chapter 1\nT he loan table is an effective illustration that the IRR is the interest rate that\npays off an investment over its term. Of course, we could have simplifi ed life\nby just using the IRR function:\nA B C D\n15 Direct calculation of IRR\n16 Year Cash flow\n17 0 -1,000\n18 1 300\n19 2 200\n20 3 150\n21 4 600\n22 5 900\n23\n24 IRR 24.44% <-- =IRR(B17:B22)\nExcel \u2019 s Rate Function\nExcel \u2019 s Rate function computes the IRR of a series of constant future pay-\nments. In the example below, we pay $1,000 today for an annual payment of\n$100 for the next 30 years. R ate shows that the IRR is 9.307%:\nA B C\nUSING EXCEL'S RATE FUNCTION TO\n1 COMPUTE THE IRR\n2 Initial investment 1,000\n3 Periodic cash flow 100\n4 Number of payments 30\n5 IRR 9.307%<-- =RATE(B4,B3,-B2)\nNote: Rate works much like P MT and PV discussed elsewhere in this\nchapter; it requires a sign change between the initial investment and the peri-\nodic cash fl ow (note that we have used \u2013B2 in cell B5). It also has switches\nto allow for payments which start today and payments which start one period\n27 Basic Financial Calculations"
        ],
        "1.4": [
            "What is multiple internal rates of return (IRR)? \nHow can the internal rate of return for multiple cash flows be calculated in Excel? \nWhat is the concept behind the Excel's IRR function adding an extra argument? \nWhat is the function of the 'guess' argument in the Excel's IRR formula? \nWhat does NPV graph crossing the x-axis twice signify? \nWhat is the importance of graphing the NPV of the investment as a function of various discount rates? \nHow can IRRs be identified from a graph of NPV against discount rate? \nWhat characterizes a set of cash flows to have multiple IRRs? \nCan you explain why typical cash flows have only one change of sign? \nWhat could be some examples of financial instruments that might exhibit multiple internal rates of return? \nIn terms of cash flow, what is the significance of the changing signs? \nWhat would be the implication if the NPV graph does not cross the x-axis? \nIn the context of bond purchases, what would be the influence of streaming cash flows on the internal rate of return? \nWhat's the relationship between cash flow sign changes and the occurrence of multiple IRRs? \nWhy is the guess in the IRR function not unique? \nHow to determine the number and approximate value of IRRs?\nCan a series of cash flows can have more than one IRR, and why?\nWhat does it mean for the cash flows to have two internal rates of return?\nWhat happens if you don't put in a guess in Excel's IRR function?\nHow is the IRR related to the discount rate in the context of bond cash flows?",
            "1.4 Multiple Internal Rates of Return\n\nS ometimes a series of cash fl ows has more than one IRR. In the next example\nwe can tell that the cash fl ows in cells B6:B11 have two IRRs, since the NPV\ngraph crosses the x-axis twice:\nA B C D E F G H I\n1 MULTIPLE INTERNAL RATES OF RETURN\n2 Discount rate 6%\n3 NPV -3.99<-- =NPV(B2,B7:B11)+B6 DATA TABLE\nDiscount\n4 rate NPV\n5 Year Cash flow -3.99Table header, <-- =B3\n6 0 -145 0% -20.00\n7 1 100 3% -10.51\n8 2 100 6% -3.99\n9 3 100 9% 0.24\n10 4 100 12% 2.69\n11 5 -275 15% 3.77\n12 18% 3.80\n13 21% 3.02\n14 24% 1.62\n15 5.00 27% -0.24\n16 30% -2.44\n17 0.00 33% -4.90\n0% 10% 20% 30% 40%\n18 36% -7.53\n-5.00\n19 39% -10.27\n20 -10.00\n21\n22 -15.00\nNote: For a discussion of how to create data\ntables in Excel, see Chapter 31.\n23\n24 -20.00\n25\n26 -25.00\n27\n28\n29 Identifying the two IRRs\n30 First IRR 8.78%<-- =IRR(B6:B11,0)\n31 Second IRR 26.65%<-- =IRR(B6:B11,0.3)\neulav\ntneserp\nteN\nTwo IRRs\nDiscount rate\nExcel \u2019 s IRR function allows us to add an extra argument which will help\nus fi nd both IRRs. Instead of writing = IRR(B6:B11), we write\n= IRR(B6:B11,guess). The argument guess is a starting point for the algorithm\nwhich Excel uses to fi nd the IRR; by adjusting the guess, we can identify both\n28 Chapter 1\nThere are two things to note about this procedure:\n\u2022 The argument guess merely has to be close to the IRR; it is not unique.\nFor example, by setting the guesses equal to 0.1 and 0.5, we will still get the\nsame IRRs:\nA B C D\n29 Identifying the two IRRs\n30 First IRR 8.78%<-- =IRR(B6:B11,0.1)\n31 Second IRR 26.65%<-- =IRR(B6:B11,0.5)\n\u2022 I n order to identify the number and the approximate value of the IRRs, it\nhelps greatly to graph (as we did above) the NPV of the investment as a func-\ntion of various discount rates. The internal rates of return are then the points\nwhere the graph crosses the x-axis, and the approximate location of these\npoints should be used as the guesses in the IRR function. 4\nF rom a purely technical point of view, a set of cash fl ows can have multiple\nIRRs only if it has at least two changes of sign. Many typical cash fl ows have\nonly one change of sign. Consider, for example, the cash fl ows from purchas-\ning a bond having a 10% coupon, a face value of $1,000, and 8 more years to\nmaturity. If the current market price of the bond is $800, then the stream of\ncash fl ows changes signs only once (from negative in year 0 to positive in\nyears 1\u20138). Thus there is only one IRR:\nA B C D E F G H I J K\n1 BOND CASH FLOWS: NPV CROSSES X-AXIS ONLY ONCE, SO THERE IS ONLY ONE IRR\n2 Year Cash flow Data table: Effect of\n3 0 -800 discount rate on NPV\n4 1 100 1,000.00<-- =NPV(E4,B4:B11)+B3, table header\n5 2 100 0% 1,000.00\n6 3 100 2% 786.04\n1200\n7 4 100 4% 603.96\n8 5 100 6% 448.39 1000\n9 6 100 8% 314.93 800\n10 7 100 10% 200.00 600\n11 8 1,100 12% 100.65 400\n12 14% 14.45 200\n13 IRR 14.36%<-- =IRR(B3:B11) 16% -60.62 0\n14 18% -126.21 -2000% 5% 10% 15% 20%\n15 20% -183.72 -400\n16\n17\nVPN\nNPV of Bond Cash Flows\nDiscount rate\n4 . I f you don\u2019 t put in a guess (as we did in the previous section), Excel defaults to a guess of 0.1.\n29 Basic Financial Calculations"
        ],
        "1.5": [
            "What is a flat payment schedule in terms of a loan?\nWhat does Excel\u2019s PMT function determine in the context of a loan repayment?\nWhy would Excel return a negative payment in terms of a loan principal?\nWhat is meant by the term \"initial loan principal\"?\nHow does the split payment into principal and interest work in a loan repayment schedule?\nAt what point is a loan considered fully repaid according to a flat payment schedule?\nHow can the present value of the payments over the term of a loan be confirmed?\nWhat is the significance of a minus sign before the loan principal while using Excel's PMT function?\nWhat are the factors that need to be considered when calculating the annual payment for a loan with a flat payment schedule?\nCan you elaborate on the computation of a flat repayment for a loan in a typical banking scenario?\nWhat is the implication of the interest rate in the calculation of the annual payment for a loan?\nWhat does it mean when the loan term is stated in number of years over which a loan is repaid?\nIn the context of a loan, what does it mean for the end of year payment to consist of return of interest and principal?",
            "1.5 Flat Payment Schedules\n\nA nother common problem is to compute a \u201cfl at\u201d repayment for a loan. For\nexample: You take a loan for $10,000 at an interest rate of 7% per year. The\nbank wants you to make a series of payments which will pay off the loan and\nthe interest over 10 years. We can use Excel \u2019 s P MT function to determine how\nmuch each annual payment should be:\nNotice that we have put \u201cPV\u201d\u2014Excel \u2019 s nomenclature for the initial loan\nprincipal\u2014with a minus sign. As discussed above, if we do not do this Excel\nreturns a negative payment (a minor irritant). You can confi rm that the answer\n30 Chapter 1\nA B C D E F G\n1 FLAT PAYMENT SCHEDULES\n2 Loan principal 10,000\n3 Interest rate 7%\n4 Loan term 6<-- Number of years over which loan is repaid\n5 Annual payment 2,097.96 <-- =PMT(B3,B4,-B2)\n6\n7 Split payment into: =$B$3*C9\nPrincipal\nat beginning Payment at Return of\n8 Year of year end of year Interest principal\n9 1 10,000.00 2,097.96 700.00 1,397.96\n10 2 8,602.04 2,097.96 602.14 1,495.82 =D9-E9\n11 3 7,106.23 2,097.96 497.44 1,600.52\n12 =C9-F9 4 5,505.70 2,097.96 385.40 1,712.56\n13 5 3,793.15 2,097.96 265.52 1,832.44\n14 6 1,960.71 2,097.96 137.25 1,960.71\n15 7 0.00\nThe zero in cell C15 indicates that the loan is fully repaid over its term of\n6 years. You can easily confi rm that the present value of the payments over\nthe 6 years is the initial principal of 10,000."
        ],
        "1.6": [
            "What is future value?\nWhat does the future value of an amount represent in financial modeling?\nHow is the future value of a deposited amount calculated after a certain period of time?\nWhat is the role of interest rate in calculating the future value of a deposit?\nWhat is the significance of the annual interest rate in financial modeling?\nWhat are the two different scenarios presented in the text related to calculating future values?\nIn the context of future value calculation, what is an Excel function? \nWhat does the Excel function PV refer to in financial modeling?\nWhat does the Excel function FV refer to in financial calculations?\nHow does the deposit frequency affect the future value calculation?\nHow can we calculate the future value with annual deposits in Excel?\nWhat components are needed to calculate future value with recurring annual deposits?\nWhat does the 'Type' in the Excel function FV refer to?\nWhat does a negative return from the FV function in Excel imply?\nIn a financial model, what does an initial account value of zero mean?\nWhat is the financial significance of deposits made at the beginning of each period?\nWhat concept does the term \u2018year 1\u2019 refer to in the statement \u201cTotal at beginning of year 10=1,000*( 1+10%)10+1,000*( 1+10%)9 +\u2026+11,000*( 1+10%)1\u201d?\nWhat is the significance of the variable 't' in the sum equation \"=\u221110 1,000*( 1+10%)t t=1\" in financial modeling?\nCan we calculate future value without using the Excel function FV? If so, what is the alternate method?",
            "1.6 Future Values and Applications\n\nWe start with a triviality. Suppose you deposit 1,000 in an account today,\nleaving it there for 10 years. Suppose the account draws annual interest of\n10%. How much will you have at the end of 10 years? The answer, as shown\n31 Basic Financial Calculations\nA B C D E\n1 SIMPLE FUTURE VALUE\n2 Interest 10%\n3\nAccount\nInterest Total in\nbalance,\nYear earned account,\nbeginning of\nduring year end year\n4 year\n5 1 1,000.00 100.00 1,100.00 <-- =C5+B5\n6 2 1,100.00 110.00 1,210.00 <-- =C6+B6\n7 3 1,210.00 121.00 1,331.00\n8 4 1,331.00 133.10 1,464.10\n=$B$2*B5\n9 5 1,464.10 146.41 1,610.51\n10 6 1,610.51 161.05 1,771.56\n11 7 1,771.56 177.16 1,948.72\n12 8 1,948.72 194.87 2,143.59\n13 9 2,143.59 214.36 2,357.95\n14 10 2,357.95 235.79 2,593.74\n15 11 2,593.74 =D5\n16\n17 A simpler way 2,593.74 <-- =B5*(1+B2)^10\nAs cell C17 shows, you don \u2019 t need all these complicated calculations: The\nfuture value of 1,000 in 10 years at 10% per year is given by:\nFV =1,000*( 1+10%)10 =2,593.74\nN ow consider the following, slightly more complicated, problem: Again,\nyou intend to open a savings account. Your initial deposit of 1,000 today will\nbe followed by a similar deposit at the beginning of years 1, 2, \u2026 , 9. If the\naccount earns 10% per year, how much will you have in the account at the\n32 Chapter 1\nThis problem is easily modeled in Excel:\nA B C D E F\n1 FUTURE VALUE WITH ANNUAL DEPOSITS\n2 Interest 10%\n3 Annual deposit 1,000 <-- Made today and at beginning of each of next 9 years\n4 Number of deposits 10\n5\nAccount\nDeposit at Interest Total in\nbalance,\nYear beginning earned account,\nbeginning of\n6 year of year during year end year\n7 1 0.00 1,000 100.00 1,100.00 <-- =D7+C7+B7\n8 2 1,100.00 1,000 210.00 2,310.00 <-- =D8+C8+B8\n9 3 2,310.00 1,000 331.00 3,641.00\n10 4 3,641.00 1,000 464.10 5,105.10\n=$B$2*(B7+C7)\n11 5 5,105.10 1,000 610.51 6,715.61\n12 6 6,715.61 1,000 771.56 8,487.17\n13 7 8,487.17 1,000 948.72 10,435.89\n14 8 10,435.89 1,000 1,143.59 12,579.48\n15 9 12,579.48 1,000 1,357.95 14,937.42\n16 10 14,937.42 1,000 1,593.74 17,531.17\n17\n18 Future value 17,531.17 <-- =FV(B2,B4,-B3,,1) =E7\nT hus the answer is that we will have 17,531.17 in the account at the end of\nyear 10. This same answer can be represented as a formula that sums the future\nvalues of each deposit:\nTotalatbeginningof\nyear10=1,000*( 1+10%)10+1,000*( 1+10%)9\n+\u2026+11,000*( 1+10%)1\n=\u221110\n1,000*( 1+10%)t\nt=1\nAn Excel function: Note from cell B18 that Excel has a function F V which\n33 Basic Financial Calculations\nWe note three things about this function:\n\u2022 For positive deposits FV returns a negative number. This is an irritating\nproperty of this function, which it shares with P V and PMT . To avoid negative\nnumbers, we have put the P mt in as \u2212 1,000.\n\u2022 The line Pv in the dialog box refers to a situation wherein the account has\nsome initial value other than 0 when the series of deposits is made. In the\nabove example, this has been left blank, which indicates that the initial account\nvalue is zero.\n\u2022 As noted in the picture, \u201cType\u201d (either 1 or 0) refers to whether the deposit\nis made at the beginning or the end of each period (in our example the former\nis the case)."
        ],
        "1.7": [
            "What is a pension problem in the context of future value calculations?\nWhat factors need to be considered while planning for retirement?\nCan you explain the influence of compound interest on retirement planning?\nHow do Excel's Solver and Goal Seek tools assist in financial modeling?\nCan you explain the deposit and withdrawal pattern in a retirement plan?\nWhat is the significance of the interest rate for a retirement account? \nWhat is the role of Excel's Solver in finding the annual deposit for retirement account?\nWhat does the term 'annual deposit' signify in financial modeling? \nWhat is the impact of an annual retirement withdrawal in retirement planning?\nHow is the present value of a series of payments calculated in creating a retirement plan?\nHow are the initial deposits calculated for a retirement account?\nHow to use Excel's PV and PMT functions in financial modelling? \nWhy is discounting process crucial in retirement planning?\nWhat does the term 'account balance' signify in a retiremnt plan?\nHow does compound interest affect the balance of a retirement account?\nHow does the timeline of deposits and withdrawals affect a retirement plan's value?\nCan you explain the effect of compound interest on retirement savings?\nHow is the future value of an investment calculated using Excel?\nWhy is it important to correctly compute the balance at the beginning of the year in a retirement plan?\nWhat is the importance of spreadsheets in financial calculations and modelling?",
            "1.7 A Pension Problem\u2014Complicating the Future Value Problem\n\nA typical exercise is the following: You are currently 55 years old and intend\nto retire at age 60. To make your retirement easier, you intend to start a retire-\nment account:\n\u2022 At the beginning of each of years 1, 2, 3, 4 (that is, starting today and at the\nbeginning of each of the next four years), you intend to make a deposit into\n34 Chapter 1\n\u2022 After retirement at age 60, you anticipate living 8 more years.5 At the begin-\nning of each of these years you want to withdraw $30,000 from your retirement\naccount. Your account balances will continue to earn 8%.\nHow much should you deposit annually in the account? The following\nspreadsheet fragment below shows how easily you can go wrong in this kind\nof problem\u2014in this case, you\u2019 v e calculated that in order to provide $30,000\nper year for 8 years, you need to contribute $240,000/5 = $48,000 in each of\nthe fi rst 5 years. As the spreadsheet shows, you\u2019 l l end up with a lot of money\nat the end of 8 years! (The reason\u2014you \u2019 ve ignored the powerful effects of\ncompound interest. If you set the interest rate in the spreadsheet equal to 0%,\nyou \u2019 ll see that you \u2019 re right.)\nA B C D E F\n1 A RETIREMENT PROBLEM\n2 Interest 8%\n3 Annual deposit 48,000.00\n4 Annual retirement withdrawal 30,000.00\n5 =$B$2*(C7+B7)\nAccount\nDeposit at Interest Total in\nbalance,\nYear beginning earned account,\nbeginning\n6 ofyear of year during year end year\n7 1 0.00 48,000.00 3,840.00 51,840.00<-- =D7+C7+B7\n8 2 51,840.00 48,000.00 7,987.20 107,827.20\n9 3 107,827.20 48,000.00 12,466.18 168,293.38\n10 4 168,293.38 48,000.00 17,303.47 233,596.85\n11 5 233,596.85 48,000.00 22,527.75 304,124.59\n12 6 304,124.59 -30,000.00 21,929.97 296,054.56\n13 7 296,054.56 -30,000.00 21,284.36 287,338.93\n14 8 287,338.93 -30,000.00 20,587.11 277,926.04\n15 9 277,926.04 -30,000.00 19,834.08 267,760.12\n16 10 267,760.12 -30,000.00 19,020.81 256,780.93\n17 11 256,780.93 -30,000.00 18,142.47 244,923.41\n18 12 244,923.41 -30,000.00 17,193.87 232,117.28\n19 13 232,117.28 -30,000.00 16,169.38 218,286.66\n20\nNote: This problem has 5 deposits and 8 annual withdrawals, all made at the beginning of the year. The\nbeginning of year 13 is the last year of the retirement plan; if the annual deposit is correctly computed, the\n21 balance at the beginning of year 13 after the withdrawal should be zero.\n5 . O f course you\u2019 r e going to live much longer! And I wish you good health! The dimensions of\n35 Basic Financial Calculations\nThere are several ways to solve this problem. The fi rst involves Excel \u2019 s\nSolver . This can be found on the Data menu.6\n6. If the Solver does not appear on the Tools menu, then you have to load it. Go to F ile|Options|Add-\nins and click Solver Add-In on the list of programs. Note that you could also use the Goal Seek\ntool to solve this problem. For simple problems such as this one, there is not much difference\nbetween the Solver and G oal Seek ; the one (not inconsiderable) advantage of the Solver is that\nit remembers its previous arguments, so that if you bring it up again on the same spreadsheet, you\ncan see what you did in the previous iteration. In later chapters we will illustrate problems that\n36 Chapter 1\n37 Basic Financial Calculations\nIf we now click on the Solve box, we get the answer:\nA B C D E F\n1 A RETIREMENT PROBLEM\n2 Interest 8%\n3 Annual deposit 29,386.55\n4 Annual retirement withdrawal 30,000.00\n5 =$B$2*(C7+B7)\nAccount\nDeposit at Interest Total in\nbalance,\nYear beginning earned account,\nbeginning\n6 of year of year during year end year\n7 1 0.00 29,386.55 2,350.92 31,737.48<-- =D7+C7+B7\n8 2 31,737.48 29,386.55 4,889.92 66,013.95\n9 3 66,013.95 29,386.55 7,632.04 103,032.54\n10 4 103,032.54 29,386.55 10,593.53 143,012.62\n11 5 143,012.62 29,386.55 13,791.93 186,191.10\n12 6 186,191.10 -30,000.00 12,495.29 168,686.39\n13 7 168,686.39 -30,000.00 11,094.91 149,781.30\n14 8 149,781.30 -30,000.00 9,582.50 129,363.81\n15 9 129,363.81 -30,000.00 7,949.10 107,312.91\n16 10 107,312.91 -30,000.00 6,185.03 83,497.94\n17 11 83,497.94 -30,000.00 4,279.84 57,777.78\n18 12 57,777.78 -30,000.00 2,222.22 30,000.00\n19 13 30,000.00 -30,000.00 0.00 0.00\nSolving the Retirement Problem Using Financial Formulas\nW e can solve this problem in a more intelligent fashion if we understand the\ndiscounting process. The present value of the whole series of payments, dis-\ncounted at 8%, must be zero:\n\u22114 Initialdeposit \u2212\u221112 30,000\n=0\n( 1.08)t ( 1.08)t\nt=0 t=5\n\u21d2Initialdepposit=\u221112 30,000 \u22114 1\n( 1.08)t ( 1.08)t\nt=5 t=0\nRewrite\n\u221112 30,000\n=\n1 \u22118 30,000\n. We can now use Excel \u2019 s PV and\n( 1.08)t ( 1.08)4 ( 1.08)t\nt=5 t=1\n38 Chapter 1\nA B C\n1 A RETIREMENT PROBLEM\n2 Interest 8%\n3 Annual retirement withdrawal 30,000.00\n4 Years of withdrawal 8\n5 Years of deposit 5\n6 Present value of withdrawals 117,331.98 <-- =-PV(B2,B4,B3)/(1+B2)^B5\n7 Annual deposit 29,386.55 <-- =PMT(B2,B5,-B6)"
        ],
        "1.8": [
            "What is continuous compounding in financial terms?\nWhat does it mean if a bank account pays 5% per year?\nCan you explain how interest is calculated when it is compounded twice a year at a rate of 5%?\nWhat happens to the accretion at year-end when you get paid interest n times per year?\nHow is continuous compounding represented in Excel function?\nHow does continuous compounding of $1,000 for 1 year at 5% affect the total amount?\nHow does the amount change when continuous compounding occurs for not a whole number of years (e.g., 4.25 years)?\nWhat does the term \"accretion\" refer to in finance?\nWhat is the effect of multiple compounding periods on the future value?\nHow does the calculation of the continuously compounded return from price data work?\nHow would you calculate the return if you initially had $1,000 in the bank and 1 year later you had $1,200 and the bank paid interest twice a year?\nHow does the compounding method affect the return percentage?\nGiven that there are n compounding periods per year and the initial deposit and end-of-year value, how would you calculate the annual interest rate?\nWhy is continuous compounding/discounting often used in financial calculations?\nWhat is a practical example of using continuous compounding on a given amount of money over a specific period of time?\nWhat is the formula to calculate the continuously compounded annual return? \nHow would you calculate the annualized rate of return if your investment grew over a period of 1 year and 9 months? \nWhat are some areas in finance where continuous compounding is commonly used?\nWhat is the concept of accretion in finance, especially in context of continuous compounding?\nHow can you calculate present value using continuous discounting?",
            "1.8 Continuous Compounding\n\nS uppose you deposit $1,000 in a bank account which pays 5% per year. This\nmeans that at the end of the year you will have $1,000*(1.05) = $1,050. Now\nsuppose that the bank interprets \u201c5% per year\u201d to mean that it pays you\n2.5% interest twice a year. Thus after 6 months you \u2019 ll have $1,025, and\n\u239b 0.05\u239e2\nafter 1 year you will have $1,000* 1+ =$1,050.625 . By this logic,\n\u239d \u23a0\n2\nif you get paid interest n times per year, your accretion at the end of the\n\u239b 0.05\u239en\nyear will be $1,000* 1+ . As n increases this amount gets larger,\n\u239d \u23a0\nn\nconverging (rather quickly, as you will soon see) to e 0 .05, which in Excel is\nwritten as the function Exp . When n is infi nite, we refer to this as continuous\ncompounding. (By typing Exp(1) in a spreadsheet cell, you can see that e =\n2.7182818285. \u2026)\nA s you can see in the next display, $1,000 continuously compounded for 1\nyear at 5% grows to $1,000* e0 .05 = $1,051.271 at the end of the year. Continu-\nously compounded for t years, it will grow to $1,000* e0 .05* t , where t need not\nbe a whole number (for example, when t = 4 .25 then the accumulation factor\ne 0.05*4.25 measures the growth of the initial investment at 5% annually, continu-\n39 Basic Financial Calculations\nA B C\n1 MULTIPLE COMPOUNDING PERIODS\n2 Initial deposit 1,000\n3 Interest rate 5%\n4 Number of compounding periods per year 2\n5 Interest per compounding period 2.500% <-- =B3/B4\n6 Accretion in one year 1,050.625 <-- =B2*(1+B5)^B4\n7 Continuous compounding with Exp 1,051.271 <-- =B2*EXP(B3)\n8\n9 Effect of Multiple Compounding Periods\n10 1,051.40\n11\n1,051.20\n12\n13 1,051.00\n14 1,050.80\n15\n1,050.60\n16\n17 1,050.40\n18 1,050.20\n19\n1,050.00\n20 Number of compounding intervals\n21 1,049.80\n22 1 10 100 1000\n23\nEnd-year\n24 Compounding periods per year accretion\n25 1 1,050.000 <-- =$B$2*(1+$B$3/A25)^A25\n26 2 1,050.625 <-- =$B$2*(1+$B$3/A26)^A26\n27 10 1,051.140\n28 20 1,051.206\n29 50 1,051.245\n30 100 1,051.258\n31 150 1,051.262\n32 300 1,051.267\n33 800 1,051.269\nnoitercca\nraey-dnE\nThe conclusion: More compounding periods increase the future value,\nthough there is a clear asymptotic value; as we will see below, for accretion\nover t years, this value is er t .\nBack to Finance\u2014Continuous Discounting\nIf the accretion factor for continuous compounding at interest r over t years\nis er t, then the discount factor for the same period is e \u2212 rt . Thus a cash fl ow C\nt\noccurring in year t and discounted at continuously compounded rate r will be\nworth C e \u2013 rt today. This is illustrated below:\n40 Chapter 1\nA B C D\n1 CONTINUOUS DISCOUNTING\n2 Interest 8%\n3\nContinously\ndiscounted\n4 Year Cash flow PV\n5 1 100 92.312 <-- =B5*EXP(-$B$2*A5)\n6 2 200 170.429 <-- =B6*EXP(-$B$2*A6)\n7 3 300 235.988\n8 4 400 290.460\n9 5 500 335.160\n10\n11 Present value 1,124.348 <-- =SUM(C5:C9)\nCalculating the Continuously Compounded Return from Price Data\nS uppose at time 0 you had $1,000 in the bank and suppose that 1 year later\nyou had $1,200. What was your percentage return? Although the answer may\nappear obvious, it actually depends on the compounding method. If the bank\npaid interest only once a year, then the return would be 20%:\n1,200\n\u22121=20%\n1,000\nHowever, if the bank paid interest twice a year, you would need to solve\nthe following equation to calculate the return:\n\u239b r\u239e2 r \u239b1,200\u239e1/2\n1 ,000* 1+ =1,200\u21d2 =\u239c \u239f \u22121=9.5445%\n\u239d \u23a0 \u239d \u23a0\n2 2 1,000\nThe annual percentage return when interest is paid twice a year is therefore\n2*9.5445% = 19.089%.\nIn general, if there are n compounding periods per year, you have to solve\nr \u239b1,200\u239e1/n\n=\u239c \u239f \u22121 and then multiply the result appropriately. If n is very large,\n\u239d \u23a0\nn 1,000\n\u239b1,200\u239e\nthis converges to r =ln\u239c \u239f =18.2322% :\n\u239d \u23a0\n41 Basic Financial Calculations\nA B C\n1 CALCULATING RETURNS FROM PRICES\n2 Initial deposit 1,000\n3 End-of-year value 1,200\n4 Number of compounding periods 2\n5 Implied annual interest rate 19.09% <-- =((B3/B2)^(1/B4)-1)*B4\n6\n7 Continuous return 18.23% <-- =LN(B3/B2)\n8\n9 Implied annual interest rate with n compounding periods\n10 Number of compounding periods Rate\n11 19.09% <-- =B5, data table header\n12 1 20.00%\n13 2 19.09%\n14 4 18.65%\n15 8 18.44%\n16 20 18.32%\n17 1,000 18.23%\nWhy Use Continuous Compounding?\nA ll of this may seem somewhat esoteric. However, continuous compounding/\ndiscounting is often used in fi nancial calculations. In this book, it is used to\ncalculate portfolio returns (Chapters 8\u201313) and in practically all of the options\ncalculations (Chapters 15\u201319).\nThere \u2019 s another reason to use continuous compounding\u2014its ease of calcula-\ntion. Suppose, for example, that your $1,000 grew to $1,500 in 1 year and 9\nmonths. What\u2019 s the annualized rate of return? The easiest\u2014and most\nconsistent\u2014way to do this is to calculate the continuously compounded annual\nreturn. Since 1 year and 9 months equals 1.75 years, this return is:\n1 ,000*exp[ r*1.75]=1,500\u21d2r= 1 ln\u23a1 \u23a21,500\u23a4 \u23a5=23.1694%\n42 Chapter 1"
        ],
        "1.9": [
            "What is the process of discounting using dated cash flows?\nCan you explain the term \"fixed periodic intervals\" in financial modeling?\nWhat are XIRR and XNPV functions used for in Excel?\nHow does the XIRR function compute an annualized return?\nWhat does XNPV function compute in financial modeling?\nWhat is the difference between XNPV and NPV functions in Excel?\nWhat are the limitations or bugs present in the XNPV and XIRR functions in Excel?\nWhat problem does NXNPV fix in the Excel financial modeling?\nHow does the Microsoft Excel bug impact calculations with zero or negative interest rates?\nWhat is the problem associated with the XIRR function in Excel?\nHow does NXIRR function fix the bugs in XIRR function?\nHow can we determine multiple internal rates of return using NXIRR function?\nWhat is the significance of internal rates of return in the context of financial modeling? \nHow are payments and cash flows analyzed using discount rates?\nWhat is the role of negative discount rates in financial modeling?\nWhat are the implications of not accurately calculating internal rates of return?",
            "1.9 Discounting Using Dated Cash Flows\n\nMost of the computations in this chapter consider cash fl ows which occur at\nfi xed periodic intervals. Typically we look at cash fl ows which occur on dates\n0, 1, \u2026 , n , where the period indicates an annual, semi-annual, or other fi xed\ninterval. Two Excel functions, XIRR and XNPV, allow us to do computations\non cash fl ows which occur on specifi c dates that need not be at even\nintervals.7\nI n the following example we compute the IRR of an investment of $1,000\nmade on 1 January 2014 with payments on specifi c dates:\nA B C\nUSING XIRR TO COMPUTE THE\nANNUALIZED INTERNAL RATE OF\n1 RETURN\n2 Date Cash flow\n3 01-Jan-14 -1,000\n4 03-Mar-14 150\n5 04-Jul-14 100\n6 12-Oct-14 50\n7 25-Dec-14 1,000\n8\n9 IRR 37.19% <-- =XIRR(B3:B7,A3:A7)\nThe function XIRR outputs an annualized return. It works by computing\nthe daily IRR and annualizing it,\nXIRR=( 1+dailyIRR)365\u22121\n.\nXNPV computes the net present value of a series of cash fl ows occurring\non specifi c dates:\n7. If you do not see these functions, add them in by going to T ools|Add-ins on the toolbar and\n43 Basic Financial Calculations\nA B C\nUSING XNPV TO COMPUTE THE NET\nPRESENT VALUE\n1\n2 Annual discount rate 12%\n3\n4 Date Cash flow\n5 01-Jan-14 -1,000\n6 03-Mar-15 100\n7 04-Jul-15 195\n8 12-Oct-16 350\n9 25-Dec-17 800\n10\n11 Net present value 16.80 <-- =XNPV(B2,B5:B9,A5:A9)\n12\n!\nNote that XNPV has a different syntax from NPV\nXNPV requires all the cash flows, including the initial cash flow,\nwhereas NPV assumes that the first cash flow occurs one period\n13 hence.\nFixing Bugs in XNPV and XIRR\nBoth XNPV and X IRR have bugs, which Microsoft has not fi xed in several\nversions of Excel. The fi le with this chapter includes functions that fi x these\nbugs, called NXNPV and NXIRR .8\n\u2022 XNPV doesn \u2019 t work with zero or negative interest rates.\n\u2022 XIRR does not identify multiple internal rates of return.\nThe XNPV relates to the failure of this function to correctly deal with zero\nor negative discount rates.\n44 Chapter 1\nA B C\nPROBLEM WITH XNPV\n1 XNPV does not work with zero or negative discount rates\n2 Discount rate -3.00%\n3 Net present value #NUM! <-- =XNPV(B2,B7:B13,A7:A13)\n4 -194.87 <-- =nXNPV(B2,B7:B13,A7:A13)\n5\n6 Date Cash flow\n7 30-Jun-14 -500\n8 14-Feb-15 100\n9 14-Feb-16 300\n10 14-Feb-17 400\n11 14-Feb-18 600\n12 14-Feb-19 800\n13 14-Feb-20 -1,800\nThe NXNPV function fi xes this problem.\nThe bug in X IRR is that the G uess switch on X IRR doesn \u2019 t work. Consider\nthe following problem:\nA B C D E F\n1 PROBLEMS WITH XIRR\n2 Discount rate 22.00%\n3 Net present value 64.96186<-- =XNPV(B2,B9:B15,A9:A15)\n4 IRR #NUM! <-- =XIRR(B9:B15,A9:A15) , no Guess\n5 #NUM! <-- =XIRR(B9:B15,A9:A15,35%), Guess = 35%\n6 #NUM! <-- =XIRR(B9:B15,A9:A15,5%) , Guess = 5%\n7\n8 Date Cash flow Data table: XNPV as function of discount rate\n9 30-Jun-14 -500\n10 14-Feb-15 100 Rate 64.962<-- =B3, data table header\n11 14-Feb-16 300 0.1% -97.366\n12 14-Feb-17 400 2.5% -42.753\n13 14-Feb-18 600 4.9% -2.310\n14 14-Feb-19 800 7.3% 26.837\n15 14-Feb-20 -1,800 9.7% 46.983\n16 12.1% 59.961\n17 80 XNPV as Function of Discount Rate 14.5% 67.240\n18 16.9% 70.000\n19 60 19.3% 69.191\n20 21.7% 65.578\n40\n21 24.1% 59.780\n22 20 26.5% 52.296\n23 28.9% 43.528\n24 0 31.3% 33.803\n0% 3% 6% 9% 12% 15% 18% 21% 24% 27% 30% 33% 36% 39% 42%\n25 -20 33.7% 23.384\n26 36.1% 12.484\n27 -40 38.5% 1.272\n28 -60 40.9% -10.113\n29\n30 -80\n31\n-100\n32\n33 -120\n45 Basic Financial Calculations\nFrom the data table, it is evident that there are two internal rates of return\n(around 5% and around 39%). But the XIRR function does not identify either\n(see cells B4:B6).\nThe function NXIRR fi xes this bug:\nA B C\nNXIRR FIXES THE XIRR BUG\n1\n2 Discount rate -3.00%\n3 IRR 5.06% <-- =nXIRR(B8:B14,A8:A14) , no Guess\n4 38.77% <-- =nXIRR(B8:B14,A8:A14,35%), Guess = 35%\n5 5.06% <-- =nXIRR(B8:B14,A8:A14,5%) , Guess = 5%\n6\n7 Date Cash flow\n8 30-Jun-14 -500\n9 14-Feb-15 100\n10 14-Feb-16 300\n11 14-Feb-17 400\n12 14-Feb-18 600\n13 14-Feb-19 800\n14 14-Feb-20 -1,800"
        ]
    },
    "2": {
        "2.1": [
            "What does corporate valuation involve?\nWhat are the key components of valuation as mentioned in the text?\nWhat is the significance of computing the cost of capital in corporate valuation?\nWhat role does the direct valuation of corporate free cash flows play in corporate valuation?\nHow are pro forma financial statements relevant in the process of corporate valuation?\nWhen discussing the valuation of a company, what aspects can be referred to?\nHow can the enterprise value of a company be defined?\nWhat does valuing the equity of a company involve?\nWhat is meant by valuing a company's debt and why could it be considered risky?\nWhich aspects of a company might be considered under 'other' during its valuation?\nWhat are the topics discussed in the initial chapters of Financial Modeling?\nHow can financial modeling be used in corporate valuation?\nHow does the value of a company's debt depend on the value of the issuing company itself?\nWhat are some examples of other securities related to a company that might need to be valued?\nWhat are firm\u2019s warrants or options in the context of corporate valuation?\nWhat is meant by employee stock options in a company's valuation?",
            "2.1 Overview\n\nC hapters 3, 4, 5, and 6 discuss various aspects of corporate valuation, one of\nthe trickiest topics in fi nance. This chapter aims to provide a short overview\nof this complicated topic. In succeeding chapters we turn to the components\nof valuation: The computation of the cost of capital (Chapter 3), the direct\nvaluation of corporate free cash fl ows from the fi rm \u2019 s consolidated statement\nof cash fl ows (Chapter 4), and the projection of fi rm pro forma fi nancial state-\nments (Chapters 5 and 6).\nWhat Is Corporate Valuation About?\nWhen we discuss the valuation of a company, we may be referring to any of\nthe following:\n\u2022 Enterprise value: Valuing the company \u2019 s productive activities.\n\u2022 Equity: Valuing the shares of a company, whether for the purpose of buying\nor selling a single share or valuing all of the equity for purposes of a corporate\nacquisition.\n\u2022 D ebt: Valuing the company\u2019 s debt. When debt is risky, its value depends on\nthe value of the company that has issued the debt.\n\u2022 O ther: We may want to value other securities related to the company\u2014for\nexample, the fi rm \u2019 s warrants or options, employee stock options, etc.\nI n Chapters 2\u20136 of Financial Modeling, we discuss the fi rst two of these\ntopics, leaving the valuation of debt and other securities for later chapters. 1"
        ],
        "2.2": [
            "What is the key concept in corporate valuation? \nCan you elaborate on the term 'enterprise value'? \nWhat does the enterprise value of a firm represent? \nHow many approaches are there to compute enterprise value? \nCan you explain the accounting approach to enterprise value? \nWhy is the accounting approach to EV often used as a starting point for thinking about enterprise value despite criticism? \nWhat does the efficient markets approach to enterprise value entail? \nWhat is an example of revaluation in the efficient markets approach to EV? \nHow does the discounted cash flow approach calculate the enterprise value? \nWhat are free cash flows in financial modeling? \nWhere can the free cash flows produced by a firm originate? \nWhat are the two implementations of the DCF approach used in financial modeling? \nWhat is the basis for projections of future anticipated FCFs in the first implementation of the DCF approach? \nWhat does the term 'pro forma model' mean in terms of financial statements in the second implementation of the DCF approach? \nHow does the pro forma model relate to future anticipated FCFs in the second implementation of the DCF approach?",
            "2.2 Four Methods to Compute Enterprise Value (EV)\n\nT he key concept in corporate valuation is enterprise value . The enterprise\nvalue (EV) of the fi rm is the value of the fi rm\u2019 s core business activities and\nforms the basis of most corporate valuation models. We distinguish between\nfour approaches to computing the enterprise value:\n1 . V aluation of risky bonds is discussed in Chapter 23. The valuation of derivative securities is\n54 Chapter 2\n\u2022 T he accounting approach to EV moves items on the balance sheet so that\nall operating items are on the left-hand side of the balance sheet and all fi nan-\ncial items are on the right-hand side. Although most academics sneer at this\napproach, it is often a useful starting point for thinking about the enterprise\nvalue.\n\u2022 The effi cient markets approach to EV revalues\u2014to the extent possible\u2014\nitems on the accounting EV balance sheet at market values. An obvious revalu-\nation is to replace the fi rm \u2019 s book value of equity with the market value of the\nequity. To the extent that we know the market value of other fi rm liabilities\u2014\ndebt, pension obligations, etc.\u2014this market value will also replace the book\nvalues.\n\u2022 The discounted cash fl ow (DCF) approach values the EV as the present value\nof the fi rm\u2019 s future anticipated free cash fl ows (FCFs) discounted at the\nweighted average cost of capital (WACC). The FCFs can best be thought of\nas the cash fl ows produced by the fi rm\u2019 s productive assets\u2014its working capital,\nfi xed assets, goodwill, etc.\n\u2022 I n this book we use two implementations of the DCF approach. These\napproaches differ in their derivation of the fi rm \u2019 s free cash fl ows.\n(cid:4284) In Chapter 4 we base our projections of future anticipated FCFs on an\nanalysis of the fi rm \u2019 s consolidated statement of cash fl ows.\n(cid:4284) I n Chapters 5 and 6 we base our projections of future anticipated FCFs\non a pro forma model for the fi rm \u2019 s fi nancial statements."
        ],
        "2.3": [
            "What is the concept of enterprise value in the context of accounting book values?\nWhat is the significance of a company's balance sheet during the valuation process?\nHow can accounting statements help define the term 'enterprise value'?\nWhat types of assets constitute a firm's productive assets in the balance sheet rewrite process?\nWhat changes are made to a balance sheet's structure during the rewrite aimed for company valuation?\nWhy do we need to separate operational and financial items in short-term assets and short-term liabilities during balance sheet rewrite?\nWhy are operational current assets moved to the left side of the balance sheet during company valuation?\nWhat is the result when you subtract liquid assets from financial debts in the context of a balance sheet?\nHow does netting out liquid assets from financial debts affect the value of a company?\nWhat is assumed about liquid assets when calculating a firm's enterprise value?\nWhy do we move short-term debt, current portion of long-term debt and other debts to the right side of the balance sheet during company valuation?\nHow do we define a firm's net financial debt in terms of the liquid assets and financial debts?\nIn the enterprise value balance sheet, what does the left-hand side and the right-hand side represent?\nHow does the inventory affect the calculation of net working capital?\nWhat is the role of long-term investments in the enterprise value balance sheet?\nWhat is the impact of stock repurchases on the total assets and total liabilities of a firm?\nHow does a minority interest and preferred stock influence the enterprise value of a company?\nHow are the operational assets of a firm and its enterprise value interlinked?\nWhat is a firm's operational assets comprised of?\nWhen valuing a company, why are cash and marketable securities subtracted from financial debts? \nWhat operational changes can we observe when moving from a standard balance sheet to an enterprise value balance sheet?",
            "2.3 Using Accounting Book Values to Value a Company: The Firm \u2019 s Accounting\n\nEnterprise Value\nWhile we would rarely use accounting numbers to value a company, the\nbalance sheet of a company is a useful starting framework for the valuation\nprocess. In this section we show how accounting statements can help us defi ne\nthe concept of enterprise value (EV). As a starting point, consider the balance\n55 Corporate Valuation Overview\nA B C D EE\n1 XYZ CORP BALANCE SHEET\n2 Assets Liabilities and equity\n3 Short-term assets Short-term liabilities\n4 Cash 1,000 Accounts payable 1,500\n5 Marketable securities 1,500 Taxes payable 200\n6 Inventories 1,500 Current portion of long-term debt 1,000\n7 Accounts receivable 3,000 Short-term debt 500\n8\n9 Fixed assets Long-term debt 1,500\n10 Land 150 Pension liabilities 800\nPlant, property and equipment at\n11 cost 2,500\n12 Minus accumulated depreciation -700 Preferred stock 200\n13 Net fixed assets Minority interest 100\n14\n15 Equity\n16 Goodwill 1,000 Stock at par 1,000\n17 Accumulated retained earnings 3,500\n18 Stock repurchases -350\n19 Total assets 9,950 Total liabilities and equity 9,950\nWe rewrite this balance sheet:\n\u2022 We separate the operational versus fi nancial items in short-term assets and\nshort-term liabilities.\n\u2022 We move the operational current assets to the left side of the balance sheet.\n\u2022 W e move all the debt (short-term debt, current portion of long-term debt,\n56 Chapter 2\nA B C D E F\nXYZ BALANCE SHEET\nOperational current liabilities moved to left side\n1 All financial liabilities in one account on right side\n2 Assets Liabilitiesandequity\nLiquid assets (cash +\n3 marketable securities) 2,500 Financialdebt\nCurrent portion of long-\n4 term debt 1,000\n5 Currentassets,operational Short-termdebt 500\n6 Inventories 1,500 Long-termdebt 1,500\n7 Accountsreceivable 3,000 Totalfinancialdebt 3,000\n8 Minus, current liabilities, operational\n9 Accounts payable -1,500\n10 Taxespayable -200 Pensionliabilities 800\n11 Net working capital 2,800<-- =SUM(B6:B10)\n12 Preferred stock 200\n13 Fixedassets 1,950 Minorityinterest 100\n14\n15 Goodwill 1,000 Equity 4,150\n16\nLeft-hand side of rewritten 8,250<-- Right-hand side of 8,250<--\nbalance sheet =B11+B13+B15+SUM rewritten balance sheet =E7+E10+SUM(\n17 (B3:B4) E12:E15)\nIn the next step we subtract liquid assets (cash and marketable securities)\nfrom fi nancial debts, to get the fi rm \u2019 s net fi nancial debt. When we fi nish this\nstep, we have all of the fi rm \u2019 s productive assets on the left side of the balance\nsheet and all of its fi nancing on the right side. The left-hand side of the result-\ning balance sheet is the fi rm \u2019 s enterprise value , defi ned as the value of the\nfi rm\u2019 s operational assets: These are the assets that provide the cash fl ows for\nthe fi rm \u2019 s actual business activities:\nA B C D E F\n1 XYZ ENTERPRISE VALUE BALANCE SHEET\n2 Assets Liabilitiesandequity\n3 Net working capital 2,800 Total financial debt 3,000\n4 Minus liquid assets -2,500\n5 Fixed assets 1,950 Net debt 500\n6\n7 Goodwill 1,000 Pension liabilities 800\n8\n9 Preferred stock 200\n10 Minority interest 100\n11\n12 Equity 4,150\n13\n57 Corporate Valuation Overview\nCaterpillar Corporation2\nT o show the rewriting of the balance sheet in practice, here is the 31 December\n2011 balance sheet for Caterpillar Corp. (CAT):\nCATERPILLAR CORP., BALANCE SHEET\n31 December 2011\nCurrentassets Currentliabilities\nCash and cash equivalents 3,057,000 Accounts payable 16,946,000\nShort-term investments Short-term debt 9,648,000\nNet receivables 19,533,000 Other current liabilities 1,967,000\nInventory 14,544,000 Total current liabilities 28,561,000\nOther current assets 994,000\nTotal current assets 38,128,000 Long-term debt 24,944,000\nOther liabilities 14,539,000\nLong-term investments 13,211,000\nProperty, plant, and equipment\n(net) 14,395,000 Minority interest 46,000\nGoodwill 7,080,000 Total liabilities 68,090,000\nIntangible assets 4,368,000\nOther assets 2,107,000 Stocks, options, warrants 473,000\nDeferred long-term asset charges 2,157,000 Common stock 4,273,000\nRetained earnings 25,219,000\nTreasury stock -10,281,000\nOther stockholder equity -6,328,000\nTotal equity 13,356,000\nTotal assets 81,446,000 Total equity and liabilities 81,446,000\nT o get to the enterprise value balance sheet for Caterpillar, we move fi nan-\ncial items from the left side of the balance sheet to the right, and we move\noperating current liabilities from the right side of the balance sheet to the left.\nNotice that we netted out liquid assets (cash and marketable securities) from\nthe fi nancial debts of the company. The assumption is that these assets are not\nneeded for the core business activities of Caterpillar.\nThe book value of Caterpillar \u2019 s enterprise value is $59,476,000:\n2. We revisit CAT in Chapter 3, where we compute its weighted average cost of capital, and in\n58 Chapter 2\nA B C D E F\nCATERPILLAR CORP., 2011 ENTERPRISE VALUE BALANCE SHEET\n1 Book values\nNet working capital 16,158,000<-- Net financial debt 31,535,000<--\n=19533000+1454 =9648000+24944000-\n4000+994000- 3057000\n16946000-\n2 1967000\n3 Long-term investments 13,211,000 Other liabilities 14,539,000\n4 Property, plant, and equipment 14,395,000\n5 Goodwill 7,080,000 Minorityinterest 46,000\n6 Intangible assets 4,368,000\n7 Otherassets 2,107,000 Equity 13,356,000\n8 Deferred long-term asset charges 2,157,000\n9 Enterprise value 59,476,000<-- =SUM(B2:B8)Enterprise value 59,476,000<-- =SUM(E2:E7)"
        ],
        "2.4": [
            "What does the Efficient Markets Approach to Corporate Valuation assume?\nWhat is the market value and how is it used in the Efficient Markets Approach to Corporate Valuation?\nWhat are the financial components needed to calculate the enterprise value of a company?\nWhat is Net working capital and how is it significant to a company's valuation?\nCan the Efficient Markets Approach to Corporate Valuation apply to all components of a firm's balance sheet? \nWhat do you mean by 'book value' in the context of corporate valuation?\nDoes the market value always align with the book value of an enterprise in the Efficient Markets Approach?\nHow does the Efficient Markets Approach differ from the accounting approach in corporate valuation?\nWhy could market price be considered as the 'true value' of a company in the Efficient Markets Approach?\nWhat could be some disadvantages of the Efficient Markets Approach to Corporate Valuation?\nWhat is meant by 'revaluing' in the context of the Efficient Markets Approach to Corporate Valuation?\nWhat is the meaning of net financial debt and how is it calculated?\nHow can long-term assets be recomputed for a balance sheet in the context of the Efficient Markets Approach?\nWhy is the revaluation of financial obligations or other liabilities typically not done in the Efficient Markets Approach?\nWhat is the significance of the balance sheet in the Efficient Markets Approach to Corporate Valuation? \nWhat are the key assumptions behind the Efficient Markets Approach to Corporate Valuation based on academic research? \nWhat is 'market cap' and how is it calculated?\nWhat is the role of minority interest in the Efficient Markets Approach to Corporate Valuation?\nWhat is the relationship between net working capital\u2019s book value and its market value in the Efficient Markets Approach?\nWhat are the key components of a firm\u2019s balance sheet that are typically revalued in the Efficient Markets Approach?",
            "2.4 The Effi cient Markets Approach to Corporate Valuation\n\nT he Caterpillar example above assumes that the book value is a correct valu-\nation of the company. But a simple calculation shows how problematic this is:\nAt the end of 2011 Caterpillar had 624.72 million shares outstanding, and the\nmarket price per share was $90.60. This suggests that the Caterpillar\u2019 s enter-\nprise value is $102.720 billion\u2014a far cry from the book value of the enterprise\nvalue of $59.476 billion.\nA B C\nCATERPILLAR VALUATION OF EQUITY AND FINANCIAL LIABILITIES:\nEFFICIENT MARKETS APPROACH\nMost figures in thousand $\n1\n2 Numberofsharesoutstanding 624,722.72<-- thousand shares\n3 Pricepershare 90.60<-- 30dec2011\n4 Equityvalue(\"MarketCap\") 56,599,878<-- =B2*B3, thousand $\n5\n6 Cashandcashequivalents 3,057,000\n7 Short-term debt and current portion of long-term debt 9,648,000\n8 Long-termdebt 24,944,000\n9 Netdebt 31,535,000<-- =SUM(B7:B8)-B6\n10\n11 Otherliabilities 14,539,000\n12\n13 Minorityinterest 46,000\n14 Preferredstock 0\n15\nEnterprise value: Equity + Net debt 102,719,878<-- =SUM(B4,B9,B11,B13)\n16 + Minority Interest + Preferred\nThe effi cient markets approach to the valuation of Caterpillar\u2019 s equity and\n59 Corporate Valuation Overview\ndebt is simply the market value at the time of valuation. This approach is better\nthan the accounting approach of the previous section and much simpler than\nthe DCF valuations illustrated in succeeding sections and in Chapters 5 and\n6. Moreover, it has the power of logic and much academic research behind it.\nIf markets work\u2014in the sense that there are many participants trading the\ncorporate securities, that there is a lot of information about the company in\nquestion, and that the valuator has no special information\u2014why not accept the\nmarket price as the true value of the company? 3\nA pplying the effi cient markets approach to the Caterpillar Enterprise Value\nBalance sheet gives 102,719,878 for the right-hand side of the enterprise value\nbalance sheet. This means, of course, that we have to revalue the left-hand side\nof the balance sheet. One approach to bringing this enterprise value balance\nsheet into balance is to assume that the net working capital\u2019 s book value is a\nreasonable approximation to its market value. We can then recompute the\nmarket value of the fi rm \u2019 s long-term assets to bring the balance sheet into\nbalance.\nA B C D E F\nCATERPILLAR CORP., 2011 ENTERPRISE VALUE BALANCE SHEET\nRight-hand side revalued at market values\nLeft-hand side brought into balance with right-hand side by adjusting long-term assets\n1\nNet working capital 16,158,000<-- Net financial debt 31,535,000<--\n=19533000+1454 =9648000+24944000-\n4000+994000- 3057000\n16946000-\n2 1967000\n3 Long-terminvestments Otherliabilities 14,539,000\n4 Property, plant, and equipment\n5 Goodwill Minorityinterest 46,000\n86,561,878 <-- =E10-B2\n6 Intangible assets\n7 Otherassets Equity 56,599,878<-- Market cap\n8 Deferred long-term asset charges\n9\n10 Enterprise value 102,719,878<-- =SUM(B2:B8)Enterprise value 102,719,878<-- =SUM(E2:E7)\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n3. We have to be careful: Market prices change over time, often precipitously. The effi cient\nmarkets hypothesis only says that it is impossible to predict market prices beyond the information\n60 Chapter 2\nNote that we could also apply the market valuation to other components of\nthe right-hand side of the balance sheet\u2014we could try to revalue the fi rm \u2019 s\nfi nancial obligations, its other liabilities, and minority interest. This is usually\nnot done, unless there is a convincing case that the book values for these liabili-\nties differ materially from their market value."
        ],
        "2.5": [
            "What is the enterprise value (EV) in terms of financial modeling?\nWhat is meant by DCF \u201cTop Down\u201d Valuation?\nWhat is the role of discounted cash flow (DCF) method in financial modeling?\nWhat are the Free Cash Flows (FCFs) in financial modeling?\nHow is Weighted Average Cost of Capital (WACC) defined in the context of financial modelling?\nHow does the firm's enterprise value (EV) relate to its future Free Cash Flows (FCFs)?\nWhat do we mean by the firm's operating activities in the context of Free Cash Flows (FCFs)?\nWhat are some typical assets considered while calculating Free Cash Flows in financial modeling?\nWhy do we use an adjusted half-year value while calculating the enterprise value (EV) with Excel\u2019s NPV function? \nWhat is the basic concept of defining Free Cash Flow (FCF)?\nIs there any difference between Free Cash Flow based on Income statement and on EBIT(Earnings Before Interest and Taxes)? If yes, what are they?\nHow does Profit After Taxes contribute to the calculation of Free Cash Flow?\nHow do Depreciation and other non-cash expenses impact the calculation of Free Cash Flow?\nWhat is the effect of an increase in operating current assets on Free Cash Flow?\nWhy is an increase in operating current liabilities considered while calculating the Free Cash Flow?\nWhy is Adjusted Interest included in the calculation of Free Cash Flow?\nIn the context of financial modelling, how do we predict Future Flow Cash Flows (FCFs)?\nWhat are the two methods of deriving the cash flows used in this book?\nWhat role does consolidated statement of cash flow (CSCF) play in predicting Future Flow Cash Flows (FCFs)? \nWhat is the relevance of pro forma financial statements in the estimation of free cash flows?",
            "2.5 Enterprise Value (EV) as the Present Value of the Free Cash Flows:\n\nDCF \u201cTop Down\u201d Valuation\nI n the previous section we valued the EV by using the market value of the\nright-hand side of the fi rm\u2019 s enterprise value balance sheet\u2014using the market\nvalue of its equity and perhaps the market valuation of other elements of the\nfi rm \u2019 s fi nancing. In this section we concentrate on the left-hand side of the\nenterprise value balance sheet.\nThe discounted cash fl ow (DCF) method focuses on two central concepts:\n\u2022 The fi rm \u2019 s free cash fl ows (FCFs) are defi ned as the cash created by the\nfi rm \u2019 s operating activities.\n\u2022 The fi rm \u2019 s weighted average cost of capital (WACC) is the risk-adjusted\ndiscount rate appropriate to the risk of the FCFs (Chapter 3).\n\u2022 The fi rm \u2019 s enterprise value ( EV) is the present value of the future FCFs\ndiscounted at the WACC: E V\n=\u2211\u221e FCF\nt . The idea is to value a\n( 1+WACC)t\nt=1\ncompany by considering the present value of the FCFs, where FCF is defi ned\nas the cash fl ow to the fi rm from its assets (the word a ssets is used broadly,\nand can be fi xed assets, intellectual and trademark assets, and net working\ncapital). The next subsection discusses this concept in more detail.\n\u2022 I n these chapters we often make two additional assumptions: We assume a\nlimited number of predictive periods for the FCFs and we assume that cash\nfl ows occur throughout the year. This leads to\nEV\n=\u2211N FCF\nt +\nTerminalvalue\n( 1+WACC)t\u22120.5 ( 1+WACC)N\u22120.5\nt=1\n=\u23a1 \u23a2\u2211N FCF t +Terminalvalue\u23a4 \u23a5( 1+WACC)0.5\n\u23a3 (cid:2)t=(cid:4)1( (cid:4)1++ (cid:4)W(cid:4)A(cid:4)CC(cid:4)(cid:4))t (cid:3)(cid:4)( 1(cid:4)+ (cid:4)W(cid:4)A(cid:4)CC(cid:4))N (cid:4)(cid:5)\u23a6\n\u2191\nComputed with EExcel\u2032s NPV function\nThe assumption that, for valuation purposes, cash fl ows occur approxi-\n61 Corporate Valuation Overview\noccur throughout the year and that it is therefore a mistake to value them as\nif they occur at year-end. As can be seen from the above formula, the mid-year\nassumption is easy to compute in Excel: We simply take the Excel NPV and\nmultiply it by (1 + WACC)0 .5 .\nDefi ning the Free Cash Flow (FCF)\nThe free cash fl ow (FCF) is a measure of how much cash is produced by the\nfi rm\u2019 s operations. There are two accepted defi nitions of the FCF (both of\nwhich, of course, ultimately boil down to the same thing).\nFree Cash Flow Based on the Income Statement\nProfi t after taxes This is the basic measure of the profi tability of the business,\nbut it is an accounting measure that includes fi nancing fl ows\n(such as interest), as well as non-cash expenses such as\ndepreciation. Profi t after taxes does not account for either\nchanges in the fi rm \u2019 s working capital or purchases of new\nfi xed assets, both of which can be important cash drains on\nthe fi rm.\n+ Depreciation and Depreciation is a non-cash expense that in the FCF\nother non-cash calculation is added back to the profi t after tax. To the extent\nexpenses that there are other non-cash expenses in the fi rm \u2019 s income\nstatement, these are also added back.\n\u2212 Increase in When the fi rm \u2019 s sales increase, more investment is needed in\noperating current inventories, accounts receivable, etc. This increase in current\nassets assets is not an expense for tax purposes (and is therefore\nignored in the profi t after taxes), but it is a cash drain on the\ncompany. When adjusting the FCF for current assets, we take\ncare to not include fi nancial current assets that are not directly\nrelated to sales such as cash and marketable securities.\n+ Increase in An increase in the sales often causes an increase in fi nancing\noperating current related to sales (such as accounts payable or taxes payable).\nliabilities This increase in current liabilities\u2014when related to sales\u2014\nprovides cash to the fi rm. Since it is directly related to sales,\nwe include this cash in the free cash fl ow calculations. When\nadjusting the FCF for current liabilities, we take care to not\ninclude fi nancial current liabilities that are not directly related\nto sales: changes in short-term debt and the current portion of\n62 Chapter 2\n\u2212 Increase in fi xed An increase in fi xed assets (the long-term productive assets of\nassets at cost the company) is a use of cash, which reduces the fi rm \u2019 s free\n(CAPEX) cash fl ow.\n+ After-tax interest FCF is an attempt to measure the cash produced by the\npayments (net) business activity of the fi rm. To neutralize the effect of\ninterest payments on the fi rm \u2019 s profi ts, we:\n\u2022 Add back the after-tax cost of interest on debt (a fter-tax\nsince interest payments are tax-deductible),\n\u2022 Subtract out the after-tax interest payments on cash and\nmarketable securities.\nA n alternative, equivalent, defi nition is based on the fi rm \u2019 s earnings before\nincome and taxes:\nFree Cash Flow Based on the EBIT (earnings before interest and taxes)\nEBIT\n+ Depreciation and other non-cash\nexpenses\n\u2212 Increase in Operating Current Assets The sum \u2013 \u0394 CA + \u0394 CL is the change in the\n+ Increase in Operating Current fi rm \u2019 s net working capital \u0394 NWC\nLiabilities\n\u2212 Increase in fi xed assets at cost\n(CAPEX)\nHow Can We Predict Future FCFs?\nT he most critical aspect in valuing a company is to project its anticipated future\nfree cash fl ows. In this book we explore two ways of deriving these cash fl ows.\nBoth methods are primarily based on accounting data. Since accounting data\nis historical data, we need to add some judgment about how this data will\ndevelop in the future.\n\u2022 O ne method is to base our estimates of future free cash fl ows on the con-\nsolidated statement of cash fl ows (CSCF) of the fi rm (Chapter 4).\n\u2022 T he second method is to estimate a set of pro forma fi nancial statements for\nthe fi rm and to derive the free cash fl ows from these statements (Chapter 5).\n63 Corporate Valuation Overview"
        ],
        "2.6": [
            "What is a Consolidated Statement of Cash Flows (CSCF)?\nWhat are the three sections of a CSCF?\nHow is Free Cash Flow (FCF) determined based on the CSCF?\nHow are operating cash flows reported within the CSCF?\nHow are investment cash flows reported within the CSCF?\nHow are financing cash flows accounted for in the CSCF?\nWhat aspects of the CSCF are considered for determining FCF?\nWhy is investment in securities not part of the firm's free cash flows?\nHow do investment cash flows related to productive activities and financial assets differ in their relevance to free cash flows?\nWhat changes are considered in the operating cash flow section of the CSCF when computing the firm's FCF?\nWhat is the role of depreciation in adjustments made to the firm's income for non-cash deductions?\nHow is the issuance of stock options to employees reflected in the firm's income and subsequently in the CSCF?\nWhat is meant by impairment of goodwill in the context of a firm's income statements?\nHow is impairment of goodwill treated in the CSCF?\nHow are financial investments treated in the CSCF?\nWhat constitutes investments in fixed assets in the CSCF?\nHow are investments in the operating assets of a firm reported in the CSCF?\nHow is the firm's financing reflected in the CSCF?\nWhat part of the firm's financing is considered for Free Cash Flows computations?\nWhy are one-time specific items eliminated from consideration when determining FCFs?\nWhat adjustments are made to the totals of the adjusted CSCF numbers when determining FCFs?",
            "2.6 Free Cash Flows Based on Consolidated Statement of Cash Flows (CSCF)\n\nT he consolidated statement of cash fl ows is part of every fi nancial statement.\nIt is the accountant\u2019 s explanation of how much cash was generated by the\nbusiness, and how this cash was generated. The consolidated statement of cash\nfl ows (CSCF) is composed of three sections: Operating cash fl ows, investment\ncash fl ows, and fi nancing cash fl ows. When we use the CSCF to determine\nFCFs, we use the following general procedure (explanations are given in sub-\nsequent subsections and again in Chapter 4):\n\u2022 We accept the operating cash fl ows as reported by the fi rm.\n\u2022 We carefully examine the investment cash fl ows, leaving for the FCF\nthe investment cash fl ows related to productive activities and eliminating\nthose investment cash fl ows relating to investment by the fi rm in fi nancial\nassets.\n\u2022 We do not count toward the FCF any of the fi nancial cash fl ows.\n\u2022 In all cases we are careful about whether specifi c items are one time or\nrecurring, eliminating from consideration the one-time items.\n\u2022 We adjust the totals of the adjusted CSCF numbers by adding back net inter-\nest paid.\nT he subsections below contain further explanations. A worked-out example\nis given in the next section.\nCSCF, Section 1: Operating Cash Flows\nThe operating cash fl ows adjust the fi rm \u2019 s net income for non-cash deductions\nto the income and for changes in the fi rm \u2019 s operating net working capital.\nBecause modern accounting statements include many non-cash items, translat-\ning the fi rm \u2019 s accounts to a cash basis necessitates many adjustments. A classic\nadjustment is to add back depreciation to the fi rm\u2019 s income: Since depreciation\nis a non-cash charge on the fi rm \u2019 s income, it must be added back when making\nthe adjustment for cash. But depreciation is just the tip of the non-cash iceberg:\n\u2022 When fi rms issue stock options to employees, the value of these options is\ndeducted from the fi rm\u2019 s income. The logic behind this\u2014that in giving its\nemployees options, the fi rm has given them something of value which must\n64 Chapter 2\nfor options is a non-cash deduction, and in the consolidated statement of cash\nfl ows, it is added back.\n\u2022 A fi rm \u2019 s income statements must refl ect the decrease in goodwill (so-called\n\u201cimpairment\u201d). This impairment\u2014the loss in economic value of an intangible\nasset that was purchased by the fi rm\u2014is an economic loss to the fi rm \u2019 s share-\nholders. But it is not a cash fl ow loss, and in the consolidated statement of\ncash fl ows it is added back.\n\u2022 The list can include a large number of additional items, as we shall see in\nChapter 4.\nF or purposes of computing the fi rm\u2019 s free cash fl ows, we can usually leave all\nthe items in the operating cash fl ow section of the CSCF.\nSCF, Section 2: Investment Cash Flows\nT he second section of the CSCF includes all investments made by the fi rm.\nThese investments include both investments in securities and investments in\noperating assets of the fi rm.\n\u2022 Investment in securities can refer to the sale or the purchase of securities\nheld by the fi rm. Investment in securities is not part of the fi rm \u2019 s free cash\nfl ows, which are intended to measure solely cash fl ows related to the fi rm \u2019 s\ncore business activities.\n\u2022 Investments in fi xed assets are usually related to the fi rm \u2019 s FCFs.\nF or purposes of computing the fi rm\u2019 s free cash fl ows, we need to distinguish\nbetween fi nancial investment cash fl ows (not part of the FCF) and investment\nin assets used to produce the fi rm \u2019 s business income (part of the FCF).\nCSCF, Section 3: Financing Cash Flows\nThe last section of the CSCF deals with changes in the fi rm \u2019 s fi nancing. For\nFCF purposes, we can ignore this section."
        ],
        "2.7": [
            "What is a Consolidated Statement of Cash Flows (CSCF) in the context of Financial Modeling?\nWhat is the purpose of adjustments to reconcile net earnings to net cash in a CSCF?\nWhat does \"Add back depreciation and amortization\" mean in a CSCF?\nWhat does a negative value in subtract increase in inventory signify in a CSCF?\nWhy is it necessary to subtract increase in prepaid expenses and other assets in a CSCF?\nWhat is the significance of adding back the increase in accounts payable, accrued expenses, pensions, and other liabilities in a CSCF?\nWhy do we calculate the net cash provided by operating activities in a CSCF?\nWhat is the importance of short-term investments in Investing Activities of a CSCF?\nWhy do we subtract purchases of property, plant, and equipment in the Investing Activities of a CSCF?\nWhy do we calculate the net cash used in investing activities in a CSCF?\nWhat is the significance of 'Proceeds from revolving credit facility borrowings' in Financing Activities of a CSCF?\nWhy do we subtract dividends paid in Financing Activities of a CSCF?\nWhat does the stock repurchased indicate in the Financing Activities of a CSCF?\nWhat does the 'Changes in cash balances' figure represent in a CSCF?\nWhy is it important to calculate free cash flow in financial modelling?\nHow is an income tax rate calculated in a CSCF?\nWhy might we delete certain items from the Investing Activities section when converting a CSCF into a free cash flow?\nWhy do we add back after-tax net interest to the sum of the remaining items in calculating free cash flow?\nHow can historical free cash flows be used for cash flow projections?\nWhat is the significance of the growth rate of Free Cash Flow (FCF)?\nWhat is the meaning and importance of the Weighted Average Cost of Capital (WACC)?\nHow is the terminal value calculated in financial valuation?\nWhat is the significance of the enterprise value in financial modeling?\nWhy do we add back initial cash and marketable securities in calculating equity value?\nWhat is the significance of subtracting out financial liabilities in calculating equity value?\nWhat information does the 'Per share' value provide in the context of financial valuation?",
            "2.7 ABC Corp., Consolidated Statement of Cash Flows (CSCF)\n\nF ive years of the consolidated statement of cash fl ows of ABC Corp. are given\n65 Corporate Valuation Overview\nA B C D E F G\nABC CORPORATION\n1 Consolidated Statement of Cash Flows, 2008-2012\n2 2008 2009 2010 2011 2012\n3 Operating Activities:\n4 Net earnings 479,355 495,597 534,268 505,856 520,273\nAdjustments to reconcile net earnings to net cash\n5 provided by operating activities\n6 Add back depreciation and amortization 41,583 47,647 46,438 45,839 46,622\n7 Changes in operating assets and liabilities:\n8 Subtract increase in accounts receivable 9,387 25,951 -12,724 1,685 -2,153\n9 Subtract increase in inventories -37,630 -22,780 -16,247 -15,780 -5,517\nSubtract increase in prepaid expenses and\n-52,191 13,573 16,255 14,703 -2,975\n10 other assets\nAdd increase in accounts payable, accrued 29,612 51,172 6,757 40,541 60,255\n11 expenses, pensions, and other liabilities\n12 Net cash provided by operating activities 470,116 611,160 574,747 592,844 616,505<-- =SUM(F4:F11)\n13\n14 Investing Activities:\n15 Short-term investments, net -5,000 -55,000 50,000 -10,000 20,000\n16 Purchases of property, plant, and equipment -48,944 -70,326 -89,947 -37,044 -88,426\nProceeds from dispositions of property, plant and\n17 equipment 197 6,956 22,942 6,179 28,693\n18 Net cash used in investing activities -53,747 -118,370 -17,005 -40,865 -39,733<-- =SUM(F15:F17)\n19\n20 Financing Activities:\n21 Repayment of debt 0 0 -300,000 0 -7,095\n22 Proceeds from revolving credit facility borrowings 1,242,431 0 0 0 250,000\n23 Proceeds from the issuance of stock 48,286 114,276 69,375 68,214 37,855\n24 Dividends paid -332,986 -344,128 -361,208 -367,499 -378,325\n25 Stock repurchased -150,095 -200,031 -200,038 -200,003 -597,738\n26 Net cash used in financing activities 807,636 -429,883 -791,871 -499,288 -695,303<-- =SUM(F21:F25)\n27\n28 Changes in cash balances 1,224,005 62,907 -234,129 52,691 -118,531<-- =F12+F18+F26\n29\n30 Supplemental disclosure of cash flow information\n31 Cash paid during the period for\n32 Income taxes 255,043 175,972 314,735 283,618 305,094\n33 Interest 83,553 83,551 70,351 57,151 57,910\n34\n35 Income tax rate 34.73% 26.20% 37.07% 35.92% 36.96%<-- =F32/(F4+F32)\nTo turn these CSCF into free cash fl ows:\n\u2022 We keep all the items under operating activities.\n\u2022 In the section for Investing Activities, we delete items that are not related\nto operations. For example, we would delete \u201cshort-term investments, net\u201d\nunder Investing Activities\u2014these represent the purchase and sale of fi nancial\nassets.\n\u2022 We completely ignore the cash fl ows under Financing Activities\n\u2022 W e add back after-tax net interest to the sum of the remaining items to\n66 Chapter 2\nA B C D E F G\nABC CORPORATION\n1 CSCF rewritten to Free Cash Flow (FCF)\n2 2008 2009 2010 2011 2012\n3 Operating Activities:\n4 Net earnings 479,355 495,597 534,268 505,856 520,273\nAdjustments to reconcile net earnings to net cash\n5 provided by operating activities\n6 Add back depreciation and amortization 41,583 47,647 46,438 45,839 46,622\n7 Changes in operating assets and liabilities:\n8 Subtract increase in accounts receivable 9,387 25,951 -12,724 1,685 -2,153\n9 Subtract increase in inventories -37,630 -22,780 -16,247 -15,780 -5,517\nSubtract increase in prepaid expenses and -52,191 13,573\n10 other assets 16,255 14,703 -2,975\nAdd increase in accounts payable, accrued 29,612 51,172\n11 expenses, pensions and other liabilities 6,757 40,541 60,255\n12 Net cash provided by operating activities 470,116 611,160 574,747 592,844 616,505<-- =SUM(F4:F11)\n13\n14 Investing Activities:\n15 Short-term investments, net\n16 Purchases of property, plant and equipment -48,944 -70,326 -89,947 -37,044 -88,426\nProceeds from dispositions of property, plant and\n197 6,956 22,942 6,179 28,693\n17 equipment\n18 Net cash used in investing activities -53,747 -118,370 -67,005 -30,865 -59,733<-- =SUM(F15:F17)\n19\n20 Financing Activities:\n21 Repayment of debt\n22 Proceeds from revolving credit facility borrowings\n23 Proceeds from the issuance of stock\n24 Dividends paid\n25 Stock repurchased\n26 Net cash used in financing activities <--\n27\n28 Free cash flow before interest adjustment 416,369 492,790 507,742 561,979 556,772<-- =F12+F18+F26\n29 Add back after-tax net interest 54,537 61,658 44,271 36,620 36,504<-- =(1-F37)*F35\n30 Free cash flow (FCF) 470,906 554,448 552,013 598,599 593,276<-- =F28+F29\n31\n32 Supplemental disclosure of cash flow information\n33 Cash paid during the period for\n34 Income taxes 255,043 175,972 314,735 283,618 305,094\n35 Interest 83,553 83,551 70,351 57,151 57,910\n36\n37 Income tax rate 34.73% 26.20% 37.07% 35.92% 36.96%<-- =F34/(F4+F34)\nIn Chapter 4 we discuss how these historical free cash fl ows can be used as\nthe basis for cash fl ow projections. One valuation of a company might look\n67 Corporate Valuation Overview\nA B C D E F G H\n1 ABC CORP. VALUATION\nFree cash flow (FCF)\n2 year ending 31 Dec. 2012 593,276<-- 593275.77278229\n3 Growth rate of FCF, years 1-5 8.00%<-- Optimistic about short-term growth\n4 Long-term FCF growth rate 5.00%<-- More pessimistic about long-term growth\n5 Weighted average cost of capital, WACC 10.70%\n6\n7 Year 2012 2013 2014 2015 2016 2017\n8 FCF 640,738 691,997 747,357 807,145 871,717<-- =F8*(1+$B$3)\n9 Terminal value 16,057,940<-- =G8*(1+B4)/(B5-B4)\n10 Total 640,738 691,997 747,357 807,145 16,929,657<-- =G8+G9\n11\n12 Enterprisevalue 13,063,055<-- =NPV(B5,C10:G10)*(1+B5)^0.5\nAdd back initial cash and marketable\n13 securities 73,697<-- From current balance sheet\n14 Subtract out 2012 financial liabilities 1,379,106<-- From current balance sheet\n15 Equityvalue 11,757,646<-- =B12+B13-B14\n16 Per share (1 million shares outstanding) 11.76<-- =B15/1000000"
        ],
        "2.8": [
            "What is meant by \"free cash flows\" in the context of financial modeling?\nCan you explain the construction of a predictive financial model?\nHow are pro forma financial statements used to project free cash flows? \nWhat are the elements included in a typical pro forma financial model?\nWhat is the role of sales growth in a pro forma financial model?\nWhat impact do current assets and current liabilities have on a pro forma financial model?\nIn the context of a pro forma financial model, what is the significance of net fixed assets?\nWhat are the implications of costs of goods sold in a pro forma financial model?\nWhat role do depreciation and interest rates play in a pro forma financial model?\nHow does the tax rate influence a pro forma financial model?\nWhat is the significance of the dividend payout ratio in the financial model?\nHow does the process of calculating free cash flow work in a pro forma financial model?\nHow does one calculate the enterprise value of a firm using free cash flows? \nWhat are the elements included in the calculation of enterprise value?\nWhat is the significance of weighted average cost of capital in valuing the firm?\nHow is the long-term free cash flow growth rate factored into the valuation of a firm?\nWhat is meant by the firm's asset value, and how is it calculated?\nHow is the value of the firm's debt taken into account in the valuation?\nWhat does the term equity value signify in the context of the financial model?\nHow is the share value determined in a pro forma financial model?",
            "2.8 Free Cash Flows Based on Pro Forma Financial Statements\n\nAnother way to project free cash fl ows is to build a set of p redictive fi nancial\nstatements based on our understanding of the company and its fi nancial state-\nments. We discuss the construction of such a model in Chapter 5 and give a\nfully worked-out example for Caterpillar in Chapter 6. A typical model might\n68 Chapter 2\nA B C D E F G\n1 PRO FORMA FINANCIAL MODEL\n2 Salesgrowth 10%\n3 Currentassets/Sales 15%\n4 Currentliabilities/Sales 8%\n5 Netfixedassets/Sales 77%\n6 Costsofgoodssold/Sales 50%\n7 Depreciationrate 10%\n8 Interestrateondebt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Taxrate 40%\n11 Dividendpayoutratio 40%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1 ,100 1 ,210 1 ,331 1 ,464 1,611\n16 Costs of goods sold (500) (550) (605) (666) (732) (805)\n17 Interest payments on debt (32) (32) (32) (32) (32) (32)\n18 Interest earned on cash and marketable securities 6 9 14 20 26 33\n19 Depreciation (100) (117) (137) (161) (189) (220)\n20 Profit before tax 374 4 10 4 50 4 92 5 38 587\n21 Taxes (150) (164) (180) (197) (215) (235)\n22 Profit after tax 225 2 46 2 70 2 95 3 23 352\n23 Dividends (90) (98) (108) (118) (129) (141)\n24 Retained earnings 135 1 48 1 62 1 77 1 94 211\n25\n26 Balance sheet\n27 Cash and marketable securities 80 1 44 2 13 2 89 3 71 459\n28 Current assets 150 1 65 1 82 2 00 2 20 242\n29 Fixed assets\n30 At cost 1,070 1 ,264 1 ,486 1 ,740 2 ,031 2,364\n31 Depreciation (300) (417) (554) (715) (904) (1,124)\n32 Net fixed assets 770 8 47 9 32 1 ,025 1 ,127 1,240\n33 Total assets 1,000 1 ,156 1 ,326 1 ,513 1 ,718 1,941\n34\n35 Current liabilities 80 88 97 1 06 1 17 129\n36 Debt 320 3 20 3 20 3 20 3 20 320\n37 Stock 450 4 50 4 50 4 50 4 50 450\n38 Accumulated retained earnings 150 2 98 4 60 6 37 8 30 1,042\n69 Corporate Valuation Overview\nUsing the defi nition of free cash fl ows from section 2.5:\nA B C D E F G\n41 Year 0 1 2 3 4 5\n42 Free cash flow calculation\n43 Profitaftertax 246 270 295 323 352\n44 Addbackdepreciation 117 137 161 189 220\n45 Subtractincreaseincurrentassets (15) (17) (18) (20) (22)\n46 Addbackincreaseincurrentliabilities 8 9 10 11 12\n47 Subtractincreaseinfixedassetsatcost (194) (222) (254) (291) (333)\n48 Addbackafter-taxinterestondebt 19 19 19 19 19\n49 Subtract after-tax interest on cash and mkt. securities (5) (9) (12) (16) (20)\n50 Free cash flow 176 188 201 214 228\nW e can now use these free cash fl ows to compute the enterprise value of\nthe fi rm (row 62 below) and the value of its shares (cell B67):\nA B C D E F G H\n53 Valuing the firm\n54 Weightedaveragecostofcapital 20%\n55 Long-termfreecashflowgrowthrate 5%\n56\n57 Year 0 1 2 3 4 5\n58 FCF 176 188 201 214 228\n59 Terminal value 1,598<-- =G58*(1+B55)/(B54-B55)\n60 Total 176 188 201 214 1,826\n61\n62 Enterprise value, present value of row 60 1,348 <-- =NPV(B54,C60:G60)*(1+B54)^0.5\n63 Add in initial (year 0) cash and mkt. securities 80 <-- =B27\n64 Assetvalueinyear0 1,428 <-- =B63+B62\n65 Subtractoutvalueoffirm'sdebttoday (320)<-- =-B36\n66 Equityvalue 1,108 <-- =B64+B65\n67 Sharevalue(100shares) 11.08<-- =B66/100"
        ],
        "2.9": [
            "What are the four enterprise-value valuation methods introduced in a corporate valuation overview?\nWhat is the book value approach in enterprise valuation?\nHow does the efficient markets approach differ from the book value approach in valuing a firm's enterprise value?\nIn the context of financial modeling, what is meant by market values for financial assets and liabilities?\nWhat is meant by a firm's free cash flows (FCFs) in financial modeling?\nWhat is the role of a firm's consolidated statement of cash flows in estimating future free cash flows?\nHow is the weighted average cost of capital (WACC) used in discounting a firm's free cash flows?\nWhat is a second approach to discounting a firm's free cash flows?\nWhat is the significance of a firm's projected future accounting statements in constructing its free cash flows?\nWhat is meant by pro forma accounting statements in financial modeling?\nHow do the book value approach and the efficient markets approach differ in valuing a firm's enterprise value?\nWhere do we use the weighted average cost of capital in financial modeling?\nHow is the firm's consolidated statement of cash flows used in financial modeling?\nCan you explain the concept of market values for financial assets and liabilities in relation to financial modeling?\nWhat is the significance of the firm\u2019s projected future accounting statements in the process of discounting its free cash flows?",
            "2.9 Summary\n\nIn this chapter we have introduced four enterprise-value valuation methods:\n\u2022 The book value approach values the fi rm \u2019 s enterprise value using its balance\nsheet numbers, appropriately rearranged.\n\u2022 The effi cient markets approach substitutes, where possible, market values\nfor fi nancial assets and liabilities instead of their book values, and then makes\n70 Chapter 2\n\u2022 One approach to discounting the fi rm \u2019 s free cash fl ows (FCFs) bases the\nestimates of future FCFs on the fi rm \u2019 s consolidated statement of cash fl ows.\nThese FCFs are then discounted at the appropriate weighted average cost of\ncapital (WACC, Chapter 3).\n\u2022 A second approach to discounting the fi rm \u2019 s free cash fl ows constructs the\nFCFs from a model of the fi rm \u2019 s projected future accounting statements (pro\nforma accounting statements). As in the previous bullet, these FCFs are dis-\ncounted at the WACC."
        ]
    },
    "3": {
        "3.1": [
            "What is the weighted average cost of capital (WACC)?\nWhat are the two important uses of WACC in finance?\nWhat is the role of WACC as the discount rate for a firm's anticipated free cash flows?\nWhat is meant by the firm's 'hurdle rate'?\nWhat weights are used in the computation of the WACC?\nHow are the weights for WACC determined by the market values of the firm's equity and debt?\nWhat is meant by the market value of the firm's equity? \nWhat is meant by the market value of the firm's debt?\nWhat is the corporate tax rate and how does it factor into the WACC calculation?\nWhat is the firm's cost of equity and how does it fit into the calculation of the WACC?\nWhat is the firm's cost of debt and how does it impact the WACC?\nWhat are the five components of the WACC?\nWhat is the considered 'main technical problem' when calculating the firm's cost of equity?\nWhat are the two models for calculating the cost of equity mentioned in the text?\nExplain how the Gordon model calculates the cost of equity.\nHow does the capital asset pricing model (CAPM) calculate the cost of equity?\nWhat is meant by the 'tax framework' in which the CAPM is defined?\nWhat are the three models mentioned for calculating the cost of debt?\nHow do net interest payments influence the cost of debt calculation?\nWhat is an 'alternative method to compute the cost of debt'?\nWhat is the notion of a 'rating-adjusted yield curve'?\nHow is the 'expected return' on the firm's bonds used to calculate its cost of debt?\nWhat is a 'risk-adjusted discount rate' in finance?\nWhat are the examples given to show how the components of the WACC might be computed?\nHow do the Gordon dividend model and the capital asset pricing model help in computing the firm's cost of equity?\nWhat is the role of the 'expected return on the market' and 'the risk-free rate' in the CAPM?\nWhat is meant by the computation of the WACC for non-marketed firms?",
            "3.1 Overview\n\nI n this chapter we discuss the calculation of the firm\u2019 s weighted average cost\nof capital (WACC). The WACC has two important uses in finance:\n\u2022 W hen used as the discount rate for a firm\u2019 s anticipated free cash flows\n(FCFs), the WACC gives the enterprise value of the firm. FCF is discussed in\nChapter 2 and again at length in Chapters 4, 5, and 6\u2014at this point it suffices\nto say that the FCF is the cash flow generated by the firm \u2019 s core business\nactivities. These chapters also show how to apply the WACC to the valuation\nof firms.\n\u2022 T he WACC is also the appropriate risk-adjusted discount rate for firm\nprojects whose riskiness is similar to the average riskiness of the firm \u2019 s cash\nflows. When used in this context, the WACC is often referred to as the firm\u2019 s\n\u201churdle rate.\u201d\nThe WACC is a weighted average of the firm \u2019 s cost of equity r and its cost\nE\nof debt r , with the weights created by the market values of the firm \u2019 s equity\nD\n( E ) and debt ( D ):\nW ACC = E r + D r ( 1\u2212T )\nE+D E E+D D C\nwhere\nE = market value of the firm\u2019 s equity\nD = market value of the firm \u2019 s debt\nT = firm \u2019 s corporate tax rate\nC\nr = firm \u2019 s cost of equity\nE\nr = firm \u2019 s cost of debt\nD\nT his chapter discusses the computation of the five components of the\nWACC\u2014the market value of the firm\u2019 s equity and debt E and D , the firm \u2019 s\ntax rate T , the firm \u2019 s cost of debt r , and the cost of equity r . We finish\nC D E\nby showing detailed examples of how to compute the firm\u2019 s WACC. The\nreader should be warned that the application of the models discussed requires\na good deal of judgment\u2014computing the WACC is equal parts science\n72 Chapter 3\nThe main technical problem is the computation of the firm \u2019 s cost of equity\nr . We consider two models for calculating the cost of equity r , the discount\nE E\nrate applied to equity cash flows.\n\u2022 T he Gordon model calculates the cost of equity based on the anticipated\ncash flows paid to the shareholders of the firm. In the implementation of the\nGordon model, dividends growing at a constant future rate are most commonly\nused as the anticipated shareholder cash flows. We explore two variations of\nthe model: multiple future growth rates and total equity cash flows.\n\u2022 T he capital asset pricing model (CAPM) calculates the cost of equity based\non the correlation between the firm\u2019 s equity returns and the returns of a large,\ndiversified, market portfolio. Variations on this model include the tax frame-\nwork in which the model is defined.\nThe other problematic component of the cost of capital is the cost of debt\nr , the anticipated future cost of the firm\u2019 s borrowing. This book contains three\nD\nmodels to calculate the cost of debt; two of these models are discussed in this\nchapter and a third method is discussed separately in Chapter 28.\n\u2022 The cost of debt r is most commonly computed by using the firm \u2019 s current\nD\nnet interest payments divided by its average net debt (net debt: debt minus\ncash and marketable securities).\n\u2022 An alternative method is to compute r by imputing the firm\u2019 s cost of debt\nD\nfrom a rating-adjusted yield curve.\n\u2022 F inally, we can compute the expected return on the firm\u2019 s bonds as a proxy\nfor its cost of debt; we discuss this method separately in Chapter 28.\nA terminological note : \u201cCost of capital\u201d is a synonym for the \u201cappropriate\ndiscount rate\u201d to be applied to a series of cash flows. In finance \u201cappropriate\u201d\nis most often a synonym for \u201crisk-adjusted.\u201d Hence another name for the cost\nof capital is the \u201crisk-adjusted discount rate\u201d (RADR).\nThe Remainder of This Chapter\nI n the following sections we discuss the various components of the WACC\nwith examples of how they might be computed:\n\u2022 Section 3.2: Computing the equity value, E .\n73 Calculating the Weighted Average Cost of Capital (WACC)\n\u2022 Section 3.4: Computing the firm \u2019 s corporate tax rate T .\nC\n\u2022 Section 3.5: Computing the firm \u2019 s cost of debt, r .\nD\n\u2022 Sections 3.6\u20133.9: Computing the firm \u2019 s cost of equity, r . We show how to\nE\nuse both the Gordon dividend model and the capital asset pricing model\n(CAPM) to compute r . Each model has a number of twists and variations,\nE\ndiscussed in these sections.\n\u2022 Sections 3.10\u20133.11: Computing the expected return on the market E ( r ) and\nM\nthe risk-free rate r in the CAPM.\nf\n\u2022 S ections 3.12\u20133.15: Three worked-out cases of the computation of the\nWACC. We present a unified template that will help you make sense of the\nWACC computation.\n\u2022 S ection 3.16: Discussion of problems with using the dividend model and the\nCAPM, including the case of the determination of the WACC for non-marketed\nfirms."
        ],
        "3.2": [
            "What does the abbreviation WACC stand for in financial modeling?\nHow is the value of a firm\u2019s equity calculated in financial modeling?\nWhat factors are needed to determine the equity value of a public company?\nCan the equity value of a private company be determined in the same way as a public company?\nWhat is an example of a company for which we can calculate the equity value?\nHow many shares did El Paso Pipeline Partners have in June 2012?\nWhat was the trading price per share for El Paso Pipeline Partners in June 2012?\nWhat was the equity value of El Paso Pipeline Partners on June 29, 2012?\nHow is the equity value of a company determined using the share price and outstanding shares?\nWhat do the terms \"Shares outstanding\" and \"Share price\" mean in the context of financial modeling?\nWhat role do gas pipelines and gas storage facilities play in the value of a company like El Paso Pipeline Partners? \nWhat is the significance of a company's 'market cap'?\nWho can access the information needed to calculate a company's equity value?\nWhat does the term 'publicly listed' mean in the context of evaluating a firm's equity value?\nWhat is the product of the number of shares outstanding times the current value per share?\nAre there any circumstances where this method of calculating equity value would not be viable or accurate?",
            "3.2 Computing the Value of the Firm \u2019 s Equity, E\n\nO f all the computations related to the WACC, computing the value of the firm\u2019 s\nequity is the easiest: As long as the company is publicly listed, take E to be\nthe product of the number of shares outstanding times the current value per\nshare.\nAs an example, consider El Paso Pipeline Partners (EPB), a New York Stock\nExchange company that owns gas pipelines and gas storage facilities. On 29\nJune 2012, EPB has 205.7 million shares outstanding, each trading at $33.80.\nThe equity value of the company is $6.953 billion. 1\nA B C\nCOMPUTING THE VALUE OF EQUITY, E, FOR\n1 EL PASO PIPELINE PARTNERS (EPB)\n2 Shares outstanding 205.70<-- Million\n3 Share price, 29 June 2012 33.80\n4 Equity value (\"market cap\") 6,953<-- =B3*B2, million $\n74 Chapter 3"
        ],
        "3.3": [
            "What is meant by \"value of the firm's debt\" in financial modeling?\nWhat does \"excess liquid assets\" refer to in the context of computing the value of firm's debt?\nHow is the value of a firm's debt commonly approximated?\nWhat does the balance sheet value of a firm's debt imply?\nWhat is the significance of a company's cash balances and marketable securities in financial modeling?\nCan you outline how to compute net debt for a company like Kroger using balance sheet values?\nWhat is meant by \"debt-like items\" such as pension liabilities and deferred taxes in financial modeling context?\nWhy are debt-like items excluded from the computation of the weighted average cost of capital (WACC)?\nWhy is it challenging to attach a cost to items such as pension liabilities and deferred taxes in the context of computing WACC?\nWhat is meant by \"financial obligations net of liquid assets\" in the context of WACC approximation?\nWhat is meant by \"negative net debt\" in financial modeling?\nUnder what conditions might a company exhibit negative net debt?\nHow is the concept of negative net debt incorporated into the computation of the WACC?\nWhat are the financial implications of a company having more cash and marketable securities than debt?",
            "3.3 Computing the Value of the Firm \u2019 s Debt, D\n\nWe compute the value of the firm \u2019 s debt by the market value of its financial\ndebt minus the market value of its excess liquid assets. A common approxima-\ntion for this number is to take the balance sheet value of the firm \u2019 s debt minus\nthe value of the firm\u2019 s cash balances and minus the value of its marketable\nsecurities. Here \u2019 s an example for Kroger:\nA B C D\nKROGER, COMPUTING NET DEBT\n1 (thousand $)\n2 2011 2010\n3 Cash 825,000 188,000\n4 Marketable securities 0 0\n5\nShort-term and current\n6 portion of long-term debt 588,000 1,315,000\n7 Long-term debt 7,304,000 6,850,000\n8\n9 Net debt 7,067,000 7,977,000<-- =SUM(C6:C7)-SUM(C3:C4)\nF or purposes of computing the weighted average cost of capital, our defini-\ntion of debt excludes other debt-like items such as pension liabilities and\ndeferred taxes. Though we consider these items as debts, it is hard to attach a\ncost to them; we prefer to approximate the WACC by using only financial\nobligations net of liquid assets.\nIt is not uncommon for a company to have negative net debt\u2014this occurs\nwhen the company has more cash and marketable securities than debt. When\nthis occurs, we set D in the WACC computation to be a negative number. Both\n75 Calculating the Weighted Average Cost of Capital (WACC)\nA B C D\nINTEL HAS NEGATIVE NET DEBT\n1 (million $)\n2 2010 2011\n3 Cash 5,498 5,065\n4 Marketable securities 16,387 9,772\n5\nShort-term debt and\ncurrent portion of long-\n6 term debt 38 247\n7 Long-term debt 2,077 7,084\n8 Net debt -19,770 -7,506 <-- =SUM(C6:C7)-SUM(C3:C4)\n9\nWHOLE FOODS HAS NEGATIVE NET DEBT\n10 (thousand $)\n11 2010 2011\n12 Cash 218,798 303,960\n13 Marketable securities 329,738 442,320\n14\nShort-term debt and\ncurrent portion of long-\n15 term debt 410 466\n16 Long-term debt 508,288 17,439\n17 Net debt -39,838 -728,375 <-- =SUM(C15:C16)-SUM(C12:C13)"
        ],
        "3.4": [
            "What does the T represent in the WACC formula?\nWhat is the common method used to measure a firm's T in the WACC formula?\nWhat could potentially create issues when measuring a firm's tax rate?\nHow is the tax rate for a company calculated?\nIs it appropriate to use the current tax rate in the WACC computation, or should an average be used from the past few years? \nWhat factors can cause fluctuations in a company's tax rate?\nHow is the tax rate affected during the years of low income for a company like Merck?\nHow can companies like Merck manage their income to attain comfortable tax venues?\nHow can future profitability and tax rate of a company be predicted?\nWhat is the reason for variations in the tax rates of companies between different years?",
            "3.4 Computing the Firm \u2019 s Tax Rate, T\n\nC\nI n the WACC formula, T should measure the firm\u2019 s marginal tax rate, but it\nC\nis common to measure it by computing the firm \u2019 s r eported tax rate. Usually\nthis should cause no problems, as the following example shows:\nA B C D E\n1 WHOLE FOODS MARKET TAX RATE\n2 2009 2010 2011\n3 Income before tax 250,942 411,781 551,712\n4 Income tax expense 104,138 165,948 209,100\n5 Tax rate, T 41.50% 40.30% 37.90%<-- =D4/D3\n76 Chapter 3\nThe tax rate for Whole Foods is reasonably stable at 38% to 41%. In our\nWACC computation we would most likely use the current tax rate or the\naverage over the past several years.\nSometimes, however, this doesn \u2019 t work, as the following example shows:\nA B C D E\n1 MERCK TAX RATE\n2 2009 2010 2011\n3 Income before taxes 15,290,000 1,653,000 7,334,000\n4 Income tax expense 2,268,000 671,000 942,000\n5 Tax rate, T 14.83% 40.59% 12.84%<-- =J4/J3\nC\nCompanies like Merck are very good at placing their income in comfortable\ntax venues, and it appears that a reasonable estimate for the tax rate is some-\nwhere between 13% and 15%. In 2010, a year of low income for Merck, these\ntax-planning strategies evidently did not work. Assuming that Merck\u2019 s future\nprofitability is indicated by the two good years 2009 and 2011, we would most\nlikely assume that Merck\u2019 s company\u2019 s future tax rate T is in the range of the\nC\n2009 and 2011 tax rate."
        ],
        "3.5": [
            "What does the cost of debt represent in a firm's financial context?\nWhat are the three ways of calculating a firm's cost of debt?\nWhat is the risk associated with approximating the cost of debt by taking the average cost of the firm\u2019s existing debt?\nWhat is the alternative method of calculating the cost of debt using the yield of similarly risked, newly issued corporate securities?\nWhat are the challenges associated with using a model that estimates the cost of debt from data about the firm\u2019s bond prices, probabilities of default, and estimated payoffs to bondholders?\nWhat is the primary difference in the application of the two methods used to calculate the cost of debt for U.S. Steel and Merck?\nWhy is the expected return on a firm's debt more in line with standard financial theory? \nWhy is the method of computing the expected return on a firm's debt considered difficult to apply?\nWhat factors are to be considered when calculating the average cost of debt from financial statements?\nWhat is the implication of treating liquid assets such as cash and cash equivalents as negative debt in the calculation of a firm's debt?\nWhat is the impact of having cash balances that earn less interest than the cost of borrowing on a firm's average cost of debt?\nWhat factors can influence the choice of a number to represent the marginal cost of borrowing in the WACC equation?\nWhat is the Rating-Adjusted Yield method in estimating the cost of debt?\nWhat factors should be considered when using financial data for bonds to calculate the cost of borrowing for a firm using the polynomial regression equation? \nWhy would the cost of borrowing for Merck be calculated assuming a 7-year average maturity for the firm\u2019s debt?\nWhat is the role of credit risk and market efficiency in determining the cost of borrowing for a firm?",
            "3.5 Computing the Firm \u2019 s Cost of Debt, r\n\nD\nW e now turn to calculating the cost of debt r . In principle, r is the marginal\nD D\ncost to the firm (before corporate taxes) of borrowing an additional dollar.\nThere are at least three ways of calculating the firm \u2019 s cost of debt. We will\nstate them briefly below and then go on to illustrate the application of two of\nthe methods that although they may not be theoretically perfect are often used\nin practice:\n\u2022 As a practical matter, the cost of debt can often be approximated by taking\nthe average cost of the firm\u2019 s existing debt. The problem with this method is\nthat it runs the danger of confusing the past costs with the future anticipated\ncost of debt that we actually want to measure.\n\u2022 We can use the yield of similar-risk, newly issued corporate securities. If a\ncompany is rated A and has mostly medium-term debt, then we can use the\naverage yield on medium-term, A-rated debt as the firm \u2019 s cost of debt. Note\nthat this method is somewhat problematic because the yield on a bond is its\n77 Calculating the Weighted Average Cost of Capital (WACC)\ndebt. Since there is usually a risk of default, the promised return is generally\nhigher than the expected return. Nevertheless, despite the problematics, this\nmethod is often a good compromise.\n\u2022 We can use a model that estimates the cost of debt from data about the firm \u2019 s\nbond prices, the estimated probabilities of default, and the estimated payoffs\nto bondholders in case of default. This method requires a lot of work and is\nmathematically non-trivial; we postpone its discussion until Chapter 28. For\ncost of capital calculations it would be used in practice only if the firm we are\nanalyzing has significant amounts of risky debt.\nThe first two methods above are relatively easy to apply, and in many cases\nthe problems or errors which are encountered in these methods are not critical.2\nAs a matter of theory, however, both of these methods fail to make proper\nrisk-adjustments for the cost of the firm \u2019 s debt. The third method, which\ninvolves computing the expected return on a firm\u2019 s debt, is more in line with\nstandard financial theory, but it is also more difficult to apply. It may not,\ntherefore, be worth the effort.\nI n the remainder of this section, we apply the first two of these methods to\ncalculate the cost of debt for U.S. Steel and Merck.\nMethod 1: U.S. Steel \u2019 s Average Cost of Debt\nFor U.S. Steel we compute the average cost of debt:\nCurrent year\u2019snetinterest paid\nr =\nD\nAveragenetdebtoverthisand preevious year\nThere are several aspects of our calculations worth noting:\n2. It bears repeating that calculating the cost of capital requires a large number of assumptions\nand does not necessarily give a precise answer. Cost of capital estimation is not a science , it is\nan art. Users of cost of capital estimates should always do a sensitivity analysis around the\nnumbers calculated. Given the data on the company you are analyzing, some sloppiness in the\n78 Chapter 3\nA B C D E\n2 UNITED STATES STEEL, COST OF DEBT\n3 2009 2010 2011\n4 Cash 1,218,000 578,000 408,000\n5 Short-term investments 0 0 0\n6\nShort-term debt and current\n7 portion of long-term debt 19,000 216,000 400,000\n8 Long-term debt 3,828,000 3,517,000 3,345,000\n9\n10 Netdebt 2,629,000 3,155,000 3,337,000 <-- =SUM(D6:D7)-SUM(D3:D4)\n11 Interest 190,000 195,000 159,000\n12 Implied cost of debt, r 6.74% 4.90%<-- =D10/AVERAGE(C9:D9)\nD\n\u2022 When calculating the average cost of debt r from the financial statements,\nD\nit is important to include all financial debt, without distinguishing between\nshort-term and long-term items.\n\u2022 We treat liquid assets such as cash and cash equivalents as n egative debt and\nsubtract them from the firm \u2019 s debt. The idea here is that the firm could use its\ncash to pay off part of its debt, so that the effective debt financing of the firm\nis its financial debt minus cash. However, the implementation of this particular\npiece of theory is largely a judgment call\u2014we may not want to attribute all\ncash to the possibility of paying off debt, and we may want to compute the\nfirm\u2019 s cost of borrowing as opposed to the interest it earns on cash.\nWere we to use the average cost of debt for U.S. Steel as a prediction of its\nfuture cost of debt r , we would most likely use the current cost r = 4.90%\nD D\nin the WACC computation. This is because we believe that historical costs of\ndebt have little predictive power for future costs.\nCash Raises the Cost of Debt: The Case of Merck\nWhen a firm has cash balances that earn less interest than the cost of borrow-\ning, the average cost of debt, based on net interest and net debt is higher than\nthe cost of borrowing. To see this, assume that the interest rate on cash is less\n79 Calculating the Weighted Average Cost of Capital (WACC)\nAverage Interest paid\u2212Interestearned\n=\ncostof debt Debt\u2212Cash\nDebtt\u2217i \u2212Cash\u2217i Debt\u2217i \u2212Cash\u2217( i \u2212\u03b5)\n= Debt Cash = Debt Debt\nDebt\u2212Cash Debt\u2212\u2212Cash\n( Debt\u2212Cash)\u2217i +\u03b5\u2217Cash\n= Debt\nDebt\u2212Cash\nCash\n=i + \u2217\u03b5>i\nDebt Debt\u2212Cassh Debt\nHere \u2019 s a somewhat dramatic example for Merck:\nA B C D E\n1 MERCK, COST OF DEBT r\nD\n2 2009 2010 2011\n3 Cash 9,311,000 10,900,000 13,531,000\n4 Short-term investments 293,000 1,301,000 1,441,000\n5 Total liquid assets 9,604,000 12,201,000 14,972,000<-- =D4+D3\n6\nShort-term debt and current\n7 portion of long-term debt 1,379,000 2,400,000 1,990,000\n8 Long-term debt 16,095,000 15,482,000 15,525,000\n9 Total financial debt 17,474,000 17,882,000 17,515,000<-- =D7+D8\n10\n11 Netdebt 7,870,000 5,681,000 2,543,000<-- =D9-D5\n12 Interest income 210,000 83,000 199,000\n13 Interest expense 460,000 715,000 749,000\n14 Netinterest 250,000 632,000 550,000<-- =D13-D12\n15 Implied cost of debt, r 9.33% 13.38%<-- =D14/AVERAGE(C11:D11)\nD\n16\n17 Interestrateearned 0.76% 1.46%<-- =D12/AVERAGE(SUM(D3:D4),SUM(C3:C4))\n18 Interestratepaid 4.04% 4.23%<-- =D13/AVERAGE(SUM(D7:D8),SUM(C7:C8))\nIn 2011 Merck \u2019 s cost of borrowing was 4.23%, and the company earned a\nrespectable 1.46% on its massive reserves of cash and short-term investments.\nWe might naively expect that this means that the average net cost of Merck\u2019 s\ndebt is between these two numbers. Instead the computations show that r =\nD\n13.38%!\nAveragenetinterest paid 550,0000\nr = 2010\u221211 = =13.38%\nD\nAveragenetdebt 4,112,000\n2010\u221211\nThis estimate of r reflects the costs of holding large reserves of liquid assets\nD\nwhich provide such low financial returns. From a purely financial point of\n80 Chapter 3\nto repurchase its debt or by paying them out as either dividends or share\nrepurchases.3\nWhat number would we choose to represent the marginal cost of borrowing\nin the WACC equation? In large measure this depends on how we view the\nfinancial policy of Merck: If we view the firm as proceeding to build up cash\nreserves, while at the same time maintaining large amounts of financial debt,\nthen 13.38% might be a reasonable measure of the cost of debt. If, on the other\nhand, we view the marginal debt financing of Merck as being with debt,\nwithout a parallel buildup of cash, then a number around 4% would better\nrepresent r . 4\nD\nMethod 2: r as the Rating-Adjusted Yield for Merck\nD\nT here is another way to measure the cost of debt for Merck\u2019 s borrowing: We\ncan impute the marginal cost of Merck\u2019 s debt from a yield curve for the appro-\npriate debt. Merck is rated A + by Fitch, BBB + by Standard and Poor\u2019 s , and\nBAA2 by Moody \u2019 s. From Yahoo we gather data for more than 1,000 A-Fitch-\nrated bonds; in the screen shot below much of this data is hidden:\nA B C D E F\n1 FITCH-RATED A BONDS, Friday 17 August 2012\nTime to Yield to\n2 Price Coupon Maturity maturity maturity\n3 CITIGROUPINC 103.88 5.63% 27-Aug-12 0.0274 0.36%\n4 LINCOLN NATL CORP IND 105.42 5.65% 27-Aug-12 0.0274 -1.62%\n5 GOLDMAN SACHS GROUP INC 104.68 5.70% 1-Sep-12 0.0411 -0.52%\n6 WELLS FARGO & CO NEW 104.85 5.13% 1-Sep-12 0.0411 -1.28%\n7 BANK OF AMERICA CORPORATION 102.91 5.38% 11-Sep-12 0.0685 1.60%\n8 BANK OF AMERICA CORPORATION 102.81 4.88% 15-Sep-12 0.0795 1.29%\n996 GOLDMAN SACHS GRP INC MTN BE 103.30 5.75% 15-Jul-41 28.9288 5.52%\n997 HEWLETT PACKARD CO 118.45 6.00% 15-Sep-41 29.0986 4.83%\n998 VERIZON COMMUNICATIONS INC 106.63 4.75% 1-Nov-41 29.2274 4.35%\n999 AMGENINC 101.52 5.15% 15-Nov-41 29.2658 5.05%\n1000ANHEUSER BUSCH COS INC 135.00 6.50% 1-May-42 29.7233 4.40%\n1001CATERPILLARINCDEL 151.00 6.95% 1-May-42 29.7233 4.03%\n1002ANHEUSER BUSCH COS INC 138.85 6.50% 1-Feb-43 30.4795 4.24%\n1003BOEINGCO 142.90 6.88% 15-Oct-43 31.1808 4.37%\n1004BELLSOUTHTELECOM 104.75 5.85% 15-Nov-45 33.2685 5.54%\n1005BELLSOUTHTELECOM 123.96 7.00% 1-Dec-95 83.3452 5.64%\n1006CITIGROUPINC 107.55 6.88% 15-Feb-98 85.5562 6.39%\n1007CUMMINSINC 99.25 5.65% 1-Mar-98 85.5945 5.69%\n3. This statement ignores the option value of the liquid assets: their ability to provide Merck with\nfinancial flexibility.\n4. In the case of Merck, as we shall see in section 3.14, none of this makes much difference,\n81 Calculating the Weighted Average Cost of Capital (WACC)\nGraphing these data shows either that these data cover a wide range of true\ncredit risks or that the market is far from efficient:\n10%\nTerm Structure, A Bonds, 17 August 2012\n8%\n6%\n4%\ny = 8E-06x3-0.0004x2+ 0.008x + 0.0005\n2% R\u00b2 = 0.4895\n0%\n0 5 10 15 20 25 30 35\nBond maturity\n-2%\nThe polynomial regression line describes about 50% of the variability of\nthe yields as a function of the time to maturity. Using this regression equation\nand assuming a 7-year average maturity for Merck \u2019 s debt, the cost of borrow-\ning for Merck is 3.96%.\nA B C\n1 COMPUTING MERCK'S r FROM THE A-YIELD CURVE\nD\n2 Average time to maturity (years) 7\n82 Chapter 3"
        ],
        "3.6": [
            "What is the equation for the weighted average cost of capital (WACC)?\nWhat are the parameters involved in the WACC equation? \nWhat is the most problematic computation related to the WACC parameters? \nWhat are the two approaches to compute the cost of equity?\nWhat is the Gordon dividend model and how does it compute the cost of equity?\nWhat factors are considered in the Gordon dividend model to calculate the cost of equity?\nWhat is the Capital Asset Pricing Model (CAPM) and how does it compute the cost of equity?\nWhat factors are considered in the CAPM model to calculate the cost of equity? \nWhat is the meaning of the market risk-free rate of interest in CAPM? \nWhat is the expected return on the market portfolio in the context of the CAPM model? \nWhat is a firm-specific risk measure in the context of the CAPM model? \nWhat are the variations and problems associated with the Gordon dividend model?\nWhat are the variations and problems associated with the CAPM model?",
            "3.6 Two Approaches to Computing the Firm \u2019 s Cost of Equity, r\n\nE\nT he equation for the weighted average cost of capital is WACC = E /( E + D )* r\nE\n+ E /( E + D )* r * (1 \u2212 T ). Thus far in this chapter we have discussed the esti-\nD C\nmation of four of the five parameters of the WACC equation: E , D , T , r . We\nC D\nnow come to the most problematic of the computations related to the WACC\nparameters\u2014the computation of the cost of equity r . There are two approaches\nE\nto r that can readily be computed:\nE\n\u2022 The Gordon dividend model computes r based on current dividend D iv ,\nE 0\ncurrent stock price P , and the anticipated growth of future dividends g :\n0\nDiv\n( 1+g)\nr = 0 +g\nE\nP\n0\n\u2022 The capital asset pricing model (CAPM) computes r based on the risk-free\nE\nrate r , the expected return on the market E ( r ) , and a firm-specific risk\nf M\nmeasure \u03b2 :\nr =r +\u03b2[ E( r )\u2212r ]\nE f M f\nwhere\nr = the market risk-free rate of interest\nf\nE ( r ) = the expected return on the market portfolio\nM\n( )\nCov r ,r\nstock M\n\u03b2 = a firm-specific risk measure = ( )\nVar r\nM\nE ach model has its variations and problems, which are discussed ( ad\nnauseam ?) in the next two sections."
        ],
        "3.7": [
            "What is the Gordon dividend model?\nWhat does the Gordon model derive?\nHow does the Gordon model explain the value of a share?\nWhat is the role of 'anticipated future dividends' in the Gordon Model?\nWhat is the simplest application of the Gordon model?\nWhat are the key components used in the Gordon model to calculate the value of a stock?\nUnder what condition can the Gordon model be simplified to P0 = Div0*(1+g)/(r - g)?\nWhat is the Gordon formula for the cost of equity?\nWhat is \"supernormal growth\" and how does it impact the Gordon model?\nIn what circumstances might the condition |g|<r be violated?\nWhat is meant by the term 'risk-adjusted cost of equity' in the context of the Gordon model?\nHow do share repurchases and stock issuance contribute to the total cash flows to equity in the Gordon model?\nHow can the Gordon model be adjusted to accommodate all cash flows to equity?\nWhat is the two-stage Gordon model?\nWhy is it necessary to adjust the Gordon model to account for all cash flows to equity?\nHow is the valuation model of Gordon rewritten in terms of total equity?\nWhy should dividends growth rate be less than the cost of equity in the long term, as per the Gordon model?\nHow does one apply the Gordon model to a company's financial data, such as Merck in the provided example?\nWhat happens when a firm's growth rate of cash flow to equity is assumed to persist indefinitely?\nHow are the additional cash flows accounted for in the Gordon model?\nWhat considerations are made while implementing the two-stage Gordon model for a firm like Merck?\nWhat variables are considered in the TwoStageGordon function to compute the cost of equity for a two-stage Gordon model?",
            "3.7 Implementing the Gordon Model for r\n\nE\nT he Gordon dividend model derives the cost of equity from the following\ndeceptively simple statement:\nThe value of a share is the present value of the future anticipated dividend stream from\nthe share, where the future anticipated dividends are discounted at the appropriate risk-\nadjusted cost of equity r . 5\nE\n5 . T his model is named after M. J. Gordon, who first published this formula in a paper entitled\n83 Calculating the Weighted Average Cost of Capital (WACC)\nT he simplest application of the Gordon model is the case where the antici-\npated future growth rate of dividends is constant. Suppose that the current\nstock price is P , the current dividend is D iv , and the anticipated growth\n0 0\nrate of future dividends is g . The Gordon model states that the stock\nprice equals the discounted (at the appropriate cost of equity r ) future\nE\ndividends:\nDiv\n( 1+g)\nDiv\n\u2217( 1+g)2\nDiv\n\u2217( 1+g)3\nDiv\n\u2217( 1+g)4\nP = 0 + 1 + 1 + 11 \u2026\n0 1+r ( 1+r )2 ( 1+r )3 ( 1+r )4\nE E E E\n=\u2211\u221e Div 0\u2217( 1+g)t\n( 1+r )t\nt=1 E\n\u2211\u221e Div \u2217( 1+g)t\nProvided that | g | < r , the expression 0 can be reduced to\nE ( 1+r )t\nDiv\n( 1+g) t=1 E\n0 (we will spare you this derivation, which is based on a formula\nr \u2212g\nE\nfor geometric series usually studied in high school). Thus\u2014given a constant\nanticipated dividend growth rate, we derive the Gordon model cost of\nequity:\nDiv\n( 1+g)\nP = 0 , provided g <r\n0 r \u2212g E\nE\nSolving the above equation for r gives the Gordon formula for the cost of\nE\nequity:\nDiv\n( 1+g)\nr = 0 +g, provided g <r\nE E\nP\n0\nNote the proviso at the end of this formula: In order for the infinite sum on\nthe first line of the formula to have a finite solution, the growth rates of the\ndividends must be less than the discount rate. In our discussion of the Gordon\nmodel with supernormal growth rates (see below) we return to the case where\nthis is not true.\nT o apply this formula, consider a firm whose current dividend is Div = $3\n0\nper share, whose share price is P = $50. Suppose the dividend is anticipated\n0\nto grow by 12% per year. Then the firm \u2019 s cost of equity r is 17.6%:\n84 Chapter 3\nA B C\n1 THE GORDON MODEL COST OF EQUITY\n2 Current share price, P 60\n0\n3 Current dividend, Div 3\n0\n4 Anticipated dividend growth rate, g 12%\n5 Gordon model cost of equity, r 17.60%<-- =B3*(1+B4)/B2+B4\nE\nUsing the Gordon Model to Compute the Cost of Equity for Merck\nWe apply the Gordon model to Merck, whose 10-year dividend history is given\nbelow (note that some of the data has been hidden):\nA B C D E F\n1 MERCK DIVIDEND HISTORY\nDividend\nDividend growth\n2 Date per share\n3 4-Sep-02 0.36 Whole period\n4 4-Dec-02 0.36 Quarterly growth 0.39% <-- =(B43/B3)^(1/40)-1\n5 5-Mar-03 0.36 Annual growth 1.55% <-- =(1+E4)^4-1\n6 4-Jun-03 0.36\n7 20-Aug-03 2.88 Last 5 years\n8 3-Sep-03 0.37 Quarterly growth 0.50% <-- =(B43/B23)^(1/20)-1\n9 3-Dec-03 0.37 Annual growth 2.02% <-- =(1+E8)^4-1\n10 3-Mar-04 0.37\n11 2-Jun-04 0.37\n12 1-Sep-04 0.38\n40 13-Sep-11 0.38\n41 13-Dec-11 0.42\n42 13-Mar-12 0.42\n43 13-Jun-12 0.42\nT he annualized growth rate of Merck\u2019 s historical dividends may be either\n1.55% or 2.02%, depending on the period taken. For purposes of computing\nthe cost of equity r , the question is which of these rates better predicts future\nE\nanticipated dividend growth rates. 6 In the spreadsheet below, we allow for both\npossibilities. The calculations use Merck \u2019 s stock price at the end of June 2012,\nP = $41.75:\n0\n6 . O r perhaps neither does! Perhaps we are better off using another story altogether to predict\nfuture anticipated dividend growth? We could use a pro forma model (discussed in Chapter 5) to\n85 Calculating the Weighted Average Cost of Capital (WACC)\nA B C\nCOMPUTING MERCK'S r\nE\n1 WITH THE GORDON MODEL\n2 Merck stock price P, 29 June 2012 10-Feb-00\n0\n3 Current dividend\n4 Quarterly 0.42\n5 Annualized dividend, Div 1.68<-- =4*B4\n0\n6 Dividend growth rate, g\n7 Last5years 1.55%\n8 Last10years 2.02%\n9\n10 Gordon model cost of equity, r\nE\n11 Using last 5 years' growth 5.64%<-- =$B$5/$B$2*(1+B7)+B7\n12 Using last 10 years' growth 6.13%<-- =$B$5/$B$2*(1+B8)+B8\nFor all practical purposes, given the margin of error in our estimates of the\nfuture, these numbers are identical\u2014remember that we are trying to predict\nfuture dividend growth based on past dividend payouts.\nAdjusting the Gordon Model to Account for All Cash Flows to Equity\nAs illustrated above, the Gordon model is computed on a per-share basis and\nfor dividends only. However, for purposes of valuing the firm \u2019 s equity, the\nGordon model should be extended to include all cash flows to equity. In addi-\ntion to dividends, cash flows to equity include at least two additional\ncomponents:\n\u2022 S hare repurchases now account for around 50% of the total cash disbursed\nby American corporations to their shareholders.7\n\u2022 The issuance of stock by the firm is an important n egative cash flow to\nequity. In many firms the most important instance of stock issuance is the\nexercise by employees of their stock options.\nI n order to account for these additional cash flows to equity, we have to\nrewrite the Gordon model in terms of total equity value. The basic valuation\nmodel of Gordon now becomes:\nMarketvalueof\nequity=\u2211\u221e Cash flowtoequity 0\u2217( 1+g)t\n( 1+r )t\nt=1 E\n7 . S ee \u201cCorporate Payout Policy\u201d by Harry DeAngelo, Linda DeAngelo, and Douglas J. Skinner,\n86 Chapter 3\nwhere\ng = Anticipated growth rate of cash flow equity\nThis gives the formula for the cost of equity r as:\nE\nCash flowtoequity\n( 1+g)\nr = 0 +g,if g <r .\nE E\nMarketvalueof equity\nAs an example we consider the data below for Merck:\nA B C D E F\n1 GORDON MODEL FOR MERCK'S EQUITY PAYOUTS\nProceeds\nfrom stock Total\nShare option equity\n2 Dividends repurchases exercise payout\n3 29-Jun-05 3,307 1,430 899 3,838<-- =B3+C3-D3\n4 30-Jun-05 3,279 2,725 102 5,901\n5 1-Jul-05 3,215 0 186 3,029\n6 2-Jul-05 4,734 1,593 363 5,964\n7 3-Jul-05 4,818 1,921 321 6,418\n8\n9 Growth 13.71% <-- =(E7/E3)^(1/4)-1\n10\n11 Computing the Gordon model cost of equity r based on total equity payouts\nE\nShares outstanding\n12 (million) 3,041\n13 Price per share 41.75\n14 Market value of equity 126,955<-- =B12*B13, $ million\n15\nGordon model cost of\n16 equity, r 19.46% <-- =E7*(1+B9)/B14+B9\nE\n17\n18 6,000\n19\n20 5,000\n21\n22 4,000 Dividends\n23\n24\n3,000 Share repurchases\n25\n26\n27 2,000 Proceeds from stock op(cid:415)on\nexercise\n28\n29 1,000\n30\n31 0\n32 29-Jun-05 30-Jun-05 1-Jul-05 2-Jul-05 3-Jul-05\n87 Calculating the Weighted Average Cost of Capital (WACC)\nI f we assume that Merck\u2019 s historic growth rate of cash flow to equity,\n13.71%, will persist in the indefinite future, then its cost of equity is r =\nE\n19.46%.8 This seems rather high. In the next subsection we present another\nvariation of the Gordon model that may provide an answer.\n\u201cSupernormal Growth\u201d and the Gordon Model\nDiv\n( 1+g)\nA basic condition of the Gordon formula r = 0 +g is the\nE\nP\n0\ncondition |g | < r . 9 In finance examples, violations of |g | < r usually occur for\nE E\nvery fast-growing firms, in which\u2014at least for short periods of time\u2014we\nanticipate very high growth rates, so that g > r . If such \u201csupernormal\u201d growth\nE\nwere the case in the long run, the original dividend discount formula shows\nthat P would have an infinite value, since, when g > r , the expression\n0 E\n\u2211\u221e Div 0\u2217( 1+g)t\n=\u221e . Thus a period of very high dividend growth rates\n( 1+r )t\nt=1 E\n(where g > r ) must be followed by a period in which the long-term growth\nE\nrate of dividends is less than the cost of equity, g < r .\nE\nS uppose that the firm is anticipated to pay high-growth dividends during\nperiods 1, \u2026 , m , and that for subsequent periods the growth rate of dividends\nwill be lower. We can write the discounted value of these anticipated future\ndividends as:\nSharevaluetoday=Presentvalueof dividends\n=\u2211m Div 0\u2217(1+g 1)t\n+\n\u2211\u221e Diiv 5\u2217(1+g 2)t\u2212m\n(cid:2)t=1(cid:4)(cid:4)(cid:4)( 1(cid:3)+ (cid:4)r E(cid:4))tt (cid:4)(cid:5) t(cid:2)=m(cid:4)+1(cid:4)(cid:4)(cid:4)( (cid:3)1+ (cid:4)r E(cid:4))t (cid:4)(cid:4)(cid:5)\n\u2191 \u2191\nPV of m years PV of remaining\nof high-growth g1 normal-growthg22\ndividends dividends\nThe problem is usually to determine the cost of equity r from predicted\nE\ngrowth rates. In the example below we use a VBA function T woStageGordon\nto compute r that equalizes the values of both sides of the above equation.1 0\nE\nThe assumption is that a firm \u2019 s share price is currently P = 30, that its current\n0\ndividend is D iv = 3, and that after 5 years of 35% growth in dividends, the\n0\ndividend growth rate will slow to 8%. As you can see below, r = 32.76%.\nE\n8. M ost firms only report stock repurchases and employee stock exercises annually. Thus the only\ndata available for these numbers is annual data, whereas dividends are reported quarterly and stock\nprice data\u2014used to compute the CAPM beta discussed in section 3.9\u2014are available on a daily basis.\n9. In this section we interpret Div in the Gordon formula to denote either dividends per share\n0\nor total equity payouts.\n88 Chapter 3\nA B C\nTHE GORDON MODEL WITH TWO GROWTH RATES\n1 Using the TwoStageGordon function\n2 Current dividend, Div 3.00\n0\n3 Growth rate g, years 1-m (\"supernormal\") 35%\n1\n4 Growth rate g, years 6 - \u221e 8%\n2\n5 Number of supernormal growth years, m 5\n6 Share price 30.00\n7 Cost of equity 32.76%<-- =twostagegordon(B6,B2,B3,5,B4)\nImplementing the Two-Stage Gordon Model for Merck\nB elow we use the two-stage model to compute the cost of equity for Merck.\nWe assume that the 5-year growth rate of total equity payouts of 13.71% will\nhold only for the next 2 years, and that afterward the growth rate of equity\npayouts will be 5%. The cost of equity is r = 11.20%. This is high, com-\nE\npared to the r computed for the Gordon model using only dividends (next\nE\nsection).\nA B C D E F\n1 MERCK'S COST OF EQUITY USING THE TWO-STAGE GORDON MODEL\nProceeds\nfrom stock Total\nShare option equity\n2 Dividends repurchases exercise payout\n3 29-Jun-05 3,307 1,430 899 3,838<-- =B3+C3-D3\n4 30-Jun-05 3,279 2,725 102 5,901\n5 1-Jul-05 3,215 0 186 3,029\n6 2-Jul-05 4,734 1,593 363 5,964\n7 3-Jul-05 4,818 1,921 321 6,418\n8\n9 Growth 13.71%<-- =(E7/E3)^(1/4)-1\n10\nComputing the Gordon model cost of equity r based on total equity payouts\nE\n11 and the 2-stage Gordon model\n12 Shares outstanding (million) 3,041\n13 Price per share 41.75\n14 Market value of equity 126,955<-- =B12*B13, $ million\n15\n16 High growth rate, g\nhigh\n17 Number of high-growth years, m 2\n18 Normal growth rate, g 5.00%<-- Author guess\nnormal\n19\nCost of equity, r\nE\n89 Calculating the Weighted Average Cost of Capital (WACC)\nTechnical Note\nT he function TwoStageGordon on the file with this chapter computes the cost\nof equity r for a two-stage Gordon model. The function computes the discount\nE\nrate r , which equates the current share price to the present value of future\nE\nequity cash flows:\nFunction TwoStageGordon(P0, Div0, Highgrowth, _\nHighgrowthyrs, Normalgrowth)\nhigh = 1\nlow = 0\nDo While (high - low) > 0.00001\nEstimate = (high + low) / 2\nfactor = (1 + Highgrowth) / _\n(1 + Estimate)\nTerm1 = Div0 * factor * (1 - factor \u2227 _\nHighgrowthyrs) / (1 - factor)\nTerm2 = Div0 * factor \u2227 Highgrowthyrs * _\n(1 + Normalgrowth) / (Estimate - _\nNormalgrowth)\nIf (Term1 + Term2) > P0 Then\nlow = (high + low) / 2\nElse: high = (high + low) / 2\nEnd If\nLoop\nTwoStageGordon = (high + low) / 2\nEnd Function"
        ],
        "3.8": [
            "What is the Capital Asset Pricing Model (CAPM)?\nHow is the cost of capital derived from a firm's covariance with the market return in CAPM?\nWhat does the symbol 'beta' represent in financial modeling?\nHow can the beta of a firm be measured?\nWhat are the components of the classic CAPM formula?\nWhat does the market risk-free rate of interest indicate in financial modeling?\nWhat is meant by the expected return on the market portfolio?\nHow does the regression coefficient relate to a firm's stock returns?\nHow does Excel's SLOPE function apply to calculating a firm's beta?\nWhat does a variance in stock returns indicate about the market?\nWhat information can be derived by regressing a firm's returns on a market index such as the S&P 500?\nWhat does a firm's alpha indicate about its performance?\nHow does the TIntercept function in Excel relate to a firm's alpha?\nWhat does the R-squared value of regression signify in financial modeling?\nHow does diversification of shares impact the variation in a firm's returns?\nWhat is the correlation between market factors and a stock's variability?\nHow does idiosyncratic risk impact a firm's R squared value?\nWhat are the functions Intercept, Slope and Rsq used for in financial modeling?\nHow can you compute the t-statistics for intercept and slope in financial modeling?\nWhat is the significance of a t-statistic over 1.96 in financial modeling?\nWhat does Excel's Data Analysis Add-in contribute to financial modeling?\nWhat is the limitation of using Data Analysis Regression in Excel for financial modeling?",
            "3.8 The CAPM: Computing the Beta, \u03b2\n\nT he capital asset pricing model (CAPM) is the only viable alternative to the\nGordon model for calculating the cost of capital. It is also the most widely\n90 Chapter 3\nits implementational simplicity. The CAPM derives the firm\u2019 s cost of capital\nfrom its covariance with the market return. 11 The classic CAPM formula for\nthe firm \u2019 s cost of equity is:\nr =r +\u03b2[ E( r )\u2212r ]\nE f M f\nwhere\nr = the market risk-free rate of interest\nf\nE ( r ) = the expected return on the market portfolio\nM\n( )\nCov r ,r\n\u03b2 = a firm-specific risk measure = st (ock )M\nVar r\nM\nIn the remainder of this section we focus on measuring the firm \u2019 s \u03b2 ;\nthe next section shows how to apply the CAPM to find the firm\u2019 s cost of\nequity r .\nE\nBeta Is the Regression Coefficient of the Firm \u2019 s Stock Returns on the\nMarket Returns\nIn the following spreadsheet, we show the 5 years of monthly prices and\nreturns for Merck and for the S&P 500, which we take to proxy for the stock\nmarket as a whole. In cells B2:B4 we regress the Merck returns on those of\nthe S&P 500:\nr =\u03b1 +\u03b2 r\nMerck,t Merck Merck SP,t\n=\u22120.0018+0.6435r , R2 =0.2245\nSP,t\n11. The CAPM is discussed in detail in Chapters 8\u201311. At this point we outline the application\n91 Calculating the Weighted Average Cost of Capital (WACC)\nA B C D E F G\nCOMPUTING THE BETA FOR MERCK\n1 monthly returns for Merck and SP500, 2007-2012\n2 Alpha 0.0018<-- =INTERCEPT(E11:E70,F11:F70)\n3 Beta 0.6435<-- =SLOPE(E11:E70,F11:F70)\n4 R-squared 0.2245<-- =RSQ(E11:E70,F11:F70)\n5 t-statistic for alpha 0.2059<-- =tintercept(E11:E70,F11:F70)\n6 t-statistic for beta 4.0979<-- =tslope(E11:E70,F11:F70)\n7\n8 Prices Returns\n9 Date Merck SP500 Merck SP500\n10 1-Jun-07 39.90 1,503.35\n11 2-Jul-07 39.78 1,455.27 -0.30% -3.25% <-- =LN(C11/C10)\n12 1-Aug-07 40.20 1,473.99 1.05% 1.28%<-- =LN(C12/C11)\n13 4-Sep-07 41.73 1,526.75 3.74% 3.52%<-- =LN(C13/C12)\n14 1-Oct-07 47.04 1,549.38 11.98% 1.47%\n15 1-Nov-07 47.93 1,481.14 1.87% -4.50%\n16 3-Dec-07 47.23 1,468.36 -1.47% -0.87%\n17 2-Jan-08 37.47 1,378.5517% -23.15% -6.31%\n18 1-Feb-08 y=0.6435x3+60..0000181,330.6314% -4.00% -3.54%\nR\u00b2=0.2245 11%\n19 3-Mar-08 31.11 1,322.70 8% -14.60% -0.60%\n20 1-Apr-08 31.19 1,385.595% 0.26% 4.65%\n21 1-May-08 31.94 1,400.382% 2.38% 1.06%\n-1%\n22 -22 0%-Jun -1- 70 %8 -14% -11%31.2 -1 8% 1,2 -58 %0.00 --24%% 1% 4% -2.371%% 10%-8.99%\n23 1-Jul-08 27.24 1,267.38-7% -13.61% -0.99%\n24 1-Aug-08 29.54 1,282.83-10% 8.11% 1.21%\n-13%\n25 2-Sep-08 26.42 1,166.36 -16% -11.16% -9.52%\n26 1-Oct-08 25.91 968.75-19% -1.95% -18.56%\n27 3-Nov-08 22.37 896.24-22% -14.69% -7.78%\n-25%\n28 1-Dec-08 25.82 903.25 14.34% 0.78%\n29 2-Jan-09 24.25 825.88 -6.27% -8.95%\nkcreM\nMerck return vs SP500, 2007-2012\nSP500\nHere \u2019 s what we can learn from this regression:\n\u2022 Merck \u2019 s beta, \u03b2 , shows the sensitivity of its stock return to the market\nMerck\nreturn. It is calculated by the following formula:\n( )\nCovariance SP500returns,Merckreturns\n\u03b2 =\nMerck ( )\nVariance SP500reeturns\nWe can compute \u03b2 either by using the formula above directly (cell B5 above)\nor by using the Excel S lope function (cell B4). Over the period covered, a 1%\nincrease or decrease in the monthly returns of the S&P 500 was accompanied\n92 Chapter 3\n(cell B6) shows that the \u03b2 is highly significant (see below for how this\nMerck\nfunction was constructed).1 2\n\u2022 Intel \u2019 s alpha, \u03b1 , shows that irrespective of changes in the S&P 500, the\nMerck\nmonthly return on Intel over the period was \u03b1 = 0.18%. On an annual\nMerck\nbasis, this is 12*0.18 = 2.18%; this seems to indicate that, in the jargon of\nfinancial markets, Merck had positive performance over the period. Note,\nhowever, the TIntercept (cell B5): This function (its construction in Excel is\ndiscussed below) shows that the negative intercept is not significantly different\nfrom zero.\n\u2022 The R2 of the regression shows that 22.45% of the variation in Merck\u2019 s\nreturns is accounted for by variability in the S&P 500. An R 2 of 22% may\nseem low, but in the CAPM literature this is not uncommon. It says that\nroughly 22% of the variation in Merck \u2019 s returns is explicable by the variation\nin the S&P 500 return. The rest of the variability in the Merck returns can be\ndiversified away by including Merck shares in a diversified portfolio of shares.\nThe average R 2 for stocks is approximately 30% to 40%, meaning that market\nfactors account for approximately this percentage of a stock\u2019 s variability, with\nfactors idiosyncratic to the stock accounting for the rest. Merck\u2019 s R 2, as you\ncan see, is a bit on the low side\u2014meaning that it has more idiosyncratic risk\nthan an average stock.\nT he spreadsheet that accompanies this chapter shows three ways of doing\nthe regression: One way is to use the functions I ntercept , Slope , Rsq . A\nsecond method involves using the Excel functions C ovar and VarP . A third\nway involves Excel \u2019 s Trendline function. Having graphed the returns of Intel\nand the SP500 on an XY Scatter plot, we then do the following:\n12. For the precise meaning of a t -statistic, you should refer to a good statistics text. For our\npurposes\u2014a t -statistic over 1.96 indicates that with 95% probability the variable under discussion\n(when using T Intercept this is the intercept, or when using TSlope this is the slope) is signifi-\ncantly different from zero. Thus the t -statistic for the intercept of \u20130.2059 indicates that the\nintercept is not significantly different from zero, whereas the t- statistic for the slope of 4.0979\n93 Calculating the Weighted Average Cost of Capital (WACC)\nFigure 3.1\nThe sequence of commands for producing regression results from the X Y Scatter Plot in Excel.\nHaving marked the points, we right-click to select A dd Trendline (left panel). We choose the\nlinear regression (middle panel) and indicate that the regression equation and the R2 should be\nprinted on the graph.\nThe Home-Made Functions TIntercept and TSlope\nT he spreadsheet above uses two functions to compute the t- statistics for the\nintercept and slope. These functions are built on the L inest function discussed\nin Chapter 33. Applying Linest to the return data, we get:\nI J K L\n9 Cells J13:K17created with the\n10 formula\n11 {=LINEST(E11:E70,F11:F70,,1)}\n12 Slope Intercept\n13 Slope --> 0.6435 0.0018<-- Intercept\n14 Standard error of slope --> 0.1570 0.0088<-- Standard error of intercept\n15 R-squared --> 0.2245 0.0682<-- Standard error of y values\n16 F statistic --> 16.7925 58.0000<-- Degrees of freedom\n17 SS --> 0.0781 0.2696<-- SSE = Residual sum of squares\nxy\nBy using the Excel function Index we define a VBA function T Intercept\nwhich divides the value of the intercept term produced by L inest (first row,\nsecond column of L inest output) by the standard error of the intercept (second\n94 Chapter 3\nFunction tintercept(yarray, xarray)\ntintercept = Application.Index(Application. _\nLinEst(yarray, xarray, , 1), 1, 2) / _\nApplication.Index(Application.LinEst(yarray, _\nxarray, , 1), 2, 2)\nEnd Function\nS imilarly we can define a function TSlope that gives the t- statistic for the\nslope:\nFunction tslope(yarray, xarray)\ntslope = Application.Index(Application. _\nLinEst(yarray, xarray, , 1), 1, 1) / _\nApplication.Index(Application.LinEst(yarray, _\nxarray, , 1), 2, 1)\nEnd Function\nBoth of these functions are embedded in the spreadsheet for this chapter.\nUsing Excel \u2019 s Data Analysis Add-In\nThere \u2019 s a fourth way to produce the regression output: By clicking on\nTools|Data Analysis|Regression , we can use a sophisticated Excel routine that\ncomputes more statistics, including the t - statistics. The output produced by\n95 Calculating the Weighted Average Cost of Capital (WACC)\nI J K L M N O P Q\n3 SUMMARY OUTPUT\n4\n5 Regression Statistics\n6 Multiple R 0.473836264\n7 R Square 0.224520805\n8 Adjusted R Square 0.211150474\n9 Standard Error 0.068184238\n10 Observations 60\n11\n12 ANOVA\n13 df SS MS F Significance F\n14 Regression 1 0.078069683 0.078069683 16.79246425 0.000131232\n15 Residual 58 0.26964724 0.00464909\n16 Total 59 0.347716923\n17\n18 Coefficients Standard Error t Stat P-value Lower 95% Upper 95% Lower 95.0% Upper 95.0%\n19 Intercept 0.001813136 0.008806331 0.205890007 0.837597818 -0.015814651 0.019440922 -0.015814651 0.019440922\n20 X Variable 1 0.643502885 0.157033851 4.097860936 0.000131232 0.329165479 0.957840291 0.329165479 0.957840291\nWe used Data|Data Analysis|Regression to produce this output. The set-\ntings are shown below:\nWhile Data|Data Analysis|Regression produces a lot of data, it has one\nmajor drawback: The output is not automatically updated when the underlying\n96 Chapter 3"
        ],
        "3.9": [
            "What is the Security Market Line (SML) in the context of capital asset pricing model?\nWhat is the risk-adjusted cost of capital?\nWhat is the difference between the two SML formulations?\nCan you explain the Classic Security Market Line (SML) .\nWhat is the formula for the cost of equity as per the classic CAPM formula?\nWhat is the relevance of taxes in the cost of capital equation?\nCan you elaborate on the terms 'risk-free rate of return' and 'expected rate of return on the market' used in the SML equation?\nWhat parameters are usually chosen for SML?\nWhat are the implications of choosing risk-free interest rate as 'r' in the SML equation?\nWhat alternative approaches are used to define the expected rate of return on the market (E(r))?\nWhy does the classic CAPM approach not allow for taxation?\nHow is the SML adjusted for the marginal corporate tax rate?\nWhat are the differences between the intercept and slope of the classic CAPM and tax-adjusted cost of equity?\nHow is a tax-adjusted cost of equity calculated?\nWhat factors contribute to the difference between classic and tax-adjusted cost of equity?\nWhy does the tax-adjusted approach typically give a higher cost of equity than the classic CAPM approach?\nHow is taxation incorporated in the tax-adjusted CAPM?\nWhat relevant concerns surround cost of capital computations related to tax-adjusted and classic CAPM?",
            "3.9 Using the Security Market Line (SML) to Calculate Merck \u2019 s Cost of\n\nEquity, r\nE\nI n the capital asset pricing model, the security market line (SML) is used to\ncalculate the risk-adjusted cost of capital. In this section we consider two SML\nformulations. The difference between these two methods has to do with the\nway taxes are incorporated into the cost of capital equation.\nMethod 1: The Classic SML\nT he classic CAPM formula uses a security market line (SML) equation that\nignores taxes:\nCostof equity,r =r +\u03b2[ E( r )\u2212r ]\nE f M f\nHere r is the risk-free rate of return in the economy and E ( R ) is the expected\nf M\nrate of return on the market. The choice of values for the SML parameters is\noften problematic. A common approach is to choose:\n\u2022 r equal to the risk-free interest rate in the economy (for example, the yield\nf\non Treasury bills). We leave the question of whether to use the short-term or\nlong-term rate open until section 3.11. For the moment, for illustrative pur-\nposes, we use r = 2%.\nf\n\u2022 E ( r ) equal to the historic average of the market return, defined as the\nM\naverage return of a broad-based market portfolio. There is an alternative\napproach based on market multiples; both of these are discussed below. For\nthe current section, we use E ( r ) = 8%.\nM\nT he following spreadsheet illustrates the classic CAPM cost of equity com-\nputation for Merck \u2019 s cost of equity:\nA B C\nCOMPUTING THE COST OF EQUITY FOR MERCK\nClassic CAPM: r = r + b*[E(r ) - r ]\n1 E f M f\n2 Merck beta, \u03b2 0.6435\n3 Risk-free rate, r 2.00%\nf\n4 Expected market return, E(r ) 8.00%\nM\n5 Merck cost of equity, r 5.86%<-- =B3+B2*(B4-B3)\n97 Calculating the Weighted Average Cost of Capital (WACC)\nMethod 2: The Tax-Adjusted SML\nT he classic CAPM approach makes no allowance for taxation. Benninga-Sarig\n(1997) show that the SML has to be adjusted for the marginal corporate tax\nrate in the economy. 13 Denoting the corporate tax rate by T , the tax-adjusted\nC\nSML is:\nCostof equity=r ( 1\u2212T )+\u03b2[ E( r )\u2212r ( 1\u2212T )]\nf C M f C\nThis formula can be applied by substituting r (1 \u2212 T ) for r in the classic\nf C f\nCAPM. Note that the Tax-adjusted cost of equity has a lower intercept and a\nhigher slope than the classic CAPM:\n\u2022 The intercept is r (1 \u2212 T ) instead of r . This intercept is lower than the r\nf C f f\nintercept of the classic CAPM.\n\u2022 The slope is E ( r ) \u2212 r ( 1 \u2212 T ) instead of E ( r ) \u2212 r. This slope can be written\nM f C M f\nas the classic CAPM slope plus T r : E ( r ) \u2212 r (1 \u2212 T ) = [ E ( r ) \u2212 r ] + T r\nC f M f C M f C f\nAnother way to write the tax-adjusted cost of equity is:\nTax-adjusted =r ( 1\u2212T )+\u03b2[ E( r )\u2212r ( 1\u2212T )]\ncostof equity f C M f C\n=r +\u03b2[ E( r )\u2212r ]+T r [\u03b2\u22121]\n(cid:2)f (cid:4)(cid:4)(cid:4)(cid:3)(cid:4)MM(cid:4)(cid:4)(cid:5)f C f\n\u2191\nClassic CAPM rE\nThis rewriting makes clear that the difference between the classic r and the\nE\ntax-adjusted r is a function of the corporate tax rate T , the risk-free rate r ,\nE C f\nand the equity beta \u03b2 . 14 For Merck, the tax-adjusted approach gives a somewhat\nhigher cost of equity:\n13. The logic of the Benninga-Sarig approach is outlined in our book C orporate Finance: A Valu-\nation Approach (McGraw-Hill, 1997). A more formal derivation of the model is given in \u201cRisk,\nReturns and Values in the Presence of Differential Taxation,\u201d co-authored with Oded Sarig.\nJournal of Banking and Finance , 2003.\n14. As this book is written, short-term, risk-free rates are close to zero, so that the difference\nbetween the tax-adjusted and classic CAPM is minimal. Presumably this will change at some\n98 Chapter 3\nA B C\nCOMPUTING THE COST OF EQUITY FOR MERCK\nTax-adjusted CAPM: r = r*(1-T ) + b*[E(r ) - r*(1-T )]\n1 E f C M f C\n2 Merck beta, \u03b2 0.6435\n3 Merck tax rate, T 12.84%<-- ='Merck tax rate'!D5\nC\n4 Risk-free rate, r 2.00%\nf\n5 Expected market return, E(r ) 8.45%\nM\n6 Merck tax-adjusted cost of equity, r 6.06%<-- =B4*(1-B3)+B2*(B5-B4*(1-B3))\nE\nAlthough the tax-adjusted CAPM is more consistent with an economy with\ntaxation, we confess that\u2014given the uncertainties surrounding cost of capital\ncomputations\u2014the difference between the classic CAPM and the tax-adjusted\nCAPM may not be worth the trouble."
        ],
        "3.10": [
            "What is the Weighted Average Cost of Capital (WACC)? \nWhat is the Capital Asset Pricing Model (CAPM)? \nWhat are some major approaches to computing the expected return on the market, E (r)? \nCan the expected return on the market, E (r), be computed from historical data? \nWhat is the role of the risk-free rate, r, in calculating the cost of equity?\nWhy might the computation of the expected return on the market involve using a major market index's historical return? \nHow can the historical market risk premium on the market index be used in calculating the expected return on the market? \nExplain the use of the Gordon model in computing E (r)?\nCan the expected return on the market, E (r), be computed from current market data without resort to history? \nWhat is the Vanguard\u2019s 500 Index Fund and how is it related to the computation of expected return on the market, E (r)? \nWhat is the significance of the annualized return in financial modeling? \nHow is the market risk premium calculated and what factors are taken into consideration? \nHow do we apply the risk premium directly to the computation of a company\u2019s cost of equity? \nCan you explain the computation of Merck\u2019s cost of equity using the market risk premium E (r) - r?\nWhat is the Gordon Model and how can it be utilized to calculate the expected return on the market, E (r)?\nWhat is a price earnings ratio and how does it factor into the calculation of E (r)?\nWhat role does the anticipated growth of market equity cash flow play in computing E (r)? \nWhat variables are considered in the Gordon Model for the computation of E (r)? \nWhat is the significance of the equity cash flow payout ratio in the computation of E (r)?\nExplain the relationship between the anticipated growth rate and the expected market return, E(r)?",
            "3.10 Three Approaches to Computing the Expected Return on the Market, E ( r )\n\nM\nTwo critical questions remain in the computation of the cost of equity r using\nE\nthe CAPM:\n\u2022 W hat is the expected return on the market, E ( r ) ? Should it be computed\nM\nfrom historical data? (And if so, how long should the data series be?) Or\nperhaps it can be computed from current market data without resort to history?\n\u2022 What is the risk-free rate, r ? Should it be a short-term or a long-term rate?\nf\nI n this section we deal with the first question, leaving the computation of r\nf\nfor section 3.11. There are three major approaches to computing E ( r ):\nM\n\u2022 The historical return on a major market index\n\u2022 The historical market risk premium on the market index\n\u2022 The Gordon model\nAll three approaches are illustrated in this section, and their effect on comput-\n99 Calculating the Weighted Average Cost of Capital (WACC)\nE ( r ) as the Historical Average Return on a Market Portfolio\nM\nA simple approach to computing E ( r ) is to take it as the average of the his-\nM\ntorical returns of a major market index. In the computation below we illustrate\nthis approach by using Vanguard \u2019 s 500 Index Fund as a proxy for the market.1 5\nThe annualized return on this fund since 1987 is 8.27%. We can take this as\na reliable proxy for the historical annual average return from holding the\nS&P 500:\nA B C D\nMEASURING E(r ) USING HISTORICAL DATA\nM\nDerived from prices for the Vanguard 500 Index Fund (symbol: VFINX)\n1 These prices include dividends; April 1987 - June 2012\n2 Average monthly return 0.69%<-- =AVERAGE(C10:C311)\n3 Monthly standard deviation 4.58%<-- =STDEV(C10:C311)\n4\n5 Annualized return 8.27%<-- =12*B2\n6 Annualized standard deviation 15.87%<-- =SQRT(12)*B3\n7\n8 Date Price Return\n9 1-Apr-87 15.66\n10 1-May-87 15.82 1.02%<-- =LN(B10/B9)\n11 1-Jun-87 16.62 4.93%<-- =LN(B11/B10)\n12 1-Jul-87 17.44 4.82%<-- =LN(B12/B11)\n13 3-Aug-87 18.11 3.77%<-- =LN(B13/B12)\n293 1-Dec-10 113.11 6.46%\n294 3-Jan-11 115.77 2.32%\n295 1-Feb-11 119.73 3.36%\n296 1-Mar-11 119.76 0.03%\n297 1-Apr-11 123.29 2.90%\n298 2-May-11 121.88 -1.15%\n299 1-Jun-11 119.84 -1.69%\n300 1-Jul-11 117.39 -2.07%\n301 1-Aug-11 110.99 -5.61%\n302 1-Sep-11 103.16 -7.32%\n303 3-Oct-11 114.42 10.36%\n304 1-Nov-11 114.15 -0.24%\n305 1-Dec-11 115.32 1.02%\n306 3-Jan-12 120.47 4.37%\n307 1-Feb-12 125.66 4.22%\n308 1-Mar-12 129.78 3.23%\n309 2-Apr-12 128.95 -0.64%\n310 1-May-12 121.19 -6.21%\n311 1-Jun-12 125.55 3.53%\n15. The Vanguard fund \u2019 s prices incorporate dividends on the S&P 500. Many index figures (such\n100 Chapter 3\nComputing the Market Risk Premium E ( r ) \u2212 r Directly\nM f\nW e can also compute the market risk premium directly. This requires a\nbit more work: In the spreadsheet below we show the monthly returns on the\nS&P 500 and monthly interest paid on U.S. Treasury bills. The average annual-\nized risk premium on the S&P 500 is 4.40%.\nA B C D E F\nMEASURING THE MARKET RISK PREMIUM E(r ) - r USING HISTORICAL DATA\nM f\nVanguard 500 Index Fund (symbol: VFINX) minus Treasury Bills\nApril 1987 - June 2012\n1 All measurements relate to monthly returns on SP500, r Mt, and the Treasury bill rate r ft\n2 Average monthly risk premium 0.37%<-- =AVERAGE(E10:E311)\nMethodological note: I have used the St. Louis FRED\n3 Monthly standard deviation 4.58%<-- =STDEV(E10:E311) data for 3-month Treasury Bills; this data is\n4 annualized, and I have divided it by 12 to get the\n5 Annualized risk premium 4.40%<-- =12*B2 monthly returns. Since the data can be taken as an\n6 Annualized standard deviation 15.85%<-- =SQRT(12)*B3 ex-ante return, the April 1987 rate is attributed to May\n7 1987.\nTreasury Market I've used 3-month instead of 1-month, because there\nrisk are lots of dataproblems with the latter.\n8 Date Price Return bill rate premium\n9 1-Apr-87 15.66\n10 1-May-87 15.82 1.02% 0.48% 0.53%<-- =C10-D10\n11 1-Jun-87 16.62 4.93% 0.49% 4.45%<-- =C11-D11\n12 1-Jul-87 17.44 4.82% 0.49% 4.33%\n13 3-Aug-87 18.11 3.77% 0.49% 3.28%\n295 1-Feb-11 119.73 3.36% 0.01% 3.35%\n296 1-Mar-11 119.76 0.03% 0.01% 0.01%\n297 1-Apr-11 123.29 2.90% 0.01% 2.90%\n298 2-May-11 121.88 -1.15% 0.01% -1.16%\n299 1-Jun-11 119.84 -1.69% 0.00% -1.69%\n300 1-Jul-11 117.39 -2.07% 0.00% -2.07%\n301 1-Aug-11 110.99 -5.61% 0.00% -5.61%\n302 1-Sep-11 103.16 -7.32% 0.00% -7.32%\n303 3-Oct-11 114.42 10.36% 0.00% 10.36%\n304 1-Nov-11 114.15 -0.24% 0.00% -0.24%\n305 1-Dec-11 115.32 1.02% 0.00% 1.02%\n306 3-Jan-12 120.47 4.37% 0.00% 4.37%\n307 1-Feb-12 125.66 4.22% 0.00% 4.22%\n308 1-Mar-12 129.78 3.23% 0.01% 3.22%\n309 2-Apr-12 128.95 -0.64% 0.01% -0.65%\n310 1-May-12 121.19 -6.21% 0.01% -6.21%\n311 1-Jun-12 125.55 3.53% 0.01% 3.53%\nApplying the risk premium directly to the computation of Merck \u2019 s cost of\nequity gives a cost of equity r close to 5% (note that we still haven\u2019 t settled\nE\nthe question of r ):\n101 Calculating the Weighted Average Cost of Capital (WACC)\nA B C\nCOMPUTING THE COST OF EQUITY FOR MERCK USING THE\nMARKET RISK PREMIUM E(r ) - r\n1 M f\n2 Merck beta, \u03b2 0.6435<-- =Page96!B2\n3 E(r ) derived from SP price/earnings 4.40%<-- =Page100!B5\nM\n4 Merck tax rate, T 12.84%<-- =Page98!B3\nC\n5 Risk free rate, r 2.00%<-- Still to be discussed\nf\n6 Intel cost of equity, r\nE,Intel\n7 Classic CAPM 4.83%<-- =B5+B2*B3\n8 Tax-adjusted CAPM 4.74%<-- =B5*(1-B4)+B2*(B3+B4*B5)\n9\nNote: The tax-adjusted model in cell B8 uses the equivalence:\nE(r ) - r (1-T ) = E(r ) - r + T *r\nM f C M f C f\nFor the low levels of taxes and low r in this example, there is virtually no difference between\nf\n10 the two approaches.\nCalculating the Expected Return on the Market Using the Gordon Model\nSetting E ( r ) = 4.40% approximates the historic market return in the United\nM\nStates for 1987\u20132012. Historic averages are appropriate if we think that the\nfuture anticipated rates of return will correspond to the historic average. On\nthe other hand, we may want to take current market data to calculate directly\nthe future anticipated market yield.\nWe can do this computation by using the Gordon model. Recall from section\n3.6 that the model says that the cost of equity r is given by:\nE\nDiv\n( 1+g)\nr = 0 +g\nE\nP\n0\nT his formula also applies to the market portfolio, so that we can write:\nDiv\n( 1+g)\nr = 0 +g , interpreting Div , P , and g to be the current dividend,\nM P 0 0\n0\nprice, and growth rate of the market portfolio. Assume that the firm pays out\na constant proportion a of its earnings as dividends; then, indicating by EPS\n0\nthe current earnings per share, D iv = a*EPS . Interpreting g to be the earnings\n0 0\ngrowth of the firm, we can write:\nE( r )=\na\u2217EPS 0( 1+g)\n+g=\na\u2217( 1+g)\n+g\nM\nP P /EPS\n0 0 0\nT he term on the right-hand side of this equation, P /EPS , is the price earnings\n0 0\nratio of the market. We can use this formula to compute E ( r ) , and thus tie\nM\nthe cost of equity to currently observable market parameters. Here is an\n102 Chapter 3\nA B C\nCOMPUTING E(r ) USING MARKET MULTIPLE\n1 M\n2 Market price/earnings multiple, June 2012 15.20\n3 Equity cash flow payout ratio 50.00%<-- Approx. U.S.: Dividends + repurchases\n4 Anticipated growth of market equity cash flow 5.00%<-- Analyst's estimate\n5 Expected market return, E(r ) 8.45%<-- =B3*(1+B4)/B2+B4\nM\nIn the remainder of this chapter, we will use this estimate for E ( r ).\nM"
        ],
        "3.11": [
            "What is a 'Risk-Free Rate' in the context of the Capital Asset Pricing Model (CAPM)?\nWhat is the debate among authors about how to determine the Risk-Free Rate in the CAPM?\nWhat is the significance of the short-term rate in the CAPM?\nCan long-term rates be used as Risk-Free Rate in the CAPM?\nWhat role does the choice of short-term or long-term rate play in financial modeling?\nWhat was the opinion of the author of the book 'Financial Modeling' about selecting Risk-Free Rate in the CAPM?\nWhat is the relevance of data from Yahoo/Finance in calculating the Risk-Free Rate?\nWhy might different authors suggest using different types of rates (short-, middle-, or long-term) for the Risk-Free Rate in the CAPM?\nHow does the choice of rate directly impact the cost of capital calculations in financial modeling?",
            "3.11 What \u2019 s the Risk-Free Rate r in the CAPM?\n\nf\nOpinions about this seem to differ widely. Some authors suggest using a short-\nterm rate, while others use a middle- or long-term rate. The author of this book\nhas been guilty of making both suggestions, though at the current writing he\nbelieves that you should use the short-term rate. 16 For the examples in this\nchapter, here is some data from Yahoo/Finance on 29 June 2012:"
        ],
        "3.12": [
            "What is the Weighted Average Cost of Capital (WACC)?\nCan you explain how WACC is computed?\nWhat are the factors considered when computing the WACC for a company?\nHow can WACC be calculated for different companies?\nWhat companies' examples are used in discussing the computation of the WACC in the present context?\nWhat does E ( r ) = 8.45% M represent in the context of WACC computation?\nWhat is the CAPM and how it applies to risky assets such as bonds?\nWhat is the \u03b2 (beta) of a risky asset?\nWhat does the \u03b2 (beta) in a risky asset impound?\nWhat is the significance of the risk-free rate (r) in financial modelling?\nUnder what circumstances might using a mid to long-term Treasury rate for r be advocated?\nWhat is the role of Treasury rate in the computation of WACC?\nHow do the WACC computations differ for Merck, Whole Foods, and Caterpillar?\nWhat is the significance of price/earnings multiple in calculating the WACC?\nWhat is meant by the 3-month Treasury bill rate in the calculation of WACC?\nWhat does r = 0.06% signify in the computation of WACC?\nPlease describe some of the ad hoc elements in the computation of the WACC.\nIs there any situation where price fluctuation of bonds can impose risk to the calculation of WACC?\nWhat is the holding period risk in the context of financial asset valuation?",
            "3.12 Computing the WACC, Three Cases\n\nIn the succeeding sections we compute the WACC for three companies: Merck,\nWhole Foods, and Caterpillar. In each of these examples we use E ( r ) = 8.45%\nM\n16. Reason: Since the CAPM should apply to all risky assets, it should also apply to bonds (even\ndefault-free bonds like Treasuries, which are risky since they suffer significant price fluctuations).\nThis suggests that the \u03b2 of a risky asset impounds its risk, including the holding period risk, and\nthat the proper risk-free rate r is a short-term rate. But in 1997 in my book P rinciples of Corporate\nf\nFinance: A Valuation Approach (with Oded Sarig), we advocated using a mid- to long-term\nTreasury rate for r . As Emerson said: \u201cA foolish consistency is the hobgoblin of little minds,\nf\n103 Calculating the Weighted Average Cost of Capital (WACC)\n(computed in section 3.10 from the S&P 500 price/earnings multiple) and the\n3-month Treasury bill rate, r = 0.06% (as discussed in section 3.11).\nf\nT hese three examples, for Merck, Whole Foods, and Caterpillar, illustrate\ndifferent situations and also how much ad hocery there is in the computations\nof the WACC. 17"
        ],
        "3.13": [
            "What is the Weighted Average Cost of Capital (WACC)?\nHow to compute the WACC for a company?\nWhat is the significance of cost of equity in calculating the WACC?\nWhat is the role of cost of debt in the calculation of the WACC?\nHow does equity value influence the WACC?\nWhat is the importance of net debt in determining the WACC?\nHow does tax rate affect the calculation of WACC?\nHow is the expected market return utilized in WACC calculation?\nWhat is the significance of the risk-free rate in WACC calculation?\nHow does equity beta affect the cost of equity and the WACC?\nWhat is the significance of the current dividend per share in the WACC calculation based on the Gordon per-share dividends method?\nHow do growth rates influence the cost of equity and the final WACC in each calculation method?\nWhat is the difference in the WACC calculated based on classic CAPM and tax-adjusted CAPM?\nHow are the different WACC estimates averaged to arrive at the final WACC?\nWhat factors can cause one WACC estimate to be considered extreme and excluded from the average calculation?\nCan a judgment call affect the estimated WACC?\nWhat is the concept of \u201cimprovised reasoning\u201d or \"ad hocery\" in financial theory?",
            "3.13 Computing the WACC for Merck (MRK)\n\nW e have discussed Merck\u2019 s cost of equity r and cost of debt r in previous\nE D\nsections. Our template summarizes these computations:\nA B C\n1 COMPUTING THE WACC FOR MERCK\n2 Shares outstanding 3.04<-- Billions\n3 Share price, 29 June 2012 41.75\n4 Equity value, E 126.92<-- =B2*B3\n5 Net debt, D 2.59<-- Billions\n6 Tax rate, T C 12.84%<-- =Page98!B3\n7 Cost of debt, r D 4.23%<-- 0.0423\n8 Expected market return, E(r M) 8.45%<-- =Page102!B5\n9 Risk-free rate, r f 2.00%\n10 Equity beta, \u03b2 0.6435<-- ='Pages91,93'!B3\n11\n12 WACC based on Gordon per-share dividends\n13 Current dividend/share 1.68<-- =4*'Page84, bottom'!B43\n14 Growth rate 2.02%<-- ='Page84, bottom'!E9\n15 Cost of equity, r E 6.13%<-- =B13*(1+B14)/B3+B14\n16 WACC 6.08%<-- =B15*$B$4/($B$4+$B$5)+B7*(1-$B$6)*$B$5/($B$4+$B$5)\n17\n18 WACC based on Gordon equity payouts\n19 Current equity payout 6,418<-- =Page86!E7\n20 Growth rate 13.71%<-- =Page86!B9\n21 Cost of equity, r E 11.20%<-- ='Page88, bottom'!B20\n22 WACC 13.90%<-- =B21*$B$4/($B$4+$B$5)+B13*(1-$B$6)*$B$5/($B$4+$B$5)\n23\n24 WACC based on classic CAPM\n25 Cost of equity, r E 6.15%<-- =B9+B10*(B8-B9)\n26 WACC 6.03%<-- =B25*$B$4/($B$4+$B$5)+B17*(1-$B$6)*$B$5/($B$4+$B$5)\n27\n28 WACC based on tax-adjusted CAPM\n29 Cost of equity, r E 6.06%<-- =B9*(1-B6)+B10*(B8-B9*(1-B6))\n30 WACC 6.14%<-- =B29*$B$4/($B$4+$B$5)+B21*(1-$B$6)*$B$5/($B$4+$B$5)\n31\n32 Estimated WACC? 6.08%<-- =AVERAGE(B16,B26,B30)\n17. Wiktionary ( http://en.wiktionary.org ) defines \u201cad hocery\u201d as \u201cimprovised reasoning.\u201d When\nused in combination with financial theory, we prefer to think of it as the golden mean between\n104 Chapter 3\nThe estimated WACC for Merck (cell B32) includes a judgment call: We\nhave averaged three of the estimates that are closest together, throwing out the\none estimate that appears to us to be extreme."
        ],
        "3.14": [
            "What is the Weighted Average Cost of Capital (WACC)?\nCan you define the Gordon Model?\nHow is the WACC computed for a company with negative net debt like Whole Foods (WFM)?\nCan you explain the significance of a company having liquid assets in excess of its debt?\nWhy is the dividend history of a company like Whole Foods (WFM) important in financial analysis?\nHow does one calculate the dividend growth rate?\nWhat is the role of dividends in the Gordon model cost of equity?\nWhat does the term \"cost of equity\" refer to in financial modeling?\nWhat are equity payouts and why are they significant in financial modeling?\nWhat is total equity payout and how does it relate to dividends and stock option exercises?\nWhat are some of the components of computing the WACC for a company like Whole Foods Market (WFM)?\nWhat is the meaning of common stock issuance proceeds and why are they important in financial modeling?\nWhat role does a company\u2019s share price play in determining its equity value?\nHow is net debt calculated and what is its significance?\nWhy are tax rates considered when computing the WACC?\nWhat is the cost of debt and how is it used in financial modeling?\nWhat is the expected market return and how does it fit into the calculation of the WACC?\nCan you explain the concept of Equity beta and its role in financial modelling?\nHow is the WACC calculated using the Gordon per-share dividends?\nWhat approach is used when the growth rate is not applicable in Gordon equity payouts?\nWhat is the connection between WACC and the classic CAPM?\nHow is the cost of equity calculated using the classic CAPM?\nWhat adjustments are made based on tax in the CAPM when computing the WACC?",
            "3.14 Computing the WACC for Whole Foods (WFM)\n\nIn a previous section we pointed out that Whole Foods (WFM) was an example\nof negative net debt; the company has liquid assets in excess of its debt. The\ncompany\u2019 s dividends have declined over the past 5 years and exhibit a break\nbetween July 2008 and January 2011:\nA B C D E F G\nCOMPUTING WHOLE FOODS (WFM) r\nE\n1 WITH THE GORDON MODEL\n2 WFM stock price P, 29 June 2012 95.32\n0\n3 Current dividend\n4 Quarterly 0.14\n5 Annualized dividend, Div 0.56<-- =4*B4\n0\nDividend growth rate, g\n6 since April 2007 -4.70%<-- =(B26/B14)^(1/5.22)-1\nDividend growth rate, g\n7 since January 2011 14.41%\n8 Gordon model cost of equity, r\nE\n9 Based on dividends since April 2007 -4.14%<-- =$B$5*(1+B6)/$B$2+B6\n10 Based on dividends since January 2011 15.08%<-- =$B$5*(1+B7)/$B$2+B7\n11\n12 Whole Foods Dividend History\nDividend per\n13 Date share Whole Foods Dividends:\n14 11-Apr-07 0.18\nIrregular and Declining\n15 11-Jul-07 0.18\n16 10-Oct-07 0.18 0.25\n17 9-Jan-08 0.20\n18 9-Apr-08 0.20 0.20\n19 9-Jul-08 0.20\n20 6-Jan-11 0.10 0.15\n21 8-Apr-11 0.10\n22 22-Jun-11 0.10 0.10\n23 15-Sep-11 0.10\n24 11-Jan-12 0.14 0.05\n25 3-Apr-12 0.14\n26 27-Jun-12 0.14 0.00\n27 10-Oct-06 22-Feb-08 6-Jul-09 18-Nov-10 1-Apr-12 14-Aug-13\n28 Term of dividends 5.22<-- =(A26-A14)/365\nI n the WACC template at the end of this subsection we use the average of\nthe two dividend growth rates in B9 and B10.\nW hole Foods total equity payouts show that in the past 3 years the company\n105 Calculating the Weighted Average Cost of Capital (WACC)\ngrowth rate for the total equity payouts that can be used in the WACC com-\nputation. In our WACC template for WFM, we ignore this method of comput-\ning the cost of equity.\nA B C D E F\n1 GORDON MODEL FOR WHOLE FOOD'S EQUITY PAYOUTS\nProceeds\nCommon from stock Total\nstock option equity\n2 Dividends issuance exercise payout\n3 2007 96,742 54,383 42,359<-- =B3-C3\n4 2008 109,072 18,019 91,053\n5 2009 0 4,286 -4,286\n6 2010 0 46,962 -46,962\n7 2011 52,620 296,719 -244,099\nA B C\n1 COMPUTING THE WACC FOR WHOLE FOODS MARKET (WFM)\n2 Shares outstanding 183.56<-- Millions\n3 Share price, 29 June 2012 95.32\n4 Equity value, E 17,497<-- =B2*B3, Millions\n5 Net debt, D -728<-- Millions\n6 Tax rate, T 37.90%<-- ='Page75, bottom'!D5\nC\n7 Cost of debt, r 4.72%<-- From financial statements, interest on term loan\nD\n8 Expected market return, E(r ) 8.45%<-- =Page102!B5\nM\n9 Risk-free rate, r 0.06%\nf\n10 Equity beta, \u03b2 0.51<-- From Yahoo\n11\n12 WACC based on Gordon per-share dividends\n13 Current dividend/share 0.56<-- =Page104!B5\n14 Growth rate 5.47%<-- =AVERAGE(Page104!B9:B10)\n15 Cost of equity, r 6.09%<-- =B13*(1+B14)/B3+B14\nE\n16 WACC 6.23%<-- =B15*$B$4/($B$4+$B$5)+B7*(1-$B$6)*$B$5/($B$4+$B$5)\n17\n18 WACC based on Gordon equity payouts\n19 Current equity payout\n20 Growth rate\nNot applicable\n21 Cost of equity, r\nE\n22 WACC\n23\n24 WACC based on classic CAPM\n25 Cost of equity, r 4.34%<-- =B9+B10*(B8-B9)\nE\n26 WACC 4.53%<-- =B25*$B$4/($B$4+$B$5)+B17*(1-$B$6)*$B$5/($B$4+$B$5)\n27\n28 WACC based on tax-adjusted CAPM\n29 Cost of equity, r 4.33%<-- =B9*(1-B6)+B10*(B8-B9*(1-B6))\nE\n30 WACC 4.52%<-- =B29*$B$4/($B$4+$B$5)+B21*(1-$B$6)*$B$5/($B$4+$B$5)\n31\n106 Chapter 3"
        ],
        "3.15": [
            "What is the Weighted Average Cost of Capital (WACC)?\nWhat is Caterpillar's cost of debt?\nHow is Caterpillar's tax rate computed?\nWhat is the significance of the Gordon dividend model in computing r for Caterpillar?\nWhat are equity payouts?\nHow is Caterpillar's equity payout calculated?\nWhat is the role of the payout method in computing r?\nWhat is the formula for computing the WACC for Caterpillar?\nWhat is the difference between WACC based on Gordon per-share dividends, WACC based on Gordon equity payouts, and WACC based on classic CAPM?\nWhy is the WACC important in financial modeling?\nHow does the expected market return affect the calculation of WACC?\nHow is the cost of equity computed in the WACC calculation?\nHow is growth rate calculated in the WACC calculation using Gordon's model?\nWhy might different models produce different estimates for the cost of equity and WACC?\nWhat is the basis for choosing the average of two computations in the WACC estimation?\nWhat factors are considered when computing Caterpillar\u2019s tax rate?\nHow does the share price influence the equity value?\nWhat is the significance of the risk-free rate in WACC calculations?\nWhat role does equity beta play in determining cost of equity?\nWhat is the impact of tax-adjusted CAPM on WACC calculation?",
            "3.15 Computing the WACC for Caterpillar (CAT)\n\nCaterpillar \u2019 s cost of debt is very low:\nA B C D E\nCATERPILLAR DEBT and Cost of debt r\nD\nNumbers in thousands\n1\n2 31-Dec-09 31-Dec-10 31-Dec-11\n3 Cash 4,867,000 3,592,000 3,057,000\n4\n5 Short-term debt 9,648,000 7,981,000 9,784,000\n6 Long-term debt 24,944,000 20,437,000 21,847,000\n7\n8 Net debt 29,725,000 24,826,000 28,574,000\n9\n10 Interest expense 389,000 343,000 396,000\n11 Cost of debt, r ? 1.26% 1.48%<-- =D10/AVERAGE(C8:D8)\nD\nCaterpillar \u2019 s tax rate is comfortably around 25% in years where it has sig-\nnificant income:\nA B C D E\n1 CATERPILLAR TAX RATE\n2 31-Dec-09 31-Dec-10 31-Dec-11\n3 Income before tax 569,000 3,750,000 6,725,000\n4 Income tax expense -270,000 968,000 1,720,000\n107 Calculating the Weighted Average Cost of Capital (WACC)\nBelow we show 10 years of dividend history for CAT. In our model we will\ntake the last 5 years of annual dividend growth to compute CAT\u2019 s r using the\nE\nGordon dividend model:\nA B C D E F\nCATERPILLAR DIVIDEND GROWTH AND GORDON DIVIDEND r\n1 E\nDividend\nDividend growth\n2 Date per share\n3 18-Oct-01 0.18 Whole period\n4 17-Jan-02 0.18 Quarterly growth 2.45%<-- =(B43/B3)^(1/40)-1\n5 18-Apr-02 0.18 Annual growth 10.15%<-- =(1+E4)^4-1\n6 18-Jul-02 0.18\n7 17-Oct-02 0.18 Last 5 years\n8 16-Jan-03 0.18 Quarterly growth 2.16%<-- =(B43/B23)^(1/20)-1\n9 16-Apr-03 0.18 Annual growth 8.92%<-- =(1+E8)^4-1\n10 17-Jul-03 0.18\n11 16-Oct-03 0.19 Cost of equity\n12 15-Jan-04 0.19 Current share price, P 90.60\n0\n13 22-Apr-04 0.19 Current dividend, Div 0.70\n0\n14 16-Jul-04 0.21 Dividend growth, g 8.92%<-- =E9\n15 21-Oct-04 0.21 Gordon cost of equity, r 9.77%<-- =E13*(1+E14)/E12+E14\nE\n16 18-Jan-05 0.21\n17 21-Apr-05 0.21\n18 20-Jul-05 0.25\n0.50\n19 20-Oct-05 0.25\n0.45\n20 18-Jan-06 0.25\n21 20-Apr-06 0.25 0.40\n22 18-Jul-06 0.30 0.35\n23 19-Oct-06 0.30 0.30\n24 18-Jan-07 0.30 0.25\n25 19-Apr-07 0.30\n0.20\n26 18-Jul-07 0.36\n0.15\n27 18-Oct-07 0.36\n28 17-Jan-08 0.36 0.10\n29 17-Apr-08 0.36 0.05\n30 17-Jul-08 0.42 0.00\n31 16-Oct-08 0.42\n32 15-Jan-09 0.42\n33 16-Apr-09 0.42\nOct-01 Oct-02 Oct-03 Oct-04 Oct-05 Oct-06 Oct-07 Oct-08 Oct-09 Oct-10 Oct-11\nC aterpillar\u2019 s equity payouts are very variable. We use the growth over the\nlast 2 years as the basis for the payout method of computing r :\n108 Chapter 3\nA B C D E F\n1 CATERPILLAR'S EQUITY PAYOUTS\nTreasury Total\nShares shares equity\n2 Dividends issued purchased payout\n3 31-Dec-07 845 -328 2,405 2,922<-- =B3+C3+D3\n4 31-Dec-08 953 -135 1,800 2,618\n5 31-Dec-09 1,029 -89 940\n6 31-Dec-10 1,084 -296 788\n7 31-Dec-11 1,159 -123 1,036\n8\n9 Growth, 5 years -22.84%<-- =(E7/E3)^(1/4)-1\n10 Growth, last 3 years 4.98%<-- =(E7/E5)^(1/2)-1\nUsing these values, we get the following template for CAT \u2019 s WACC:\nA B C\nCOMPUTING THE WACC FOR CATERPILLAR (CAT)\n1\n2 Shares outstanding 624.72<-- million\n3 Share price, 29 June 2012 90.60\n4 Equity value, E 56.60<-- =B2*B3/1000\n5 Net debt, D 28.57<-- Billions\n6 Tax rate, T 25.58%<-- ='Page106, bottom'!D5\nC\n7 Cost of debt, r 1.48%<-- ='Page106, top'!D11\nD\n8 Expected market return, E(r ) 8.45%<-- =Page102!B5\nM\n9 Risk-free rate, r 0.06%\nf\n10 Equity beta, \u03b2 1.98<-- Yahoo\n11\n12 WACC based on Gordon per-share dividends\n13 Current dividend/share 0.70<-- =4*Page107!B3\n14 Growth rate 9.77%<-- =Page107!E15\n15 Cost of equity, r 10.61%<-- =B13*(1+B14)/B3+B14\nE\n16 WACC 7.42%<-- =B15*$B$4/($B$4+$B$5)+B7*(1-$B$6)*$B$5/($B$4+$B$5)\n17\n18 WACC based on Gordon equity payouts\n19 Current equity payout 1.036<-- ='Page108, top'!E7/1000\n20 Growth rate 4.98%<-- ='Page108, top'!B10\n21 Cost of equity, r 6.90%<-- =B19*(1+B20)/B4+B20\nE\n22 WACC 4.96%<-- =B21*$B$4/($B$4+$B$5)+B7*(1-$B$6)*$B$5/($B$4+$B$5)\n23\n24 WACC based on classic CAPM\n25 Cost of equity, r 16.68%<-- =B9+B10*(B8-B9)\nE\n26 WACC 11.08%<-- =B25*$B$4/($B$4+$B$5)+B17*(1-$B$6)*$B$5/($B$4+$B$5)\n27\n28 WACC based on tax-adjusted CAPM\n29 Cost of equity, r 16.70%<-- =B9*(1-B6)+B10*(B8-B9*(1-B6))\nE\n30 WACC 12.82%<-- =B29*$B$4/($B$4+$B$5)+B21*(1-$B$6)*$B$5/($B$4+$B$5)\n31\n109 Calculating the Weighted Average Cost of Capital (WACC)\nO ur WACC estimates divide into two groups: the two Gordon-based models\nproduce significantly lower estimates for the r and WACC than the two\nE\nCAPM-based methods. In this case we take the average of the two latter com-\nputations (our general preference is often for CAPM over the dividend models)."
        ],
        "3.16": [
            "What is the Gordon model in financial modeling?\nWhat are some potential problems with the Gordon model?\nWhy doesn't the Gordon model work if a firm doesn't pay dividends?\nWhat can be the difficulties with the application of the Gordon model for even dividend-paying firms?\nWhat does the extraction of the future dividend payout rate from past dividends mean?\nHow can the Gordon model be applied using the dividend history of a company, for example, Ford Motor Company?\nWhat types of issues might arise when using past dividend history to predict future dividends?\nWhat solutions are suggested for those wishing to use the Gordon model, in relation to the case of Ford Motor Company's dividends?\nWhat is the Capital Asset Pricing Model (CAPM) in financial modeling?\nWhat problems can be encountered while using the CAPM model?\nWhat does the beta value of a company's stock indicate?\nWhat does negative beta indicate for a company's stock, as represented in the case of Big City Bagels?\nWhat implications does a near-zero R-squared value in a regression model between a company's returns and the S&P 500 returns have?\nWhat potential solutions are offered when the calculated beta value seems unreasonable or presents complications when estimating the cost of equity, as in the scenario offered about Big City Bagels?\nWhat is a financial model for a company and why might it be used to predict future dividends?\nWhat do the terms 'standard deviation' and 'risk' mean in the context of stock performance?\nWhy might one utilize beta values of similar companies when calculating the cost of equity for a particular company? \nWhat assumptions can be made concerning the beta value of a company when the beta estimate is not statistically different from zero? \nHow do you calculate cost of equity using the CAPM model?\nWhat influence does a company's tax rate have on the calculation of its cost of equity in context of CAPM?\nWhat is the concept of 'future correlation with the market' in reference to a company's beta?",
            "3.16 When Don \u2019 t the Models Work?\n\nA ll models have problems and nothing is perfect. 18 In this section we discuss\nsome of the potential problems with the Gordon model and with the capital\nasset pricing model.\nProblems with the Gordon Model\nO bviously the Gordon model doesn\u2019 t work if a firm doesn\u2019 t pay dividends and\nappears to have no intention\u2014in the immediate future\u2014of paying dividends. 19\nBut even for dividend-paying firms, it may be difficult to apply the model.\nParticularly problematic, in many cases, is the extraction of the future dividend\npayout rate from past dividends.\nC onsider, for example, the dividend history of Ford Motor Company in the\nyears 1989\u20131998:\nA B C\nFORD MOTOR CO. DIVIDEND HISTORY\n1989-1998\n1\n2 Year Dividend\n3 1989 3.00\n4 1990 3.00\n5 1991 1.95\n6 1992 1.60\n7 1993 1.60\n8 1994 1.33\n9 1995 1.23\n10 1996 1.46\n11 1997 1.64\n12 1998 22.81\n13 Growth rate, 1989-1997 -7.27% <-- =(B11/B3)^(1/8)-1\n14 Growth rate, 1989-1998 25.28% <-- =(B12/B3)^(1/9)-1\n18. \u201cHappiness is the maximum agreement of reality and desire.\u201d\u2014Stalin.\n19. Firms cannot intend never to pay dividends, because such an intention would rationally mean\n110 Chapter 3\nThe problem here is easily identifiable: Ford, whose dividends were in\nsteady decline until 1997, paid a cash dividend of $21.09 in 1998, this in addi-\ntion to its regular quarterly dividends (which summed to $1.72 in 1998). If we\nuse past history to predict the future, any inclusion of the extraordinary cash\ndividend will cause us to overestimate the future dividend growth. Excluding\nthe $21.09 dividend, however, also does not reflect the actual situation.\nI t appears that the 10-year history of Ford\u2019 s dividends is not, perhaps, the\nbest guide to its future dividend payout. There are several solutions to those\nwishing to use the Gordon model:\n\u2022 I f we exclude the extraordinary dividend of $21.09 in 1998, then the divi-\ndend growth over the 4 years ending in 1998 is a respectable 6.64%. If Ford\u2019 s\nanticipated future dividend growth is estimated to be this rate, then\u2014given its\nend-1998 stock price of $58.69\u2014the Gordon model cost of equity is 9.77%:\nA B C\n17 FORD'S DIVIDENDS EXCLUDING THE 1998 $21.09 DIVIDEND\n18 Year Dividend\n19 1989 3.00\n20 1990 3.00\n21 1991 1.95\n22 1992 1.60\n23 1993 1.60\n24 1994 1.33\n25 1995 1.23\n26 1996 1.46\n27 1997 1.64\n28 1998 1.72\n29 Growth rate, 1994-1998 6.64% <-- =(B28/B24)^(1/4)-1\n30 Ford's stock price, end-1998 58.69\n31 Gordon cost of equity 9.77% <-- =B28*(1+B29)/B30+B29\n\u2022 A better alternative might be to use Ford \u2019 s total payouts to equity, as illus-\ntrated in this chapter. This method does not mean, however, that we can get\naway from judgment calls (witness our extensive use of the two-stage Gordon\nmodel).\n\u2022 A last alternative to finding Ford \u2019 s cost of capital is to predict its future\ndividends by doing a full-blown financial model for the company. Such\nmodels\u2014illustrated in the succeeding two chapters\u2014are often used by ana-\nlysts. Though they are complicated and time consuming to build, they take\ninto account all of the firm \u2019 s productive and financial activities. Potentially\n111 Calculating the Weighted Average Cost of Capital (WACC)\nProblems with the CAPM\nIn the spreadsheet fragment below you will find the return of the S&P 500\nand Big City Bagels. From the regression, you can see that Big City \u2019 s \u03b2 is\n\u20130.6408.\nA B C D E F G\n1 COMPUTING BIG CITY BAGEL'S BETA\n2 S&P 500 Index Big City Bagels (BIGC)\nClosing Closing\n3 Date price Date price\n4 May-96 669.12 May-96 46.25\n5 Jun-96 670.63 0.23% Jun-96 38.75 -16.22%\n6 Jul-96 639.95 -4.57% Jul-96 50.00 29.03%\n7 Aug-96 R65e1g.9r9essin1g. 8B8i%g City Bagel onA tuhge-9 6S&P54050.63 -8.75%\n8 Sep-96 687.33 5.42% Sep-96 35.00 -23.29%\nMonthly data, May 1996 -March 1999\n9 Oct-96 705.27 2.61% Oct-96 33.75 -3.57%\n10 Nov-96 757.02 7.34% 200% Nov-96 16.25 -51.85%\n11 Dec-96 740.74 -2.15% Dec-96 13.13 -19.23%\n150%\n12 Jan-97 786.16 6.13% Jan-97 17.50 33.33%\n13 Feb-97 790.82 0.59% Feb-97 22.50 28.57%\n100%\n14 Mar-97 757y .=1 -20.6408- x4 -.2 06 .0% 212 Mar-97 25.63 13.89%\n15 Apr-97 801.34R\u00b2 = 0.500.8524% 50% Apr-97 30.00 17.07%\n16 May-97 848.28 5.86% May-97 25.00 -16.67%\n17 Jun-97 885.14 4.35% 0% Jun-97 24.38 -2.50%\n-15% -13% -10% -8% -5% -3% 0% 3% 5% 8%\n18 Jul-97 954.31 7.81% Jul-97 26.25 7.69%\n-50%\n19 Aug-97 899.47 -5.75% Aug-97 20.94 -20.24%\n20 Sep-97 947.28 5.32% -100% Sep-97 22.50 7.46%\n21 Oct-97 914.62 -3.45% Oct-97 10.16 -54.86%\nBig City Bagel \u2019 s stock is clearly risky\u2014the annualized standard deviation\nof its returns is 135% as compared to about 17% for the S&P 500 over the\nsame period. However, the \u03b2 of Big City Bagels is \u20130.0542, which indicates\nthat Big City has\u2014in a portfolio context\u2014n egative risk . Were this true, it\nwould mean that adding Big City to a portfolio would lower the portfolio\nvariance enough to justify a below-risk-free return for Big City. While this\nmight be true for some stocks, it is hard to believe that\u2014in the long run\u2014the\n\u03b2 of Big City is indeed negative. 20\n20. A more plausible explanation is that\u2014for the period covered\u2014Big City \u2019 s return has n othing\n112 Chapter 3\nThe R 2 of the regression between Big City \u2019 s returns and the S&P 500 is\nessentially zero, meaning that the S&P 500 simply doesn \u2019 t explain any of the\nvariation in Big City returns. For statistics mavens: The t -statistics of the\nintercept and the slope indicate that neither differs significantly from zero. In\nshort: The regression of Big City Bagels\u2019 historic returns on the S&P 500\nindicates no connection between the two whatsoever.\nWhat are we to make of this situation? How should we calculate the cost\nof capital for Big City? There are several alternatives:\n\u2022 We could assume that the Big City \u03b2 is \u20130.0542. The company\u2019 s tax rate in\nMarch 1999 was essentially zero, so that the classical CAPM and the tax-\nadjusted version coincide:\nA B C\nCOMPUTING THE COST OF EQUITY r FOR\nE\nBIG CITY BAGELS\nMarch 1999\n1\n2 Big City's beta -0.0542\n3\n4 Risk-free rate, r 4.29%\nf\n5 Expected market return, E(r ) 9.08%\nM\n6 Cost of equity, r 4.03% <-- =B4+B2*(B5-B4)\nE\n\u2022 We could assume that the \u03b2 of Big City is in fact 0; given the standard\ndeviation of the \u03b2 estimate for Big City, the \u03b2 is not statistically different from\nzero, so that this assumption makes sense. This means that all of Big City \u2019 s\nrisk is diversifiable and that the correct cost of equity for Big City is the risk-\nless rate of interest.\n\u2022 W e could assume that the covariance (or lack thereof) between Big City and\nthe S&P 500 is not indicative of their future correlation. This would eventually\nlead us to conclude that Big City \u2019 s risk is comparable to that of similar com-\npanies. A small study of the \u03b2 s of snack food companies during the same\nperiod shows their \u03b2 s to be well over 1: New World Coffee has a \u03b2 of 1.15,\nPepsico has a \u03b2 of 1.42, Starbucks has a \u03b2 of 1.84. Thus we might conclude\nthat the \u03b2 of Big City (in the sense of its future correlation with the market)\nwould be somewhere between 1.15 and 1.84. This would, of course, give a\n113 Calculating the Weighted Average Cost of Capital (WACC)\nA B C\nCOMPUTING THE COST OF EQUITY r FOR\nE\nBIG CITY BAGELS\nAssumes that forward-looking beta = 1.3\n1\n2 Big City's beta 1.3000\n3\n4 Risk-free rate, r 4.29%\nf\n5 Expected market return, E(r ) 9.08%\nM\n6 Cost of equity, r 10.52% <-- =B4+B2*(B5-B4)\nE\n(For what it \u2019 s worth: This author would follow the latter case \u2026)"
        ],
        "3.17": [
            "What is the Gordon Dividend Model used for in financial modelling?\nWhat is the purpose of the CAPM in financial modelling?\nHow is the cost of equity calculated in financial modelling?\nWhat are some practicable models used to calculate the cost of equity?\nWhat is the role of judgement calls in the application of financial models?\nWhat is the recommended approach when calculating the cost of capital?\nWhy is it suggested to use several models to calculate the cost of capital?\nWhat is the benefit of calculating the cost of capital for firms in the same industry?\nHow can the cost of capital be derived from analysis of multiple firms in the same industry?\nWhat is meant by 'consensus estimate' in the context of capital cost calculation?\nWhat are the implications of excluding certain numbers, like negative costs of equity, in capital cost calculations?\nHow does the process of calculating the cost of capital differ from a mechanistic exercise?",
            "3.17 Summary\n\nIn this chapter we have illustrated in detail the application of two models for\ncalculating the cost of equity: The Gordon dividend model and the CAPM.\nWe have also considered three of the four practicable models for calculating\nthe cost of debt. Because the application of these models includes for many\njudgment calls, our advice is to do the following:\n\u2022 Always use several models to calculate the cost of capital.\n\u2022 I f you have time, try to calculate the cost of capital not only for the firm\nyou are analyzing but also for other firms in the same industry.\n\u2022 F rom your analysis try to pick out a consensus estimate of the cost of capital.\nDon \u2019 t hesitate to exclude numbers (such as Big City \u2019 s negative cost of equity)\nthat strike you as unreasonable.\nI n sum, the calculation of the cost of capital is not just a mechanistic\nexercise!"
        ]
    },
    "4": {
        "4.1": [
            "What are the four approaches to corporate valuation as defined in financial modeling?\nWhat is the firm's enterprise value (EV) defined as in the context of financial modeling?\nHow does the accounting approach to computing an enterprise's value (EV) organize items on a balance sheet?\nWhat does the efficient markets approach to EV do to items on the accounting balance sheet?\nWhat role does market values play in the efficient markets approach to EV?\nWhat is the value of the enterprise in the discounted cash flow (DCF) approach based on?\nWhat are the free cash flows (FCFs) produced by in the discounted cash flow (DCF) approach to EV?\nHow does this chapter base its projections of future anticipated FCFs?\nHow are future anticipated FCFs projected in Chapters 5 and 6?\nWhat are the powerful tools that pro forma statements can be used for?\nHow does the method for deriving free cash flows differ between this chapter and Chapter 5?\nWhat factors are considered in the derivation of future FCFs in this chapter?\nWhat are the important technical issues that we need to focus on in the context of financial modeling?\nWhat adjustments need to be made in the passage from the consolidated statement of cash flows (CSCFs) to the free cash flow (FCF)?\nWhat are financing adjustments and how are they relevant in financial modeling?\nWhat does eliminating non-forward-looking items mean in the context of analyzing consolidated statements of cash flows?\nHow does the date discrepancy affect the analysis and what is the possible solution for this?\nWhat is the relevance of estimating the return on assets versus the return on equity in financial modeling?\nHow can reality fit our template in financial modeling?",
            "4.1 Overview\n\nC hapter 2 of Financial Modeling defi nes four approaches to corporate valua-\ntion. All are based on computing the fi rm\u2019 s enterprise value (EV), defi ned as\nthe present value of the fi rm \u2019 s future free cash fl ows (FCFs).\n\u2022 T he accounting approach to EV moves items on the balance sheet so that\nall operating items are on the left-hand side of the balance sheet and all fi nan-\ncial items are on the right-hand side.\n\u2022 The effi cient markets approach to EV revalues\u2014to the extent possible\u2014\nitems on the accounting EV balance sheet at market values. An obvious revalu-\nation is to replace the fi rm \u2019 s book value of equity with the market value of the\nequity.\n\u2022 The discounted cash fl ow (DCF) approach values the EV as the present value\nof the fi rm\u2019 s future anticipated free cash fl ows (FCFs) discounted at the\nweighted average cost of capital (WACC). The FCFs are the cash fl ows pro-\nduced by the fi rm \u2019 s productive assets\u2014its working capital, fi xed assets, good-\nwill, etc. In this book we use two implementations of the DCF approach. These\napproaches differ in their derivation of the fi rm \u2019 s free cash fl ows:\nI n this chapter we base our projections of future anticipated FCFs on an\nanalysis of the fi rm \u2019 s consolidated statement of cash fl ows. This method is\neasy to implement and (for a valuation method, all of which take a lot of time)\nrelatively simple.\nIn Chapters 5 and 6 we base our projections of future anticipated FCFs on\na pro forma model for the fi rm \u2019 s fi nancial statements. Pro forma statements\nare powerful tools that can be used for business plans as well as valuations,\nbut they are diffi cult and time consuming to implement.\nA lthough both Chapter 4 (this chapter) and Chapter 5 differ in their method\nfor deriving the free cash fl ows to be discounted, both chapters boil down to\n118 Chapter 4\nA B C D E F G H\n1 BASIC CASH FLOW VALUATION TEMPLATE\n2 Current free cash flow (FCF) 1,000\n3 Growth rate of FCF, years 1-5 8.00%\n4 Long-term FCF growth rate 5.00%\n5 Weighted average cost of capital (WACC) 11.00%\n6\n7 Year 0 1 2 3 4 5\n8 Future FCFs 1,080 1,166 1,260 1,360 1,469<-- =F8*(1+$B$3)\n9 Terminal value 25,713<-- =G8*(1+B4)/(B5-B4)\n10 Total 1,080 1,166 1,260 1,360 27,183<-- =G8+G9\n11\n12 Enterprise value 20,933<-- =NPV(B5,C10:G10)*(1+B5)^0.5\n13 Add back initial cash 2,000<-- From current balance sheet\n14 Subtract out debt 10,000<-- From current balance sheet\n15 Equity value 12,933<-- =B12+B13-B14\n16 Per share (1,000 shares) 12.93<-- =B15/1000\nT he difference between the two DCF approaches is in the derivation of the\nfuture FCFs. In this chapter we examine the fi rm \u2019 s consolidated statement of\ncash fl ows (CSCFs) and use it as a basis for estimating the future FCFs. We\nthen discuss issues related to estimating the short-term growth rate (8% above),\nthe long-term growth rate (5%), assuming that you have learned from Chapter\n3 how to compute the weighted average cost of capital (WACC) (11% above).\nWe focus on a number of important technical issues:\n\u2022 Adjustments that need to be made in the passage from the consolidated\nstatement of cash fl ows (CSCFs) to the free cash fl ow (FCF). These adjust-\nments involve:\nFinancing adjustments\n(cid:4284)\nCorrections for the vagaries of accounting rules\n(cid:4284)\nEliminating non-forward-looking items\n(cid:4284)\n\u2022 Dates that don \u2019 t match. Quite often the dates are not evenly spaced. We may\nbe, for example, projecting from annual statements that end on 31 December,\nbut the current valuation date may be September. How do we make our valu-\nation appropriate to this? The answer is to use XNPV , as we shall see.\n\u2022 Estimating the return on assets versus the return on equity. X IRR can\nprovide us with the answer.\nFinally, we discuss the methodology for making reality fi t our template (or\n119 Valuation Based on the Consolidated Statement of Cash Flows"
        ],
        "4.2": [
            "What is Free Cash Flow (FCF)? \nHow is Free Cash Flow (FCF) defined in terms of the cash produced by a business?\nWhat is the relationship between profit after taxes and Free Cash Flow (FCF)?\nWhat role does depreciation play in calculating Free Cash Flow (FCF)?\nHow does an increase in operating current assets affect the Free Cash Flow (FCF)?\nWhy are financing items excluded from the definitions of current assets and current liabilities when calculating Free Cash Flow (FCF)?\nHow does an increase in operating current liabilities contribute to a firm's Free Cash Flow (FCF)?\nWhat effect does an increase in fixed assets at cost have on a firm's Free Cash Flow (FCF)?\nWhy are after-tax net interest payments added back when measuring the Free Cash Flow (FCF)?\nHow is the Free Cash Flow (FCF) connected to the firm's consolidated statement of cash flows?\nWhat is the enterprise value (EV) and how is it calculated?\nHow are the short-term and long-term growth rates used in determining the enterprise value of a firm?\nWhat is the terminal value? How is it calculated?\nWhat adjustments need to be made in calculating the enterprise value (EV) if the cash flows occur throughout the year instead of at year-end?\nIn the context of Financial Modeling, how can Excel's NPV function be used to compute enterprise value?",
            "4.2 Free Cash Flow (FCF): Measuring the Cash Produced by the Business\n\nThe free cash fl ow (FCF) is defi ned as the cash produced by a business without\ntaking into account the way the business is fi nanced\u2014is the best measure of\nthe cash produced by a business. We discussed the defi nition of the FCF in\nChapter 2 and here only recall the defi nition:\nDefi ning the Free Cash Flow\nProfi t after taxes Accounting measure of fi rm profi tability. It is not a cash fl ow.\n+ Depreciation This noncash expense is added back to the profi t after tax.\n\u2212 Increase in Increase in sales-related For purposes of FCF, our\noperating current current assets is not an defi nitions of current assets\nassets expense for tax purposes and current liabilities\n(and is therefore ignored in excludes fi nancing items such\nthe profi t after taxes), but it as cash and debt.\nis a cash drain on the\ncompany.\n+ Increase in Increase in sale-related\noperating current current liabilities provides\nliabilities cash to the fi rm.\n\u2212 Increase in fi xed An increase in fi xed assets (the long-term productive assets of\nassets at cost the company) is a use of cash, which reduces the fi rm \u2019 s free\ncash fl ow.\n+ After-tax net FCF measures the cash produced by the business activity of\ninterest payments the fi rm. Add back after-tax net interest payments to neutralize\nthe interest component of the profi t after taxes.\nI n this chapter we base our computations of the free cash fl ow (FCF) on the\nfi rm \u2019 s consolidated statement of cash fl ows (CSCFs).\nComputing the Terminal Value\nThe enterprise value (EV) is defi ned as the present value of all future FCFs,\nE V\n=\u2211\u221e FCF\nt . Our valuation model assumes that a FCF growth rate\n( 1+WACC)t\nt=1\n120 Chapter 4\n6 and subsequent). Denoting the short-term growth rate by S Tg and the long-\nterm growth rate by LTg , the enterprise value of the fi rm can be written as:\nEV\n=\u22115 FCF 0( 1+STg)t\n+\n11 \u2211\u221e FCCF 5( 1+LTg)t\n(cid:2)t=1(cid:4)( (cid:4)1(cid:4)+W(cid:3)A(cid:4)C(cid:4)C(cid:4)) (cid:5)t (cid:2)( 1(cid:4)+ (cid:4)W(cid:3)A(cid:4)CC(cid:4)(cid:5))5 (cid:2)t=1(cid:4)( (cid:4)1(cid:4)+W(cid:3)A(cid:4)C(cid:4)C(cid:4)) (cid:5)t\n\u2191 \u2191 \u2191\nThe present value Discounting the Terminalvalue:\nof cash flowws,t=1,\u2026,5, terminal value to The present value in year 5\ngrowing at the time 0 of cash flows,t>5,\nshort-term growth rate growing at long-term\ngrowth ratte\nUsing a standard technique, we can show that:\nTerminalvalue=\u2211\u221e FCF 5\u2217( 1+LTg)t\n( 1+WACC)t\nt=1\n\u23a7FCF \u2217( 1+LTg)\n\u23aa 5 ifWACC >LTg\n=\u23a8 WACC\u2212\u2212LTg\n\u23aa\n\u23a9 undefined otherwise\nMid-Year Discounting\nRewriting the enterprise value (EV) to include the terminal value gives:\nEV\n=\u22115 FCF\nt +\n1 FCF 5( 1+LTg)\n( 1+WACC)t ( 1+WACC)5 ( WACC\u2212LTg)\nt=1\nThis formulation assumes that all cash fl ows occur at year-end. In fact most\ncorporate cash fl ows occur throughout the year; if we approximate this fact by\nassuming that on average the year-t cash fl ow occurs in the middle of the year,\nwe can rewrite the EV equation as\nEV\n=\u22115 FCF\nt +\n1 FCF 5( 1+LTg)\n( 1+WACC)t\u22120.5 ( 1+WACC)4.5 ( WACC\u2212LTg))\nt=1\nA little bit of algebra shows how this can be accommodated by Excel \u2019 s N PV\nfunction:\nEV =\u23a1 \u23a2\u22115 FCF t + 1 FCF 5( 1+LTg) \u23a5\u23a5\u23a4 \u2217( 1+WACC)0.5\n\u23a3 (cid:2)t=(cid:4)1( (cid:4)1+ (cid:4)W(cid:4)A(cid:4)CC(cid:4)) (cid:4)t (cid:4)( 1(cid:4)+ (cid:4)W(cid:3)A(cid:4)C(cid:4)C(cid:4))5 (cid:4)(cid:4)( W (cid:4)A (cid:4)CC (cid:4)\u2212 (cid:4)L (cid:4)T (cid:4)g (cid:5)) \u23a6\n\u2191\nCan be computed by Excel\u2019s NPV function\nI t is this version of EV that is used throughout this section of Financial\n121 Valuation Based on the Consolidated Statement of Cash Flows"
        ],
        "4.3": [
            "What is a consolidated statement of cash flows (CSCFs)?\nHow do we convert a consolidated statement of cash flows (CSCFs) into free cash flows (FCFs)?\nWhat items are eliminated in the conversion of CSCFs to FCFs?\nWhat adjustments are made to the figures of CSCFs during the conversion?\nWhat activities are accepted in the CSCFs during the conversion?\nWhat financing activities are dispensed with in the CSCFs during the conversion?\nWhat investing activities are examined in the CSCFs during the conversion?\nWhat is 'after-tax net interest' and how it affects the conversion of CSCFs into FCFs?\nWhat is enterprise value and how is it calculated?\nWhat does the valuation of a firm's historical free cash flows (FCF) require?\nHow can one estimate the short-term growth rate of a company's cash flows?\nHow is the long-term growth rate of a company's cash flows estimated?\nWhat is the weighted average cost of capital (WACC) and what role does it play in valuation?\nHow does the FCF factor into the estimation of the firm's enterprise value?\nWhy is the formula for terminal value only valid if the long-term growth rate is less than the WACC?\nWhat key parameters are necessary to apply the enterprise valuation methodology based on cash flow data? \nWhat is the 'data table header' in the financial valuation context and why does it include an \"If\" statement?\nWhat issues can arise in the process of valuation based on the consolidated statement of cash flows?",
            "4.3 A Simple Example\n\nThe consolidated statement of cash fl ows for ABC Corp. for the past 5 years\nis given below:\nA B C D E F G\nABC CORPORATION\n1 Consolidated Statement of Cash Flows, 2008-2012\n2 2008 2009 2010 2011 2012\n3 Operating Activities:\n4 Net earnings 479,355 495,597 534,268 505,856 520,273\nAdjustments to reconcile net earnings to net cash\n5 provided by operating activities\n6 Add back depreciation and amortization 41,583 47,647 46,438 45,839 46,622\n7 Changes in operating assets and liabilities:\n8 Subtract increase in accounts receivable 9,387 25,951 -12,724 1,685 -2,153\n9 Subtract increase in inventories -37,630 -22,780 -16,247 -15,780 -5,517\nSubtract increase in prepaid expenses and -52,191 13,573\n10 other assets 16,255 14,703 -2,975\nAdd increase in accounts payable, accrued 29,612 51,172\n11 expenses, pensions, and other liabilities 6,757 40,541 60,255\n12 Net cash provided by operating activities 470,116 611,160 574,747 592,844 616,505<-- =SUM(F4:F11)\n13\n14 Investing Activities:\n15 Short-term investments, net -5,000 -55,000 50,000 -10,000 20,000\n16 Purchases of property, plant and equipment -48,944 -70,326 -89,947 -37,044 -88,426\nProceeds from dispositions of property, plant and 197 6,956 22,942 6,179 28,693\n17 equipment\n18 Net cash used in investing activities -53,747 -118,370 -17,005 -40,865 -39,733<-- =SUM(F15:F17)\n19\n20 Financing Activities:\n21 Repayment of debt 0 0 -300,000 0 -7,095\n22 Proceeds from revolving credit facility borrowings 1,242,431 0 0 0 250,000\n23 Proceeds from the issuance of stock 48,286 114,276 69,375 68,214 37,855\n24 Dividends paid -332,986 -344,128 -361,208 -367,499 -378,325\n25 Stock repurchased -150,095 -200,031 -200,038 -200,003 -597,738\n26 Net cash used in financing activities 807,636 -429,883 -791,871 -499,288 -695,303<-- =SUM(F21:F25)\n27\n28 Changes in cash balances 1,224,005 62,907 -234,129 52,691 -118,531<-- =F12+F18+F26\n29\n30 Supplemental disclosure of cash flow information\n31 Cash paid during the period for\n32 Income taxes 255,043 175,972 314,735 283,618 305,094\n33 Interest 83,553 83,551 70,351 57,151 57,910\n34\n35 Income tax rate 34.73% 26.20% 37.07% 35.92% 36.96%<-- =F32/(F4+F32)\nIn order to turn this consolidated statement of cash fl ows (CSCFs) into free\ncash fl ows (FCFs), we eliminate all the fi nancial items. We also adjust the\nfi gures by adding back after-tax net interest. Since we want to use the CSCF\n122 Chapter 4\nor investment items that are not expected to recur. 1 In most cases these adjust-\nments amount to the following:\n\u2022 Accept all operating activities in the CSCF.\n\u2022 Dispense with all fi nancing activities.\n\u2022 Carefully examine the investing activities, eliminating those that are fi nan-\ncial but keeping the operational items.\n\u2022 Add back after-tax interest.\nIn the current example:\nA B C D E F G\nABC CORPORATION\n1 Consolidated Statement of Cash Flows, 2008-2012\n2 2008 2009 2010 2011 2012\n3 Operating Activities:\n4 Net earnings 479,355 495,597 534,268 505,856 520,273\nAdjustments to reconcile net earnings to net cash\n5 provided by operating activities\n6 Add back depreciation and amortization 41,583 47,647 46,438 45,839 46,622\n7 Changes in operating assets and liabilities:\n8 Subtract increase in accounts receivable 9,387 25,951 -12,724 1,685 -2,153\n9 Subtract increase in inventories -37,630 -22,780 -16,247 -15,780 -5,517\nSubtract increase in prepaid expenses and -52,191 13,573\n10 other assets 16,255 14,703 -2,975\nAdd increase in accounts payable, accrued 29,612 51,172\n11 expenses, pensions, and other liabilities 6,757 40,541 60,255\n12 Net cash provided by operating activities 470,116 611,160 574,747 592,844 616,505<-- =SUM(F4:F11)\n13\n14 Investing Activities:\n15 Short-term investments, net\n16 Purchases of property, plant and equipment -48,944 -70,326 -89,947 -37,044 -88,426\n17 Proceeds from dispositions of property, plant and 197 6,956 22,942 6,179 28,693\nequipment\n18 Net cash used in investing activities -53,747 -118,370 -67,005 -30,865 -59,733<-- =SUM(F15:F17)\n19\n20 Financing Activities:\n21 Repayment of debt\n22 Proceeds from revolving credit facility borrowings\n23 Proceeds from the issuance of stock\n24 Dividends paid\n25 Stock repurchased\n26 Net cash used in financing activities\n27\n28 Free cash flow before interest adjustment 416,369 492,790 507,742 561,979 556,772<-- =F12+F18+F26\n29 Add back after-tax net interest 54,537 61,658 44,271 36,620 36,504<-- =(1-F37)*F35\n30 Free cash flow (FCF) 470,906 554,448 552,013 598,599 593,276<-- =F28+F29\n31\n32 Supplemental disclosure of cash flow information\n33 Cash paid during the period for\n34 Income taxes 255,043 175,972 314,735 283,618 305,094\n35 Interest 83,553 83,551 70,351 57,151 57,910\n36\n37 Income tax rate 34.73% 26.20% 37.07% 35.92% 36.96%<-- =F34/(F4+F34)\n123 Valuation Based on the Consolidated Statement of Cash Flows\nThe Enterprise Value and the Value per Share\nAt this point we have estimates for the fi rm \u2019 s historical FCFs. In order to apply\nthe methodology, we need to estimate three parameters:\n\u2022 The short-term growth rate of ABC cash fl ows.\n\u2022 The long-term growth rate of ABC cash fl ows.\n\u2022 The weighted average cost of capital (WACC).\nS ome analysis, combined with seat-of-the-pants intuition, leads to the fol-\nlowing parameter choices and valuation. The D ata Table does sensitivity\nanalysis on the long-term growth rate and the WACC.\nA B C D E F G H\n1 ABC CORP. VALUATION\nFree cash flow (FCF)\n2 year ending 31 Dec. 2012 593,276<-- ='ABC, CSCF to FCF'!F30\n3 Growth rate of FCF, years 1-5 8.00%<-- Optimistic about short-term growth\n4 Long-term FCF growth rate 5.00%<-- More pessimistic about long-term growth\n5 Weighted average cost of capital (WACC) 10.70%\n6\n7 Year 2012 2013 2014 2015 2016 2017\n8 FCF 640,738 691,997 747,357 807,145 871,717<-- =F8*(1+$B$3)\n9 Terminal value 30,510,086<-- =G8*(1+B4)/(B3-B4)\n10 Total 640,738 691,997 747,357 807,145 31,381,803<-- =G8+G9\n11\n12 Enterprise value 22,209,831<-- =NPV(B5,C10:G10)*(1+B5)^0.5\nAdd back initial cash and marketable\n13 securities 73,697<-- From current balance sheet\n14 Subtract out 2012 financial liabilities 1,379,106<-- From current balance sheet\n15 Equity value 20,904,422<-- =B12+B13-B14\n16 Per share (1 million shares outstanding) 20.90<-- =B15/1000000\n17\n18 Data table: Share value vs LT growth and WACC\n19 data table header, Long-term growth \u2193\n20 =IF(B5>B4,B16,\"nmf\") --> 20.90 0% 3% 6% 9% 12%\n21 6% 10.31 15.74 nmf nmf nmf\n22 WACC \u2192 8% 9.48 14.48 34.45 nmf nmf\n23 10% 8.74 13.33 31.73 -60.24 nmf\n24 12% 8.06 12.30 29.26 -55.55 nmf\n25 14% 7.44 11.35 27.02 -51.29 -12.14\n26 16% 6.87 10.49 24.98 -47.44 -11.23\n27 18% 6.36 9.71 23.12 -43.93 -10.40\nT he data table header (our nomenclature for what the Data Table actually\ncomputes) includes an If statement. The reason is that, as shown above, the\nterminal value formula is valid only if the long-term growth rate is less than\nthe WACC.\nIn the following sections we deal with a number of issues that arise in this\n124 Chapter 4"
        ],
        "4.4": [
            "What is the method discussed in this chapter used for in financial modelling?\nCan you explain the term 'reverse engineering the market value' in the context of financial modelling?\nWhat is the significance of the CSCF in the financial valuation of a company?\nHow is Free Cash Flow (FCF) calculated for a company like Merck?\nWhat does the WACC represent in financial modelling and why is it important?\nWhat are short-term and long-term FCF growth rates and how do they influence the financial valuation of a company?\nWhat is a valuation template and how is it used in financial modelling?\nCan you explain how the enterprise value of a company is calculated?\nHow is the equity value of a company calculated?\nHow does the number of shares outstanding affect the share value of a company?\nWhat is the importance of the actual stock price in the context of financial modelling?\nHow does a change in the short-term growth rate affect the share value of a company?\nWhat is a \u2018Data table\u2019 in financial modelling?\nWhy would the market impute a negative long-term growth rate to a company's free cash flows?\nWhat is sensitivity analysis and how can it be applied to short-term growth rates?\nWhat is the significance of long-term growth rate in financial modelling?\nHow do growth rates and WACC affect model share prices?\nWhat impact does adjusting the short-term FCF growth rate have on the share price as per the model?",
            "4.4 Merck: Reverse Engineering the Market Value\n\nThe method discussed in this chapter can often be used to extract market\nexpectations of growth. As an example, consider Merck. Manipulation of the\nCSCF produces a 2011 FCF of $10,346 million. Using the WACC of 5.66%\ncomputed in Chapter 3 and some arbitrary values for the short- and long-term\nFCF growth rates gives us the valuation template for Merck below. 2\nA B C D E F G H\n1 MERCK CASH FLOW VALUATION TEMPLATE\n2 Current free cash flow (FCF) 10,346<-- ='Merck Free Cash Flow'!D51\n3 Growth rate of FCF, years 1-5 3.00%\n4 Long-term FCF growth rate 3.00%<-- critical question\n5 Weighted average cost of capital (WACC) 5.66%<-- Chapter 2\n6\n7 Year 0 1 2 3 4 5\n8 FCF 10,656 10,976 11,305 11,645 11,994<-- =F8*(1+$B$3)\n9 Terminal value 464,423<-- =G8*(1+B4)/(B5-B4)\n10 Total (sum of FCF+terminal) 10,656 10,976 11,305 11,645 476,417<-- =G8+G9\n11\n12 Enterprise value 411,797<-- =NPV(B5,C10:G10)*(1+B5)^0.5\n13 Add back initial cash 14,972<-- =13531+1441\n14 Subtract out debt 17,515<-- From current balance sheet\n15 Equity value 409,254<-- =B12+B13-B14\n16 Number of shares outstanding 3,040,838,643<-- Merck's financial statements\n17 Share value from our model 134.59<-- =B15/B16*1000000\n18 Actual stock price (30 Dec 2011) 37.70\nT he WACC for Merck was discussed in Chapter 3, where we saw that\nplausible estimates are in the range of 5% to 7%; the WACC = 5.66% was\ndetermined in Chapter 3 as an average of these plausible estimates. If the\nshort-term growth rate is 6% and the long-term growth is 3%, then our model\nproduces a share value of $154.43, which is very much larger than Merck \u2019 s\nstock price of $37.70. We use a D ata Table to fi nd what current market price\nrepresents in terms of long-term growth and WACC:\n125 Valuation Based on the Consolidated Statement of Cash Flows\nA B C D E F G\n20 Data table: Model share price as function of LT growth and WACC, short-term FCF growth rate = 6%\n21 Long-term growth rate \u2193\n22 =IF(B5>B4,B17,\"nmf\") --> 154.43 -5% -4% -3% -2% 0%\n23 5.0% 51.83 56.09 61.42 68.28 90.21\n24 5.2% 50.77 54.83 59.89 66.35 86.71\n25 5.4% 49.76 53.63 58.43 64.52 83.48\n26 WACC --> 5.6% 48.78 52.48 57.03 62.79 80.47\n27 5.8% 47.84 51.37 55.70 61.15 77.67\n28 6.0% 46.93 50.31 54.43 59.59 75.06\n29 6.2% 46.06 49.29 53.22 58.11 72.62\n30 6.4% 45.22 48.31 52.05 56.70 70.33\n31 6.6% 44.40 47.36 50.94 55.35 68.18\n32 6.8% 43.62 46.45 49.87 54.07 66.15\n33 7.0% 42.86 45.58 48.85 52.84 64.25\n34 7.2% 42.12 44.74 47.86 51.67 62.44\n35 7.4% 41.41 43.92 46.91 50.54 60.74\nWe have used Excel \u2019 s Conditional Formatting to highlight Merck share\nvaluations that are + / \u2212 20% of the current market price. It is now clear that\nthe market imputes a negative long-term growth rate to Merck \u2019 s free cash\nfl ows. We can also do some sensitivity analysis on the short-term growth rate\n(perhaps it doesn \u2019 t make sense that Merck \u2019 s long-term growth is so low and\nthat its short-term growth is 6%). Changing the short-term growth to 3% pro-\nduces the following Data Table :\nA B C D E F G\n20 Data table: Model share price as function of LT growth and WACC, short-term FCF growth rate = 3%\n21 Long-term growth rate \u2193\n22 =IF(B5>B4,B17,\"nmf\") --> 134.59 -5% -4% -3% -2% 0%\n23 5.0% 45.71 49.40 54.02 59.96 78.96\n24 5.2% 44.79 48.31 52.69 58.28 75.93\n25 5.4% 43.91 47.26 51.42 56.70 73.12\n26 WACC --> 5.6% 43.06 46.26 50.21 55.20 70.51\n27 5.8% 42.24 45.30 49.05 53.77 68.09\n28 6.0% 41.45 44.38 47.95 52.42 65.82\n29 6.2% 40.69 43.49 46.90 51.13 63.70\n30 6.4% 39.96 42.64 45.89 49.91 61.72\n31 6.6% 39.25 41.82 44.92 48.74 59.85\n32 6.8% 38.57 41.03 43.99 47.62 58.10\n33 7.0% 37.91 40.27 43.10 46.56 56.44\n34 7.2% 37.27 39.54 42.24 45.54 54.88\n35 7.4% 36.66 38.83 41.42 44.56 53.40\nT he conclusion remains the same: Market expectations of Merck\u2019 s long-\n126 Chapter 4"
        ],
        "4.5": [
            "What is the role of free cash flows in corporate valuation?\nWhat are the four parameters used in a simple valuation template?\nWhat is the significance of current Free Cash Flow (FCF) and short-term FCF growth rate in valuation?\nWhat is the role of long-term FCF growth rate in valuation?\nHow is valuation connected with Weighted Average Cost Of Capital (WACC)?\nWhat does it mean to 'reverse engineer the growth and WACC expectations'?\nWhat can be inferred about a company based on its current market price?\nHow is Pro Forma Financial Statement Modeling different from the valuation method discussed in the text?\nWhat role does the consolidated statement of cash flows play in building a valuation template?\nWhat does the term \"corporate simple valuation technique\" mean in financial modeling?\nHow can one use the WACC in a corporate valuation?\nIs it possible to deduce growth expectations from a company's current market price? \nWhat is the main focus of a valuation based on consolidated statement of cash flows?",
            "4.5 Summary\n\nT his chapter has illustrated a relatively corporate simple valuation technique.\nStarting with free cash fl ows derived from the consolidated statement of cash\nfl ows, we build a simple valuation template that is a function of only four\nparameters: the current FCF, the short-term FCF growth rate, the long-term\nFCF growth rate, and the weighted average cost of capital (WACC). Our tech-\nnique allows us to focus on the main valuation parameters and also allows us\nto reverse engineer the growth and WACC expectations built into the current\nmarket price.\nExercise\nThe fi les that accompany this book contains information for Kellogg. Use this information and\n5\nPro Forma Financial Statement Modeling"
        ]
    },
    "5": {
        "5.1": [
            "What are pro forma financial statements? \nWhat is the usefulness of financial statement projections for corporate financial management?\nHow are pro formas used in valuing a firm and its component securities?\nWhat role do pro formas play in credit analysis?\nHow can pro forma financial statements be used to predict a firm's future financing needs?\nWhat are \"what if\" games of simulation models in the context of financial analysis?\nHow can pro formas be used to determine potential strains on a firm caused by changes in financial and sales parameters?\nWhat is the significance of the fact that these financial models are sales driven?\nHow are sales related to balance sheet and income statement items?\nWhat does the mathematical structure of solving these financial models entail?\nWhat is the role of spreadsheet in modeling financial relations?\nWhy is there no need to worry about the solution of the financial model when using a spreadsheet? \nWhat is meant by accounting relations in the context of Excel models?",
            "5.1 Overview\n\nThe usefulness of fi nancial statement projections for corporate fi nancial man-\nagement is undisputed. Such projections, termed pro forma fi nancial state-\nments, are the bread and butter for much corporate fi nancial analysis. In this\nand the next chapter we will focus on the use of pro formas for valuing the\nfi rm and its component securities, but pro formas also form the basis for many\ncredit analyses; by examining pro forma fi nancial statements we can predict\nhow much fi nancing a fi rm will need in future years. We can play the usual\n\u201cwhat if \u201d games of simulation models, and we can use pro formas to ask\nwhat strains on the fi rm may be caused by changes in fi nancial and sales\nparameters.\nIn this chapter we present a variety of fi nancial models. All the models are\nsales driven, in that they assume that many of the balance sheet and income\nstatement items are directly or indirectly related to sales. The mathematical\nstructure of solving the models involves fi nding the solution to a set of simul-\ntaneous linear equations predicting both the balance sheets and the income\nstatements for the coming years. However, the user of a spreadsheet need never\nworry about the solution of the model; the fact that spreadsheets can solve\u2014by\niteration\u2014the fi nancial relations of the model means that we only have to\nworry about correctly stating the relevant accounting relations in our Excel\nmodel."
        ],
        "5.2": [
            "What is meant by sales driven in financial statement modeling?\nWhat is the role of sales in a financial statement model?\nHow might one determine the percentage of receivable accounts?\nWhat is a step function regarding sales levels?\nWhat is the difference between financial variables dependent on sales and those dependent on policy decisions?\nWhat is typically assumed about the asset side of a balance sheet in financial planning models?\nHow does a company decide between long term debt and equity for their financial policy?\nWhat are the assumed financial statement relations regarding sales growth, current assets, net fixed assets and depreciation?\nWhat is meant by 'the plug' in a financial statement model?\nHow does a firm ensure equal assets and liabilities in a financial model?\nHow does the plug relate to the firm's financing decisions?\nHow does defining the plug as cash and marketable securities impact the financing of the firm?\nWhat statement is being made about how the firm finances itself if cash and marketable securities are defined as the plug?\nWhy is it important to ensure that assets and liabilities are always equal in a financial model?\nWhat is the significance of projecting the next year's balance sheet and income statement in financial modeling?\nWhat influences the payout ratio of dividends in a financial model?\nWhat are the balance sheet equations used for in financial modeling?\nWhat does it mean when cash and marketable securities are the balance sheet plug?\nWhat assumptions are made about debt and stock in financial modeling?\nWhat does accumulated retained earnings represent in a financial model?\nWhy are circular references important in financial statement models in Excel?\nHow does one configure a spreadsheet to account for circular references between cells?\nWhat changes occur when extending a financial model to years 2 and beyond?\nWhat common errors occur when transitioning between a two-column financial model and an extended version?",
            "5.2 How Financial Models Work: Theory and an Initial Example\n\nA lmost all fi nancial statement models are sales driven; this term means that\nas many as possible of the most important fi nancial statement variables are\nassumed to be functions of the sales level of the fi rm. For example, accounts\nreceivable are often taken as a direct percentage of the sales of the fi rm. A\nslightly more complicated example might postulate that the fi xed assets (or\nsome other account) are a step function of the level of sales:\n\u23a7 a if sales<A\n\u23aa\nFixedassets=\u23a8 b if A\u2264sales<B\n\u23aa\n128 Chapter 5\nTo solve a fi nancial planning model, we must distinguish between those\nfi nancial statement items that are functional relationships of sales and perhaps\nof other fi nancial statement items and those items that involve policy decisions.\nThe asset side of the balance sheet is usually assumed to be dependent only\non functional relationships. The current liabilities may also be taken to involve\nfunctional relationships only, leaving the mix between long-term debt and\nequity as a policy decision.\nA simple example is the following. We wish to predict the fi nancial state-\nments for a fi rm whose current balance sheet and income statement are as\nfollows:\nA B\n13 Year 0\n14 Income statement\n15 Sales 1,000\n16 Costsofgoodssold (500)\n17 Interestpaymentsondebt (32)\n18 Interest earned on cash and marketable securities 6\n19 Depreciation (100)\n20 Profitbeforetax 374\n21 Taxes (150)\n22 Profitaftertax 225\n23 Dividends (90)\n24 Retainedearnings 135\n25\n26 Balance sheet\n27 Cashandmarketablesecurities 80\n28 Currentassets 150\n29 Fixed assets\n30 Atcost 1,070\n31 Depreciation (300)\n32 Netfixedassets 770\n33 Total assets 1,000\n34\n35 Currentliabilities 80\n36 Debt 320\n37 Stock 450\n38 Accumulatedretainedearnings 150\n129 Pro Forma Financial Statement Modeling\nThe current (year 0) level of sales is 1,000. The fi rm expects its sales to\ngrow at a rate of 10% per year, and it anticipates the following fi nancial state-\nment relations:\nCurrent assets: Assumed to be 15% of end-of-year sales\nCurrent liabilities: Assumed to be 8% of end-of-year sales\nNet fi xed assets: 77% of end-of-year sales\nDepreciation: 10% of the average value of assets on the books\nduring the year.\nFixed assets at cost: Sum of net fi xed assets plus accumulated\ndepreciation.\nDebt: The fi rm neither repays any existing debt nor\nborrows any more money over the 5-year horizon\nof the pro formas.\nCash and marketable This is the balance sheet plug (see explanation\nsecurities: below). Average balances of cash and marketable\nsecurities are assumed to earn 8% interest.\nThe \u201cPlug\u201d\nP erhaps the most important fi nancial policy variable in the fi nancial statement\nmodeling is the \u201cplug\u201d: This relates to the decision as to which balance sheet\nitem will \u201cclose\u201d the model:\n\u2022 How do we guarantee that assets and liabilities are equal (this is \u201cclosure\u201d\nin the accounting sense)?\n\u2022 How does the fi rm fi nance its incremental investments (this is \u201cfi nancial\nclosure\u201d)?\nI n general the plug in a pro forma model will be one of three fi nancial\nbalance sheet items: (i) Cash and marketable securities, (ii) debt, or (iii) stock.1\nAs an example, consider the balance sheet of our fi rst pro forma model:\n1 . A s noted in Chapter 3, cash can often be considered negative debt and vice versa. We return\n130 Chapter 5\nAssets Liabilities and Equity\nCash and marketable securities Current liabilities\nCurrent assets Debt\nFixed assets Equity\nFixed assets at cost Stock (net funds directly provided by\n\u2013 Accumulated depreciation shareholders)\nNet fi xed assets Accumulated retained earnings (profi ts\nnot paid out)\nTotal assets Total liabilities and equity\nI n the current example we assume that cash and marketable securities will\nbe the plug. This assumption has two meanings:\n1. The mechanical meaning of the plug: Formally, we defi ne\nCash and marketable securities = Total liabilities and equity\n\u2013 Current assets \u2013 Net fi xed assets\nBy using this defi nition, we guarantee that assets and liabilities will always be\nequal.\n2. The fi nancial meaning of the plug: By defi ning the plug to be cash and\nmarketable securities, we are also making a statement about how the fi rm\nfi nances itself. In our model below, for example, the fi rm sells no additional\nstock, does not pay back any of its existing debt, and does not raise any more\ndebt. This defi nition means that all incremental fi nancing (if needed) for the\nfi rm will come from the cash and marketable securities account; it also means\nthat if the fi rm has additional cash, it will go into this account.\nProjecting Next Year \u2019 s Balance Sheet and Income Statement\nAbove we have given the fi nancial statement for year 0. We now project the\n131 Pro Forma Financial Statement Modeling\nA B C D\n1 SETTING UP THE FINANCIAL STATEMENT MODEL\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 40%\n12\n13 Year 0 1\n14 Income statement\n15 Sales 1,000 1,100 <-- =B15*(1+$B$2)\n16 Costs of goods sold (500) (550) <-- =-C15*$B$6\n17 Interest payments on debt (32) (32) <-- =-$B$8*(B36+C36)/2\n18 Interest earned on cash and marketable securities 6 9 <-- =$B$9*(B27+C27)/2\n19 Depreciation (100) (117) <-- =-$B$7*(C30+B30)/2\n20 Profit before tax 374 410 <-- =SUM(C15:C19)\n21 Taxes (150) (164) <-- =-C20*$B$10\n22 Profit after tax 225 246 <-- =C21+C20\n23 Dividends (90) (98) <-- =-$B$11*C22\n24 Retained earnings 135 148 <-- =C23+C22\n25\n26 Balance sheet\n27 Cash and marketable securities 80 144 <-- =C39-C28-C32\n28 Current assets 150 165 <-- =C15*$B$3\n29 Fixed assets\n30 At cost 1,070 1,264 <-- =C32-C31\n31 Depreciation (300) (417) <-- =B31+C19\n32 Net fixed assets 770 847 <-- =C15*$B$5\n33 Total assets 1,000 1,156 <-- =C32+C28+C27\n34\n35 Current liabilities 80 88 <-- =C15*$B$4\n36 Debt 320 320 <-- =B36\n37 Stock 450 450 <-- =B37\n38 Accumulated retained earnings 150 298 <-- =B38+C24\n39 Total liabilities and equity 1,000 1,156 <-- =SUM(C35:C38)\nThe formulas are mostly obvious. (The dollar signs\u2014indicating that when\nthe formulas are copied the cell references to the model parameters should not\nchange\u2014are very important! If you fail to put them in the model will not copy\ncorrectly when you project years 2 and beyond.) In each year (model param-\n132 Chapter 5\nIncome Statement Equations\n\u2022 Sales = Initial sales * (1 + Sales growth )y ear\n\u2022 Costs of goods sold = Sales * Costs of goods sold/Sales\nThe assumption is that the only expenses related to sales are costs of\ngoods sold. Most companies also book an expense item called Selling, General,\nand Administrative expenses (SG&A). The change you would have to\nmake to accommodate this item are obvious (see an exercise at the end of\nthis chapter).\n\u2022 Interest payments on debt = Interest rate on debt * Average debt over the\nyear\nThis formula allows us to accommodate changes in the model for repay-\nment of debt, and rollover of debt at different interest rates. Note that in the\ncurrent version of the model, debt stays constant, but in other versions of the\nmodel discussed below debt will vary over time.\n\u2022 I nterest earned on cash and marketable securities = Interest rate on cash *\nAverage cash and marketable securities over the year\n\u2022 Depreciation = Depreciation rate * Average fi xed assets at cost over the\nyear\nT his calculation assumes that all new fi xed assets are purchased during the\nyear. We also assume that there is no disposal of fi xed assets.\n\u2022 Profi t before taxes = Sales \u2013 Costs of goods sold \u2013 Interest payments on debt\n+ Interest earned on cash and marketable securities \u2013 Depreciation\n\u2022 Taxes = Tax rate* Profi t before taxes\n\u2022 Profi t after taxes = Profi t before taxes \u2013 Taxes\n\u2022 Dividends = Dividend payout ratio * Profi t after taxes.\nThe fi rm is assumed to pay out a fi xed percentage of its profi ts as dividends.\nAn alternative would be to assume that the fi rm has a target for its dividends\nper share.\n133 Pro Forma Financial Statement Modeling\nBalance Sheet Equations\n\u2022 Cash and marketable securities = Total liabilities and equity \u2013 Current assets\n\u2013 Net fi xed assets\nA s explained above, this means that cash and marketable securities are the\nbalance sheet plug.\n\u2022 Current assets = Current assets/Sales * Sales\n\u2022 Net fi xed assets = Net fi xed assets/Sales * Sales2\n\u2022 Accumulated depreciation = Previous year \u2019 s accumulated depreciation +\nDepreciation rate * Average fi xed assets at cost over the year\n\u2022 Fixed assets at cost = Net fi xed assets + Accumulated depreciation\nNote that this model does not distinguish between plant property and equip-\nment (PP&E) and other fi xed assets such as land.\n\u2022 Current liabilities = Current liabilities/Sales * Sales\n\u2022 D ebt is assumed to be unchanged. An alternative model, which we will\nexplore later, assumes that debt is the balance sheet plug.\n\u2022 Stock doesn \u2019 t change. (Shareholders provide no additional direct fi nancing:\nthe company is assumed to issue no new stock or repurchase any stock.)\n\u2022 Accumulated retained earnings = Previous year \u2019 s accumulated retained earn-\nings + Current year\u2019 s additions to retained earnings\n2. This is not the only way to model fi xed assets. An alternative method assumes that n et fi xed\n134 Chapter 5\nCircular References in Excel\nFinancial statement models in Excel almost always involve cells that are mutually\ndependent. As a result the solution of the model depends on the ability of Excel to\nsolve circular references. If you open a spreadsheet that involves iteration and if your\nspreadsheet is not set up for circular references you will see the following Excel error\nmessage:\nTo make sure your spreadsheet recalculates, you have to go to the F ile|Options|Formulas\nbox and click Enable iterative calculation :\nExtending the Model to Years 2 and Beyond\n135 Pro Forma Financial Statement Modeling\nA B C D E F G\n1 FIRST FINANCIAL MODEL\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 40%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1 ,100 1 ,210 1 ,331 1 ,464 1 ,611\n16 Costs of goods sold (500) (550) (605) (666) (732) (805)\n17 Interest payments on debt (32) (32) (32) (32) (32) (32)\n18 Interest earned on cash and marketable securities 6 9 1 4 2 0 2 6 3 3\n19 Depreciation (100) (117) (137) (161) (189) (220)\n20 Profit before tax 374 4 10 4 50 4 92 5 38 5 87\n21 Taxes (150) (164) (180) (197) (215) (235)\n22 Profit after tax 225 2 46 2 70 2 95 3 23 3 52\n23 Dividends (90) (98) (108) (118) (129) (141)\n24 Retained earnings 135 1 48 1 62 1 77 1 94 2 11\n25\n26 Balance sheet\n27 Cash and marketable securities 80 1 44 2 13 2 89 3 71 4 59\n28 Current assets 150 1 65 1 82 2 00 2 20 2 42\n29 Fixed assets\n30 At cost 1,070 1 ,264 1 ,486 1 ,740 2 ,031 2 ,364\n31 Depreciation (300) (417) (554) (715) (904) (1,124)\n32 Net fixed assets 770 8 47 9 32 1 ,025 1 ,127 1 ,240\n33 Total assets 1,000 1 ,156 1 ,326 1 ,513 1 ,718 1 ,941\n34\n35 Current liabilities 80 8 8 9 7 1 06 1 17 1 29\n36 Debt 320 3 20 3 20 3 20 3 20 3 20\n37 Stock 450 4 50 4 50 4 50 4 50 4 50\n38 Accumulated retained earnings 150 2 98 4 60 6 37 8 30 1 ,042\n39 Total liabilities and equity 1,000 1 ,156 1 ,326 1 ,513 1 ,718 1 ,941\nNote that the most common mistake to make in the transition between the\ntwo-columned fi nancial model and this one is the failure to mark the model\nparameters with dollar signs. If you commit this error, you will get zeros in\n136 Chapter 5"
        ],
        "5.3": [
            "What is Free Cash Flow (FCF)?\nHow is Free Cash Flow (FCF) measured in a business? \nWhat's the importance of Free Cash Flow (FCF) for valuation purposes?  \nWhat are the components considered while defining Free Cash Flow?\nWhy is profit after taxes not considered the cash flow?\nHow does depreciation affect Free Cash Flow?\nWhat is the influence of the increase in operating current assets and liabilities on Free Cash Flow?\nWhat is the impact of an increase in fixed assets on the company's cash flow?\nHow does after-tax net interest payments contribute to Free Cash Flow?\nWhat is the difference between the Free Cash Flow calculation and the consolidated statement of cash flows?\nWhat are the three activities that contribute to the increase in the cash accounts in the balance sheet as mentioned in consolidated statement of cash flows?\nWhat is the purpose of the consolidated statement of cash flows?\nWhat is the role of a balance sheet plug in a Pro Forma Financial Statement?\nWhat are the elements considered in the cash flow from operating activities in the financial model?\nWhat are the elements considered in the cash flow from investing activities in the financial model?\nWhat are the elements considered in the cash flow from financing activities in the financial model?\nHow do the cash and marketable securities come into play in reconciling the cash balances?\nHow is net increase in cash and cash equivalents calculated?\nWhat checks are performed to ensure the accuracy of the projected balance sheets of the pro forma model?",
            "5.3 Free Cash Flow (FCF): Measuring the Cash Produced by the Business\n\nNow that we have the model, we can use it to make fi nancial predictions. The\nmost important calculation for valuation purposes is the f ree cash fl ow (FCF).\nFCF\u2014the cash produced by a business without taking into account the way\nthe business is fi nanced\u2014is the best measure of the cash produced by a busi-\nness. An extended discussion of the FCF was included in Chapter 2. For refer-\nence, we briefl y repeat the defi nition given in that chapter:\nDefi ning the Free Cash Flow\nProfi t after taxes Accounting measure of fi rm profi tability. It is not a cash fl ow.\n+ Depreciation This noncash expense is added back to the profi t after tax.\n\u2212 Increase in Increase in sales-related For purposes of FCF, our\noperating current current assets is not an defi nitions of current assets\nassets expense for tax purposes and current liabilities\n(and is therefore ignored in excludes fi nancing items such\nthe profi t after taxes), but it as cash and debt.\nis a cash drain on the\ncompany.\n+ Increase in Increase in sale-related\noperating current current liabilities provides\nliabilities cash to the fi rm.\n\u2212 Increase in fi xed An increase in fi xed assets (the long-term productive assets of\nassets at cost the company) is a use of cash, which reduces the fi rm \u2019 s free\ncash fl ow.\n+ After-tax net FCF measures the cash produced by the business activity of\ninterest payments the fi rm. Add back after-tax net interest payments to neutralize\n137 Pro Forma Financial Statement Modeling\nHere is the calculation for our fi rm:\nA B C D E F G\n40\n41 Year 0 1 2 3 4 5\n42 Free cash flow calculation\n43 Profit after tax 246 270 295 323 352\n44 Add back depreciation 117 137 161 189 220\n45 Subtract increase in current assets (15) (17) (18) (20) (22)\n46 Add back increase in current liabilities 8 9 10 11 12\n47 Subtract increase in fixed assets at cost (194) (222) (254) (291) (333)\n48 Add back after-tax interest on debt 19 19 19 19 19\n49 Subtract after-tax interest on cash and mkt. securities (5) (9) (12) (16) (20)\n50 Free cash flow 176 188 201 214 228\nReconciling the Cash Balances\nT he free cash fl ow calculation is different from the \u201cconsolidated statement of\ncash fl ows\u201d that is a part of every accounting statement. The purpose of the\nconsolidated statement of cash fl ows is to explain the increase in the cash\naccounts in the balance sheet as a function of the cash fl ows from the fi rm \u2019 s\noperating, investing, and fi nancing activities. In the pro forma example of this\nsection we treat the cash and marketable securities as the balance sheet plug;\nhowever, it can also be derived from a standard accounting statement of cash\nfl ows:\nA B C D E F G H\n53 CONSOLIDATED STATEMENT OF CASH FLOWS: RECONCILING THE CASH BALANCES\n54 Cash flow from operating activities\n55 Profit after tax 2 46 2 70 2 95 3 23 3 52 <-- =G22\n56 Add back depreciation 1 17 1 37 1 61 1 89 2 20 <-- =-G19\n57 Adjust for changes in net working capital:\n58 Subtract increase in current assets (15) (17) (18) (20) (22) <-- =-(G28-F28)\n59 Add back increase in current liabilities 8 9 1 0 1 1 1 2 <-- =G35-F35\n60 Net cash from operating activities 3 56 4 00 4 48 5 02 5 62 <-- =SUM(G55:G59)\n61\n62 Cash flow from investing activities\n63 Aquisitions of fixed assets--capital expenditures (194) (222) (254) (291) (333) <-- =-(G30-F30)\n64 Purchases of investment securities 0 0 0 0 0 <-- Not in our model\n65 Proceeds from sales of investment securities 0 0 0 0 0 <-- Not in our model\n66 Net cash used in investing activities (194) (222) (254) (291) (333) <-- =SUM(G63:G65)\n67\n68 Cash flow from financing activities\n69 Net proceeds from borrowing activities 0 0 0 0 0 <-- =G36-F36\n70 Net proceeds from stock issues, repurchases 0 0 0 0 0 <-- =G37-F37\n71 Dividends paid (98) (108) (118) (129) (141) <-- =G23\n72 Net cash from financing activities (98) (108) (118) (129) (141) <-- =SUM(G69:G71)\n73\n74 Net increase in cash and cash equivalents 64 70 76 82 88 <-- =G72+G66+G60\n138 Chapter 5\nL ine 75 checks that the changes in the cash accounts derived through the\nconsolidated statement of cash fl ows match those derived in the fi nancial\nmodel (which uses cash as a plug). As you can see, the model works, in the\nsense that changes in cash balances from the consolidated statement of cash\nfl ows in fact match those in the projected balance sheets of the pro forma\nmodel."
        ],
        "5.4": [
            "What is the enterprise value of a firm in the context of financial modeling?\nWhat is the role of free cash flow projections in determining the enterprise value of a firm?\nCan you explain the concept of weighted average cost of capital (WACC)? \nHow is WACC related to the enterprise value of a firm? \nWhat does the term \"terminal value\" refer to in financial modeling?\nWhat is the expected growth rate of free cash flows in the terminal value calculation? \nCan you explain how the Year-5 Terminal Value is used in the enterprise value calculation formula? \nWhy does the formula for calculating terminal value become senseless if the long-term growth rate is greater than or equal to the WACC?\nWhat is the significance of long-term free cash flow growth rate in financial modeling?\nHow can one calculate the present value of a growing annuity? \nWhat happens if the long-term growth rate is greater than or equal to the weighted average cost of capital?\nHow is the asset value in year 0 calculated in these projections?\nWhat role does the value of a firm's debt today play in deriving the equity value?\nHow does sales growth differ from long-term free cash flow growth rate in financial modeling? \nFor firms operating in a mature market, how can the long-term FCF growth be estimated? \nWhat is the relationship between sales growth and long-term FCF growth rate?\nWhat might be the significance of a firm's market sector in determining its long-term FCF growth rate? \nHow is inflation anticipated to impact the long-term FCF growth?",
            "5.4 Using the Free Cash Flow (FCF) to Value the Firm and Its Equity\n\nThe enterprise value of the fi rm is the present value of the fi rm \u2019 s future antici-\npated free cash fl ows. We can use the pro forma FCF projections and a cost of\ncapital to determine the enterprise value of the fi rm. Suppose we have deter-\nmined that the fi rm\u2019 s weighted average cost of capital (WACC) is 20% (recall\nthat the calculation of the WACC was discussed in Chapter 2). Then the e nter-\nprise value of the fi rm is the discounted value of the fi rm \u2019 s projected\nFCFs plus its terminal value:\nEnterprisevalue=\u2211\u221e FCF\n1\n( 1+WACC)t\nt=1\nMost fi nancial analysts consider it presumptuous to project an infi nite number\nof free cash fl ows; therefore the projected cash fl ow stream is often cut off at\nsome arbitrary date and a terminal value is substituted for the cash fl ows\nbeyond this date:\nFCF FCF FCF\nEnterprisevalue=\n(\n1+WAC1\nC)1\n+\n(\n1+WAC2\nC)2\n+\u2026+\n(\n1+WAC5\nC)55\nYear-5TerminalValue\n+\n( 1+WACC)5\nI n this formula, the Year-5 Terminal Value is a proxy for the present value of\n139 Pro Forma Financial Statement Modeling\nonward, we use the most common terminal value model, assuming that year-5\nfree cash fl ows grow at a long-term growth rate L Tg :\nTerminalValueatendof\nyear5=\u2211\u221e FCF\nt+5\n=\u2211\u221e FCF 5\u2217( 1+LTg))t\n( 1+WACC)t ( 1+WACC)t\nt=1 t=1\nFCF\n\u2217( 1+LTg)\n= 5\nWACC\u2212LTg\nprovided LTg <WACC\nT his model (based on the formula for the present value of a growing annuity,\nsee section 1.1) assumes that the year-5 cash fl ow will continue to grow at a\nconstant long-term growth rate. Note that the formula is senseless if the long-\nterm growth rate LTg is greater than or equal to the weighted average cost of\ncapital; if this were the case, then the terminal value would be infi nite (clearly\nimpossible).\nHere \u2019 s an example which uses our projections:\nA B C D E F G H I J\n53 Valuing the firm\n54 Weighted average cost of capital 20%\n55 Long-term free cash flow growth rate 5%<-- real growth 2% + inflation 3%?\n56\n57 Year 0 1 2 3 4 5\n58 FCF 176 188 201 214 228\n59 Terminal value 1,598<-- =G58*(1+B55)/(B54-B55)\n60 Total 176 188 201 214 1,826\n61\n62 Enterprise value, present value of row 60 1,231 <-- =NPV(B54,C60:G60)\n63 Add in initial (year 0) cash and mkt. securities 80 <-- =B27\n64 Asset value in year 0 1,311 <-- =B63+B62\n65 Subtract out value of firm's debt today (320)<-- =-B36\n66 Equity value 991 <-- =B64+B65\nN ote that the long-term FCF growth rate in cell B55 is different from the\nsales growth in cell B2 in the spreadsheet on page 135. The sales growth is\nthe anticipated growth over the years 1\u20135; the long-term growth rate is prob-\n140 Chapter 5\nfi rm \u2019 s market sector. For fi rms operating in a mature market, we often estimate\nthe long-term FCF growth as the sum of real growth plus anticipated\ninfl ation."
        ],
        "5.5": [
            "What is the valuation procedure in financial modeling?\nCan you explain the concept of terminal value in financial modeling?\nWhat is the role of the growing annuity model in determining the terminal value?\nHow can the long-term rate of growth impact the terminal value?\nWhat are some common variations of calculating the terminal value?\nHow does the treatment of cash and marketable securities affect the valuation procedure?\nWhat are the assumptions made about Year-0 balances of cash and marketable securities in the valuation procedure? \nWhat is the concept of initial cash balances being considered as negative debt?\nHow does mid-year discounting play into financial valuation modeling?\nWhat adjustments are made to the valuation if cash flows occur smoothly throughout the year instead of at the end?\nWhat are the components in the formula for calculating enterprise value using mid-year discounting?\nHow does the Weighted Average Cost of Capital (WACC) factor into the valuation procedure? \nWhat is the significance of Free Cash Flow (FCF) in financial modeling and the valuation procedure?\nHow does the book value of debt and equity factor into the valuation of terminal value?\nCan you explain the process of using the Excel\u2019s NPV function for financial calculations in financial modeling? \nHow is the equity value calculated in the valuation procedure?\nWhat is the role of EBITDA in the valuation procedure in financial modeling?",
            "5.5 Some Notes on the Valuation Procedure\n\nI n this section we cover some issues related to the valuation procedure outlined\nin section 5.4.\nTerminal Value\nI n determining the terminal value we used a version of the growing annuity\nmodel described in Chapter 1. We have assumed that\u2014after the year-5 projec-\ntion horizon\u2014the cash fl ows will grow at a long-term rate of growth of 5%.\nThis gives the terminal value as:\nFCF \u2217( 1+Long-termFCF growth)\nTerminalValueatendof year5= 5\nWACC\u2212LLong-termFCF growth\nA s noted in the previous section, this formula is only valid if the long-term\nFCF growth is less than the WACC.\nT here are other ways of calculating the terminal value. All of the following\nare common variations that can be implemented in the framework of our model\n(see end-of-chapter exercises):\n\u2022 Terminal value = Year-5 book value of debt + Equity\nT his calculation assumes that the book value correctly predicts the market\nvalue.\n\u2022 Terminal value = (Enterprise market/book multiple) * (Year-5 book value of\ndebt + Equity)\n\u2022 Terminal value = P/E ratio * Year-5 profi ts + Year-5 book value of debt\n\u2022 Terminal value = EBITDA ratio * Year-5 anticipated EBITDA\n(EBITDA = Earnings before interest, taxes, depreciation, and amortization.)\nThe Treatment of Cash and Marketable Securities in the Valuation\nWe have added the initial cash balances back to the present value of the\nprojected FCFs to get the enterprise value. This procedure assumes the\n141 Pro Forma Financial Statement Modeling\n\u2022 Y ear-0 balances of cash and marketable securities are not needed to produce\nthe FCFs in subsequent years.\n\u2022 Y ear-0 balances of cash and marketable securities are \u201csurpluses\u201d which\ncould be drawn down or paid out by shareholders without affecting the future\neconomic performance of the fi rm.\nA wholly equivalent assumption sometimes made by investment bankers\nand equity analysts is to assume that initial cash balances are n egative debt .\nIf you made this assumption, you would value the equity in the following way:\nA B C D\n68 Cash and marketable securities as negative debt\n69 NPV of row 60 = enterprise value 1,295 <-- =B62\n70 Net year 0 debt: debt minus cash (240)<-- =-B36+B27\n71 Equity value 1,055 <-- =B69+B70\nMid-Year Discounting\nW hile the NPV formula assumes that all cash fl ows occur at the end of the\nyear, it is more logical to assume that they occur smoothly throughout the year.\nFor discounting purposes, we should therefore discount cash fl ows as if, on\naverage, they occur in the middle of the year. This means that the enterprise\nvalue is more logically calculated as:\nFCF FCF\nEnterprisevalue= 1 + 2 +\u2026\n( 1+WACC)0.5 ( 1+WACC)1.5\nFCF Year-5TerminalValue\n+ 5 +\n( 1+WACCC)4.5 ( 1+WACC)4..5\n\u23a1 FCF FCF \u23a4\n1 + 22 +\u2026\n\u23a2\u23a2( 1+WACC)1 ( 1+WACC)2 \u23a5\n=\u23a2 \u23a5\n\u23a2 FCF Year-5TerminalValue\u23a5\n+ 5 +\n\u23a2 \u23a5\n\u23a3 (cid:2)(cid:4)( 1(cid:4)+ (cid:4)W(cid:4)A(cid:4)CC(cid:4)) (cid:4)5 (cid:4)(cid:4)(cid:3)(cid:4)( 1(cid:4)+ (cid:4)W(cid:4)A(cid:4)CC(cid:4)) (cid:4)5 (cid:4)(cid:4)(cid:5)\u23a6\n\u2191\nThis can be calculated using Excel\u2019s NPV functiion\n\u2217( 1+WACC)0.5\n142 Chapter 5\nA B C D E F G H I J\n74 Valuing the firm\u2014using mid-year discounting\n75 Weighted average cost of capital 20%\n76 Long-term free cash flow growth rate 5%\n77\n78 Year 0 1 2 3 4 5\n79 FCF 176 188 201 214 228\n80 Terminal value 1,598 <-- =G79*(1+B76)/(B75-B76)\n81 Total 176 188 201 214 1,826\n82\n83 Enterprise value, NPV of row 81 1,348 <-- =NPV(B75,C81:G81)*(1+B75)^0.5\n84 Add in initial (year 0) cash and mkt. securities 80 <-- =B27\n85 Asset value in year 0 1,428 <-- =B84+B83\n86 Subtract out value of firm's debt today (320)<-- =B65\n87 Equity value 1,108 <-- =B85+B86"
        ],
        "5.6": [
            "What does the term \"Net Fixed Assets\" refer to in financial modeling?\nCan you describe the concept of depreciation and its significance in financial modeling?\nWhat does it mean when it is said that net fixed assets are a function of sales?\nWhat are the implications if depreciation has no economic meaning in a financial model?\nHow may the productive capacity of assets be represented in a financial model if depreciation is deemed economically insignificant?\nWhat are the alternative models for fixed assets mentioned in the context of pro forma financial statement modeling?\nUnder what circumstances might it be assumed that the existing fixed asset base can accommodate future sales if maintained properly?\nWhat does the term \"pro forma\" mean in financial modeling and analysis?\nWhat does the term \"gross fixed assets\" refer to in the context of financial modeling?\nWhat adjustments might need to be made if the fixed assets at cost represent the future productive capacity of assets in a financial model?\nHow can the concept of depreciation be applied in the case of a supermarket financial model?\nHow does keeping net fixed assets constant impact the financial model?\nWhat is the signification of the statement, \"This model implies that depreciation equals capital expenditure\"?\nHow are free cash flows affected under the assumption of constant net fixed assets?\nWhat does the term \"free cash flow\" mean in financial analysis and modeling? \nWhat are the components of the free cash flow calculation indicated in the text? \nHow does the model account for after-tax interest on debt and cash market securities?\nWhat is the impact of sales growth on equity valuation in financial modeling?\nWhat is the role of dividend payout ratios in pro forma financial statement modeling?\nHow is the depreciation rate applied in the financial models described?",
            "5.6 Alternative Modeling of Fixed Assets\n\nThe models in this chapter assume that the net fi xed assets (NFA) are a func-\ntion of sales. In effect this means that we assume that the depreciation of the\nfi xed assets has actual economic meaning, so that the productive capacity of\nthese assets is determined by their after-depreciation value. At the ethereal\nlevel of the pro forma models of this chapter, this appears to us to be an accept-\nable assumption.\nThere are, however, two alternative models that the fi nancial modeler may\nwant to consider. The fi rst of these assumes that depreciation has no economic\nmeaning. In this case the gross fi xed assets are a function of sales. The second\nalternative model is to assume that the existing fi xed asset base, if properly\nmaintained, can accommodate reasonable levels of future sales.3 Both alterna-\ntive models are easily accommodated in the pro forma framework already set\nout; in the remainder of this section we give illustrations.\nGross Fixed Assets Are a Function of Sales\nSuppose depreciation has no economic meaning, so that the fi xed assets at cost\nrepresent the future productive capacity of assets.4 This requires only a small\nadjustment to our previous model:\n3. A third alternative is to extensively model future fi xed asset expenditures. While this may add\nthe whiff of \u201creality\u201d to the fi nancial model, it often just adds many layers of fi nancial and model-\ning confusion.\n143 Pro Forma Financial Statement Modeling\nA B C D E F G H\n1 FIXED ASSETS AT COST IS A FUNCTION OF SALES\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Fixed assets at cost/Sales 107%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 40%\n26 Balance sheet\n27 Cash and marketable securities 80 229 398 589 805 1,049\n28 Current assets 150 165 182 200 220 242\n29 Fixed assets\n30 At cost 1,070 1,177 1,295 1,424 1,567 1,723 <-- =$B$5*G15\n31 Depreciation (300) (412) (536) (672) (821) (986)<-- =F31+G19\n32 Net fixed assets 770 765 759 752 745 737 <-- =G30+G31\n33 Total assets 1,000 1,158 1,338 1,541 1,770 2,028\nNet Fixed Assets Are Constant\nIn certain cases it may be appropriate to assume that the current fi xed assets,\nif properly maintained, can accommodate reasonable levels of future sales. An\nexample might be the case of a supermarket\u2014if depreciation is taken to be\nthe economic expression of the maintenance and asset replacement required\nto service the existing customer base, then this means that the net fi xed assets\nwould be constant over time. This assumption has been made in a number of\nHarvard cases. 5\nThis variation in our basic model is easily made, as shown below:\nA B C D E F G H\nNET FIXED ASSETS CONSTANT\nDepreciation reinvested into fixed assets\n1\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets Constant\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 40%\n26 Balance sheet\n27 Cash and marketable securities 80 223 386 570 777 1,010\n28 Current assets 150 165 182 200 220 242\n29 Fixed assets\n30 At cost 1,070 1,183 1,307 1,445 1,597 1,765 <-- =G32-G31\n31 Depreciation (300) (413) (537) (675) (827) (995)<-- =F31+G19\n32 Net fixed assets 770 770 770 770 770 770 <-- =F32\n33 Total assets 1,000 1,158 1,337 1,539 1,767 2,022\n5. See William Fruhan, Financial Strategy: Studies in the Creation, Transfer, and Destruction of\n144 Chapter 5\nT his model implies that depreciation equals capital expenditure. This can\nbe seen in the free cash fl ows:\nA B C D E F G H I J\n90 Data table: The effect of sales growth (cell B2) on equity valuation\n91 Growth 1,108<-- =B87 , data table header\n92 0% 1,093\n93 2% 1,105 1,120 Sales Growth and Equity Value\n94 4% 1,113 1,110\n95 6% 1,117 1,100\n96 8% 1,115\n97 10% 1,108 1,090\n98 12% 1,095 1,080\n99 14% 1,076 1,070\n100 16% 1,049 1,060\n101 1,050\n102 1,040\n103 0% 2% 4% 6% 8% 10% 12% 14% 16%\n104\nSales growth\n105\n106\neulav\nytiuqE\nA B C D E F G H\n41 Year 0 1 2 3 4 5\n42 Free cash flow calculation\n43 Profit after tax 251 284 320 361 406\n44 Add back depreciation 113 124 138 152 168 <-- =-G19\n45 Subtract increase in current assets (15) (17) (18) (20) (22)\n46 Add back increase in current liabilities 8 9 10 11 12\n47 Subtract increase in fixed assets at cost (113) (124) (138) (152) (168)<-- =-(G30-F30)\n48 Add back after-tax interest on debt 19 19 19 19 19\n49 Subtract after-tax interest on cash and mkt. securities (7) (15) (23) (32) (43)\n50 Free cash flow 255 281 308 339 372"
        ],
        "5.7": [
            "What is sensitivity analysis in financial modeling?\nWhat could be an example of a base case for sensitivity analysis in valuation?\nHow is the sales growth rate related to the equity value of a firm?\nWhat could be indicated by the increased value of a firm with initial increases in sales growth?\nWhy does high sales growth sometimes lead to a decrease in a firm's value?\nHow does calculating the effect on equity valuation of both the long-term Free Cash Flow (FCF) growth and the Weighted Average Cost of Capital (WACC) differ from calculating the effects of only one of these factors?\nWhy does examining the terminal value equation only make sense if the WACC is greater than the growth rate?\nCan you explain how a data table does a sensitivity analysis in financial modeling?\nWhat would happen if the WACC is less than or equal to the long-term FCF growth in the terminal value equation?\nWhat could be the possible impact on equity valuation when there are changes in the growth rate of sales and WACC?",
            "5.7 Sensitivity Analysis\n\nA s in any Excel model, we can perform extensive sensitivity analysis on our\nvaluation. Taking the example in section 5.3 as our base case, we can ask, for\nexample, what is the effect of the sales growth rate on the equity value of\nthe fi rm:\nC ells B91:C100 contain a data table (see Chapter 31 if you are unsure of\nhow to construct these tables). While initial increases in sales growth increase\nthe value of the fi rm, very high sales growth actually decreases fi rm value. We\n145 Pro Forma Financial Statement Modeling\nAnother variation is to calculate the effect on equity valuation of\nboth the long-term FCF growth and the WACC. Here, however, you\nhave to be careful: Examining the terminal value equation\nFCF \u2217( 1+long-termFCF growth)\nT erminalValue= 5 will show you that\nWACC\u2212long-termFCF ggrowth\nthis calculation only makes sense if the WACC is greater than the growth rate.6\nTo overcome this problem we defi ne the data table cell B107 (this is the\ncalculation on which the data table does its sensitivity analysis) in the\nfollowing way:\nA B C D E F G H I J K\n107 WACC \u2193\n=IF(B75<=B76,\"nmf\",B87)\n108 1,108.37 10% 12% 14% 16% 18% 20% 22% 24% 26%\n109 0% 2 ,038.12 1 ,660.04 1 ,390.52 1 ,188.82 1 ,032.29 9 07.35 8 05.37 7 20.58 6 49.00\n110 Growth rate of sales --> 2% 2 ,447.00 1 ,915.96 1 ,562.34 1 ,310.08 1 ,121.12 9 74.36 8 57.11 7 61.31 6 81.59\n111 4% 3 ,128.45 2 ,299.84 1 ,802.89 1 ,471.75 1 ,235.34 1 ,058.12 9 20.35 8 10.19 7 20.10\n112 6% 4 ,491.36 2 ,939.65 2 ,163.72 1 ,698.09 1 ,387.62 1 ,165.81 9 99.40 8 69.93 7 66.32\n113 8% 8 ,580.08 4 ,219.26 2 ,765.09 2 ,037.61 1 ,600.82 1 ,309.39 1 ,101.03 9 44.61 8 22.81\n114 10% nmf 8 ,058.09 3 ,967.84 2 ,603.47 1 ,920.62 1 ,510.41 1 ,236.55 1 ,040.62 8 93.42\n115 12% nmf nmf 7 ,576.07 3 ,735.18 2 ,453.61 1 ,811.94 1 ,426.27 1 ,168.64 9 84.20\n116 14% nmf nmf nmf 7 ,130.34 3 ,519.60 2 ,314.48 1 ,710.85 1 ,347.86 1,105.25\n117 16% nmf nmf nmf nmf 6 ,717.58 3 ,319.58 2 ,185.15 1 ,616.70 1,274.71"
        ],
        "5.8": [
            "What does the term \"Debt as a Plug\" imply in Financial Modeling?\nWhat can be the implications of negative cash and marketable securities in a model?\nHow is the WACC related to the terminal value in a pro forma financial statement model? \nWhat does a negative cash account indicate about a firm's financial status?\nWhat is the role of the firm's sales growth, current asset requirements, fixed asset requirements, and dividend payouts in financing the firm?\nWhat two conditions should a model meet with regards to cash and financing in a firm?\nWhat is the significance of debt and cash in the equations for a balance sheet as indicated for year-5 entries?\nWhat happens when current assets plus net fixed assets is greater than the sum of current liabilities, last year\u2019s debt, stock, and accumulated retained earnings?\nWhat happens to the firm's cash balances if the firm does not need to increase debt?\nHow does the cash act as a plug in the financial model?\nHow could the model accommodate a situation with minimum cash balances?\nWhat is the relevance of the Dividend Payout Ratio in a firm's financial statement? \nWhat does it mean for a firm to finance its productive activities? \nHow do increased sales growth, current asset requirements, and increased dividend payouts affect a firm's need for financing?",
            "5.8 Debt as a Plug\n\nI n the model shown above, cash and marketable securities were the plug and\ndebt was a constant. However, for some values of the model parameters, you\ncan get negative cash and marketable securities. Consider the following\nexample\u2014this is still the same model as above, but\u2014as indicated on the\nspreadsheet itself\u2014with some different parameter values:\n6. If the growth rate > WACC, then\nT\nerminalValue=\u2211\u221e FCF 5\u2217( 1+long-termFCFgrowth)t\n=\u221e . Thus the WACC puts an\nt=1\n( 1+WACC)t\n146 Chapter 5\nA B C D E F G\n1 NEGATIVE CASH BALANCES: ILLUSTRATION\n2 Sales growth 20%<-- Increased from 10%\n3 Current assets/Sales 20%<-- Increased from 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 80%<-- Increased from 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 50%<-- Increased from 40%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1 ,200 1 ,440 1 ,728 2 ,074 2 ,488\n16 Costs of goods sold (500) (600) (720) (864) (1,037) (1,244)\n17 Interest payments on debt (40) (40) (40) (40) (40) (40)\n18 Interest earned on cash and marketable securities 6 4 (0) (6) (13) (21)\n19 Depreciation (100) (124) (156) (194) (242) (299)\n20 Profit before tax 366 4 40 5 24 6 24 7 42 8 84\n21 Taxes (147) (176) (210) (249) (297) (354)\n22 Profit after tax 220 2 64 3 14 3 74 4 45 5 30\n23 Dividends (110) (132) (157) (187) (223) (265)\n24 Retained earnings 110 1 32 1 57 1 87 2 23 2 65\n25\n26 Balance sheet\n27 Cash and marketable securities 80 2 8 (36) (113) (209) (325)\n28 Current assets 200 2 40 2 88 3 46 4 15 4 98\n29 Fixed assets\n30 At cost 1,100 1 ,384 1 ,732 2 ,157 2 ,675 3 ,306\n31 Depreciation (300) (424) (580) (774) (1,016) (1,315)\n32 Net fixed assets 800 9 60 1 ,152 1 ,382 1 ,659 1 ,991\n33 Total assets 1,080 1 ,228 1 ,404 1 ,615 1 ,865 2 ,163\n34\n35 Current liabilities 80 9 6 1 15 1 38 1 66 1 99\n36 Debt 400 4 00 4 00 4 00 4 00 4 00\n37 Stock 450 4 50 4 50 4 50 4 50 4 50\n38 Accumulated retained earnings 150 2 82 4 39 6 26 8 49 1 ,114\n39 Total liabilities and equity 1,080 1 ,228 1 ,404 1 ,615 1 ,865 2 ,163\nGiven these changes the cash and marketable securities account (row 27 in\nthe above example) turns negative by year 2, a result which is obviously illogi-\ncal. However, the economic meaning of these negative numbers is clear: Given\nthe increased sales growth, increased current asset and fi xed asset require-\nments, and increased dividend payouts, the fi rm needs more fi nancing.7\nWhat we want is a model which recognizes that:\n\u2022 Cash cannot be less than zero.\n\u2022 When the fi rm needs additional fi nancing, it b orrows money.\n7. If you examine the model as it now stands you will see that it implicitly assumes that this extra\nfi nancing comes at the cost of the cash and marketable securities. If we consider this account a\nkind of checking account with interest, then the model implicitly assumes that the fi rm can fi nance\n147 Pro Forma Financial Statement Modeling\nHere is the model:\nA B C D E F G H\n1 NO NEGATIVE CASH BALANCES\n2 Sales growth 20%<-- Increased from 10%\n3 Current assets/Sales 20%<-- Increased from 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 80%<-- Increased from 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 50%<-- Increased from 40%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1 ,200 1 ,440 1 ,728 2 ,074 2 ,488\n16 Costs of goods sold (500) (600) (720) (864) (1,037) (1,244)\n17 Interest payments on debt (40) (40) (42) (47) (56) (67)\n18 Interest earned on cash and marketable securities 6 4 1 - - -\n19 Depreciation (100) (124) (156) (194) (242) (299)\n20 Profit before tax 366 4 40 5 24 6 22 7 39 8 78\n21 Taxes (147) (176) (209) (249) (296) (351)\n22 Profit after tax 220 2 64 3 14 3 73 4 43 5 27\n23 Dividends (110) (132) (157) (187) (222) (263)\n24 Retained earnings 110 1 32 1 57 1 87 2 22 2 63\n25\n26 Balance sheet\n27 Cash and marketable securities 80 2 8 0 0 0 0 <-- =G39-G28-G32\n28 Current assets 200 2 40 2 88 3 46 4 15 4 98\n29 Fixed assets\n30 At cost 1,100 1 ,384 1 ,732 2 ,157 2 ,675 3 ,306\n31 Depreciation (300) (424) (580) (774) (1,016) (1,315)\n32 Net fixed assets 800 9 60 1 ,152 1 ,382 1 ,659 1 ,991\n33 Total assets 1,080 1 ,228 1 ,440 1 ,728 2 ,074 2 ,488\n34\n35 Current liabilities 80 9 6 1 15 1 38 1 66 1 99\n36 Debt 400 4 00 4 36 5 14 6 10 7 28 <-- =MAX(G28+G32-G35-G37-G38,F36)\n37 Stock 450 4 50 4 50 4 50 4 50 4 50\n38 Accumulated retained earnings 150 2 82 4 39 6 26 8 47 1 ,111\n39 Total liabilities and equity 1,080 1 ,228 1 ,440 1 ,728 2 ,074 2 ,488\nThe equations for cash (row 27) and debt (row 36) are indicated for the\nyear-5 entries. What they do, in accounting terms, is the following:\n\u2022 Cash and marketable securities remains the plug in the model.\n\u2022 The debt on the balance sheet conforms to the following test:\n(cid:4284) Current assets + Net fi xed assets > Current liabilities + Last year\u2019 s debt +\nStock + Accumulated retained earnings?\nI n this case even if cash and marketable securities = 0, we need to increase\ndebt balances in order to fi nance the fi rm \u2019 s productive activities.\n(cid:4284) Current assets + Net fi xed assets < Current liabilities + Last year\u2019 s debt +\n148 Chapter 5\nI f this relation holds, then there is no need to increase debt and, in fact, the\nfi rm has to have positive cash and marketable securities as a balancing item,\nand the fact that we have made cash the plug will take care of this.\n(cid:4284) I n Excel programming terms, this formula becomes (for the year 5, but\neach previous year has the same type of equation): Max(G28 + G32-G35\n-G37-G38,F36).\nAs shown in the Exercises for this chapter, the model can easily accom-\nmodate a situation in which there are minimum cash balances."
        ],
        "5.9": [
            "What is the meaning of target debt/equity ratio in a pro forma financial statement modeling?\nHow can we incorporate a target debt/equity ratio into a pro forma?\nWhat is the significance of the plug in a financial model?\nWhat changes can be made in a financial model with respect to the plug?\nWhat does a target ratio of debt to equity signify in a business firm?\nHow can the target debt/equity ratio affect the balance sheet?\nWhat does it mean for a firm to have a target ratio of debt to equity by end of certain years?\nWhat is the effect of sales growth, cost of goods sold and dividend payout ratio on the debt/equity ratio?\nHow does interest rate on debt and interest paid on marketable securities affect the financial model?\nWhat are the impacts of depreciation rate and tax rate on the target debt/equity ratio?\nWhat is the concept of retained earnings in the context of pro forma?\nHow can issuing of new debt and equity affect the financial statements?\nHow is the debt and stock calculated in the financial model mentioned?\nWhat does it mean for a firm to lower its current debt/equity ratio over the course of years?\nIn the context of financial modeling, what does the term 'accumulated retained earnings' refer to?",
            "5.9 Incorporating a Target Debt/Equity Ratio into a Pro Forma\n\nAnother change we might want to make in our model relates to the plug.\nSuppose that the fi rm has a target ratio of debt to equity: In each of the years\n1\u20135 it wants the ratio of debt/equity on the balance sheet to conform to a\n149 Pro Forma Financial Statement Modeling\nA B C D E F G H\nTARGET DEBT/EQUITY RATIO\n1 Cash is fixed, ratio of debt/equity changes in each year\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash & marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 60%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1,100 1,210 1,331 1,464 1,611\n16 Costs of goods sold (500) (550) (605) (666) (732) (805)\n17 Interest payments on debt (32) (30) (29) (28) (29) (32)\n18 Interest earned on cash & marketable securities 6 6 6 6 6 6\n19 Depreciation (100) (117) (137) (161) (189) (220)\n20 Profit before tax 374 409 445 483 521 560\n21 Taxes (150) (164) (178) (193) (208) (224)\n22 Profit after tax 225 246 267 290 313 336\n23 Dividends (135) (147) (160) (174) (188) (202)\n24 Retained earnings 90 98 107 116 125 134\n25\n26 Balance sheet\n27 Cash and marketable securities 80 80 80 80 80 80\n28 Current assets 150 165 182 200 220 242\n29 Fixed assets\n30 At cost 1,070 1,264 1,486 1,740 2,031 2,364\n31 Depreciation (300) (417) (554) (715) (904) (1,124)\n32 Net fixed assets 770 847 932 1,025 1,127 1,240\n33 Total assets 1,000 1,092 1,193 1,305 1,427 1,562\n34\n35 Current liabilities 80 88 97 106 117 129\n36 Debt 320 287 284 276 302 331 <-- =G41*(G37+G38)\n37 Stock Initial (year 0) 450 469 457 451 412 372 <-- =G33-G35-G36-G38\n38 Accumulated retained earnings debt/equity ratio: 150 248 355 471 596 730\n39 Total liabilities and equity =B36/(B37+B38) 1,000 1,092 1,193 1,305 1,427 1,562\n40\n41 Target debt/equity ratio 0.53 0.40 0.35 0.30 0.30 0.30\nRow 41 of the spreadsheet shows the target debt/equity ratio in each of years\n1\u20135. The fi rm wants to lower its current debt/equity ratio of 53% to 30% over\nthe next 2 years. The relevant changes to the equations of our initial model\nare the following:\n\u2022 Debt = Target debt/Equity ratio * (Stock + Retained earnings)\n\u2022 Stock = Total assets \u2013 Current liabilities \u2013 Debt \u2013 Accumulated retained\nearnings\nN ote that the fi rm will issue new debt years 4 and 5; in year 1 the stock\naccount grows (indicating that new equity is issued), whereas in subsequent\n150 Chapter 5"
        ],
        "5.10": [
            "What is pro forma financial statement modeling?\nWhat is project finance in the context of financial modeling?\nWhat are common stipulations attached to a firm's borrowing for project finance?\nWhat is a firm generally not allowed to do until the debt is paid off in project finance?\nWhat are the typical financing components for a new firm or project?\nHow is debt typically repaid in project finance?\nWhat happens to extra cash earned by the firm before the debt is paid off?\nWhat factor determines the changes to fixed assets at cost every year in project finance?\nHow does a firm ensure that net fixed assets stay constant over the life of the project in project finance?\nWhat does the depreciation of fixed assets mean in terms of capital maintenance?\nHow is the debt repayment terms incorporated into the model?\nWhat are the implications of a firm assuming to issue no new equity?\nWhat role does the cash and marketable securities account play in project finance modeling?\nWhat could indicate a potential problem in a firm's capacity to make its debt principal repayments?\nHow can the firm's ability to meet its payments be analyzed?\nWhat is the implication when the balance of cash and marketable securities is negative in the pro forma? \nWhat would happen to a firm's capacity to make repayments if the ratio of COGS/sales is increased?\nWhat happens to the firm's debt repayments when there are negative balances of cash and marketable securities? \nHow does the change in the parameters of the financial model affect the firm's ability to fulfill its debt obligations?\nWhat happens to the firm's ability to pay off its debt when costs of goods sold increase in proportion to sales?",
            "5.10 Project Finance: Debt Repayment Schedules\n\nHere is another use for pro forma modeling: In a typical case of so-called\n\u201cproject fi nance,\u201d the fi rm borrows money in order to fi nance a project. The\nborrowing often comes with strings attached:\n\u2022 The fi rm is not allowed to pay any dividends until the debt is paid off.\n\u2022 The fi rm is not allowed to issue any new equity.\n\u2022 The fi rm must pay back the debt over a specifi ed period.\nThe following simplifi ed example uses a variation of the version of our basic\nmodel with cash balances. A new fi rm or project is set up; in year 0:\n\u2022 The fi rm has assets of 2,200, which are fi nanced with 200 of current liabili-\nties, 1,100 of equity, and 1,000 of debt.\n\u2022 T he debt must be paid off in equal installments of principal over the next\n5 years. Until the debt is paid off, the fi rm is not allowed to pay dividends\n(if there is extra cash, this will go into a cash and marketable securities\n151 Pro Forma Financial Statement Modeling\nA B C D E F G H\nPROJECT FINANCE\nNo dividends, debt repayment schedule fixed, net fixed assets constant\n1\n2 Sales growth 15%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Costs of goods sold/Sales 45%\n6 Depreciation rate 10%\n7 Interest rate on debt 10.00%\n8 Interest paid on cash and marketable securities 8.00%\n9 Tax rate 40%\n10 Dividend payout ratio 0%<-- No dividends until all the debt is paid off\n11\n12 Year 0 1 2 3 4 5\n13 Income statement\n14 Sales 1,150 1,323 1,521 1,749 2,011\n15 Costs of goods sold (518) (595) (684) (787) (905)\n16 Interest payments on debt (90) (70) (50) (30) (10)\n17 Interest earned on cash and marketable securities 1 3 9 21 40\n18 Depreciation (211) (233) (257) (284) (314)\n19 Profit before tax 333 428 539 669 822\n20 Taxes (133) (171) (216) (268) (329)\n21 Profit after tax 200 257 323 401 493\n22 Dividends 0 0 0 0 0\n23 Retained earnings 200 257 323 401 493\n24\n25 Balance sheet\n26 Cash and marketable securities 0 19 64 173 359 633 <-- =G38-G27-G31\n27 Current assets 200 173 198 228 262 302\n28 Fixed assets\n29 At cost 2,000 2,211 2,443 2,700 2,985 3,299\n30 Depreciation 0 (211) (443) (700) (985) (1,299)<-- =F30-$B$6*(G29+F29)/2\n31 Net fixed assets 2,000 2,000 2,000 2,000 2,000 2,000 <-- NFA don't change\n32 Total assets 2,200 2,192 2,262 2,401 2,621 2,935\n33\n34 Current liabilities 100 92 106 122 140 161\n35 Debt 1,000 800 600 400 200 0 <-- =F35-$B$35/5\n36 Stock 1,100 1,100 1,100 1,100 1,100 1,100\n37 Accumulated retained earnings 0 200 456 780 1,181 1,674\n38 Total liabilities and equity 2,200 2,192 2,262 2,401 2,621 2,935\nThe debt repayment terms are incorporated into the model by simply speci-\nfying the debt balances at the end of each year. Since the fi rm is assumed to\nissue no new equity (in accordance with the covenants on the lending), it\nfollows that the model \u2019 s plug cannot be on the liabilities side of the balance\nsheet. In our model the plug is the cash and marketable securities account.\nT he model incorporates one other assumption often made about fi xed assets:\nIt assumes that the n et fi xed assets stay constant over the life of the project.\nEssentially this means that the depreciation accurately refl ects the capital\nmaintenance of the fi xed assets. As you can see from looking at rows 29\u201331\nabove, this means that the fi xed assets at cost grow each year by the increase\nin asset depreciation. It also means that there is no net cash fl ow from\n152 Chapter 5\nA B C D E F G H\n41 FREE CASH FLOW CALCULATION\n42 Year 0 1 2 3 4 5\n43 Profit after tax 200 257 323 401 493\n44 Add back depreciation 211 233 257 284 314\nCash flow generated\n45 Subtract increase in current assets 28 (26) (30) (34) (39)\nby depreciation\n46 Add back increase in current liabilities (8) 14 16 18 21\nequals capital\n47 Subtract increase in fixed assets at cost (211) (233) (257) (284) (314)\nexpenditures.\n48 Add back after-tax interest on debt 54 42 30 18 6\n49 Subtract after-tax interest on cash and mkt. securities (0) (2) (6) (13) (24)\n50 Free cash flow 273 285 334 391 457\nIn this example, the fi rm has no problem in making its debt principal repay-\nments. As credit analysts, we might be interested in how the fi rm \u2019 s ability to\nmeet its payments is affected by the various parameter values. In the following\nexample we have increased the ratio of COGS/sales. With the new parameter\nvalues, the fi rm can no longer meet its debt repayments in years 1\u20133. This fact\ncan be seen in the pro forma: In years 1\u20134 the balances of cash and marketable\nsecurities are negative, indicating that\u2014in order to make the repayment of the\nloan principal\u2014the fi rm had to borrow money.8\n8. From the point of view of corporate fi nance, positive balances of cash are like n egative bal-\n153 Pro Forma Financial Statement Modeling\nA B C D E F G H\nPROJECT FINANCE\nWith these parameters the project cannot pay off its debt\n1\n2 Sales growth 15%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Costs of goods sold/Sales 55%\n6 Depreciation rate 10%\n7 Interest rate on debt 10.00%\n8 Interest paid on cash and marketable securities 8.00%\n9 Tax rate 40%\n10 Dividend payout ratio 0%<-- No dividends until all the debt is paid off\n11\n12 Year 0 1 2 3 4 5\n13 Income statement\n14 Sales 1,150 1,323 1,521 1,749 2,011\n15 Costs of goods sold (633) (727) (836) (962) (1,106)\n16 Interest payments on debt (90) (70) (50) (30) (10)\n17 Interest earned on cash and marketable securities (2) (6) (7) (4) 4\n18 Depreciation (211) (233) (257) (284) (314)\n19 Profit before tax 215 287 370 469 585\n20 Taxes (86) (115) (148) (187) (234)\n21 Profit after tax 129 172 222 281 351\n22 Dividends 0 0 0 0 0\n23 Retained earnings 129 172 222 281 351\n24\n25 Balance sheet\n26 Cash and marketable securities 0 (52) (92) (83) (18) 114 <-- =G38-G27-G31, the plug\n27 Current assets 200 173 198 228 262 302\n28 Fixed assets\n29 At cost 2,000 2,211 2,443 2,700 2,985 3,299\n30 Depreciation 0 (211) (443) (700) (985) (1,299)\n31 Net fixed assets 2,000 2,000 2,000 2,000 2,000 2,000 <-- NFA don't change\n32 Total assets 2,200 2,121 2,107 2,145 2,244 2,416\n33\n34 Current liabilities 100 92 106 122 140 161\n35 Debt 1,000 800 600 400 200 0\n36 Stock 1,100 1,100 1,100 1,100 1,100 1,100\n37 Accumulated retained earnings 0 129 301 523 804 1,155\n38 Total liabilities and equity 2,200 2,121 2,107 2,145 2,244 2,416"
        ],
        "5.11": [
            "What does calculating the return on equity involve in pro forma financial statement modeling?\nCan you explain how to use pro forma models to compute the anticipated return on equity?\nWhat does the book value of the assets reflect in the context of financial modeling?\nWhat does the equity return depend upon in a financial model?\nWhat happens to equity return as the equity investment decreases?\nCan you explain the relationship between initial equity investment and equity return?\nWhat does the firm initially borrowing and the equity owners investing indicate in this context?\nWhat does the term 'ROE as a Function of Initial Equity Investment' mean?\nWhy does the equity return increase as the equity investment decreases?\nIn financial modeling, how is the return on equity in the first financial model computed?\nWhat is meant by mid-year discounting in financial modeling?\nHow to compute the return on equity of an investor who purchases the firm at date 0, gets 5 years of dividends, and sells it for the imputed terminal value of the equity?\nWhat is imputed equity valuation?\nHow is the asset value calculated in year 0?\nWhat is the significance of projected dividends in computing the return on equity? \nCan you explain the role of anticipated equity value in equity cash flow?\nWhat is the relationship between leverage and risk for equity investors in financial modeling?\nHow is the enterprise value calculated using the NPV method?\nWhy should the increased return compensate equity holders for extra risk in financial modeling?",
            "5.11 Calculating the Return on Equity\n\nW e can use the pro forma models illustrated in this chapter to compute the\nanticipated return on equity. Look at the previous example: Equity owners in\nthe project have to pay 1,100 in year 0. During years 1\u20134 they get no payoffs,\nbut in year 5 they own the company. Suppose that the book value of the assets\naccurately refl ects the market value. Then at the end of year 5 the equity in\nthe fi rm is worth stock + accumulated retained earnings = 2,255. The return\non the equity investment (ROE) is calculated as follows:\nA B C D E F G H\n56 RETURN ON EQUITY (ROE)\n57 Year 0 1 2 3 4 5\n58 Equity cash flow -1,100 - - - - 2 ,255 <-- =G22+G36+G37\n154 Chapter 5\nN ote that this equity return increases as the equity investment decreases. 9\nConsider the case where the fi rm initially borrows 1,500 and the equity owners\ninvest 600:\nA B C D E F G H\n56 RETURN ON EQUITY (ROE)\n57 Year 0 1 2 3 4 5\n58 Equity cash flow -600 - - - - 1 ,602 <-- =G22+G36+G37\n59 RETURN ON EQUITY (ROE) 21.70%<-- =IRR(B58:G58)\nAs the following data table and graph show, the less the initial equity invest-\nment, the greater the equity return:\nA B C D E F G H I J\n61\n62 Data table: ROE as a function of initial 21.70%<-- =B59 , data table header\n63 equity investment 2,000 10.80%\n64 1,800 11.43% ROE as a Function of Initial Equity Investment\n65 1,600 12.19%\n66 1,400 13.14% 45%\n67 1,200 14.36% 40%\n68 1,000 15.98% 33 05 %%\n69 800 18.26% 25%\n70 600 21.70% 20%\n71 400 27.61% 11 05 %%\n72 200 40.76% 5%\n73 0%\n74 2,000 1,750 1,500 1,250 1,000 750 500 250 0\n75 Equity investment\n76\n77\nEOR\nThe ROE in Our First Full Model\nThe model in sections 5.3\u20135.5 has annual dividends. If we use the mid-year\ndiscounting explained in section 5.5 to value the fi rm, we can compute the\nreturn on equity (ROE) of an investor who purchases the fi rm at date 0 at its\nimputed equity valuation, gets 5 years of dividends, and sells it for the imputed\nterminal value of the equity:\n9 . I nteresting but not surprising: As the equity investment goes down, the project becomes more\nleveraged and hence more risky for the equity investors. The increased return should compensate\nthe equity holders for this extra risk. The really interesting question (not answered here) is whether\n155 Pro Forma Financial Statement Modeling\nA B C D E F G H\n1 COMPUTING THE ROE IN THE FIRST FINANCIAL MODEL\n2 Sales growth 10%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 77%\n6 Costs of goods sold/Sales 50%\n7 Depreciation rate 10%\n8 Interest rate on debt 10.00%\n9 Interest paid on cash and marketable securities 8.00%\n10 Tax rate 40%\n11 Dividend payout ratio 40%\n12\n13 Year 0 1 2 3 4 5\n14 Income statement\n15 Sales 1,000 1 ,100 1 ,210 1 ,331 1 ,464 1,611\n51\n52\n53 Valuing the firm (mid-year discounting)\n54 Weighted average cost of capital 20%\n55 Long-term free cash flow growth rate 5%\n56\n57 Year 0 1 2 3 4 5\n58 FCF 176 188 201 214 228\n59 Terminal value 1,598<-- =G58*(1+B55)/(B54-B55)\n60 Total 176 188 201 214 1,826\n61\n62 Enterprise value, NPV of row 60 1,348 <-- =NPV(B54,C60:G60)*(1+B54)^0.5\n63 Add in initial (year 0) cash and mkt. securities 80 <-- =B27\n64 Asset value, year 0 1,428 <-- =B63+B62\n65 Subtract out value of firm's debt today (320)<-- =-B36\n66 Equity value 1,108 <-- =B64+B65\n67\n68\n69 RETURN ON EQUITY (ROE)\n70 Year 0 1 2 3 4 5\n71 Projected dividends (1,108) 9 8 1 08 1 18 1 29 141\n72 Anticipated equity value, year 5 1,737<-- Terminal value + year 5 cash - year 5 debt\n73 Equity cash flow (1,108) 98 108 118 129 1,878 <-- =SUM(G71:G72)\n74 RETURN ON EQUITY (ROE) 18.29%<-- =IRR(B73:G73)"
        ],
        "5.12": [
            "What is a tax loss carryforward in financial modeling?\nHow can firms apply accumulated losses to reduce their current tax liabilities?\nWhat changes do we need to make in a basic pro forma model to include tax loss carryforwards?\nWhat are the assumptions to be made about fixed costs and accumulated tax losses in the first year of operation in such models?\nHow is the accumulated tax loss modeled?\nHow does the accumulated tax loss change if the previous year exhibits a gain or a loss?\nWhat happens to the accumulated tax loss carryforward when a company starts making profits?\nWhen is the accumulated tax loss carryforward considered used up?\nHow are taxable profits calculated in these models?\nHow does the effective tax rate play a role in the tax loss carryforward model?\nHow is the effective tax rate used in computing the free cash flows?\nWhat is the role of depreciation, increase in current assets and liabilities, increase in fixed assets, and interest on cash and debt in the calculation of free cash flow?",
            "5.12 Tax Loss Carryforwards\n\nFirms can apply accumulated losses to reduce their current tax liabilities. In\nthis section we show how to model such tax loss carryforwards in our pro\nforma model. We make a number of changes in our basic model, highlighted\nbelow:\n\u2022 W e assume that in addition to costs of goods sold that are a proportion of\nsales, the fi rm also has an annual fi xed cost component of sales (in the Excel\nclip below, this number is 440 in cell B6).\n\u2022 We assume that in year 0 the fi rm has an initial accumulated tax loss of 100\n156 Chapter 5\nA B C D E F G H\n1 MODELING TAX LOSS CARRYFORWARDS\n2 Sales growth 11%\n3 Current assets/Sales 15%\n4 Current liabilities/Sales 8%\n5 Net fixed assets/Sales 45%\n6 Fixed costs 440\n7 Costs of goods sold/Sales 55%\n8 Depreciation rate 10%\n9 Interest rate on debt 10.00%\n10 Interest paid on cash and marketable securities 8.00%\n11 Initial tax-loss carryforward -100\n12 Tax rate 40%\n13 Dividend payout ratio 40%\n14\n15 Year 0 1 2 3 4 5\n16 Income statement\n17 Sales 1,000 1,110 1,232 1,368 1,518 1,685\n18 Fixed costs (440) (440) (440) (440) (440) <-- =-$B$6\n19 Costs of goods sold (611) (678) (752) (835) (927)\n20 Interest payments on debt 3 9 15 21 27\n21 Interest earned on cash and marketable securities 1 (8) (14) (16) (17) <-- =$B$10*AVERAGE(F34:G34)\n22 Depreciation (82) (96) (112) (130) (152)\n23 Profit before tax (18) 20 65 118 177\n24 Taxes - - - (34) (71) <-- =-MAX($B$12*G30,0)\n25 Profit after tax (18) 20 65 84 106\n26 Dividends - 8 26 34 42 <-- =IF(G25<0,0,$B$13*G25)\n27 Retained earnings (18) 27 91 118 149\n28\n29 Tax loss carryforward from previous years (100) (118) (99) (34) - <-- =MIN(F29+F23,0)\n30 Taxable profit 0 0 0 0 84 177 <-- =MAX(G23+G29,0)\n31 Effective tax rate 0% 0% 0% 29% 40% <-- =-G24/G23\nI n each year we model the accumulated tax loss (row 29). If the previous\nyear exhibited a loss (for example, year 1, with a loss of 18), then the accu-\nmulated loss increased by that amount (cell D29). If the previous year exhibits\na gain (year 2), then the accumulated tax loss carryforward gets closer to zero\n(cell D30). At some point (year 5 in our example), tax losses may be com-\npletely used up.\nIn any year, the taxable profi ts are given in row 30. If the accumulated tax\nloss carryforward is greater than that year \u2019 s profi t, then there is no tax. Oth-\nerwise only the difference in income is taxed (consider year 4, for example).\nThese differences are refl ected in the effective tax rate in row 31.\nT he effective tax rate is used in computing the free cash fl ows, as shown\nbelow:\nA B C D E F G H\n48 Year 0 1 2 3 4 5\n49 Free cash flow calculation\n50 Profit after tax (18) 20 65 84 106\n51 Add back depreciation 82 96 112 130 152\n52 Subtract increase in current assets (17) (18) (20) (23) (25)\n53 Add back increase in current liabilities 9 10 11 12 13\n54 Subtract increase in fixed assets at cost (131) (151) (173) (198) (227)\n55 Add back after-tax interest on debt (3) (9) (15) (21) (27)<-- =-(1-$C$31)*G20\n56 Subtract after-tax interest on cash and mkt. securities (1) 8 14 16 17 <-- =-(1-$C$31)*G21\n157 Pro Forma Financial Statement Modeling"
        ],
        "5.13": [
            "What is pro forma modeling? \nWhat are the basic skills of corporate financial analysis? \nWhat combination forms the basic skill of pro forma modeling?\nWhy should financial models match the situation at hand?\nWhy should financial models be simple enough for users to understand?\nCan you explain the potential outputs of a financial model?\nWhat implications might a financial model have on a firm or project several years down the line? \nWhat are some examples of situations where financial modelling is useful?\nWhat does it mean when a financial models is said to 'match the situation at hand'?\nIn what ways can a financial model illustrate credit-worthiness? \nIn what ways can a financial model illustrate common-sense predictions?\nWhat is the significance of spreadsheet skills in pro forma modeling? \nWhat are some of the complexities involved in implementing accounting rules in financial models? \nHow does pro forma modeling relate to valuations of financial assets or entities?",
            "5.13 Summary\n\nP ro forma modeling is one of the basic skills of corporate fi nancial analysis,\na devious combination of fi nance, the implementation of accounting rules, and\nspreadsheet skills. In order to be useful, fi nancial models must match the situ-\nation at hand, but they must also be simple enough so that the user can easily\nunderstand w hy the results happen (be they valuations, credit-worthiness, or\nsimply commonsense predictions of how a fi rm or project might look several\nyears down the road)."
        ]
    },
    "6": {
        "6.1": [
            "What is pro forma modeling in financial models?\nWho is Caterpillar, Inc.?\nWhat industry does Caterpillar, Inc. operate in?\nWhat is the purpose of analyzing financial statements of Caterpillar from 2007-2011?\nWhy is it essential to understand the business model of a company while creating its financial model?\nWhat skills are required for interpreting financial statements to fit them into a financial model?\nWhat does financial deviousness mean in the context of financial modelling?\nWhy can building pro forma financial models be considered irritating?\nWhat assumptions and analysis does a pro forma financial model require?\nWhy is it important to recall basic accounting concepts for financial modeling?\nHow are different elements related in a pro forma financial model?\nWhat is the significance of company valuation in the framework of its accounting and financial parameters?\nHow are company valuations critical to business plans, corporate financial planning models, and analyst valuations?",
            "6.1 Overview\n\nIn this chapter we implement the pro forma modeling techniques discussed in\nChapter 5 to build a fi nancial model for Caterpillar, Inc. Caterpillar, as most\nreaders of this book will surely know, is a world leader in the manufacture and\nsales of large-scale earth-moving equipment.\nOur energies in this chapter will be to understand Caterpillar \u2019 s fi nancial\nstatements for the years 2007\u20132011 in order to fi t them into the format illus-\ntrated in Chapter 5. This is not a trivial task, and it requires a combination of\nunderstanding of CAT \u2019 s business, modeling skills, and a small dose of fi nancial\ndeviousness (otherwise we would never get to the end of the exercise).\nWarning: This Chapter May Be Deleterious to Your Mental Health1\nThe material in this chapter is irritating and complicated but not diffi cult . Why\nirritating? Because pro forma fi nancial models require a lot of assumptions\nand analysis. Everything is related to almost everything else. And because they\nrequire you to recall some basic accounting concepts. This is all irritating!\nHowever, the case in this chapter illustrates one of the most important cor-\nporate fi nance applications: The valuation of a company in the framework of\nits accounting and fi nancial parameters. Such valuations are the core of most\nbusiness plans, corporate fi nancial planning models, and (intelligent) analyst\nvaluations.\n162 Chapter 6"
        ],
        "6.2": [
            "What are Caterpillar's financial statements from the years 2007\u20132011? \nWhat is the operating profit of Caterpillar for the year 2011? \nWhat are the total assets of Caterpillar in 2008?\nHow are the Caterpillar's balance sheets rewritten for better understanding? \nWhat is the concept of 'Operating Current Assets'? \nWhat are the components of 'Operating Current Liabilities'? \nWhat is the meaning of 'Financial Debt' in the context of a balance sheet? \nWhat is 'Stockholders' Equity' in the financial context?\nWhat is meant by 'Deferred income taxes'? \nWhat were the 'Sales of Machinery and Power Systems' for Caterpillar in 2009? \nWhat is the role of 'Accrued Expenses' in financial statements? \nCan you explain the term 'Intangible Assets' used in balance sheets?\nWhat is the purpose of 'Depreciation and Amortization' in cash flow statements?\nWhat falls under the 'Profit of Consolidated and Affiliated Companies'?\nExplain the item 'Cash and Short term Investments' in the balance sheet. \nWhat does 'Equity in profit (loss) of unconsolidated affiliated companies' mean?",
            "6.2 Caterpillar \u2019 s Financial Statements, 2007\u20132011\n\nCaterpillar \u2019 s fi nancial statements for the fi ve years 2007\u20132011 are given below:\nA B C D E F\n1 CATERPILLAR PROFIT AND LOSS, 2007-2011\n2 Sales and revenues 2007 2008 2009 2010 2011\n3 Sales of Machinery and Power Systems 41,962 48,044 29,540 39,867 57,392\n4 Revenues of Financial Products 2,996 3,280 2,856 2,721 2,746\n5 Total sales and revenues 44,958 51,324 32,396 42,588 60,138\n6\n7 Operating costs:\n8 Cost of goods sold 32,626 38,415 23,886 30,367 43,578\n9 Selling, general and administrative expenses 3,821 4,399 3,645 4,248 5,203\n10 Research and development expenses 1,404 1,728 1,421 1,905 2,297\n11 Interest expense of Financial Products 1,132 1,153 1,045 914 826\n12 Deferred income taxes 1,054 1,181 1,822 1,191 1,081\n13 Total operating costs 40,037 46,876 31,819 38,625 52,985\n14\n15 Operating profit 4,921 4,448 577 3,963 7,153\n16\n17 Interest expense excluding financial products 288 274 389 343 396\n18 Other income (expense) 357 327 381 130 -32\n19\n20 Consolidated profit before taxes 4,990 4,501 569 3,750 6,725\n21\n22 Provision (benefit) for income taxes 1,485 953 -270 968 1,720\n23 Profit of consolidated companies 3,505 3,548 839 2,782 5,005\n24\n25 Equity in profit (loss) of unconsolidated affiliated companies 73 37 -12 -24 -24\n26\n27 Profit of consolidated and affiliated companies 3,578 3,585 827 2,758 4,981\n28 Less: Profit (loss) attributable to noncontrolling interests 37 28 -68 58 53\n29\n163 Building a Pro Forma Model: The Case of Caterpillar\nA B C D E F\n1 CATERPILLAR BALANCE SHEETS, 2007-2011\n2 Assets 2007 2008 2009 2010 2011\n3 Current assets\n4 Cash and short-term investments 1,122 2,736 4,867 3,592 3,057\n5 Receivables--trade and other 8,249 9,397 5,611 8,494 10,285\n6 Receivables--finance 7,503 8,731 8,301 8,298 7,668\n7 Deferred and refundable income taxes 816 1,223 1,216 931 1,580\n8 Prepaid expenses and other current assets 583 765 862 908 994\n9 Inventories 7,204 8,781 6,360 9,587 14,544\n10 Total current assets 25,477 31,633 27,217 31,810 38,128\n11\n12 Property, plant and equipment--net 9,997 12,524 12,386 12,539 14,395\n13 Long-term receivables--trade and other 685 1,479 971 793 1,130\n14 Long-term receivables--finance 13,462 14,264 12,279 11,264 11,948\nInvestments in unconsolidated affiliated\n15 companies 598 94 105 164 133\nNoncurrent deferred and refundable income\n16 taxes 1,553 3,311 2,714 2,493 2,157\n17 Intangibleassets 475 511 465 805 4,368\n18 Goodwill 1,963 2,261 2,269 2,614 7,080\n19 Otherassets 1,922 1,705 1,632 1,538 2,107\n20 Total assets 56,132 67,782 60,038 64,020 81,446\n21\n22 Liabilities 2007 2008 2009 2010 2011\n23 Current liabilities\n24 Short-term borrowings\n25 Machineandpowersystems 187 1,632 433 204 93\n26 Financialproducts 5,281 5,577 3,650 3,852 3,895\n27 Accountspayable 4,723 4,827 2,993 5,856 8,161\n28 Accruedexpenses 3,178 4,121 2,641 2,880 3,386\nAccrued wages, salaries and employee\n29 benefits 1,126 1,242 797 1,670 2,410\n30 Customeradvances 1,442 1,898 1,217 1,831 2,691\n31 Dividendspayable 225 253 262 281 298\n32 Othercurrentliabilities 951 1,027 1,281 1,521 1,967\n33 Long-term debt due within one year\n34 Machinery and power systems 180 456 302 495 558\n35 Financialproducts 4,952 5,036 5,399 3,430 5,102\n36 Total current liabilities 22,245 26,069 18,975 22,020 28,561\n37\n38 Long-term debt due after one year\n39 Machinery and power systems 3,639 5,736 5,652 4,505 8,415\n40 Financialproducts 14,190 17,098 16,195 15,932 16,529\n41 Liability for postemployment benefits 5,059 9,975 7,420 7,584 10,956\n42 Otherliabilities 2,003 2,190 2,496 2,654 3,583\n43 Total liabilities 47,136 61,068 50,738 52,695 68,044\n44\n45 Redeemablenoncontrollinginterest 0 524 477 461 473\n46 Stockholders' equity\n47 Common stock of $1.00 par\n48 Common stock (814,894,624 shares) 2,744 3,057 3,439 3,888 4,273\n49 Treasurystockatcost -9,451 -11,217 -10,646 -10,397 -10,281\n50 Profit employed in the business 17,398 19,826 19,711 21,384 25,219\nAccumulated and other comprehensive\n51 income(loss) -1,808 -5,579 -3,764 -4,051 -6,328\n52 Noncontrollinginterests 113 103 83 40 46\n53 Total shareholders equity 8,996 6,190 8,823 10,864 12,929\n54 Total liabilities and equity 56,132 67,782 60,038 64,020 81,446\n55\n56\n57 Treasurystock,shares 190,908,490213,267,983190,171,905176,071,910167,361,280\n164 Chapter 6\nA B C D E F\nCATERPILLAR, CONSOLIDATED STATEMENT OF CASH FLOWS, 2007-2011\n1\n2 Cash flow from operating activities 2007 2008 2009 2010 2011\n3 Profit of consolidated and affiliated companies 3,578 3,585 827 2,758 4,981\n4 Adjustments for non-cash items:\n5 Depreciation and amortization 1,797 1,980 2,336 2,296 2,527\n6 Other 162 355 137 469 457\nChanges in assets and liabilities, net of acquisitions\n7 and divestitures:\n8 Receivables\u2014trade and other 899 -545 4,014 -2,320 -1,345\n9 Inventories -745 -833 2,501 -2,667 -2,927\n10 Accounts payable 387 -4 -2,034 2,570 1,555\n11 Accrued expenses 231 660 -505 117 308\n12 Accrued wages, salaries and employee benefits 576 286 -534 847 619\n13 Deferred income taxes 66 -470 -646 604 173\n14 Other assets, net 1,004 -217 235 358 -91\n15 Other liabilities, net 12 -23 753\n16 Net cash provided by(used for) operating activities 7,955 4,797 6,343 5,009 7,010\n17\n18 Cash flow from investing activities\nCapital expenditures\u2014excluding equipment leased to\n-1,700 -2,445 -1,348 -1,575 -2,515\n19 others\n20 Expenditures for equipment leased to others -1,340 -1,566 -968 -1,011 -1,409\nProceeds from disposals of leased assets and property,\n408 982 1,242 1,469 1,354\n21 plant and equipment\n22 Additions to finance receivables -13,946 -14,031 -7,107 -8,498 -10,001\n23 Collections of finance receivables 10,985 9,717 9,288 8,987 8,874\n24 Proceeds from sale of finance receivables 866 949 100 16 207\n25 Investments and acquisitions (net of cash acquired) -229 -117 -19 -1,126 -8,184\n26 Proceeds from sale of businesses and investments (net of c 290 0 0 0 376\n27 Proceeds from sale of available-for-sale securities 282 357 291 228 247\n28 Investments in available-for-sale securities -485 -339 -349 -217 -336\n29 Other, net 461 197 -128 132 -40\n30 Net cash provided by(used for) investing activities -4,408 -6,296 1,002 -1,595 -11,427\n31\n32 Cash flow from financing activities\n33 Dividends paid -845 -953 -1,029 -1,084 -1,159\n34 Distribution to noncontrolling interests -20 -10 -10 0 -3\nCommon stock issued, including treasury shares\n328 135 89 296 123\n35 reissued\n36 Payment for stock repurchase derivative contracts -56 -38\n37 Treasury shares purchased -2,405 -1,800\n38 Excess tax benefit from stock-based compensation 155 56 21 153 189\n39 Acquisitions of noncontrolling interests 0 0 -6 -132 -8\nProceeds from debt issued (original maturities greater\n40 than three months):\n41 - Machinery and Power Systems 224 1,673 458 216 4,587\n42 - Financial Products 10,815 16,257 11,833 8,108 10,873\nPayments on debt (original maturities greater than\n43 three months):\n44 - Machinery and Power Systems -598 -296 -918 -1,298 -2,269\n45 - Financial Products -10,290 -14,143 -11,769 -11,163 -8,324\nShort-term borrowings, net (original maturities three\n-297 2,074 -3,884 291 -43\n46 months or less)\n47 Net cash provided by(used for) financing activities -2,989 2,955 -5,215 -4,613 3,966\n48\n49 Interest expense excluding financial products 288 274 389 343 396\n165 Building a Pro Forma Model: The Case of Caterpillar\nRewriting the Balance Sheet\nTo more easily understand the balance sheet, we rewrite the balance sheets to\ncombine the short- and long-term fi nancial debt items. We also write all the\noperating (i.e., non-fi nancial) current assets and operating current liabilities as\none item.\nA B C D E F\nCATERPILLAR BALANCE SHEETS, 2007-2011\nRewritten: Operating Current Assets, Operating Current Liabilities, Financial Debts together\n1\n2 Assets 2007 2008 2009 2010 2011\n3 Current assets\n4 Cash and short-term investments 1,122 2,736 4,867 3,592 3,057\n5 Operating current assets 24,355 28,897 22,350 28,218 35,071\n6\n7 Property, plant and equipment--net 9,997 12,524 12,386 12,539 14,395\n8 Long-term receivables 14,147 15,743 13,250 12,057 13,078\nInvestments in unconsolidated affiliated\n9 companies 598 94 105 164 133\nNoncurrent deferred and refundable income\n10 taxes 1,553 3,311 2,714 2,493 2,157\n11 Intangible assets 475 511 465 805 4,368\n12 Goodwill 1,963 2,261 2,269 2,614 7,080\n13 Other assets 1,922 1,705 1,632 1,538 2,107\n14 Total assets 56,132 67,782 60,038 64,020 81,446\n15\n16 Liabilities 2007 2008 2009 2010 2011\n17 Operating current liabilities 11,645 13,368 9,191 14,039 18,913\n18\n19 Financial debt 28,429 35,535 31,631 28,418 34,592\n20\n21 Liability for postemployment benefits 5,059 9,975 7,420 7,584 10,956\n22 Other liabilities 2,003 2,190 2,496 2,654 3,583\n23 Total liabilities 47,136 61,068 50,738 52,695 68,044\n24\n25 Redeemable noncontrolling interest 0 524 477 461 473\n26 Stockholders' equity\n27 Common stock (814,894,624 shares) 2,744 3,057 3,439 3,888 4,273\n28 Treasury stock at cost -9,451 -11,217 -10,646 -10,397 -10,281\n29 Profit employed in the business 17,398 19,826 19,711 21,384 25,219\nAccumulated and other comprehensive\n30 income (loss) -1,808 -5,579 -3,764 -4,051 -6,328\n31 Noncontrolling interests 113 103 83 40 46\n32 Total shareholders equity 8,996 6,190 8,823 10,864 12,929\n166 Chapter 6"
        ],
        "6.3": [
            "What is a Pro Forma Model in the context of financial modelling?\nWhat are financial statements and what role do they play in financial modelling?\nWhat are the key elements in developing a forward-looking financial model?\nWhy are sales projections critical in a financial model?\nWhat factors can influence the choice of model parameters in a financial model?\nWhat is the importance of Year-on-year sales growth in a financial model?\nWhat is the Cumulative Average Growth Rate (CAGR) and how is it used in financial modelling?\nHow can historical analysis and expert opinions impact sales projections in a financial model?\nWhat are the limitations of solely relying on historical data for financial modelling?\nWhat is the role of Current Assets and Current Liabilities in financial statements?\nWhat are the implications of operating cost fluctuations on financial projections?\nWhat is the purpose of separating depreciation from other operating costs in a financial model?\nWhat are the decisions involved in determining a model for Caterpillar's fixed assets?\nHow are dividends factored into a Pro Forma Model?\nWhy is the tax rate considered in financial modelling?\nWhat is the role of long-term receivables in financial modelling?\nWhy would a company use long-term receivables as a marketing tool?\nWhat is the importance of the cost of debt in a financial model?\nHow is the interest earned on cash and short-term securities considered in financial modelling?\nCan you explain what a 'plug' is in financial modelling and why it's important?\nWhat factors influence the cash/sale and debt/assets ratios used in financial modelling?",
            "6.3 Analyzing the Financial Statements\n\nWe now build a set of fi nancial statements with the technology of Chapter 5\nbut in roughly the same format as Caterpillar \u2019 s historical statements. Our\nmodel is forward looking but based on CAT \u2019 s historical fi nancial statements.\nOur choices of model parameters is based on our analysis of the historicals\nand on a number of judgment calls.\nSales Projections\nT he sales projection is one of the most critical elements in our model. Should\nit be based on a historical analysis of Caterpillar sales? Or should it be based\non expert opinions about the potential growth of the heavy-equipment indus-\ntry? Should we differentiate between short-term (next 5 years) growth and\nlong-term growth?\nNone of these questions has a satisfactory answer. We illustrate several\nmethods and suggest that you use the pro forma model to experiment with the\nvarious answers to see whether they have a value impact. In the Excel below\nwe show:\n\u2022 Year-on-year sales growth\n\u2022 Cumulative average growth rates (CAGR)\n167 Building a Pro Forma Model: The Case of Caterpillar\nA B C D E F G H I J K L\n1 ANALYSIS OF CATERPILLAR SALES\nRevenues of Total sales Year-on- Caterpillar Sales Regressed on Year\nSales of\nYear financial and year 70,000\n2 machinery products revenues growth 60,000\n3 2000 18,913 1,262 20,175 y = 3168.7x -6E+06\n4 2001 19,027 1,423 20,450 1.36% 50,000 R\u00b2 = 0.7579\n5 2002 18,648 1,504 20,152 -1.46% 40,000\n6 2003 21,048 1,759 22,807 13.17%\n30,000\n7 2004 28,336 1,970 30,306 32.88%\n8 2005 34,006 2,333 36,339 19.91% 20,000\n9 2006 28,869 2,648 31,517 -13.27% 10,000\n10 2007 41,962 2,996 44,958 42.65%\n0\n11 2008 48,044 3,280 51,324 14.16% 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011\n12 2009 29,540 2,856 32,396 -36.88%\n13 2010 39,867 2,721 42,588 31.46% Total sales and revenues Linear (Total sales and revenues)\n14 2011 57,392 2,746 60,138 41.21%\n15\n16 Growth measures CATERPILLAR, YEAR-ON-YEAR\n17 CAGR 10.44%<-- =(D14/D3)^(1/11)-1 GROWTH\n18 Slope 3,169<-- =SLOPE(D3:D14,A3:A14)\nSlope/2011 50%\n5.27%<-- =B18/D14\n19 sales 40%\n20 30%\n21 Intercept -6,320,495<-- =INTERCEPT(D3:D14,A3:A14)\n20%\n22 R-squared 0.7579<-- =RSQ(D3:D14,A3:A14)\n10%\n23\n24 CAGR is very affected by end points! 0%\n25 2001-2011 11.39%<-- =(D14/D4)^(1/10)-1\n-10%2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012\n26 2002-2011 12.92%<-- =(D14/D5)^(1/9)-1 -20%\n27 2003-2011 12.88%<-- =(D14/D6)^(1/8)-1 -30%\n28 2006-2011 13.79%<-- =(D14/D9)^(1/5)-1 -40%\n29\n-50%\n30 2001-2010 8.49%<-- =(D13/D4)^(1/9)-1\n31 2002-2010 9.80%<-- =(D13/D5)^(1/8)-1\n32 2003-2010 9.33%<-- =(D13/D6)^(1/7)-1\n33 2005-2010 3.22%<-- =(D13/D8)^(1/5)-1\nWe focus on two numbers in the above Excel:\n\u2022 The compound annual growth rate (CAGR) in cell B17 is\n\u239b1\u239e\nC\nAGR=\u239b \u239cSales 2011\u239e \u239f\u239d\u239c 11\u23a0\u239f\n\u22121=10.44% . CAGR is often used but because of\n\u239d \u23a0\nSales\n2000\nits dependence on the endpoints, it is a problematic number. We fi nd it a\nsuspect measure of long-term growth, unless verifi ed by other time spans. As\nthe second chart above shows, the year-on-year growth of CAT exhibits a lot\nof variability. In the Excel above we have played with these end points, and\nfi nd that the CAGR can vary from 3.22% to 13.79%.\n\u2022 R egressing the annual sales on the year is not dependent solely on the start-\ning and ending sales, and thus often provides a better estimation of future sales\n168 Chapter 6\nSales =a+b\u2217Year\nt t\n=\u22126,320,495+3,169\u2217Year,R2 =75.79%\nThis regression line suggests that sales will grow at a rate of about 3,169\nannually. Impounding this estimate into the current sales (cell B14 above)\ngives an annual growth rate of about 5.27%. On the whole we fi nd this a more\nsatisfactory estimate of sales growth. 2\nCurrent Assets and Current Liabilities\nThe ratio of current assets to sales and current liabilities to sales shows a lot\nof stability over the 5 years. As model parameter values we have chosen the\naverage of the 5 years.\nA B C D E F\n1 CATERPILLAR ANALYSIS OF RATIOS\n2 2007 2008 2009 2010 2011\n3 CA/Sales 54.17% 56.30% 68.99% 66.26% 58.32%\n4 CL/Sales 25.90% 26.05% 28.37% 32.96% 31.45%\n5 Model values\n6 CA/Sales 58.32% <-- =F3\n7 CL/Sales 31.45% <-- =F4\n8\n9 NWC Analysis\n10\n80%\n11\n70%\n12\n60%\n13\n50%\n14\n40%\n15\n30%\n16\n17 20%\n18 10%\n19 0%\n20 2007 2008 2009 2010 2011\n21 CA/Sales CL/Sales\n22\n2. Our baseline prejudice is that for a company in an established, old-line business, growth rate\nshould be approximately the economy\u2019 s real growth rate plus the infl ation rate. The 5.27% number\n169 Building a Pro Forma Model: The Case of Caterpillar\nOperating Costs\nLike most industrial companies Caterpillar \u2019 s operating costs include deprecia-\ntion. Following the model in Chapter 5, we want to separate depreciation from\nother operating costs, so we refer to the consolidated statement of cash fl ows\nto compute the operating costs without depreciation. Operating costs have\nvaried considerably over the past 5 years:\nA B C D E F G\n1 CATERPILLAR OPERATING COSTS\n2 2007 2008 2009 2010 2011\n3 Operating costs from P&L 40,037 46,876 31,819 38,625 52,985<-- ='Caterpillar P&L'!F13\n4 Depreciation 1,797 1,980 2,336 2,296 2,527<-- ='Caterpillar CSCF'!F5\n5 Operating costs net of depreciation 38,240 44,896 29,483 36,329 50,458<-- =F3-F4\n6 Sales 44,958 51,324 32,396 42,588 60,138<-- ='Caterpillar P&L'!F5\n7 Net operating costs/Sales 85.1% 87.5% 91.0% 85.3% 83.9%<-- =F5/F6\n8\n9 Net opera(cid:2)ng costs/Sales\n10\n92%\n11\n12\n90%\n13\n14 88%\n15\n16 86%\n17\n18 84%\n19\n20 82%\n21\n22 80%\n23 2007 2008 2009 2010 2011\nW e note that the operating cost ratio is an increasing function of sales\n(shown below). This indicates a large fi xed cost component. Modeling this and\nrunning a regression, we chose to model the operating costs as a linear function\nof sales:\n170 Chapter 6\nA B C D E\n25 Regressing net operating costs on sales\n26 Intercept 3,833<-- =INTERCEPT(B5:F5,B6:F6)\n27 Slope 77.89%<-- =SLOPE(B5:F5,B6:F6)\n28 R-squared 99.14%<-- =RSQ(B5:F5,B6:F6)\n29\n30 Net Opera(cid:2)ng Costs vs Sales\n31\n60,000\n32\n33\n50,000\n34\n35 40,000\n36\n37 30,000\n38 y = 0.7789x + 3833.3\n39 20,000 R\u00b2 = 0.9914\n40\n41 10,000\n42\n43 0\n25,000 30,000 35,000 40,000 45,000 50,000 55,000 60,000 65,000\n44\nWe use this regression in our pro forma model for Caterpillar.\nFixed Assets and Sales\nWe need to determine a model for the fi xed assets of Caterpillar. This involves\ntwo decisions:\n\u2022 Are fi xed assets best modeled by assuming that the critical model ratio is\nNet FA/Sales or Gross FA/Sales? We have a slight predilection toward the\nformer, believing it to make more economic sense.3\n\u2022 What is the applicable average depreciation rate?\nI n this subsection we deal with the fi rst question. The depreciation rate is\ndiscussed in the next section.\n3 . I f depreciation has any economic meaning, then producing more sales should require more net\n171 Building a Pro Forma Model: The Case of Caterpillar\nA B C D E F\nCATERPILLAR\u2014ANALYSIS OF FIXED ASSETS\n1\n2 2007 2008 2009 2010 2011\n3 Land 189 575 639 682 753\n4 Buildings and land improvements 3,625 4,647 4,914 5,174 5,857\n5 Machinery, equipment and other 9,756 12,173 12,917 13,414 14,435\n6 Equipment leased to others 4,556 4,561 4,717 4,444 4,285\n7 Construction-in-process 1,082 1,531 1,034 1,192 1,996\n8\n9 Total property, plant and equipment, at cost 19,208 23,487 24,221 24,906 27,326\n10 Less: Accumulated depreciation -9,211 -10,963 -11,835 -12,367 -12,931\n11 Property, plant and equipment\u2014net 9,997 12,524 12,386 12,539 14,395\n12\n13 Sales 44,958 51,324 32,396 42,588 60,138\n14\n15 Net PPE/Sales 22.24% 24.40% 38.23% 29.44% 23.94%\n16 Gross PPE/Sales 42.72% 45.76% 74.77% 58.48% 45.44%\n17 Model value: Net PPE/Sales 25.00%<-- =AVERAGE(B15,C15,E15,F15)\nThere appears to be a slightly better connection between the Net PPE and\nSales than the Gross PPE, and this is accordingly the value we use in our\nmodel.\n80%\n70%\n60%\n50%\n40%\n30%\n20%\n10%\n0%\n2007 2008 2009 2010 2011\n172 Chapter 6\nGross and Net Fixed Assets vs Sales\n30,000\n25,000\n20,000 y = 0.102x + 19108\nR\u00b2 = 0.1265\n15,000\n10,000\ny = 0.0731x + 8983.3\n5,000 R\u00b2 = 0.2327\n0\n30,000 35,000 40,000 45,000 50,000 55,000 60,000 65,000\nGross FA Net FA\nDepreciation\nNote 8 of the Caterpillar 2011 annual report gives the approximate lives of\ndifferent fi xed asset classes:\nIn row 28 below we use SumProduct to compute the weighted average\ndepreciation rate for CAT. In B29 we average these numbers to compute the\n173 Building a Pro Forma Model: The Case of Caterpillar\nA B C D E F G\n19 Depreciation analysis\n20 %Buildings and land improvements 20.21% 21.73% 21.79% 22.46% 23.83%<-- =F4/SUM(F$4:F$6)\n21 %Machinery, equipment and other 54.39% 56.93% 57.29% 58.24% 58.73%<-- =F5/SUM(F$4:F$6)\n22 %Equipment leased to others 25.40% 21.33% 20.92% 19.29% 17.44%<-- =F6/SUM(F$4:F$6)\n23\n24 Depreciation rates\n25 Buildings and land improvements 3.1%<-- =1/32.5\n26 Machinery, equipment and other 15.4%<-- =1/6.5\n27 Equipment leased to others 18.2%<-- =1/5.5\n28 Average depreciation rate 13.61% 13.31% 13.29% 13.16% 12.94%<--\n29 Model depreciation rate 13.26%<-- =AVERAGE(B28:F28) =SUMPRODUCT($B$25:\n30 $B$27,F20:F22)\nDividends\nCaterpillar total dividends have grown at a compound growth rate of 8.22%\nper year. We use this number in our model. Our previous objection to CAGR\ndoesn\u2019 t hold here, since various starting and ending points yield pretty much\nthe same estimates. We prefer to use total dividends as opposed to dividends\nper share.\nA B C D E F\n1 CATERPILLAR DIVIDENDS\n2 Other liabilities 2007 2008 2009 2010 2011\n3 Dividends 845 953 1,029 1,084 1,159\n4 Year-on-year growth 12.78% 7.97% 5.34% 6.92%\n5 Dividend CAGR 8.22%<-- =(F3/B3)^(1/4)-1\n6\n7 Dividends per share 1.38 1.62 1.68 1.74 1.82\n8 Dividend CAGR 7.16%<-- =(F7/B7)^(1/4)-1\nOther Liabilities and Pensions\nW e are frankly confused by these two items. Why are other liabilities and\npension liabilities growing at a rate much faster than sales? We have no good\nanswer, and in our model assume that the growth of these important liabilities\n174 Chapter 6\nA B C D E F\n1 OTHER LIABILITIES AND PENSIONS\n2 2007 2008 2009 2010 2011\n3 Other liabilities 2,003 2,190 2,496 2,654 3,583\n4 Year-on-year growth 9.34% 13.97% 6.33% 35.00%\n5 Whole period 15.65%<-- =(F3/B3)^(1/4)-1\n6 Excluding 2011 9.83%<-- =(E3/B3)^(1/3)-1\n7\n8 Pension liabilities 5,059 9,975 7,420 7,584 10,956\n9 Year-on-year growth 97.17% -25.61% 2.21% 44.46%\n10 Whole period 21.31%<-- =(F8/B8)^(1/4)-1\n11 Excluding 2011 14.45%<-- =(E8/B8)^(1/3)-1\n12 Model value 17.88%<-- =AVERAGE(B10:B11)\nCaterpillar \u2019 s Tax Rate\nExcept for the problematic year 2009, CAT \u2019 s tax rate averages around 26%.\nThis is the value we use in our model:\nA B C D E F\n1 CATERPILLAR ANALYSIS OF TAX RATE\n2 2007 2008 2009 2010 2011\n3 Profits before taxes 4,990 4,501 569 3,750 6,725\n4 Taxes 1,485 953 -270 968 1,720\n5 Tax rate 29.76% 21.17% -47.45% 25.81% 25.58%\n6 Model value 25.58%<-- =AVERAGEIF(B5:F5,\">0\")\nLong-Term Receivables\nC AT uses long-term receivables as a marketing tool to provide fi nancing to\nthe purchases of its equipment, so that it makes sense that this item grows at\nthe same rate as sales.\nCost of Debt\nCaterpillar is a highly rated borrower in fi nancial markets. A chart from Morn-\ningstar (http://quicktake.morningstar.com/stocknet/bonds.aspx?symbol= cat)\nshows the term structure of CAT\u2019 s debt. We will assume that the company\u2019 s\n175 Building a Pro Forma Model: The Case of Caterpillar\nInterest Earned on Cash and Short-Term Securities\nA t the time this chapter is written, short-term interest rates are very low. We\nwill assume that CAT earns 1% on its short-term cash investments.\nWhat \u2019 s the Plug?\nThe plug should be one of the following fi nancial items: cash and marketable\nsecurities, debt, or treasury stock. After some analysis, we use the cash/sales\nand the debt/assets ratios below. This leaves treasury stock as the plug in our\nmodel.\nA B C D E F G\n1 CATERPILLAR: VARIOUS PLUGS vs SALES AND OTHER\n2 2007 2008 2009 2010 2011\n3 Sales 44,958 51,324 32,396 42,588 60,138<-- ='Page 162'!F5\n4\n5 Cash 1,122 2,736 4,867 3,592 3,057<-- ='Page 163'!F4\n6 Cash/Sales 2.50% 5.33% 15.02% 8.43% 5.08%<-- =F5/F3\n7 Debt 28,429 35,535 31,631 28,418 34,592<-- ='Page 165'!F19\n8 Debt/Sales 63.23% 69.24% 97.64% 66.73% 57.52%<-- =F7/F3\n9 Debt/Total assets 50.65% 52.43% 52.68% 44.39% 42.47%<-- =F7/'Page 163'!F20\n10\n11 Model values\n12 Cash/Sales 5.08%<-- =F6\n176 Chapter 6"
        ],
        "6.4": [
            "What is a pro forma model in financial modeling?\nWhat is the sales growth value computed for Caterpillar in the given pro forma model?\nHow are current assets and current liabilities of a company related to its sales according to Caterpillar's pro forma model?\nWhat are the methods to compute net fixed assets over sales in a financial model?\nCan you explain the concept of cost of goods sold over sales in context of financial modeling?\nWhat is the assumption about the growth of long-term receivables in Caterpillar's pro forma model and why?\nWhat does 'Depreciation Rate' imply in a company's financial model?\nWhy are pension liabilities significant in analyzing a company's financial model? \nWhat does the term 'Other liabilities, growth' mean in financial modeling? \nWhy is the debt to assets ratio an important consideration in a company's pro forma model?\nHow does the interest rate on debt play a crucial role in a financial model of a company?\nHow is the tax rate calculated and why is it significant in a company's financial model?\nWhat is 'Dividend Growth' in financial modeling and why is it important?\nIn a financial model, how does the income statement impact the sales and the costs of goods sold?\nWhy is 'Interest payments on debt' considered in a company's pro forma model?\nHow to calculate 'Interest earned on cash & marketable securities' in financial modeling?\nWhat does the phrase 'Profit before tax' imply in a pro forma model?\nWhat could be the consequence of ' Taxes ' on a company's profit after tax?\nWhy is tracking 'Dividends' and 'Retained earnings' crucial in a pro forma model?\nWhat role does a balance sheet play in depicting a company's financial stance in a pro forma model?\nHow does 'Cash and marketable securities' affect 'Current assets' and 'Fixed assets' in a financial model?\nCan you explain 'Pension Liabilities' and 'Other Liabilities' role in a company's financial model?\nWhat is the significance of 'Debt', 'Redeemable Noncontrolling Interest', and 'Stock' in a pro forma financial model?\nWhat is meant by 'Treasury Stock' in financial modeling?\nwhat is the meaning of 'Accumulated retained earnings' in a financial model?\nWhat is free cash flow projection in financial modeling?\nHow is 'PAT' determined in financial modeling?\nWhat is the relevance of depreciation in calculating 'Free Cash Flow'?\nWhat is the idea behind the calculation of 'Minus NWC' and 'Minus increase in CA' in a financial model?\nWhat is the significance of 'Add Back Increase in CL' and 'Subtract CAPEX' in free cash flow computations?\nWhat does 'Add back net Interest after taxes' mean and how it is utilized in the computation of 'Free Cash Flow'?",
            "6.4 A Model for Caterpillar\n\nUsing the values computed for Caterpillar, we arrive at the following pro forma\nmodel for the company:\nA B C D E F G H\n1 CATERPILLAR PRO FORMA MODEL\n2 Sales growth 5.27%<-- ='Page 167'!B19\n3 Current assets/Sales 58.32%<-- ='Page 168'!B6\n4 Current liabilities/Sales 31.45%<-- ='Page 168'!B7\n5 Net fixed assets/Sales 27.65%<-- =AVERAGE('Page 171-173'!B15:F15)\n6 Cost of goods sold/Sales 83.90%<-- ='Page 169-170'!F7\n7 Long-term receivables, growth 5.27%<-- Assume this grows at the same rate as sales\n8 Depreciation rate 13.26%<-- ='Page 171-173'!B29\n9 Pension liabilities, growth 17.88%<-- ='Page 174'!B12\n10 Other liabilities, growth 9.83%<-- ='Page 174'!B6\n11 Cash/Sales 5.08%<-- ='Page 175'!B12\n12 Debt/Assets 42.47%<-- ='Page 175'!B13\n13 Interest rate on debt 1.41%<-- ='Ratios (5)'!F18\n14 Interest paid on cash & mkt. sec. 0.00%<-- Author guesstimate\n15 Tax rate 25.58%<-- ='Page 174, middle'!B6\n16 Dividend growth 8.22%<-- ='Page 173'!B6\n17\n18 Year 2011 2012 2013 2014 2015 2016\n19 Income statement\n20 Sales 60,138 63,307 66,642 70,154 73,850 77,742<-- =F20*(1+$B$2)\n21 Costs of goods sold -50,458 -53,117 -55,915 -58,862 -61,963 -65,228<-- =-$B$6*G20\n22 Interest payments on debt -521 -543 -567 -592 -618<-- =-$B$13*G50\nInterest earned on cash &\n23 marketable securities 0 0 0 0 0<-- =$B$14*AVERAGE(F32:G32)\n24 Depreciation -2,527 -3,711 -4,524 -5,301 -6,196 -7,225<-- =G38-F38\n25 Profit before tax 7,153 5,958 5,659 5,424 5,100 4,671<-- =SUM(G20:G24)\n26 Taxes -1,720 -1,524 -1,448 -1,387 -1,305 -1,195<-- =-$B$15*G25\n27 Profit after tax 5,433 4,434 4,212 4,036 3,795 3,476<-- =G25+G26\n28 Dividends 1,159 1,254 1,357 1,469 1,590 1,720<-- =F28*(1+$B$16)\n29 Retained earnings 5,688 5,569 5,505 5,385 5,196<-- =G27+G28\n30\n31 Balance sheet 2011 2012 2013 2014 2015 2016 <-- 2016\n32 Cash and marketable securities 3,057 3,218 3,388 3,566 3,754 3,952<-- =$B$11*G20\n33 Current assets 35,071 36,919 38,864 40,912 43,068 45,337<-- =$B$3*G20\n34 Fixed assets <--\n35 Land 753 753 753 753 753 753<-- =F35\n36 Construction in progress 1,996 1,996 1,996 1,996 1,996 1,996<-- =F36\n37 Depreciable assets at cost 24,577 31,397 36,844 43,117 50,335 58,635<-- =G39-G38-G36-G35\n38 Accumulated depreciation -12,931 -16,642 -21,167 -26,468 -32,664 -39,889<-- =F38-$B$8*AVERAGE(F37:G37)\n39 Net PPE 14,395 17,504 18,427 19,398 20,420 21,496<-- =$B$5*G20\n40 <--\n41 Long-term receivables 13,078 13,767 14,493 15,256 16,060 16,906<-- =F41*(1+$B$7)\nInvestments in unconsolidated\n42 affiliated companies 133 133 133 133 133 133<-- =F42\nNoncurrent deferred and\n43 refundable income taxes 2,157 2,157 2,157 2,157 2,157 2,157<-- =F43\n44 Intangibles and other 13,555 13,555 13,555 13,555 13,555 13,555<-- =F44\n45 Total assets 81,446 87,253 91,016 94,977 99,147 103,536<-- =G32+G33+G39+SUM(G41:G44)\n46 <--\n47 Current liabilities 18,913 19,910 20,959 22,063 23,225 24,449<-- =$B$4*G20\n48 Pension liabilities 10,956 12,915 15,224 17,946 21,155 24,937<-- =F48*(1+$B$9)\n49 Other liabilities 3,583 3,935 4,322 4,748 5,214 5,727<-- =F49*(1+$B$10)\n50 Debt 34,592 37,059 38,657 40,339 42,110 43,974<-- =$B$12*G45\n51 Redeemable noncontrolling interest 473 473 473 473 473 473<-- =F51\n52 Stock 2,744 2,744 2,744 2,744 2,744 2,744<-- =F52\n53 Treasury stock -9,451 -12,868 -20,018 -27,496 -35,320 -43,511<-- =G45-SUM(G47:G52)-G54\n54 Accumulated retained earnings 17,398 23,086 28,655 34,161 39,545 44,742<-- =F54+G29\n177 Building a Pro Forma Model: The Case of Caterpillar\nThis model gives the following free cash fl ow projections:\nA B C D E F G H\n58 Year 2011 2012 2013 2014 2015 2016\n59 Free Cash Flow\n60 PAT 4,434 4,212 4,036 3,795 3,476<-- =G27\n61 Add back depreciation 3,711 4,524 5,301 6,196 7,225<-- =-G24\n62 Minus NWC\n63 Minus increase in CA -1,848 -1,945 -2,048 -2,156 -2,269<-- =F33-G33\n64 Add back increase in CL 997 1,049 1,104 1,163 1,224<-- =G47-F47\n65 Subtract CAPEX -6,820 -5,447 -6,272 -7,218 -8,301<-- =-(SUM(G35:G37)-SUM(F35:F37))\n66 Add back net interest after taxes 388 404 422 440 460<-- =-(1-$B$15)*(G22-G23)\n67 Free Cash Flow 861 2,797 2,544 2,220 1,814<-- =SUM(G60:G66)"
        ],
        "6.5": [
            "What does WACC stand for in the context of financial modeling?\nHow is the long-term FCF growth rate used in the valuation of a business?\nWhat is the significance of WACC value in the pro forma model for Caterpillar?\nWhat values are represented by the term 'terminal value' in the valuation model?\nWhat is the role of initial cash in computing the asset value in a valuation model?\nWhat do negative equity values represent in the valuation of a company like Caterpillar?\nWhat is the importance of the number of shares outstanding in calculating the share value?\nWhy is it important to account for year 0 debt in assessing the value of a firm's equity?\nHow is the current market value per share used to determine if a company is over or undervalued?\nCan you explain how the data table on the long-term growth rate and the weighted average cost of capital is used in valuation?\nWhat does it mean when WACC is less than long-term growth in valuation model?\nWhat is the significance of a valuation greater than the current market value in the valuation model results?",
            "6.5 Using the Model to Value Caterpillar\n\nIn Chapter 3 we discussed the cost of capital for Caterpillar, and came to the\nconclusion that WACC = 10.84%. Using this number in our model and assum-\ning that the long-term FCF growth is 9% produces the following FCF\nvaluation:\nA B C D E F G H\n70 WACC 10.84%\n71 Long-term FCF growth 9.00%\n72\n73 Year 2011 2012 2013 2014 2015 2016\n74 FCF 861 2,797 2,544 2,220 1,814<-- =G67\n75 Terminal value 107,487<-- =G74*(1+B71)/(B70-B71)\n76 Total 861 2,797 2,544 2,220 109,301<-- =G74+G75\n77\nEnterprise value:\n78 PV of FCFs and terminal value 75,515<-- =NPV(B70,C76:G76)*(1+B70)^0.5\n79 Add back initial cash 3,057<-- =B32\n80 Asset value 78,572<-- =B78+B79\n81 Subtract year 0 debt -49,604<-- =-SUM(B48:B51)\n82 Imputed equity value 28,968<-- =B80+B81\n83 Divide by # shares outstanding 647,533,344<-- ='Page 163'!F58\n84 Share value 44.74<-- =B82/B83*1000000\n85 Current market value per share 90.60\nAccording to these model values, Caterpillar is currently overvalued.\nA Data Table on the long-term growth rate and the weighted average cost\nof capital produces the following table. Cells with a valuation greater than the\ncurrent market value of 90.60 are highlighted, and where the WACC < long-\nterm growth, the cells have been blanked, since this does not accord with the\nvaluation model (see section 5.4). Note that for some combinations, the model\npredicts that the value of the equity is negative\u2014meaning that Caterpillar \u2019 s\n178 Chapter 6\nA B C D E F G\n87 LT growth rate \u2193\n88 44.74 6.0% 7.0% 8.0% 9.0% 10.0%\n89 WACC--> 6.0%\n90 6.5% 389.00\n91 7.0% 160.45\n92 7.5% 84.25 374.31\n93 =IF(B70>B71,B84,\"\") 8.0% 46.13 153.15\n94 8.5% 23.24 79.40 360.22\n95 9.0% 7.97 42.51 146.14\n96 9.5% -2.94 20.37 74.75 346.69\n97 10.0% -11.14 5.59 39.04 139.41\n98 10.5% -17.52 -4.97 17.61 70.29 333.71"
        ],
        "6.6": [
            "What is a pro forma financial model in context of valuation?\nWhat is meant by labor-intensive in the context of a pro forma financial model?\nWhat can be discovered through the pro forma financial model for a firm like Caterpillar?\nWhat aspect of a firm's operation can be understood by pro forma financial modelling?\nWhat limitations can be encountered while understanding a firm's financial statements through pro forma models?\nWhy is the pro forma modelling technique not to be undertaken lightly?\nWhen can undertaking the intensive investigation into the firm's workings be necessary?\nWhat could be the role of pro forma modelling technique in financial analysis of leasing?",
            "6.6 Summary\n\nOn one hand, the pro forma fi nancial model is an extraordinarily labor-\nintensive method of valuing the fi rm. On the other hand, in modeling Caterpil-\nlar, we have discovered much about the way the fi rm operates and about how\nmuch we understand (and don \u2019 t \u2026 ) about its fi nancial statements.\nT he pro forma modeling technique cannot be undertaken lightly, but if an\nintensive investigation into the fi rm\u2019 s workings is needed, this is the way\n7\nFinancial Analysis of Leasing"
        ]
    },
    "7": {
        "7.1": [
            "What is a lease in financial terms?\nWhat are the roles of the lessor and lessee in a lease?\nWhat is a long-term lease and how does it differ from short-term leasing?\nHow does financial theory regard such leases?\nWhat are some of the financial considerations that a company must weigh when deciding whether to lease or purchase an asset?\nHow are the operating inflows and outflows from the equipment affected by its ownership?\nWhat is the relevance of Statement 13 of the Financial Accounting Standards Board in the context of leases?\nWho bears the responsibility for maintaining the equipment in a lease arrangement?\nWhat does the financial analysis of a lease focus on?\nWhat are the tax implications for both the lessor and lessee in a lease?\nWhat benefits do lessors derive from tax shield on the depreciation of the asset?\nCan the lessee claim the rent as an expense in a lease arrangement?\nHow do tax authorities treat the lessor and the lessee in a lease contract?",
            "7.1 Overview\n\nA lease is a contractual arrangement by which the owner of an asset (the\nlessor ) rents the assets to a l essee . In this chapter we analyze long-term leases,\nin which the asset spends most of its useful life with the lessee. In economic\nterms, the leases we consider in this chapter are considered by the lessees as\nalternatives to purchasing an asset. The analysis of this chapter fi ts many long-\nterm equipment leases, but not short-term leasing (car rentals, for example).\nFinancial theory regards such leases as being essentially debt contracts: For\nthe lessee, the lease is an alternative to purchasing the asset with debt, and the\nlessor understands that it is essentially providing fi nancing for the lessee.\nI n the example that follows we consider a company that is faced with the\nchoice of either purchasing or leasing a piece of equipment. We assume that\nthe operating infl ows and outfl ows from the equipment are not affected by its\nownership\u2014irrespective of how the asset is held (whether owned or leased),\nthe owner/lessee will have the same sales and must bear the responsibility for\nmaintaining the equipment. In the words of Statement 13 of the Financial\nAccounting Standards Board (FASB 13), the lease we are considering is one\nthat \u201ctransfers substantially all of the benefi ts and risks incident to the owner-\nship of property\u201d to the lessee.\nT he analysis in this chapter concentrates exclusively on the cash fl ows from\nthe lease. It is assumed that the lessor pays taxes on the income from the lease\nrentals and gets a tax shield on the depreciation of the asset, and that the lessee\ncan claim the rent as an expense. The analysis assumes that the tax authorities\ntreat the lessor as the owner of the asset and the lessee as the user. 1"
        ],
        "7.2": [
            "What is the essence of financial analysis in the context of leasing?\nWhat factors should a company consider before deciding to lease or buy machinery?\nWhat does the term \"Straight-line depreciation\" mean in financial analysis?\nHow is taxation related to financial decisions about leasing or buying assets?\nWhat could be the financial significance of a company's tax rate while making leasing decisions?\nWhat does the term \"Economic Ownership\" mean in the context of leasing?\nWhy would a company consider leasing over buying an asset?\nWhat is the significance of present values of cash flows in decision making?\nHow is the risk-free rate used in financial modeling and analysis?\nWhat is the Net Present Value (NPV) in financial analysis and how is it used in decision making?\nHow does leasing compare to buying an asset with a loan in terms of financial risk?\nHow do financial risks differ when comparing leasing to a straightforward purchase?\nHow could borrowing money affect a company's decision to lease or buy an asset?\nWhat does the term \"cash-flow patterns\" refer to in financial analysis?\nHow might borrowing money to buy assets produce tax benefits?\nWhat is the equivalent-loan method in the analysis of leases and how is it utilized? \nWhy might an analysis that doesn't take loan potential into account be misleading?\nHow is the equivalent-loan method different from other methods of lease analysis?",
            "7.2 A Simple but Misleading Example\n\nThe essence of our analysis can be understood from the following simple\nexample: A company has decided to acquire the use of a machine costing\n$600,000. If purchased, the machine will be depreciated on a straight-line basis\nto a residual value of zero. The machine \u2019 s estimated life is 6 years, and the\ncompany \u2019 s tax rate T is 40%.\nC\n1. From an economic point of view this assumption is not innocuous: If the lessee has true eco-\nnomic ownership of the asset, why doesn \u2019 t it get to take the depreciation? But the facts are\n180 Chapter 7\nThe company \u2019 s alternative to purchasing the machine is to lease it for 6\nyears. A lessor has offered to lease the machine to the company for $140,000\nannually, with the fi rst payment to be made today and with fi ve additional\npayments to be made at the start of each of the next 5 years.\nO ne way of analyzing this problem (a misleading way, as it turns out) is to\ncompare the present values of the cash fl ows to the company of leasing and\nof buying the asset. The company feels that the lease payment and the tax\nshield from depreciation are riskless. Suppose, furthermore, that the risk-free\nrate is 12%. On the basis of the following calculation, the company should\nlease the asset. 2\nNPV(leasing)=\u22115 ( 1\u2212T c)\u2217Leaserental =\u22115 ( 1\u2212T c)\u2217140,0000\n=386,801\n( 1+12%)t ( 1+12%)t\nt=0 t=0\nNPV(buying)= Assetcost\u2212PV( taxshieldsonndepreciation)\n=600,000\u2212\u22116 0.40\u2217100,000\n=435,544\n( 1+12%)t\nt=1\nIn a spreadsheet:\nA B C\n1 HOW NOT TO ANALYZE A LEASE\n2 Asset cost 600,000\n3 Interest rate 12%\n4 Lease rental payment 140,000\n5 Annual depreciation 100,000\n6 Tax rate 40%\n7\n8 NPV (leasing) 386,801 <-- =-PV(B3,5,B4*(1-B6))+B4*(1-B6)\n9 NPV (buying) 435,544 <-- =B2+PV(B3,6,B6*B5)\nThis analysis suggests that leasing the asset is preferable to buying it.\nHowever, it is misleading because it ignores the fact that leasing is very much\nlike buying the asset with a loan. The fi nancial risks are thus different when\nwe compare a lease (implicitly a purchase with loan fi nancing) against a\nstraightforward purchase without loan fi nancing. If the company is willing to\nlease the asset, then perhaps it should also be willing to borrow money to buy\n2 . A t this point we assume that the residual value of the asset at the end of its life is zero. In\n181 Financial Analysis of Leasing\nthe assets. This borrowing will change the cash-fl ow patterns and could also\nproduce tax benefi ts. Hence, our decision about the leasing decision could\nchange if we were to take the loan potential into account.\nI n the following section we present a method of analyzing leases that deals\nwith this problem by imagining what kind of loan would produce cash fl ows\n(and hence fi nancial risks) equivalent to those produced by the lease. This\nmethod of lease analysis is called the equivalent-loan method."
        ],
        "7.3": [
            "What is the equivalent-loan method in financial analysis of leasing?\nCan you explain the lessee point of view in the equivalent-loan method with asset cost, interest rate, lease rental payment, annual depreciation, tax rate, and cash flows details?\nWhy is it easier to decide between the lease or the purchase of an asset with the equivalent-loan method?\nWhat does after-tax cash flow from leasing and buying the asset indicate in financial modeling?\nHow can the differential cash flow between the lease and the buy decision be calculated?\nWhat is the significance of tax shield in the context of leasing versus buying an asset?\nHow does a lease save a lessee cash in the initial period of asset utilization?\nWhat is the after-tax cost of a lease versus the buy over the years?\nHow can leasing an asset be equated to getting a loan in terms of financial modeling?\nHow is the cost of financing in a lease compared with the cost of alternative financing?\nHow is the after-tax cost of the financing implicit in the lease figured out using the internal rate of return of the differential cash flows?\nWhy might buying be preferable to leasing according to the equivalent-loan method?\nWhat factors might influence the decision against the lease in financial analysis of leasing?\nIn the context of the equivalent-loan method, how can a hypothetical bank loan bearing an interest rate be represented?\nWhy might a firm consider leasing an asset to get the financing it needs?\nWhat might be the advantage of borrowing from the bank at a certain interest rate instead of leasing an asset from the lessee's perspective?\nWhat are the elements constituting the repayment to the bank at the end of the year in the context of the equivalent-loan method?\nHow is the after-tax payment calculated in the equivalent-loan method?\nHow does the principal outstanding at the beginning of a year influence the repayment structure in the subsequent year?\nIn financial modeling, how is the present value of lease versus buy outflows calculated?\nHow are the interest, total payment, and after-tax payment values determined for each year in financial modeling?",
            "7.3 Leasing and Firm Financing\u2014The Equivalent-Loan Method\n\nThe idea behind the equivalent-loan method is to devise a hypothetical loan\nthat is somehow equivalent to the lease.3 It then becomes easy to see whether\nthe lease or the purchase of an asset is preferable.\nT he easiest way to understand the equivalent-loan method is with an\nexample. We return to the previous example:\nA B C D E F G H I\n1 EQUIVALENT-LOAN METHOD\u2014THE LESSEE POINT OF VIEW\n2 Asset cost 600,000\n3 Interest rate 12%\n4 Lease rental payment 140,000\n5 Annual depreciation 100,000\n6 Tax rate 40%\n7\n8 Year 0 1 2 3 4 5 6\n9 After-tax cash flows from leasing\n10 After-tax lease rental -84,000 -84,000 -84,000 -84,000 -84,000 -84,000 <-- =-$B$4*(1-$B$6)\n11\n12 After-tax cash flows from buying the asset\n13 Asset cost -600,000\n14 Depreciation tax shield 40,000 40,000 40,000 40,000 40,000 40,000<-- =$B$5*$B$6\n15 Net cash from buying -600,000 40,000 40,000 40,000 40,000 40,000 40,000<-- =G13+G14\n16\n17 Differential cash flow: Lease saves lessee\n18 Lease minus buy 516,000 -124,000 -124,000 -124,000 -124,000 -124,000 -40,000<-- =G10-G15\n19\n20 IRR of differential cash flow 8.30%<-- =IRR(B18:H18,0)\n21 Decision?? Buy <-- =IF(B20<(1-B6)*B3,\"Lease\",\"Buy\")\nRows 2\u20136 give the various parameters of the problem. The spreadsheet then\ncompares two after-tax cash fl ows, that of the lease and that of the buy; we\nwrite outfl ows with a minus sign and infl ows (such as the tax shield from the\ndepreciation) with a plus sign.\n3 . T his method is due to Myers, Dill, and Bautista (1976). A somewhat more accessible explana-\n182 Chapter 7\n\u2022 The cash fl ow from leasing the asset is ( 1 \u2013 tax rate)*lease payment in each\nof years 0\u20135.\n\u2022 The cash fl ow from buying the asset is the asset cost in year 0 (an outfl ow,\nhence negative) and the tax shield on the asset \u2019 s depreciation, tax rate*depre-\nciation , in years 1\u20136 (an infl ow, hence written here with a positive sign).\nThe differential cash fl ow between the lease and the buy decision. This line\nshows that leasing the asset, instead of buying it, results in the following cash\nfl ows to the lessor:\n\u2022 A cash infl ow of $516,000 in year 0. This infl ow is the c ash saved at time\n0 by the lease: Purchasing the asset costs $600,000, whereas leasing the asset\ncosts only $84,000 on an after-tax basis. Thus the lease initially saves the\nlessee $516,000.\n\u2022 A cash outfl ow of $124,000 in years 1\u20135 and an outfl ow of $40,000 in year\n6. This outfl ow corresponds to the after-tax cost of the lease versus the buy in\nthese years. This cost has two components: the after-tax lease payment\n($84,000) and the fact that when the lessee leases, it does not get the tax shield\non the asset \u2019 s depreciation ($40,000).\nT hus leasing instead of purchasing the asset is like getting a loan of $516,000\nwith after-tax repayments of $124,000 in years 1\u20135 and an after-tax repayment\nof $40,000 in year 6. The lease, in other words, can be viewed as an alternative\nmethod of fi nancing the asset. In order to compare the lease to the buy, we\nshould compare the cost of this fi nancing with the cost of alternative fi nancing .\nThe internal rate of return of the differential cash fl ows\u20148.30%\u2014gives the\nafter-tax cost of the fi nancing implicit in the lease; this is larger than the after-\ntax cost of fi rm borrowing, since in this case (where the fi rm\u2019 s tax rate is 40%\nand its borrowing cost is 12%), this cost is 7.20%. Our conclusion: Buying is\npreferable to leasing.\nWhy Do We Decide Against the Lease?\nN ot everyone is fully convinced by the preceding argument. We therefore\npresent an alternative argument in this subsection. We show that if the fi rm\ncan borrow at 12%, it can borrow m ore money with the same schedule of after-\ntax repayments as that which resulted from the lease versus the buy. This\n183 Financial Analysis of Leasing\nA B C D E F G H\n=D26+B26-B27 Split of loan repayment =B26-B27\n24 between:\nLease minus\nLoan\nPrincipal at Repayment After-tax loan buy cash\nYear payment, end Interest\nbeg. year of principal repayment flows, years\n25 year 1-6\n26 1 532,070 149,539 63,848 85,691 124,000 124,000\n27 2 446,379 145,426 53,565 91,861 124,000 124,000\n<-- {=-\n28 3 354,518 141,017 42,542 98,475 124,000 124,000\nTRANSPOSE\n29 4 256,044 136,290 30,725 105,565 124,000 124,000\n(C18:H18)}\n30 5 150,479 131,223 18,057 113,166 124,000 124,000\n31 6 37,313 41,791 4,478 37,313 40,000 40,000\n32\n33 =NPV((1-$B$6)*$B$3,G26:$G$31)\n34 =$B$3*B26\nThe table (a version of the loan tables discussed in Chapter 1) shows the\nprincipal of a hypothetical bank loan bearing a 12% interest rate. At the begin-\nning of year 0 (that is, at the time when the fi rm either purchases or leases the\nasset), for example, the fi rm borrows $532,070 from the bank. At the end of\nthe year, the fi rm repays $149,539 to the bank, of which $63,848 is interest\n(since $63,848 = 12%*$532,070) and the remainder, $85,691, is repayment of\nprincipal. The net, after-tax, repayment in year 1\u2014assuming full tax deduct-\nibility of the interest payment\u2014is (1 \u2013 40%)*$63,848 + $85,691 = $124,000,\nwhich is, of course, the same after-tax differential cash fl ow calculated in our\noriginal spreadsheet.\nPayments in subsequent years are calculated similarly to the illustration in\nthe preceding paragraph. At the beginning of year 6, there is still $37,313 of\nprincipal outstanding; this is fully paid off at the end of the year with an after-\ntax payment of $40,000.\nT he point of this example? If the fi rm is considering leasing the asset in\norder to get the fi nancing of $516,000, which the lease gives, it should instead\nborrow $532,070 from the bank at 12%; it can repay this larger loan with the\nsame after-tax cash fl ows as are implicit in the lease. The bottom line: Purchas-\n184 Chapter 7\nThe alternative loan table shown above was constructed in the following way:\nThe principal at the beginning of each of years 1\u20136 is the present value of the lease\nversus buy outfl ows, discounted at (1 \u2212 38%)*12%. Thus, for example:\n532,070=\u22115 124,000\n+\n40,000\nt=1( 1+( 1\u22120.40)\u22c50.12)t ( 1+( 1\u22120.40)\u22c50.112)6\n446,379=\u2211 t=4\n1( 1+(\n11 \u22122 04 ., 40 00 )0\n\u22c50.12)t\n+\n( 1+(\n1\u221240 0, .40 000 )0\n\u22c50.12)5\n(cid:2)\n40,000\n37,313=\n( 1+( 1\u22120.40)\u22c50.12)\nOnce the principal at the start of each year is known, it is an easy matter to construct the\nrest of the columns.\nInterest=12%\u2217Principalatthebeginningof theyear\nTotalpayment=Interestinyeart+Repaymentof principalinyeart\nAfter-taxpayment,yeart=(1\u2212Taxrate)\u2217Interest\n+Repaymentof prinncipal"
        ],
        "7.4": [
            "What is the lessor's problem in the context of financial leasing?\nWhat factors should the lessor consider while deciding the minimum rental rate for an asset?\nWhat is the use of Excel Goal Seek in solving the lessor\u2019s problem?\nCan you explain the concept of 'Lessor after-tax cash flows' from leasing?\nWhat is the meaning of 'Depreciation tax shield' in the context of lessor's cash flows from buying the asset?\nWhat does the 'IRR of differential cash flow' signify?\nCan any situation make leasing profitable for both the lessor and the lessee?\nIn which cases could differences in tax rates between the lessee and the lessor make it profitable for both to enter into a leasing arrangement?\nWhat factors contributed to a profitable lease scenario for both Greenville Electric Corp and United Turbine Corp?\nHow can tax rate differences impact the profitability of a lease agreement?\nWhat is meant by the term 'after-tax return' in a leasing scenario?\nCan you elaborate on the \u2018Lessee after-tax lease costs\u2019 and 'Lessee after-tax purchase costs'?\nHow are the 'Lessor cash flows' calculated in a leasing arrangement?\nWhat factors affect 'United Turbine's after-tax borrowing cost'?\nWhat is the concept of 'total lessor cash flow' in the context of financial leasing?",
            "7.4 The Lessor \u2019 s Problem: Calculating the Highest Acceptable Lease Rental\n\nThe lessor \u2019 s problem is the opposite of that of the lessee:\n\u2022 T he lessee has to decide whether\u2014given a rental rate on the leased asset\u2014it\nis preferable to buy the asset or lease it.\n\u2022 The lessor has to decide what minimum rental rate justifi es the purchase of\nthe asset in order to lease it out.\nO ne way of solving the lessor\u2019 s problem is to turn the above analysis around.\nWe use the Excel Goal Seek ( Data|What-if analysis|Goal Seek ) to get\n185 Financial Analysis of Leasing\nA B C D E F G H\nTHE LESSOR'S PROBLEM\n1 Calculating the lowest acceptable lease rate\n2 Asset cost 600,000\n3 Interest rate 12%\n4 Lowest acceptable lease payment 134,822<-- Computed either with Goal Seekor Solver\n5 Annual depreciation 100,000\n6 Tax rate 40%\n7\n8 Year 0 1 2 3 4 5 6\n9 Lessor after-tax cash flows from leasing\n10 After-tax lease rental 80,893 80,893 80,893 80,893 80,893 80,893\n11\n12 Lessor after-tax cash flows from buying the asset\n13 Asset cost -600,000\n14 Depreciation tax shield 40,000 40,000 40,000 40,000 40,000 40,000\n15 Net cash from buying -600,000 40,000 40,000 40,000 40,000 40,000 40,000\n16\n17 Lessor cash flows\n18 Lease + buy -519,107 120,893 120,893 120,893 120,893 120,893 40,000\n19\n20 IRR of differential cash flow 7.22%<-- =IRR(B18:H18)\nHere \u2019 s what the Goal Seek settings look like:\n186 Chapter 7\nMini-Case: When Is Leasing Profi table for Both the Lessor and Lessee?\nT he symmetry between the lessee\u2019 s problem and the lessor\u2019 s problem suggests\nthat if the lessee wants to lease, it will not be profi table for the lessor to pur-\nchase the asset in order to lease it out.\nI n some cases, however, it may be that the differences in tax rates between\nthe lessee and the lessor make it profi table for both to enter into a leasing\narrangement. Here is an example: Greenville Electric Corp. is a public utility\nwhich pays no taxes. Its credit rating is of the highest order, since all of Green-\nville\u2019 s debts are guaranteed by the city of Greenville. Greenville Electric has\ndecided that it requires a new turbine. The turbine costs $10,000,000 and will\nbe depreciated to zero salvage value over 5 years. Greenville Electric borrows\nat 6%.\nG reenville can either lease or buy the plant. The lease offer it has is\n$1,800,000 per year for 6 years (starting today); the lessee is a captive leasing\nsubsidiary of United Turbine Corp., the manufacturer of the turbine. United\nTurbine Leasing also borrows at 6% and has a tax rate of 40%.\nAs can be seen below, the lease is profi table to both lessor and lessee.\nGreenville Electric gets fi nancing at a cost of 3.19%, compared to its borrow-\ning cost of 6%; United Turbine gets an after-tax return of 4.3%, compared to\nits after-tax borrowing cost of 3.6%. Both Greenville Electric and United\nTurbine profi t. 4\n4. Who loses? The government, of course! What makes the lease profi table is the utilization of\n187 Financial Analysis of Leasing\nA B C D E F G H\n1 GREENVILLE ELECTRIC CORP.\n2 Turbine cost 10,000,000\n3 Greenville's borrowing rate 6.00%\n4 Lease payment 1,800,000\n5\n6 Year 0 1 2 3 4 5 6\n7 Lessee after-tax lease costs\n8 After-tax lease rental -1,800,000 -1,800,000 -1,800,000 -1,800,000 -1,800,000 -1,800,000\n9\n10 Lessee after-tax purchase costs\n11 Asset cost -10,000,000\n12 Depreciation tax shield (Greenville Electric's tax rate = 0) 0 0 0 0 0 0\n13 Net cash from buying -10,000,000 0 0 0 0 0 0\n14\n15 Cash saved by leasing\n16 Lease - purchase cash flows 8,200,000 -1,800,000 -1,800,000 -1,800,000 -1,800,000 -1,800,000 0\n17\n18 IRR of differential cash flow 3.19%<-- =IRR(B16:H16,0)\n19 Greenville's after-tax borrowing cost 6.00%<-- =B3\n20\n21 UNITED TURBINE LEASING CORPORATION\n22 Turbine cost 10,000,000\n23 Lease payment 1,800,000\n24 Depreciation (straight line, 5 years) 2,000,000\n25 United Turbine's borrowing rate 6.00%\n26 United Turbine's corporate tax rate 40%\n27\n28 Year 0 1 2 3 4 5 6\n29 Lessor cash flows\n30 Equipment cost -10,000,000\n31 Lease payment, after tax 1,080,000 1,080,000 1,080,000 1,080,000 1,080,000 1,080,000\n32 Depreciation tax shield 800,000 800,000 800,000 800,000 800,000 800,000\n33 Total lessor cash flow -8,920,000 1,880,000 1,880,000 1,880,000 1,880,000 1,880,000 800,000\n34\n35 IRR of lessor cash flows 4.30%<-- =IRR(B33:H33)\n36 United Turbine's after-tax borrowing cost 3.60%<-- =B25*(1-B26)"
        ],
        "7.5": [
            "What is the residual value of an asset?\nHow can the residual value be included in financial calculations or modelling?\nHow can you consider the tax implications of the residual value in leasing?\nWhat is the role of depreciation in financial modeling of leasing and buying assets?\nHow can lease rental payments impact the financial model?\nWhat impact does the after-tax residual have on cash flows from buying the asset?\nWhat does differential cash flow entail in financial models?\nWhat role does the Internal Rate of Return (IRR) play in decision-making between leasing or buying an asset?\nWhat factors can impact the realization of the anticipated residual value?\nHow does the uncertainty of realizing the residual value affect the financial model?\nWhat is the Certainty Equivalent Factor? \nHow does the Certainty Equivalent Factor factor into financial modeling and decision-making?\nWhy might the residual value in financial models be reduced by a factor indicating uncertainty? \nHow may the computed residual value differ from its actual realization?\nHow does applying the Certainty Equivalent Factor to the estimated residual value influence the After-tax Residual in the model?\nWhat is the potential impact of tax rates on the decision between leasing or buying an asset?\nWhat is a Depreciation Tax Shield and how does it impact after-tax cash flows?\nWhat does the Lease minus Buy variable represent in financial modelling?",
            "7.5 Asset Residual Value and Other Considerations\n\nI n the above example we have ignored the residual value of the asset\u2014its\nanticipated market value at the end of the lease term. In a mechanical sense,\nit is easy to include the residual value in the calculations (but you have to be\ncareful with this\u2014see the warning after the numerical example below).\nSuppose, for example, you think that the asset will have a market value of\n$100,000 in year 7; assuming that this value is fully taxed (after all, we\u2019 v e\ndepreciated the asset to zero value over the fi rst 6 years), the after-tax residual\n188 Chapter 7\nA B C D E F G H I\n1 RESIDUAL VALUES IN LEASE ANALYSIS\n2 Asset cost 600,000\n3 Interest rate 12%\n4 Lease rental payment 140,000\n5 Annual depreciation 100,000\n6 Tax rate 40%\n7 Residual value 100,000<-- Anticipated to be realized in year 7; fully taxed\n8\n9 Year 0 1 2 3 4 5 6 7\n10 After-tax cash flows from leasing\n11 After-tax lease rental -84,000 -84,000 -84,000 -84,000 -84,000 -84,000\n12\n13 After-tax cash flows from buying the asset\n14 Asset cost -600,000\n15 Depreciation tax shield 40,000 40,000 40,000 40,000 40,000 40,000\n16 After-tax residual 60,000\n17 Net cash from buying -600,000 40,000 40,000 40,000 40,000 40,000 40,000 60,000\n18\n19 Differential cash flow\n20 Lease minus buy 516,000 -124,000 -124,000 -124,000 -124,000 -124,000 -40,000 -60,000\n21\n22 IRR of differential cash flow 10.49%<-- =IRR(B20:I20,0)\n23 Decision?? Buy <-- =IF(B22<(1-B6)*B3,\"Lease\",\"Buy\")\nN ot surprisingly, the possibility of realizing an extra cash fl ow from asset\nownership makes the lease even less attractive than before (you can see this\ndifference by noting that the return rate in cell B22, the IRR of the differential\ncash fl ows, has increased from 8.30% in our original example to 10.49%).\nBe a bit careful here, however; the spreadsheet treats the residual value as\nif it has the same certainty of realization as the depreciation tax shields and\nthe lease rentals. This can be far from the truth! There is no good practical\nsolution to this problem; an ad hoc way of dealing with it might be to reduce\nthe $100,000 by a factor which expresses the uncertainty about its realization.\nThe fi nance technical jargon for this is \u201ccertainty equivalent factor,\u201d and\nyou can fi nd it referenced in any basic fi nance text. 5 The last spreadsheet\nsnapshot in this chapter (below) assumes that you\u2019 v e decided that the certainty-\nequivalence factor for the residual value is 0.7:\n5 . F or further references on certainty-equivalents, see for example Brealey-Myers-Allen (2011,\nChapter 9). However, note that neither this work nor the present text (nor anyone else) can\ntell you precisely how to calculate the certainty-equivalence factor. It depends on your attitudes\n189 Financial Analysis of Leasing\nA B C D E F G H I J\nRESIDUAL VALUES IN LEASE ANALYSIS\nEstimated residual value multiplied by certainty-equivalence factor which represents\n1 uncertainty about realizing residual\n2 Asset cost 600,000\n3 Interest rate 12%\n4 Lease rental payment 140,000\n5 Annual depreciation 100,000\n6 Tax rate 40%\n7 Residual value 100,000<-- Anticipated to be realized in year 7; fully taxed\n8 Certainty-equivalence factor for residual 0.70\n9\n10Year 0 1 2 3 4 5 6 7\n11After-tax cash flows from leasing\n12After-tax lease rental -84,000 -84,000 -84,000 -84,000 -84,000 -84,000\n13\n14After-tax cash flows from buying the asset\n15Asset cost -600,000\n16Depreciation tax shield 40,000 40,000 40,000 40,000 40,000 40,000\n17After-tax residual 42,000 <-- =(1-B6)*B7*B8\n18Net cash from buying -600,000 40,000 40,000 40,000 40,000 40,000 40,000 42,000\n19\n20Differential cash flow\n21Lease minus buy 516,000 -124,000 -124,000 -124,000 -124,000 -124,000 -40,000 -42,000\n22\n23IRR of differential cash flow 9.88%<-- =IRR(B21:I21,0)\n24Decision?? Buy <-- =IF(B23<(1-B6)*B3,\"Lease\",\"Buy\")"
        ],
        "7.6": [
            "What is leveraged leasing in financial terms? \nHow is a lease vs purchase decision analyzed from the viewpoint of a lessee and a lessor?\nWhat is the lessor\u2019s perspective in a leveraged lease?\nWho are typically involved in a leveraged lease and what roles do they play?\nWhat are the two major issues related to the analysis of leveraged leases?\nHow are the cash flows obtained by the lessor calculated in the context of leveraged leases?\nWhat is the importance of net present value (NPV) in leveraged leasing?\nWhat is the concept of internal rate of return (IRR) in leveraged leasing?\nWhat is the accounting analysis of a lease?\nWhat is meant by the MPM rate of return and how does it differ from the internal rate of return (IRR)?\nWhat is the efficient-markets hypothesis and how does it relate to leveraged leasing?\nWhy do people get concerned about how things look on their financial statements in a less than efficient world?\nHow is the accounting rate of return on the lease calculated?\nWhat role does Excel play in the computation of the accounting rate of return on the lease?",
            "7.6 Leveraged Leasing\n\nU p to this point we analyzed the lease versus purchase decision from both the\npoints of view of the lessee (the long-term user of the asset) and the lessor\n(the asset \u2019 s owner, who rents it out to the lessee). In this chapter we analyze\nleveraged leasing: In a leveraged lease the lessor fi nances the purchase of the\nasset to be leased with debt. From the point of view of the lessee, there is no\ndifference in the analysis of a leveraged or a non-leveraged lease. From the\nlessor \u2019 s point of view, however, the cash fl ows of a leveraged lease present\nsome interesting problems.\nA t least six parties are typically involved in a leveraged lease: the lessee,\nthe equity partners in the lease, the lenders to the equity partners, an owner\ntrustee, an indenture trustee, and the manufacturer of the asset. In most cases,\na seventh party is also involved: a lease packager (a broker or leasing company).\nFigure 7.1 on page 190 illustrates the arrangements among the six parties of\na typical leveraged lease.\nThe two major problems related to the analysis of leveraged leases are these:\n\u2022 The straightforward fi nancial analysis of the lease from the point of view of\nthe lessor. This concerns the calculation of the cash fl ows obtained by the\nlessor, and a computation of these cash fl ows\u2019 net present value (NPV) or\ninternal rate of return (IRR).\n\u2022 The accounting analysis of the lease. Accountants use a method called the\n190 Chapter 7\nLEVERAGED LEASING\nPurchasePrice Agreements RentPayments\nlessee lessee lessee\nassignment rent\nof rent\nexcess of\nowner indenture owner indenture owner rent over indenture\ntrustee trustee trustee trustee trustee debt service trustee\nequity\nfunds d fue nb dt s a g rtr eu es mt ent bonds a g rtr eu es mt ent de rex enc bte t os svs ee ro r vf ice d see rb vt ice\nlessor: lessor: lessor: lessor: lessor: lessor:\nequity lenders equity lenders equity lenders\npurchase title\nprice\nmanufacturer manufacturer manufacturer\nFigure 7.1\nleases. The MPM rate of return is different from the internal rate of return\n(IRR). In an ordinary fi nancial context this should be of no concern, since the\neffi cient-markets hypothesis tells us that only cash fl ows matter. However, in\na less than effi cient world, people tend to get very concerned about how things\nlook on their fi nancial statements. Since the accounting rate of return on the\nlease is diffi cult to compute, we will use Excel to calculate it; then we will\nanalyze the results."
        ],
        "7.7": [
            "What is a leveraged lease?\nWhat is FASB 13 in the context of accounting for leases?\nHow is the purchase of a leased asset typically financed in a leveraged lease?\nWhat is the interest rate often used for the debt in a leveraged lease case?\nHow is the annual payment of interest and principal calculated in a leveraged lease?\nWhat is the usual lease term for an asset in a leveraged lease?\nHow is an asset depreciated over the lease term in a leveraged lease scenario?\nWhat is the standard IRS depreciation schedule for assets with a 7-year life?\nWhat happens when an asset is fully depreciated at the time it is sold?\nHow is the after-tax cash flow from the residual calculated?\nWhat is the significance of a company's tax rate in the context of a leveraged lease?\nWhat is the modified cost recovery system (MACRS) depreciation?\nWhat happens to the cash flows of a typical long-lived leveraged lease over time, and why?\nWhat are the three reasons for the typical cash flow phenomenon in a long-lived leveraged lease?\nWhat is the role of depreciation in the cash flow of a long-lived leveraged lease?\nHow do the annual debt payments change over the lease term in a leveraged lease?\nWhat is the anticipated large cash flow in the case of a leveraged lease?",
            "7.7 A Leveraged Lease Example\n\nW e can explore these issues by considering an example, roughly based on an\nexample given in Appendix E of FASB 13, the accounting profession \u2019 s magnum\nopus on accounting for leases.\nA leasing company is considering the purchase of an asset whose cost is\n$1,000,000. The asset will be purchased with $200,000 of the company \u2019 s\nequity and with $800,000 of debt. The interest on the debt is 10%, so that the\nannual payment of interest and principal over the 15-year term of the debt is\n$105,179. 6\n191 Financial Analysis of Leasing\nT he company will lease the asset out for $110,000 per year, payable at the\nend of each year. The lease term is 15 years. The asset will be depreciated\nover a period of 8 years, using standard IRS depreciation schedule for assets\nwith a 7-year life.7 The depreciation schedule for such assets is:\nYear Depreciation\n1 14.28%\n2 24.49%\n3 17.49%\n4 12.5%\n5 8.92%\n6 8.92%\n7 8.92%\n8 4.48%\nBecause the asset will be fully depreciated at the time it is sold (year 16), the\nwhole anticipated residual value ($300,000) will be taxable. Since the com-\npany \u2019 s tax rate is 40%, this means that the after-tax cash fl ow from the residual\nis (1 \u2013 40%)*300,000 = $180,000.\nThese facts are summarized in the spreadsheet below, which also derives\nthe lessor \u2019 s cash fl ows:\n7. The depreciation schedule we use is referred to as the modifi ed cost recovery system (MACRS)\ndepreciation. More information can be obtained from an introductory fi nance text or from many\n192 Chapter 7\nA B C D E F G H I J\n1 BASIC LEVERAGED LEASE EXAMPLE\n2 Cost of asset 1,000,000\n3 Lease term 15\n4 Residual value 300,000<-- Realized year 16\n5 Equity 200,000\n6 Debt 800,000<-- 15-year term loan, equal payments of interest and principal\n7 Interest 10%\n8 Annual debt payment 105,179 <-- =PMT(B7,B3,-B6)\n=(1-tax)*C14+tax*D14-(1-tax)*G14-\n9 Annual rent received 110,000\nH14\n10 Tax rate 40%\n11\nPrincipal\nEquity Rental or Loan Repayment Cash flow to\nYear Depreciation at start of Interest\n12 Invested salvage year payment of principal equity\n13 0 -200,000 -200,000\n14 1 110,000 142,800 800,000 105,179 80,000 25,179 49,941\n15 2 110,000 244,900 774,821 105,179 77,482 27,697 89,774\n16 3 110,000 174,900 747,124 105,179 74,712 30,467 60,666\n17 4 110,000 125,000 716,657 105,179 71,666 33,513 39,487\n18 5 110,000 89,200 683,144 105,179 68,314 36,865 23,827\n19 6 110,000 89,200 646,280 105,179 64,628 40,551 22,352\n20 7 110,000 89,200 605,728 105,179 60,573 44,606 20,730\n21 8 110,000 44,800 561,122 105,179 56,112 49,067 1,186\n22 9 110,000 512,056 105,179 51,206 53,973 -18,697\n23 10 110,000 458,082 105,179 45,808 59,371 -20,856\n24 11 110,000 398,711 105,179 39,871 65,308 -23,231\n25 12 110,000 333,403 105,179 33,340 71,839 -25,843\n26 13 110,000 261,565 105,179 26,156 79,023 -28,716\n27 14 110,000 182,542 105,179 18,254 86,925 -31,877\n28 15 110,000 95,617 105,179 9,562 95,617 -35,354\n29 16 300,000 180,000\n30\n31 IRR of cash flows 12.46% <-- =IRR(I13:I29)\nThe last column gives the cash fl ow to the equity owners of the asset. A\ntypical year \u2019 s cash fl ow for the equity owner is calculated as follows:\nCash flow( t)=( 1\u2212Tax)\u2217Lease payment+Tax\u2217Depreciation\n\u2212( 1\u2212Tax)\u2217IInterest( t)\u2212Principalrepayment( t)\nThe cash fl ows of the typical long-lived leveraged lease are usually positive\nat the beginning of the lease term, and then decline over time, turning positive\nagain at the end, when the residual value is received. There are three reasons\nfor this phenomenon:\n\u2022 The cash fl ow which stems from depreciation typically ends or falls off\nrapidly before the end of the lease term. The more accelerated the depreciation\nmethod, the larger will be the depreciation allowances (and hence the larger\nthe depreciation tax shields) at the beginning of the asset\u2019 s life.\n\u2022 I n the later years of the lease, the portion of the annual debt payments\ndevoted to interest (tax-deductible) falls, while the portion of the annual debt\npayments that constitutes a repayment of principal (not tax deductible) rises.\n\u2022 F inally, of course, we anticipated a large cash fl ow from the realization of\n193 Financial Analysis of Leasing"
        ],
        "7.8": [
            "What is a lease-purchase decision? \nWhat assumptions are made in the decision to lease? \nWhat is the equivalent-loan method and how is it used in making lease-purchase decisions? \nWhat is a leveraged lease? \nWho is the lessor in a leveraged lease? \nHow does a lessor finance his investment in a leveraged lease? \nWhat happens to the equity income of the lessor in a leveraged lease? \nWhat is the economic analysis of lease cash flows? \nWhat happens to the equity value of the owner at a certain point in the lease life?",
            "7.8 Summary\n\nThis chapter has looked at the lease-purchase decision. We have examined the\ndecision to lease as a purely fi nancing decision, assuming (i) that all opera-\ntional factors between leasing and buying are equivalent, and (ii) that the\nessential fi rm decision to acquire the use of the asset has already been made.\nOn the basis of these assumptions, the lease-purchase decision can be made\nusing the equivalent-loan method.\nA leveraged lease is an arrangement whereby the lessor\u2014the owner of the\nasset\u2014fi nances his investment with a combination of debt and equity. In this\nchapter we analyzed the equity income of the lessor in a leveraged lease. The\neconomic analysis of the lease cash fl ows shows that at some point in the lease\nlife, the equity owner has negative equity value."
        ]
    },
    "8": {
        "8.1": [
            "What does the chapter review about the basic mechanics of portfolio calculations?\nCan you explain the general case of N assets in portfolio calculations?\nWhat is the role of matrix notation and Excel\u2019s matrix handling capabilities in financial modelling?\nCan you explain what is meant by the term 'expected return on an asset' in financial modelling?\nWhat does Var represent in the context of portfolio calculations?\nWhat does the term Cov denote in the context of financial modelling?\nWhy might it be convenient to write Cov as \u03c3 in financial modelling?\nCan you define the variance of an asset's return?\nWhy might the covariance of an asset's returns with itself be equivalent to the variance of the asset's returns?\nWhat assets could potentially be characterized by several statistics in financial modelling?\nHow can historical price data be used to derive return distributions in portfolio calculations?\nWhat do the statistics that characterize each asset in a portfolio refer to?\nCan \u03bc be used to denote the expected return on an asset in financial modelling?\nWhy is the use of \u03c3 not only economical but also logical in the notation of financial modelling?\nWhat kind of assets are usually considered in numerical examples of portfolio calculations?",
            "8.1 Overview\n\nIn this chapter we review the basic mechanics of portfolio calculations. We\nstart with a simple example of two assets, showing how to derive the return\ndistributions from historical price data. We then discuss the general case of N\nassets; for this case it becomes convenient to use matrix notation and exploit\nExcel \u2019 s matrix handling capabilities.\nIt is useful before going on to review some basic notation: Each asset i\n(assets may be stocks, bonds, real estate, or whatever, although our numerical\nexamples will be largely confi ned to stocks) is characterized by several statis-\ntics: E ( r ), the expected return on asset i ; Var ( r ), the variance of asset i \u2019 s return;\ni i\nand C ov ( r , r ) , the covariance of asset i \u2019 s and asset j \u2019 s returns. Occasionally\ni j\nwe will use \u03bc to denote the expected return on asset i . In addition, it will often\ni\nbe convenient to write C ov ( r , r ) as \u03c3 and Var ( r ) as \u03c3 (instead of \u03c3 2 , as\ni j ij i ii i\nusual). Since the covariance of an asset \u2019 s returns with itself, \u03c3 = Cov ( r , r ),\nii i i\nis in fact the variance of the asset\u2019 s returns, this notation is not only economical\nbut also logical."
        ],
        "8.2": [
            "What is the process of computing returns for stocks?\nWhat are the returned statistics for stocks?\nWhat is the definition of return in the context of stock prices?\nWhat does the monthly mean, variance and standard deviation represent in stock return data?\nHow is the annual mean, variance, and standard deviation calculated from the monthly data?\nWhat is the continuously compounded return on the stock and how is it calculated?\nWhat assumption is made regarding the return data for the 60 months?\nWhat does the historic data represent in the context of stock returns?\nWhat is the difference between sample statistics and population statistics in portfolio return?\nWhat is the difference between the average return in population statistics and sample statistics?\nHow is the variance calculated in population and sample statistics?\nHow are standard deviation, covariance and correlation calculated in portfolio return statistics?\nWhat is the covariance in portfolio statistics?\nHow can covariance be interpreted in terms of unit measures?\nWhat is the correlation coefficient and how is it calculated?\nWhat does the correlation coefficient measure in portfolio statistics?\nWhat are the characteristics of the correlation coefficient?\nWhat is the implication of a positive correlation coefficient for returns on two assets?\nWhat is the implication of a negative correlation coefficient for returns on two assets?\nWhat is the relationship between independent return distributions and the correlation coefficient?\nHow can the correlation coefficient be viewed using a graphical method in Excel?\nWhat is the relationship between regression R2 and correlation coefficient?\nWhat does the Excel Trendline facility illustrate in terms of returns?",
            "8.2 Computing Returns for Apple (AAPL) and Google (GOOG)\n\nIn this section we compute the return statistics for two stocks: Apple (stock\nsymbol AAPL) and Google (GOOG). Here is the price and return data. The\n198 Chapter 8\nA B C D E F G\nPRICES AND RETURNS FOR APPLE AND GOOGLE\n1 June 2007 - June 2012\n2 Monthly mean 2.61% -0.24%<-- =AVERAGE(F11:F71)\n3 Monthly variance 0.0125 0.0102<-- =VAR.S(F11:F71)\n4 Monthly standard deviation 11.17% 10.09%<-- =STDEV.S(F11:F71)\n5\n6 Annual mean 31.31% -2.91%<-- =12*C2\n7 Annual variance 0.1497 0.1221<-- =12*C3\n8 Annual standard deviation 38.70% 34.94%<-- =SQRT(12)*C4\n9\n10 Date AAPL Google AAPL Google\n11 1-Jun-07 122.04 580.11\n12 2-Jul-07 131.76 645.90 0.0766 0.1074<-- =LN(C12/C11)\n13 1-Aug-07 138.48 599.39 0.0497 -0.0747<-- =LN(C13/C12)\n66 3-Jan-12 456.48 522.70 0.1197 0.0246<-- =LN(C66/C65)\n67 1-Feb-12 542.44 497.91 0.1725 -0.0486<-- =LN(C67/C66)\n68 1-Mar-12 599.55 471.38 0.1001 -0.0548\n69 2-Apr-12 583.98 458.16 -0.0263 -0.0284\n70 1-May-12 577.73 449.45 -0.0108 -0.0192\n71 1-Jun-12 584.00 501.50 0.0108 0.1096\nT hese data give the closing price at the end of each month for each stock. We\ndefi ne the return as\n\u239b P \u239e\nr =ln\u239c t \u239f\nt \u239d \u23a0\nP\nt\u22121\nA t the top of the Excel sheet we calculate the return statistics for each stock.\nThe m onthly return is the percentage return that would be earned by an investor\nwho bought the stock at the end of a particular month t \u2212 1 and sold it at the\nend of the following month.\nNote that we use the continuously compounded return on the stock,\nr t = ln( P t / P t \u2212 1 ). An alternative would have been to use the discrete return,\nP t / P t \u2212 1 \u2212 1. Appendix 2 at the end of this chapter discusses the reasons for our\nchoice of the continuously compounded return.\nWe now make a heroic assumption: We assume that the return data for the\n60 months represent the distribution of the returns for the coming month. We\nthus assume that the past gives us some information about the way returns will\nbehave in the future. This assumption allows us to assume that the average of\nthe historic data represents the e xpected monthly return from each stock. It\nalso allows us to assume that we may learn from the historic data what is the\nvariance of the future returns. Using the A verage, Var.s, and Stdev.s functions\n199 Portfolio Models\u2014Introduction\nA B C D E F\n2 Monthly mean 2.61% -0.24%<-- =AVERAGE(F11:F71)\n3 Monthly variance 0.0125 0.0102<-- =VAR.S(F11:F71)\n4 Monthly standard deviation 11.17% 10.09%<-- =STDEV.S(F11:F71)\n5\n6 Annual mean 31.31% -2.91%<-- =12*C2\n7 Annual variance 0.1497 0.1221<-- =12*C3\n8 Annual standard deviation 38.70% 34.94%<-- =SQRT(12)*C4\nNote: Sample Versus Population Statistics and Excel\nW e interrupt this discussion of portfolio computations with a short note on the\nstatistical computations. In statistics it is common to distinguish between\nsample statistics and population statistics. If we examine the whole range of\npossibilities for a given random variable, then we are dealing with the p opula-\ntion. If we are dealing with a set of outcomes for the random variable, then\nwe are dealing with a sample. In the case of portfolio return statistics we will\nalmost always be dealing with a s ample rather than the whole population.\nT he table below gives the defi nitions of the population and sample statistics\nand the Excel functions that compute them.\nPopulation S ample\nMean, average, \u03bc Average=\n1 \u2211N\nr Average=\n1 \u2211N\nr\nN i N i\ni=1 i=1\nVariance Var.p= 1 \u2211N ( r \u2212r)2 Var.s= 1 \u2211N ( r \u2212r)2\nN i N\u22121 i\ni=1 i=1\nStandard deviation Stdev.p= 1 \u2211N ( r \u2212r)2 Stdev.s= 1 \u2211N ( r \u2212r)2\nN i N\u22121 i\ni=1 i=1\nCovariance Covariance.p= Covariance.s=\n1 \u2211N (\nr\n\u2212r)(\nr\n\u2212r) 1 \u2211N (\nr\n\u2212r)(\nr\n\u2212r)\nN it i jt j N\u22121 it i jt j\nt=1 t=1\nCovar.p(i, j) Covar.s(i, j)\nCorrelation Correl(i, j)= =\n200 Chapter 8\nPopulation S ample\nAlternative Excel Var, VarP, Stdev, StdevP\nfrom previous VarS, StdevS\nversions, still work Covar computes the population covariance. New versions of\nExcel distinguish between population and sample covariance.\nRegression slope Excel Slope , equivalent to\nslope(i_data,M_data)=\nCovar.p(i,M)\n=\nCovar.S(i,M)\nVar.p(i,M) Varr.S(i,M)\nSample or Population? Does It Matter?\nA ll of this discussion about population versus sample statistics may not matter\nmuch. We like the point of view stated by Press et al. in their splendid book\nNumerical Recipes : \u201cThere is a long story about why the denominator is\nN \u2212 1 instead of N . If you have never heard that story, you may consult any\ngood statistics text. We might also comment that if the difference between N\nand N \u2212 1 ever matters to you, then you are up to no good anyway\u2014e.g., trying\nto substantiate a questionable hypothesis with marginal data.\u201d1\nBack to Our Portfolio Example\nNext we want to calculate the c ovariance of the returns.\nA B C D E F G H\n1 COMPUTING COVARIANCE AND CORRELATION\n2 Stock returns Return minus average\n3 Date AAPL Google AAPL Google Product\n4 2-Jul-07 7.66% 10.74% =B4-$B$65 --> 0.0505 0.1099 0.0056<-- =E4*F4\n5 1-Aug-07 4.97% -7.47% =B5-$B$65 --> 0.0237 -0.0723 -0.0017<-- =E5*F5\n59 1-Feb-12 17.25% -4.86% 0.1464 -0.0462 -0.0068\n60 1-Mar-12 10.01% -5.48% 0.0740 -0.0523 -0.0039\n61 2-Apr-12 -2.63% -2.84% -0.0524 -0.0260 0.0014\n62 1-May-12 -1.08% -1.92% -0.0369 -0.0168 0.0006\n63 1-Jun-12 1.08% 10.96% -0.0153 0.1120 -0.0017\n64\n65 Average 2.61% -0.24%\n66 Variance 0.0125 0.0102<-- =VAR.S(C4:C63) Covariance computation\n67 Standard deviation 0.1117 0.1009<-- =STDEV.S(C4:C63) 0.001956<-- =AVERAGE(G4:G63)\n68 0.1117 0.1009<-- =SQRT(C66) 0.001956<-- =COVARIANCE.P(B4:B63,C4:C63)\n69 0.001956<-- =COVAR(B4:B63,C4:C63)\n70 0.0123 0.0100<-- =VAR.P(C4:C63) 0.001989<-- =AVERAGE(G4:G63)*60/59\n71 0.1108 0.1000<-- =STDEV.P(C4:C63) 0.001989<-- =COVARIANCE.S(B4:B63,C4:C63)\n72 0.1108 0.1000<-- =SQRT(C70)\n73 Correlation computation\n74 0.1765<-- =CORREL(B4:B63,C4:C63)\n75 0.1765<-- =G68/(B71*C71)\n76 0.1765<-- =G71/(B67*C67)\n201 Portfolio Models\u2014Introduction\nThe column Product contains the multiple of the deviation from the mean in each\nmonth, i.e., the terms ( r \u2212 E ( r ))( r \u2212 E ( r )), for t = 1, \u2026 ,\nWMT,t WMT TGM,t TGT\n12. The population covariance is A verage(product) = 0.0020. While it\nis worthwhile calculating the covariance this way at least once, there is\na shorter way which is also illustrated above: The Excel functions\nCovariance . P(AAPL,GOOG) and C ovariance.S(AAPL,GOOG) calculate\nthe population and the sample covariance directly. 2 There is no necessity to\nfi nd the difference between the returns and the means. Simply use C ovariance.P\nor Covariance.S directly on the columns, as illustrated above.\nThe covariance is a hard number to interpret, since its size depends on the\nunits in which we measure the returns. (If we were to write the returns in\npercentages\u2014i.e., 4 instead of 0.04\u2014then the covariance would be 20, which\nis 10,000 times the number we just calculated.) We can also calculate the cor-\nrelation coeffi cient \u03c1 , which is defi ned as\nAB\nCov(r ,r )\n\u03c1 = AAPL GOOG\nAAPL,GOOG \u03c3 \u03c3\nAAPL GOOG\nT he correlation coeffi cient is unit-free; calculating it for our example gives\n\u03c1 = 0.1765. As illustrated above, the correlation coeffi cient can be\nAAPL,GOOG\ncalculated directly in Excel using the function Correl(AAPL,GOOG) .\nT he correlation coeffi cient measures the degree of linear relation between\nthe returns of Stock A and Stock B. The following facts can be proven about\nthe correlation coeffi cient:\n\u2022 The correlation coeffi cient is always between + 1 and \u2212 1: \u2212 1 \u2264 \u03c1 \u2264 1.\nAB\n\u2022 If the correlation coeffi cient is + 1, then the returns on the two assets are\nlinearly related with a positive slope; i.e., if \u03c1 = 1, then\nAB\nr =c+dr , whered>0\nAt Bt\n\u2022 If the correlation coeffi cient is \u2212 1, then the returns on the two assets are\nlinearly related with a negative slope; i.e., if \u03c1 = \u2212 1, then\nAB\nr =c+dr , whered<0\nAt Bt\n2. The function Covar was used in pre-Excel 2013 and calculates the population covariance; it\nstill works in current versions. As noted elsewhere, previous Excel versions had functions V arP ,\nStdevP , VarS , StdevS (though still working, these are now replaced by Var.P , Stdev.P , Var.S ,\nStdev.S ). Note how, in our example, the difference between the sample and population covariance\n202 Chapter 8\n\u2022 I f the return distributions are independent, then the correlation coeffi cient\nwill be zero. (The opposite is not true: If the correlation coeffi cient is zero,\nthis does not necessarily mean that the returns are independent. See the Exer-\ncises for an example.)\nA Different View of the Correlation Coeffi cient\nAnother way to look at the correlation coeffi cient is to graph the Apple and\nGoogle returns on the same axes and then use the Excel Trendline facility to\nregress the returns of GOOG on those of AAPL. (The use of Excel \u2019 s T rendline\nfunction\u2014used to calculate the regression equation\u2014is explained in Chapter\n33.) You can confi rm from the previous calculations that the regression R 2 is\nthe correlation squared:\nGraphing GOOG (y-axis) against AAPL (x-axis) and using\nTrendline\nNote that R2= correla(cid:2)on2\n20%\n10%\n0%\n-42% -32% -22% -12% -2% 8% 18%\n-10%\n-20%\ny = 0.1594x -0.0066\nR\u00b2 = 0.0312\n-30%"
        ],
        "8.3": [
            "What is the process of calculating portfolio means and variances?\nWhat does the mean return of the portfolio represent?\nWhat is the significance of the proportion invested in a certain stock in portfolio calculation?\nHow do variances of different assets in a portfolio affect the variance of the portfolio?\nWhat is the role of covariance in calculating the variance of a portfolio?\nHow do the mean returns of individual assets impact the mean return of the portfolio?\nWhy is the portfolio's variance not the average of the variances of the stocks?\nWhy are the means and standard deviations plotted for various portfolio proportions?\nHow is Excel's Data|What-If|DataTable command used in this calculation?\nWhat does it mean that the portfolio mean return is the weighted average return of the component stocks?\nHow are the mean return, variance, and standard deviation of a portfolio calculated?\nWhat is the equation used to define the expected portfolio return?\nWhat is the significance of the standard deviation in the portfolio's variance calculation? \nHow do we account for the proportion of investments in individual stocks when computing portfolio standard deviation?\nWhat is the purpose of calculating portfolio return variance and standard deviation?\nWhat does a portfolio's mean return, return variance and return standard deviation signify in portfolio modeling?",
            "8.3 Calculating Portfolio Means and Variances\n\nIn this section we show how to do the basic calculations for a portfolio \u2019 s mean\nand variance. Suppose we form a portfolio invested equally in AAPL and\nGOOG. What will be the mean and the variance of this portfolio? It is worth\n203 Portfolio Models\u2014Introduction\nA B C D E\nCALCULATING THE MEAN AND STANDARD DEVIATION\n1 OF A PORTFOLIO\n2 Proportion of AAPL 0.5\n3 Proportion of GOOG 0.5<-- =1-B2\n4\nAAPL GOOG Portfolio\n5 return return return\n6 2-Jul-07 7.66% 10.74% 9.20%<-- =$B$2*B6+$B$3*C6\n7 1-Aug-07 4.97% -7.47% -1.25%<-- =$B$2*B7+$B$3*C7\n8 4-Sep-07 10.28% -1.13% 4.57%<-- =$B$2*B8+$B$3*C8\n9 1-Oct-07 21.33% -14.03% 3.65%\n10 1-Nov-07 -4.15% 4.91% 0.38%\n11 3-Dec-07 8.35% 10.97% 9.66%\n12 2-Jan-08 -38.07% -17.58% -27.83%\n13 1-Feb-08 -7.95% 4.37% -1.79%\n14 3-Mar-08 13.79% 2.81% 8.30%\n15 1-Apr-08 19.24% 7.55% 13.40%\n16 1-May-08 8.17% 4.44% 6.30%\n17 2-Jun-08 -11.98% -2.15% -7.06%\nComputing the statistics for this example:\nG H I J\n5 Asset returns AAPL GOOG\n6 Mean return 2.61% -0.24%<-- =AVERAGE(C6:C65)\n7 Variance 0.0125 0.0102<-- =VAR.S(C6:C65)\n8 Standard deviation 11.17% 10.09%<-- =STDEV.S(C6:C65)\n9 Covariance 0.0020<-- =COVARIANCE.S(B6:B65,C6:C65)\n10\n11 Portfolio mean return\n12 1.18%<-- =AVERAGE(D6:D65)\n13 1.18%<-- =B2*H6+B3*I6\n14 Portfolio return variance\n15 0.0067<-- =VAR.S(D6:D65)\n16 0.0067<-- =B2^2*H7+B3^2*I7+2*B2*B3*H9\n17 Portfolio return standard deviation\n18 0.0816<-- =SQRT(H16)\n204 Chapter 8\nT he mean portfolio return is exactly the average of the mean returns of the\ntwo assets:\nExpected portfolioreturn=E(r )=0.5E(r )+0.5E(r )\np AAPL GOOG\nIn general the mean return of the portfolio is the w eighted average return of\nthe component stocks. If we denote by x the proportion invested in AAPL and\n1 \u2212 x the proportion invested in stock GOOG, then the expected portfolio\nreturn is given by:\nE (r )=xE(r )+(1\u2212x)E(r )\np AAPL GOOG\nH owever, the portfolio\u2019 s variance is not the average of the two variances of\nthe stocks! The formula for the variance is\nV ar(r )=x2Var(r )+( 1\u2212x)2Var(r )+2x( 1\u2212x) Cov(r ,r )\np AAPL GOOG AAPL GOOOG\nAnother way of writing this is\n\u03c3 2 =x2\u03c32 +( 1\u2212x)2\u03c32 +2x( 1\u2212x)\u03c1 \u03c3 \u03c3\np AAPL GOOG AAPL,GOOG AAPL GOOG\nA frequently performed exercise is to plot the means and standard deviations\nfor various portfolio proportions x . To do this we build a table using Excel \u2019 s\nData|What-If|DataTable command (see Chapter 31); cells B16 and C16\ncontain the data table\u2019 s header, which refers to cells B11 and B10,\n205 Portfolio Models\u2014Introduction\nA B C D E F G H I J\n1 CALCULATING THE MEAN AND STANDARD DEVIATION OF A PORTFOLIO\n2 Asset returns AAPL GOOG\n3 Mean return 2.61% -0.24%\n4 Variance 0.0125 0.0102\n5 Standard deviation 11.17% 10.09%\n6 Covariance 0.0020\n7\n8 Proportion of AAPL 0.5\n9\n10 Portfolio mean return 1.18%<-- =B8*B3+(1-B8)*C3\n11 Portfolio return variance 0.0067<-- =B8^2*B4+(1-B8)^2*C4+2*B8*(1-B8)*B6\n12 Portfolio return standard deviation 8.16%<-- =SQRT(B11)\n13\n14 Data table\u2014varying the proportion of AAPL\nPortfolio Portfolio\nstandard mean\n15 deviation return\n16 Proportion of AAPL 8.16% 1.18%<-- =B10, table header\n17 -0.5 15.18% -1.67%\n18 -0.4 14.04% -1.38%\n19 -0.3 12.95% -1.10%\n20 -0.2 11.91% -0.81% 5%\n21 -0.1 10.95% -0.53%\n4% 22 0 10.09% -0.24%\n23 0.1 9.34% 0.04% 3%\n24 0.2 8.75% 0.33%\n2%\n25 0.3 8.33% 0.61%\n26 0.4 8.13% 0.90% 1%\n27 0.5 8.16% 1.18%\n0%\n28 0.6 8.41% 1.47%\n0% 2% 4% 6% 8% 10% 12% 14% 16% 18%\n29 0.7 8.87% 1.75% -1%\n30 0.8 9.50% 2.04%\n-2%\n31 0.9 10.28% 2.32% 32 1 11.17% 2.61%\n33 1.1 12.15% 2.89%\n34 1.2 13.20% 3.18%\n35 1.3 14.30% 3.46%\n36 1.4 15.45% 3.75%\n37 1.5 16.62% 4.04%\n)pr(E\nnruter\nnaem\noilo(cid:3)roP\nPor(cid:3)olio E(r ) and s\np p\nPor(cid:3)olio standard devia(cid:2)on s p"
        ],
        "8.4": [
            "What is the portfolio mean in the context of financial modeling? \nWhat does the variance refer to when discussing a portfolio composed of multiple assets? \nCan you explain how matrix notation is used to simplify the calculation of portfolio means and variances?\nHow is the proportion of an asset in a portfolio represented? \nWhat does it indicate when the proportion value for a specific asset is positive or negative in the portfolio? \nWhat does a short sale indicate in portfolio management? \nWhat is the expected return of a portfolio? \nHow can the expected return of a portfolio be represented in matrix notation? \nWhat factors are considered while calculating the variance of a portfolio? \nWhat is a variance-covariance matrix and how is it used in portfolio variance calculation? \nHow is the covariance between two portfolios calculated? \nWhat is the role of an array function in determining the portfolio statistics? \nHow can one calculate the standard deviation and return of combinations of portfolios? \nWhat is the significance of the Correlation \u03c1 in a portfolio? \nHow can the returns of combinations of portfolios be calculated using excel? \nIn the context of portfolio management, what is the meaning of portfolio optimization?\nWhat does the Excel array function MMult stand for and how is it used in financial modeling? \nWhat are the short-sale restrictions in portfolio optimization? \nCan you explain the meaning and importance of portfolio calculations using matrices with an example? \nHow to implement portfolio variance in Excel for large portfolios?\nWhy is it crucial to calculate the means, variances, and covariance of the returns of portfolios in portfolio management? \nWhat is the role of Transpose in the context of Excel functions for financial modeling? \nHow is portfolio standard deviation calculated using Excel?",
            "8.4 Portfolio Mean and Variance\u2014Case of N Assets\n\nIn the previous sections we discussed the computation of a portfolio \u2019 s mean,\nvariance, and standard deviation for the case wherein the portfolio is composed\nof only two assets. In this section we extend this discussion to portfolios of\nmore than two assets. For this case, matrix notation greatly simplifi es the\nwriting of the portfolio problem. 3 In the general case of N assets, suppose that\nthe proportion of asset i in the portfolio is denoted by x . We require that\ni\n\u2211 x =1 , but we place no restrictions on the signs of the x ; if x > 0, this\ni i i\ni\n3. Chapter 32 gives an introduction to matrices suffi cient to deal with all the problems encoun-\ntered in this book. The Excel matrix functions M Mult and MInverse used in portfolio problems\n206 Chapter 8\nindicates a purchase of asset i and if x < 0, this indicates a short sale.4 We\ni\nusually write the portfolio composition x and the vector of means E ( r ) as\ncolumn vectors (we make no pretense at consistency\u2014when convenient we\nwill write these as row vectors):\n\u23a1x \u23a4 \u23a1E(r)\u23a4\n1 1\n\u23a2 \u23a5 \u23a2 \u23a5\nx E(r )\n\u23a2 2\u23a5 \u23a2 2 \u23a5\nx=\u23a2x \u23a5 E(r)=\u23a2E(r )\u23a5\n\u23a2 3\u23a5 \u23a2\u23a2 3 \u23a5\n(cid:2) (cid:2)\n\u23a2 \u23a5 \u23a2 \u23a5\n\u23a3\u23a2\nx\n\u23a6\u23a5 \u23a2\u23a3E(r )\u23a6\u23a5\nN N\nWe may then write x T and E ( r ) T as the transpose of these two vectors:\nxT =[ x,x ,\u2026,x ] , E( r)T =[ E( r ) ,E( r ) ,\u2026,E( r )]\n1 2 N 1 2 N\nT he expected return of the portfolio whose proportions are given by X is\nthe weighted average of the expected returns of the individual assets:\nE(r\n)=\u2211N\nxE(r)\nx i i\ni=1\nwhich, in matrix notation, can be written as:\nE(\nr\n)=\u2211N xE( r)=xTE( r)=E( r)Tx\np i i\ni=1\nThe portfolio \u2019 s variance is given by\nVar(r\n)=\u2211N (\nx\n)2Var( r)+2\u2211N \u2211N xxCov( r,r)\nX i i i j i j\ni=1 i=1j=i+1\nThis looks bad, but it is really a straightforward extension of the expression\nfor the variance of a portfolio of two assets which we had before: Each asset\u2019 s\nvariance appears once, multiplied by the square of the asset\u2019 s proportion in\nthe portfolio; the covariance of each pair of assets appears once, multiplied by\ntwice the product of the individual assets\u2019 proportions. Another way of writing\nthe variance is to use the notation\nVar( r)=\u03c3, Cov( r,r)=\u03c3\ni ii i j ij\n4 . I n Chapter 12 we discuss portfolio optimization when there are short-sale restrictions. In the\n207 Portfolio Models\u2014Introduction\nIn this case the variance of portfolio x is:\nVar( r )=\u2211\u2211 xx\u03c3\nX i j ij\ni j\nT he most economical representation of the portfolio variance uses matrix\nnotation. It is also the easiest representation to implement for large portfolios\nin Excel. In this representation we call the matrix that has \u03c3 in the i th row\nij\nand the j th column the variance-covariance matrix :\n\u23a1\u03c3 \u03c3 \u03c3 (cid:3) \u03c3 \u23a4\n11 12 13 1N\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c3 (cid:3) \u03c3\n\u23a2\u23a2 21 22 23 2N\u23a5\nS=\u23a2\u03c3 \u03c3 \u03c3 (cid:3) \u03c3 \u23a5\n\u23a2 31 32 33 3N\u23a5\n(cid:2)\n\u23a2 \u23a5\n\u23a2\u23a3\u03c3 \u03c3 \u03c3 (cid:3) \u03c3 \u23a6\u23a5\nN1 N2 N3 NN\nThen the portfolio variance is given by Var ( r ) = xT Sx . In Excel formulas, this\np\nis written as the array function m mult(mmult(transpose(x),S),x) .5\nComputing the Covariance Between Two Portfolios\nI f we have two portfolios represented as row vectors, x = [ x , x , \u2026 , x ] and\n1 2 N\ny = [ y , y , \u2026 , y ], then the covariance of the two portfolios is given by\n1 2 N\nCov ( x , y ) = xSyT = ySTx . In Excel formulas this is the array function MMult\n(MMult(x,S),Transpose(y)) .\nPortfolio Calculations Using Matrices\u2014An Example\nW e implement the above formulas in a numerical example. Suppose that\nthere are four risky assets which have the following expected returns and\nvariance-covariance matrix:\nA B C D E F\n1 A FOUR-ASSET PORTFOLIO PROBLEM\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.20 0.50 15%\n5 . A rray functions are discussed in Chapter 34. The many examples below illustrate their use for\n208 Chapter 8\nWe consider two portfolios of risky assets:\nA B C D E\n8 Portfolio x 0.20 0.30 0.40 0.10\n9 Portfolio y 0.20 0.10 0.10 0.60\nWe calculate the means, variances, and covariance of the two portfolios.\nWe use the Excel array function MMult for the matrix multiplications\nand the array function T ranspose to make a row vector into a column\nvector.6\nA B C D E F G\n1 A FOUR-ASSET PORTFOLIO PROBLEM\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Portfolio x 0.20 0.30 0.40 0.10\n9 Portfolio y 0.20 0.10 0.10 0.60\n10\n11 Portfolio x and y statistics: Mean, variance, covariance, correlation\n12 Mean, E(r) 9.10% Mean, E(r) 12.00%<-- {=MMULT(B9:E9,F3:F6)}\nx y\n13 Variance \u03c3 x2 0.1216 Variance \u03c3 y2 0.2034<--\n14 Covariance(x,y) 0.0714 {=MMULT(MMULT(B9:E9,A3:\n15 Correlation \u03c1 0.4540<-- =B14/SQRT(B13*E13) D6),TRANSPOSE(B9:E9))}\nxy\nWe can now calculate the standard deviation and return of combinations of\nportfolios x and y . Note that once we have calculated the means, variances,\nand the covariance of the returns of the two portfolios, the calculation\nof the mean and the variance of any portfolio is the same as for the two-\nasset case.7\n6. Remember from Chapter 34 that MMult and T ranspose are array functions and must be\nentered by pressing [Ctrl] + [Shift] + [Enter] simultaneously.\n7 . T his sentence is critical. As we shall see in the next chapter, all portfolio problems of N assets\n209 Portfolio Models\u2014Introduction\nA B C D E F G\n1 A FOUR-ASSET PORTFOLIO PROBLEM\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Portfolio x 0.20 0.30 0.40 0.10\n9 Portfolio y 0.20 0.10 0.10 0.60\n10\n11 Portfolio x and y statistics: Mean, variance, covariance, correlation\n12 Mean, E(r) 9.10% Mean, E(r) 12.00%<-- {=MMULT(B9:E9,F3:F6)}\nx y\n13 Variance \u03c3 x2 0.1216 Variance \u03c3 y2 0.2034<--\n14 Covariance(x,y) 0.0714 {=MMULT(MMULT(B9:E9,A3:\n15 Correlation \u03c1 0.4540<-- =B14/SQRT(B13*E13) D6),TRANSPOSE(B9:E9))}\nxy\n16\n17 Calculating returns of combinations of Portfolio x and Portfolio y\n18 Proportion of x 0.3\nMean portfolio\n19 return, E(r) 11.13%<-- =B18*B12+(1-B18)*E12\np\nPortfolio\n20 variance \u03c32 0.1406<-- =B18^2*B13+(1-B18)^2*E13+2*B18*(1-B18)*B14\np\nPortfolio\nstandard\n21 deviation \u03c3 37.50%<-- =SQRT(B20)\np\n22\n23 Table of returns (using Data Table)\nStandard\n24 Proportion of x deviation Mean\n25 37.50% 11.13%\n26 -0.5 61.72% 13.45%\n14%\n27 -0.4 58.15% 13.16%\n28 -0.3 54.68% 12.87% 13%\n29 -0.2 51.33% 12.58%\n12%\n30 -0.1 48.13% 12.29%\n31 0.0 45.10% 12.00% 11%\n32 0.1 42.29% 11.71%\n10%\n33 0.2 39.74% 11.42%\n34 0.3 37.50% 11.13% 9%\n35 0.4 35.63% 10.84%\n8%\n36 0.5 34.20% 10.55%\n37 0.6 33.26% 10.26% 7%\n38 0.7 32.84% 9.97% 30% 35% 40% 45% 50% 55% 60% 65%\n39 0.8 32.99% 9.68%\n40 0.9 33.67% 9.39%\n41 1.0 34.87% 9.10%\n)r(E\nnruter\ndetcepxe\noilo(cid:3)roP\np\nPor(cid:3)olio Means and Returns\nPor(cid:3)olio standard devia(cid:2)on \u03c3\n210 Chapter 8"
        ],
        "8.5": [
            "What is an envelope portfolio in financial modeling?\nCan you define an efficient portfolio within the context of financial modeling?\nHow can we mathematically define an envelope portfolio?\nWhat is the role of expected return while defining an envelope portfolio?\nHow would you determine the variance of return for the envelope portfolio?\nCan you explain the concept of envelope set in portfolio theory?\nWhat is the efficient frontier in the context of portfolio theory?\nWhat does it mean when we say an envelope is a set of all convex combinations of any two envelope portfolios?\nCan you explain the procedure of calculating the whole envelope frontier given two envelope portfolios?\nWhat are the primary characteristics of efficient portfolios?\nHow does a convex combination of two efficient portfolios contribute to forming another efficient portfolio?\nWhat is the relation between mean and variance in efficient portfolios?\nCould you explain why a portfolio might not be on the envelope?\nWhat are the consequences if stocks fall outside the frontier created by combinations of portfolios? \nWhat methods are employed to compute efficient and envelope portfolios? \nWhat criteria should portfolios meet to be considered 'efficient' in financial modeling? \nWhat mathematical relationships hold between a portfolio's expected return, variance, covariance, and correlation?",
            "8.5 Envelope Portfolios\n\nAn envelope portfolio is the portfolio of risky assets that gives the lowest vari-\nance of return of all portfolios having the same expected return. An effi cient\nportfolio is the portfolio that gives the highest expected return of all portfolios\nhaving the same variance. Mathematically, we may defi ne an envelope port-\nfolio as follows: For a given return \u03bc = E ( r ) , an effi cient portfolio p = [ x , x ,\np 1 2\n\u2026 , x ] is one that solves\nN\nmin\u2211\u2211 xx\u03c3 =Var( r )\ni j ij p\ni j\nsubjectto\n\u2211\nxr\n=\u03bc=E(\nr\n)\ni i p\ni\n\u2211 x =1\ni\ni\nThe envelope is the set of all envelope portfolios, and the effi cient frontier is\nthe set of all effi cient portfolios.8 As shown by Black (1972), the envelope\nis the set of all convex combinations of any two envelope portfolios. 9 This\nmeans that if x = [x , x , \u2026 , x ] and y = [y , y , \u2026 , y ] are envelope portfolios\n1 2 N 1 2 N\nand if a is a constant, then the portfolio Z defi ned by\n\u23a1 ax +(1\u2212a)y \u23a4\n1 1\n\u23a2 \u23a5\nax +(1\u2212a)y\nz=ax+(1\u2212a)y=\u23a2 2 2 \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3ax +(1\u2212a)y \u23a6\nN N\ni s also an envelope portfolio. Thus, we can compute the whole envelope fron-\ntier if we can fi nd any two envelope portfolios.\n8. Chapter 9 discusses the difference between envelope and effi cient portfolios. In a word: The\neffi cient frontier is a subset of the envelope containing only the optimal portfolios.\n211 Portfolio Models\u2014Introduction\nB y this theorem, once we have found two effi cient portfolios x and y, we know\nthat any other effi cient portfolio is a convex combination of x and y . If we denote\nthe mean and variance of x and y by\n{ E(\nr\n) ,\u03c32}\nand\n{ E(\nr\n) ,\u03c32}\n,\nx x y y\nand if z = ax + (1\u2212 a ) y , then\nE(\nr\n)=aE(\nr\n)+(1\u2212a)E(\nr\n)\nz x y\n\u03c32 =a2\u03c32 +( 1\u2212a)2\u03c32 +2a( 1\u2212a) Cov( x,y)\nz x y\n==a2\u03c32 +( 1\u2212a)2\u03c32 +2a( 1\u2212a) xTSy\nx y\nFurther details of the calculation of effi cient portfolios are discussed in\nChapter 9.\nPortfolios x and y Are Not on the Envelope\nT o show that the concepts of envelope and effi cient portfolio is non-trivial, we\nshow that the two portfolios whose combinations are graphed in the previous\nexample are not either envelope or effi cient. This is easy to see if we extend\n212 Chapter 8\nA B C D E F G\n1 A FOUR-ASSET PORTFOLIO PROBLEM\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Portfolio x 0.20 0.30 0.40 0.10\n9 Portfolio y 0.20 0.10 0.10 0.60\n10\n11 Portfolio x and y statistics: Mean, variance, covariance, correlation\n12 Mean, E(r) 9.10% Mean, E(r) 12.00%<-- {=MMULT(B9:E9,F3:F6)}\nx y\n13 Variance \u03c3 x2 0.1216 Variance \u03c3 y2 0.2034<--\n14 Covariance(x,y) 0.0714 {=MMULT(MMULT(B9:E9,A3:D6),TRANSPOSE(B9:E\n15 Correlation \u03c1 0.4540<-- =B14/SQRT(B13*E13) 9))}\nxy\n16\n17 Calculating returns of combinations of Portfolio x and Portfolio y\n18 Proportion of x 0.3\nMean portfolio\n19 return, E(r) 11.13%<-- =B18*B12+(1-B18)*E12\np\nPortfolio\n20 variance \u03c32 0.1406<-- =B18^2*B13+(1-B18)^2*E13+2*B18*(1-B18)*B14\np\nPortfolio\nstandard\n21 deviation \u03c3 37.50%<-- =SQRT(B20)\np\n22\n23 Table of returns (using Data Table)\nStandard\n24 Proportion of x deviation Mean\n25 37.50% 11.13%\n26 -1.0 80.60% 14.90%\n27 -0.8 72.88% 14.32% 17%\n28 -0.6 65.38% 13.74%\n29 -0.4 58.15% 13.16% 15%\n30 -0.2 51.33% 12.58%\n31 0.0 45.10% 12.00% 13%\n32 0.2 39.74% 11.42%\n33 0.4 35.63% 10.84% 11%\n34 0.6 33.26% 10.26%\n35 0.8 32.99% 9.68% 9%\n36 1.0 34.87% 9.10%\n37 1.2 38.60% 8.52% 7%\n38 1.4 43.69% 7.94%\n39 1.6 49.74% 7.36% 5%\n40 1.8 56.44% 6.78% 30% 35% 40% 45% 50% 55% 60% 65% 70% 75% 80% 85%\n41 2.0 63.58% 6.20% 42 2.2 71.02% 5.62%\n43 2.4 78.69% 5.04%\n44 2.6 86.53% 4.46%\n45 2.7 90.49% 4.17%\n46 Stock1 31.62% 6.00%\n47 Stock2 54.77% 8.00%\n48 Stock3 63.25% 10.00%\n49 Stock4 70.71% 15.00%\n)pr(E\nnruter\ndetcepxe\noilo(cid:414)roP\nPor(cid:414)olio Means and Returns\nStock 4\nStock3\nStock2\nStock 1\n213 Portfolio Models\u2014Introduction\nWere the two portfolios on the envelope, then all of the individual stocks\nwould fall on or inside the curved line in the graph. In our case, two of the\nstock returns (stock 1 and stock 4) fall outside the frontier created by combina-\ntions of portfolios x and y . Thus x and y cannot be effi cient portfolios. In\nChapter 9 you will learn to compute effi cient and envelope portfolios, and as\nyou will see there, this requires considerably more computation."
        ],
        "8.6": [
            "What are the basic concepts of portfolios?\nWhat is the importance of the variance-covariance matrix in financial modeling?\nHow does one compute the variance-covariance matrix from asset returns?\nWhat are efficient portfolios in financial modeling?\nHow are efficient portfolios calculated in the context of financial modeling?\nWhat is the role of mathematics in portfolio models?\nWhat does it mean to compute the variance-covariance matrix? \nCan efficient portfolios be computed from asset returns? If so, how?\nWhat is the significance of the variance-covariance matrix in portfolio models? \nWhat mathematical concepts are relevant to the study of portfolio models?",
            "8.6 Summary\n\nIn this chapter we have reviewed the basic concepts and mathematics of\nportfolios. In succeeding chapters we shall describe how to compute the\nvariance-covariance matrix from asset returns and how to calculate effi cient\nportfolios."
        ]
    },
    "9": {
        "9.1": [
            "What is the classical capital asset pricing model (CAPM)?\nWhat are the two versions of CAPM?\nWhat is the Sharp-Lintner-Mossin model?\nWhat is Black's zero-beta CAPM?\nWhy is it beneficial to use a spreadsheet for CAPM calculations?\nWhat are efficient portfolios?\nWhat steps involve in the calculation of efficient portfolios?\nCan you explain the efficient frontier and how to calculate it?\nWhat theoretical material is required for understanding efficient portfolios?\nWhat is the Security Market Line (SML)?\nWhy might the variance-covariance matrix be given?\nWhat is the importance of the variance-covariance matrix in financial modeling?\nWhat is meant by the assumption of a risk-free asset?\nWhy do we delay the discussion of various methods of computing the variance-covariance matrix until Chapter 10?\nWhat are some of the major results of this chapter about CAPM?",
            "9.1 Overview\n\nThis chapter covers the theory and calculations necessary for both versions of\nthe classical capital asset pricing model (CAPM)\u2014both that which is based\non a risk-free asset (also known as the Sharp-Lintner-Mossin model) and\nBlack \u2019 s (1972) zero-beta CAPM (which does not require the assumption of a\nrisk-free asset). You will fi nd that using a spreadsheet enables you to do the\nnecessary calculations easily.\nT he structure of the chapter is as follows: We begin with some preliminary\ndefi nitions and notation. We then state the major results (proofs are given in\nthe appendix to the chapter). In succeeding sections we implement these\nresults, showing you:\n\u2022 How to calculate effi cient portfolios.\n\u2022 How to calculate the effi cient frontier.\nThis chapter includes more theoretical material than most chapters in this\nbook: Section 9.2 contains the propositions on portfolios which underlie the\ncalculations of both effi cient portfolios and the security market line (SML) in\nChapter 11. If you fi nd the theoretical material in section 9.2 diffi cult, skip it\nat fi rst and try to follow the illustrative calculations in section 9.3. This\nchapter assumes that the variance-covariance matrix is given; we delay a dis-\ncussion of various methods of computing the variance-covariance matrix until\nChapter 10."
        ],
        "9.2": [
            "What is the definition of risky assets in the context of financial modeling?\nWhat does the matrix E(r) represent?\nWhat does the matrix S represent in the context of financial modeling?\nWhat is a portfolio in financial modeling?\nWhat does the column vector x represent in the context of financial modeling?\nHow is the expected portfolio return calculated?\nWhat is the definition of variance in the context of portfolio return?\nWhat is the definition of covariance in the context of portfolio return?\nWhat does it mean for a portfolio to be feasible?\nWhat is the feasible set in financial modeling?\nCan you define what it means for a portfolio to be on the envelope of the feasible set?\nWhat does it mean for a portfolio to be efficient?\nWhat is the definition of the efficient frontier?\nWhat is the significance of the efficient frontier in financial modeling?\nWhat is meant by portfolio variance or standard deviation in portfolio selection?\nWhat is the difference between E ( R )y and E ( R )x?\nWhat does \u2211N x i mean in the context of portfolio calculations?\nWhat is the significance of a column vector whose coordinates sum to 1 in financial modeling?\nWhat is expected return in the context of financial modeling?\nWhat is the significance of \u03c3 xx in portfolio return calculations?",
            "9.2 Some Preliminary Defi nitions and Notation\n\nT hroughout this chapter we use the following notation: There are N risky\nassets, each of which has expected return E ( r ). The matrix E ( r ) is the column\ni\nvector of expected returns of these assets:\n\u23a1E(r)\u23a4\n1\n\u23a2 \u23a5\nE(r )\nE( r)=\u23a2 2 \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3E(r )\u23a6\n222 Chapter 9\nand S is the N \u00d7 N variance-covariance matrix:\n\u23a1\u03c3 \u03c3 (cid:3) \u03c3 \u23a4\n11 21 N1\n\u23a2 \u23a5\n\u03c3 \u03c3 (cid:3) \u03c3\nS=\u23a2 12 22 N2\u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3\u03c3 \u03c3 (cid:3) \u03c3 \u23a6\n1N 2N NN\nA portfolio of risky assets (when our intention is clear, we shall just use the\nword portfolio ) is a column vector x whose coordinates sum to 1:\n\u23a1x \u23a4\n1\n\u23a2 \u23a5\nx=\u23a2x\n2\u23a5 ,\n\u2211N\nx =1\n\u23a2 (cid:2) \u23a5 i\n\u23a2 \u23a5\ni=1\n\u23a3x \u23a6\nN\nE ach coordinate x represents the proportion of the portfolio invested in risky\ni\nasset i .\nThe expected portfolio return E ( r ) of a portfolio x is given by the product\nx\nof x and R :\nE(\nr\nx)=xT\u22c5R\u2261\u2211N\nx\niE(\nr\ni)\n.\ni=1\nThe variance of portfolio x \u2019 s return , \u03c32 \u2261\u03c3 , is given by the product\nx xx\nxTSx=\u2211N \u2211N\nxx\u03c3 .\ni j ij\ni=1 j=1\nThe covariance between the return of two portfolios x and y , Cov ( r ,ry ), is\nx\ndefi ned by the product \u03c3\n=xTSy=\u2211N \u2211N\nxy\u03c3 . Note that \u03c3 = \u03c3 .\nxy i j ij xy yx\ni=1 j=1\nT he following graph illustrates four concepts. A feasible portfolio is any\nportfolio whose proportions sum to 1. The feasible set is the set of portfolio\nmeans and standard deviations generated by the feasible portfolios; this fea-\nsible set is the area inside and to the right of the curved line. A feasible port-\nfolio is on the e nvelope of the feasible set if for a given mean return it has\nminimum variance. Finally, a portfolio x is a n effi cient portfolio if it maximizes\nthe return given the portfolio variance (or standard deviation). That is: x is\neffi cient if there is no other portfolio y such that E ( R ) > E ( R ) and \u03c3 < \u03c3 .\ny x y x\nThe set of all effi cient portfolios is called the effi cient frontier ; this frontier is\n223 Calculating Effi cient Portfolios"
        ],
        "9.3": [
            "What are the five propositions related to efficient portfolios and the CAPM?\nWhat does the notation E(r) - c stand for in financial modelling?\nWhat does the envelope of the feasible portfolio signify?\nWhat is the significance of the constant c in portfolio calculations?\nHow is the vector z used in finding efficient portfolio x?\nWhat does it mean by all envelope portfolios are of the similar form?\nHow is \"Black's zero-beta CAPM\" different from the usual CAPM?\nWhat does the term \"Sharpe-Lintner-Mossin security market line (SML)\" mean?\nHow is Cov(x,y) used in the calculation of efficient portfolios?\nWhat does Propostion 3 state about envelope portfolio and its relation with other portfolios?\nWhat is the \"Black's 1972 paper\" known for in terms of Financial Modelling?\nWhat does Proposition 4 suggest about the existence of a portfolio y?\nWhat is the significance of SML relationship according to propositions 3 and 4?\nWhy is it important to test whether the true market portfolio is mean-variance efficient?\nWhat is the concept of a \"Market portfolio\" in Financial Modeling?\nHow are the weights for market portfolio calculated?\nWhat would it mean if the market portfolio M is efficient?\nWhat would it signify if the SML holds with E(r) substituted for c?\nWhat is the classic capital asset pricing model?\nWhat happens when there exists a risk-free asset with return rf according to Proposition 5?\nHow is the market portfolio denoted as M in terms of Sharpe, Lintner and Mossin's papers?\nWhat is the role of beta in establishing the entire envelope of efficient portfolios? \nHow does the capital asset pricing model consider the risk-free asset?\nWhat does Proposition 2 state about envelope portfolios and their establishment?\nHow do you calculate Cov(x,y) as used in the propositions?\nWhat does the term \"Black's zero-beta CAPM\" propose in relation to risk-free asset?",
            "9.3 Five Propositions on Effi cient Portfolios and the CAPM\n\nI n the appendix to this chapter we prove the following results, which are basic\nto the calculations of the CAPM. All of these propositions are used in deriving\nthe effi cient frontier and the security market line; numerical illustrations are\ngiven in the next section and in succeeding chapters.\nP ROPOSITION 1 Let c be a constant. We use the notation E ( r ) \u2212 c to denote\nthe following column vector:\n\u23a1E(\nr\n)\u2212c\u23a4\n1\n\u23a2 E(\nr\n)\u2212c\u23a5\nE( r)\u2212c=\u23a2 2 \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3E(\nr\n)\u2212c\u23a6\nN\nL et the vector z solve the system of simultaneous linear equations E ( r ) \u2013 c =\nSz. Then this solution produces a portfolio x on the envelope of the feasible\n224 Chapter 9\nz=S\u22121{ E( r)\u2212c}\nx={ x,\u2026,x } ,\n1 N\nwhere\nz\nx = i\ni \u2211N\nz\nj\nj=1\nFurthermore, all envelope portfolios are of this form.\nIntuition A formal proof of the proposition is given in the appendix to this\nchapter, but the intuition is simple and geometric. Suppose we pick a constant\nc and we try to fi nd an effi cient portfolio x for which there is a tangency\nbetween c and the feasible set:\nFinding Envelope Portfolios\nPortfolio standard deviation\nnruter\nnaem\noiloftroP\nx, the tangency\nportfolio given c\nc\nProposition 1 gives a procedure for fi nding x; furthermore, the proposition\nstates that all envelope portfolios (in particular, all effi cient portfolios) are the\nresult of the procedure outlined in the proposition. That is, if x is any envelope\nportfolio, then there exists a constant c and a vector z such that Sz = E ( r ) \u2013 c\nand x=z \u2211 z .\ni\ni\nP ROPOSITION 2 By a theorem fi rst proved by Black (1972), any two envelope\nportfolios are enough to establish the whole envelope. Given any two envelope\nportfolios x = { x , \u2026 , x } and y = { y , \u2026 , y } , all envelope portfolios are\n225 Calculating Effi cient Portfolios\nconvex combinations of x and y. This means that given any constant a , the\nportfolio\n\u23a1 ax +(1\u2212a)y \u23a4\n1 1\n\u23a2 \u23a5\nax +(1\u2212a)y\nax+(1\u2212a)y=\u23a2 2 2 \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3ax +(1\u2212a)y \u23a6\nN N\nis an envelope portfolio.\nP ROPOSITION 3 If y is any envelope portfolio, then for any other portfolio\n(envelope or not) x , we have the relationship:\nE(\nr\n)=c+\u03b2[ E(\nr\n)\u2212c]\nx x y\nwhere\nCov(x,y)\n\u03b2 =\nx \u03c32\ny\nFurthermore, c is the expected return of all portfolios z whose covariance with\ny is zero:\nc=E(\nr\n) ,whereCov( y,z)=0\nz\nNotes If y is on the envelope, the regression of any and all portfolios x on y\ngives a linear relationship. In this version of the CAPM (usually known as\n\u201cBlack \u2019 s zero-beta CAPM,\u201d in honor of Fischer Black, whose 1972 paper\nproved this result) the Sharpe-Lintner-Mossin security market line (SML) is\nreplaced with an SML in which the role of the risk-free asset is played by a\nportfolio with a zero beta with respect to the particular envelope portfolio y .\nNote that this result is true for any envelope portfolio y .\nThe converse of Proposition 3 is also true:\nP ROPOSITION 4 Suppose that there exists a portfolio y such that for any port-\nfolio x the following relation holds:\nE(\nr\n)=c+\u03b2[ E(\nr\n)\u2212c]\nx x y\nwhere\nCov(x,y)\n\u03b2 =\nx \u03c32\n226 Chapter 9\nThen the portfolio y is an envelope portfolio.\nP ropositions 3 and 4 show that a n SML relation holds if and only if we\nregress all portfolio returns on an envelope portfolio with an R 2 = 100%. As\nRoll (1977, 1978) has forcefully pointed out, these propositions show that it\nis not enough to run a test of the CAPM by showing that the SML holds. 1 The\nonly real test of the CAPM is whether the true market portfolio is mean-\nvariance effi cient . We shall return to this topic in Chapter 10.\nT HE MARKET PORTFOLIO The market portfolio M is a portfolio composed of\nall the risky assets in the economy, with each asset taken in proportion to its\nvalue. To make this more specifi c: Suppose that there are N risky assets and\nthat the market value of asset i is V . Then the market portfolio has the follow-\ni\ning weights:\nV\nProportionof assetiinM = i\n\u2211N\nV\nh\nh=1\nIf the market portfolio M is effi cient (this is a big \u201cif\u201d as we shall see in\nChapters 11 and 13, Proposition 3 is also true for the market portfolio. That\nis, the SML holds with E ( r ) substituted for c :\nz\nE(\nr\n)=E(r)+\u03b2[ E(\nr\n)\u2212E(r)]\nx z x M z\nwhere\n( )\n\u03b2 =Cov x,M and Cov( z,M)=00\nx \u03c32\nM\nThis version of the SML has received the most empirical attention of all of\nthe CAPM results. In Chapter 11 we show how to calculate \u03b2 and how to\ncalculate the SML; we go on to examine Roll\u2019 s criticism of these empirical\ntests. From the following graph, it is easy to see how to locate a zero-beta\nportfolio on the envelope of the feasible set:\n1. Roll \u2019 s 1977 paper is more often cited and more comprehensive, but his 1978 paper is much\n227 Calculating Effi cient Portfolios\nFinding Envelope Portfolios\nPortfolio standard deviation\nWhen there is a risk-free asset, Proposition 3 specializes to the security\nmarket line of the classic capital asset pricing model:\nP ROPOSITION 5 I f there exists a risk-free asset with return r f, then there exists\nan envelope portfolio M such that:\nE(\nr\n)=r +\u03b2[ E(\nr\n)\u2212r ]\nx f x M f\nwhere\nCov(x,M)\n\u03b2 =\nx \u03c32\nM\nA s shown in the classic papers by Sharpe (1964), Lintner (1965), and\nMossin (1966), if all investors choose their portfolios only on the basis of\nportfolio mean and standard deviation, then the portfolio x of Proposition 5 is\nthe market portfolio M .\nI n the remainder of this chapter, we explore the meaning of these proposi-\ntions using numerical examples worked out on Excel."
        ],
        "9.4": [
            "What is the efficient frontier in financial modeling?\nWhat are the risky assets when calculating the efficient frontier?\nWhat is the role of expected returns and variance-covariance matrix in financial modeling?\nHow are portfolios calculated on the envelope of the feasible set? \nWhat does it mean to identify the whole efficient frontier?\nHow can different values for 'c' help to identify efficient portfolios?\nWhat is the role of arbitrary 'c' values in solving for efficient portfolio?\nWhat is computed to find the means, standard deviations, and covariance of returns for portfolios?\nWhat is a variance-covariance matrix and how is it used in financial modeling?\nWhat is a tangent portfolio in financial modeling?\nWhat does the SumProduct function do in Excel and how is it used in financial modeling?\nHow is the mean, variance, and covariance calculated in financial modeling? \nWhat does the array function Transpose do in Excel and how is it used in financial modeling?\nHow can one calculate the whole envelope of the feasible set in the context of efficient portfolios calculation?\nWhat are convex combinations in the context of efficient portfolios?\nWhat might be the result of proportions invested in different portfolios?\nHow is a single portfolio calculation performed in financial modeling?\nWhat is the relationship between convex combinations and efficient portfolios?\nHow can data tables be utilized in producing a graph of the frontier?\nCan a portfolio contain short positions? If yes, how does it affect the portfolio? \nHow can portfolios be marked using convex combinations in a financial model? \nBy what methods can the expected returns of the assets be identified in a variance-covariance matrix?\nWhat is the envelope portfolio and how is it calculated in financial modeling?\nWhat does it mean for a portfolio to be 'efficient' in the context of financial modeling? \nWhat is a zero-beta portfolio in financial modeling?",
            "9.4 Calculating the Effi cient Frontier: An Example\n\nI n this section we calculate the effi cient frontier using Excel. We consider a\nworld with four risky assets having the following expected returns and vari-\nance-covariance matrix:\nnruter\nnaem\noiloftroP\nx, the tangency\nportfolio given c\nc\nZero-beta portfolios\n228 Chapter 9\nA B C D E F G H\n1 CALCULATING THE FRONTIER\nMean E(r)\nVariance-covariance, S returns minus\n2 E(r) constant\n3 0.10 0.01 0.03 0.05 6% 2.00% <-- =F3-$B$8\n4 0.01 0.30 0.06 -0.04 8% 4.00%\n5 0.03 0.06 0.40 0.02 10% 6.00%\n6 0.05 -0.04 0.02 0.50 15% 11.00%\n7\n8 Constant, c 4.00%\nEach cell of the column vector labeled E (r) minus constant contains the mean\nreturn of the given asset minus the value of the constant c (in this case c =\n4%). We use this column in fi nding the second envelope portfolio below.\nWe separate our calculations into two parts: In the next subsection we cal-\nculate two portfolios on the envelope of the feasible set. In the subsequent\nsubsection we calculate the effi cient frontier.\nCalculating Two Envelope Portfolios\nB y Proposition 2, we have to fi nd two effi cient portfolios in order to identify\nthe whole effi cient frontier. By Proposition 1 each envelope portfolio solves\nthe system R \u2212 c = Sz fozr . T o identify two effi cient portfolios, we use two\ndifferent values for c . For each value of c , we solve for z and then set\nx =z \u2211 z to fi nd an effi cient portfolio.\ni i h\nh\nThe c \u2019 s we solve for are arbitrary (see section 9.6), but to make life easy,\nwe fi rst solve this system for c = 0. This gives the following results:\nA B C D E F G H\n10 Computing an envelope portfolio with constant = 0\nEnvelope\n11 z portfolio x\n12 0.3861 <-- {=MMULT(MINVERSE(A3:D6),F3:F6)} 0.3553 <-- =A12/SUM($A$12:$A$15)\n13 0.2567 0.2362\n14 0.1688 0.1553\n15 0.2752 0.2532\n229 Calculating Effi cient Portfolios\nThe formulas in the cells are:\n\u2022 For z we use the array function M Mult(MInverse(A3:D6),F3:F6) . The\nrange A3:D6 contains the variance-covariance matrix and the cells F3:F6\ncontain the expected returns of the assets.\n\u2022 For x : Each cell contains the associated value of z divided by the sum\nof all the z \u2019 s. Thus, for example, cell F12 contains the formula\n= A12/SUM($A$12:$A$15) .\nTo fi nd the second envelope portfolio we now solve this system for c = 0.04\n(cell B8).\nA B C D E F G H\n18 Computing an envelope portfolio with constant = 4.00%\nEnvelope\nz portfolio\n19 y\n20 0.0404 <-- {=MMULT(MINVERSE(A3:D6),G3:G6)} 0.0782 <-- =A20/SUM($A$20:$A$23)\n21 0.1386 0.2684\n22 0.1151 0.2227\n23 0.2224 0.4307\n24 Sum 1.0000 <-- =SUM(F20:F23)\nThe portfolio y in cells F20:F23 is, by the results of Proposition 1, an enve-\nlope portfolio. This vector z associated with y is calculated in a manner similar\nto that of the fi rst vector, except that the array function in the cells is\nMMult(MInverse(A3:D6),G3:G6), where G3:G6 contains the vector of\nexpected returns minus the constant 0.04.\nTo complete the basic calculations, we compute the means, standard devia-\ntions, and covariance of returns for portfolios x and y :\nA B C D E F G H I J K\n26 E(x) 9.37% E(y) 11.30%<-- {=MMULT(TRANSPOSE(F20:F23),F3:F6)}\n27 Var(x) 0.0862 Var(y) 0.1414<-- {=MMULT(MMULT(TRANSPOSE(F20:F23),A3:D6),F20:F23)}\n28 Sigma(x) 29.37% Sigma(y) 37.60%<-- =SQRT(F27)\n29\n30 Cov(x,y) 0.1040<-- {=MMULT(MMULT(TRANSPOSE(F12:F15),A3:D6),F20:F23)}\n230 Chapter 9\nThe transpose vectors of x and of y are inserted using the array\nfunction T ranspose (see Chapter 34 for a discussion of array functions).\nThis now enables us to calculate the mean, variance, and covariance as\nfollows:\nE(x) uses the array formula M Mult(transpose_x,means) . Note that\nwe could have also used the function S umProduct(x,means) .\nVar(x) uses the array formula MMult(MMult(transpose_x,\nvar_cov),x) .\nSigma(x) uses the formula Sqrt(var_x) .\nCov(x,y) uses the array formula MMult(MMult(transpose_x,var_\ncov),y) .\nCorr(x,y) uses the formula cov(x,y)/(sigma_x*sigma_y) .\nThe following spreadsheet illustrates everything that has been done in this\n231 Calculating Effi cient Portfolios\nA B C D E F G H\n1 CALCULATING THE FRONTIER\nMean E(r)\nVariance-covariance, S returns minus\n2 E(r) constant\n3 0.10 0.01 0.03 0.05 6% 2.00% <-- =F3-$B$8\n4 0.01 0.30 0.06 -0.04 8% 4.00%\n5 0.03 0.06 0.40 0.02 10% 6.00%\n6 0.05 -0.04 0.02 0.50 15% 11.00%\n7\n8 Constant, c 4.00%\n9\n10 Computing an envelope portfolio with constant = 0\nEnvelope\nz portfolio\n11 x\n12 0.3861 <-- {=MMULT(MINVERSE(A3:D6),F3:F6)} 0.3553 <-- =A12/SUM($A$12:$A$15)\n13 0.2567 0.2362\n14 0.1688 0.1553\n15 0.2752 0.2532\n16 Sum 1.0000 <-- =SUM(F12:F15)\n17\n18 Computing an envelope portfolio with constant = 4.00%\nEnvelope\nz portfolio\n19 y\n20 0.0404 <-- {=MMULT(MINVERSE(A3:D6),G3:G6)} 0.0782 <-- =A20/SUM($A$20:$A$23)\n21 0.1386 0.2684\n22 0.1151 0.2227\n23 0.2224 0.4307\n24 Sum 1.0000 <-- =SUM(F20:F23)\n25\n26 E(x) 9.37% E(y) 11.30% <-- {=MMULT(TRANSPOSE(F2\n27 Var(x) 0.0862 Var(y) 0.1414 <-- {=MMULT(MMULT(TRANSP\n28 Sigma(x) 29.37% Sigma(y) 37.60% <-- =SQRT(F27)\n29\n30 Cov(x,y) 0.1040 <-- {=MMULT(MMULT(TRANSPOSE(F12:F15),A3:D6),F20:F23)}\n31 Corr(x,y) 0.9419 <-- =B30/(B28*F28)\nCalculating the Envelope\nBy Proposition 2 of section 9.3, convex combinations of the two portfolios\ncalculated in the previous subsection allow us to calculate the whole envelope\nof the feasible set (which, of course, includes the effi cient frontier). Suppose\n232 Chapter 9\nproportion (1 \u2212 a) invested in y . Then\u2014as discussed in Chapter 8\u2014the mean\nand standard deviation of p \u2019 s return are:\nE(\nr\n)=aE(\nr\n)+( 1\u2212a) E(\nr\n)\np x y\n\u03c3 = a2\u03c32 +( 1\u2212a)2\u03c32 +2a( 1\u2212a) Cov(x,y)\np x y\nHere \u2019 s a sample calculation for our two portfolios:\nA B C D E F G\n34 A single portfolio calculation\n35 Proportion of 0.3\n36 E(r) 10.72%<-- =B35*B26+(1-B35)*F26\np\n37 \u03c32 0.1207<-- =B35^2*B27+(1-B35)^2*F27+2*B35*(1-B35)*B30\np\n38 \u03c3 34.75%<-- =SQRT(B37)\np\nW e can turn this calculation into a data table (see Chapter 31) to get the fol-\n233 Calculating Effi cient Portfolios\nA B C D E F G H I\n34 A single portfolio calculation\nProportion of\n35 x 0.3\n36 E(r) 10.72%<-- =B35*B26+(1-B35)*F26\np\n37 \u03c32 0.1207<-- =B35^2*B27+(1-B35)^2*F27+2*B35*(1-B35)*B30\np\n38 \u03c3 34.75%<-- =SQRT(B37)\np\n39\n40 Data table: We vary the proportion of x to produce a graph of the frontier\nProportion\n41 of x Sigma Return\n42 34.75% 10.72%<-- =B36, data table header\n43 -1.5 54.56% 14.20%\n44 -1.2 50.93% 13.62%\n16%\n45 -1.0 48.56% 13.23%\n46 -0.8 46.24% 12.85%\n47 -0.6 43.97% 12.46% 14%\n48 -0.4 41.77% 12.08%\n49 -0.2 39.64% 11.69% 12%\n50 0.0 37.60% 11.30%\n51 0.3 35.20% 10.82% 10%\n52 0.5 33.00% 10.34%\n53 0.8 31.04% 9.86% 8%\n54 0.8 30.68% 9.76%\n55 1.0 29.37% 9.37%\n6%\n56 1.2 28.27% 8.99%\n57 1.4 27.42% 8.60%\n4%\n58 1.6 26.83% 8.21%\n20% 25% 30% 35% 40% 45% 50% 55% 60%\n59 1.8 26.53% 7.83%\n60 2.0 26.52% 7.44%\n61 2.2 26.80% 7.06%\n62 2.4 27.37% 6.67%\n63 2.6 28.21% 6.28%\n64 2.8 29.30% 5.90%\n65 3.0 30.60% 5.51%\nThe two portfolios, x and y , whose convex combinations compose the enve-\nlope are marked. Also marked are other portfolios, some of which contain\nshort positions of either x or y . Note that the convex combinations all lie on\nthe envelope, but may not necessarily be effi cient. An example is the last point\nin the data table\u2014300% in x and \u22122 00% in portfolio y. Thus, while every\neffi cient portfolio is a convex combination of any two effi cient portfolios, it\nis not true that every convex combination of any two effi cient portfolios is\n234 Chapter 9"
        ],
        "9.5": [
            "What does the term 'Efficient Portfolios' mean in financial modeling?\nHow can we find efficient portfolios in one step?\nWhat is the role of Excel functions in calculating efficient portfolios?\nWhat are the components of an efficient portfolio?\nHow is the expected returns calculated in the example of efficient portfolio?\nWhat is the variance-covariance matrix in relation to efficient portfolios?\nWhy is the inverse of the variance-covariance matrix important in calculating efficient portfolios?\nWhat does the constant value in the efficient portfolio model represent?\nHow are array formulas used in calculating efficient portfolios?\nCan cell names be used for clarity when calculating efficient portfolios? How?\nWhat formula is used to calculate the envelope portfolio?\nHow is the formula for an envelope portfolio written in one cell?\nIn the efficient portfolio calculation, how is the SUM function used?\nHow is the denominator of the efficient portfolio expression calculated?\nWhat does the term 'Proposition 1 expression' refer to?\nWhy is the correct usage of array functions important in the calculation of the efficient portfolio?\nHow can we calculate the mean and sigma of a portfolio?\nWhat is the transpose function used for in financial modeling?\nWhat is the role of SUMPRODUCT function in finding the efficient portfolios?\nHow is MMULT function used in calculating efficient portfolios?",
            "9.5 Finding Effi cient Portfolios in One Step\n\nT he examples in section 9.4 fi nd effi cient portfolios by writing out most of\nthe components of the portfolio separately on the spreadsheet. However, for\nsome uses we will want to calculate the effi cient portfolio in one step. Here\u2019 s\nan example:\nA B C D E F G\n1 FINDING ENVELOPE PORTFOLIOS IN ONE STEP\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Constant 4%\n9\nEnvelope\n10 portfolio\n11 0.0782\n12 0.2684 <-- {=MMULT(MINVERSE(A3:D6),F3:F6-\n13 0.2227 B8)/SUM(MMULT(MINVERSE(A3:D6),F3:F6-B8))}\n14 0.4307\n15\nPortfolio\n16 mean 11.30%<-- =SUMPRODUCT(A11:A14,F3:F6)\nPortfolio\n17 sigma 37.60%<-- {=SQRT(MMULT(MMULT(TRANSPOSE(A11:A14),A3:D6),A11:A14))}\nT his approach requires a number of Excel tricks, most of which relate to\nthe correct use of array functions. The end result is that we can write the\nS\u22121{ E( r)\u2212c}\nProposition 1 expression for an envelope portfolio, x= Sum[ S\u22121{ E( r)\u2212c}] ,\nin one cell:\n\u2022 I n cells A11:A14 we have used the array formula F3:F6-B8 to indicate the\nexpected returns minus the constant in cell B8.\n\u2022 I n these same cells we have used SUM(MMult(MInverse(A3:D6),F3:F6-\nB8)) to give the denominator of the expression\nS\u22121{ E( r)\u2212c}\n235 Calculating Effi cient Portfolios\nUsing Cell Names for Clarity\nWe can make the whole process even clearer by using cell names. To defi ne\na cell name, simply mark the cell or a range of cells and go to the Name Box ,\nas shown below:\n236 Chapter 9\nThe name can now be used, as illustrated below:\nA B C D E F G\n1 FINDING ENVELOPE PORTFOLIOS IN ONE STEP\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Constant 4%\n9\nEnvelope\n10 portfolio\n11 0.0782\n12 0.2684 <-- {=MMULT(MINVERSE(varcov),means-\n13 0.2227 B8)/SUM(MMULT(MINVERSE(varcov),means-B8))}\n14 0.4307\n15\nPortfolio\n16 mean 11.30%<-- =SUMPRODUCT(portx,means)\nPortfolio\n17 sigma 37.60%<-- {=SQRT(MMULT(MMULT(TRANSPOSE(portx),varcov),portx))}"
        ],
        "9.6": [
            "What is the optimization procedure in financial modeling?\nWhat is an envelope portfolio in the financial domain?\nWhat does the statement 'All Roads Lead to Rome: Envelope Is Determined by Any Two c \u2019 s' imply in the context of financial modeling?\nWhat is the relevance of the constants c in determining the envelope in financial modeling?\nWhat is the computation process of envelope portfolios?\nWhat happens when a constant c leads to an inefficient portfolio?\nWhat is the importance of the constant c value in locating Non-Efficient Envelope Portfolios?\nWhat is the relationship between the risk-free rate of interest and optimization in portfolio management?\nWhat is meant by an \"efficient\" portfolio in the context of financial modelling and portfolio management?\nHow is the optimal investment portfolio determined for an investor in terms of the mean and standard deviation of portfolio returns?\nWhat does it mean for a portfolio to be optimal in financial modeling?\nWhat is the relevance of the risk-free rate during the optimization process in portfolio management? \nHow is the variance-covariance matrix utilized in financial modelling specifically for portfolio optimization?",
            "9.6 Three Notes on the Optimization Procedure\n\nI n this section we note three additional facts about the optimization procedure\nof Proposition 1, which leads to the computation of envelope portfolios.\nNote 1: All Roads Lead to Rome: Envelope Is Determined by Any Two c \u2019 s\nB y Proposition 2, the envelope is determined by any two of its portfolios. This\nmeans that for the determination of the envelope it is irrelevant which two\nportfolios we use. To drive home this point, the spreadsheet below computes\nthree envelope portfolios:\n\u2022 The envelope portfolio x is computed with a constant c = 0%.\n\u2022 The envelope portfolio y is computed with a constant c = 4%.\n\u2022 A third envelope portfolio z is computed with a constant c = 6% (cells\nD11:D14). As shown in rows 20\u201326, portfolio z is composed of a convex\ncombination of x and y . This is true for any x , y , and z .\nThis little exercise shows that the constants c which determine the enve-\nlope are completely arbitrary. Any two constants will determine the same\n237 Calculating Effi cient Portfolios\nA B C D E F G\nCALCULATING THE ENVELOPE\n1 All constants c lead to the same envelope\nMean\nVariance-covariance, S returns\n2 E(r)\n3 0.10 0.01 0.03 0.05 6%\n4 0.01 0.30 0.06 -0.04 8%\n5 0.03 0.06 0.40 0.02 10%\n6 0.05 -0.04 0.02 0.50 15%\n7\n8 Constant 0% 4% 6%\n9\nPortfolio Portfolio Portfolio\n10 x y z\n11 0.3553 0.0782 -0.5724\n<-- {=MMULT(MINVERSE(varcov),means-\n12 0.2362 0.2684 0.3439\nD8)/SUM(MMULT(MINVERSE(varcov),mean\n13 0.1553 0.2227 0.3811\ns-D8))}\n14 0.2532 0.4307 0.8474\n15\nPortfolio\n16 mean 9.37% 11.30% 15.84%<-- =SUMPRODUCT(portfolioz,means)\nPortfolio <--\n17 sigma 29.37% 37.60% 65.20%{=SQRT(MMULT(MMULT(TRANSPOSE(port\n18 folioz),varcov),portfolioz))}\n19\n20 Show: portfolio z is a linear proportion of portfolio x and portfolio y\n21 Proportion -2.34822<-- =(D11-C11)/(B11-C11)\n22 Check\n23 z1 -0.5724<-- =$B$21*B11+(1-$B$21)*C11\n24 z2 0.3439<-- =$B$21*B12+(1-$B$21)*C12\n25 z3 0.3811<-- =$B$21*B13+(1-$B$21)*C13\n26 z4 0.8474<-- =$B$21*B14+(1-$B$21)*C14\nNote 2: Some Values of c Locate Non-Effi cient Envelope Portfolios\nThe optimization procedure of Proposition 1 locates a portfolio x, which has\nproportions:\nS\u22121{ E( r)\u2212c}\nx=\nSum[ S\u22121{ E( r)\u2212c}]\nA lthough always on the envelope, this portfolio is not necessarily effi cient, as\nis shown in the example below, where a constant c = 0.11 leads to an ineffi cient\n238 Chapter 9\nA B C D E F G H\n8 Constant 11% 4%\n9\nPortfolio Portfolio\n10 x y\n11 1.1728 0.0782\n12 0.1413 0.2684\n13 -0.0437 0.2227\n14 -0.2704 0.4307\n15\nPortfolio\n16 mean 3.67% 11.30%\nPortfolio\n17 sigma 39.01% 37.60%\n18 Cov(x,y) -0.00631\n19\n20 Single portfolio calculation\n21 Proportion of x 0.6\n22 Mean 6.73%<-- =B21*B16+(1-B21)*C16\n23 Sigma 27.27%<-- =SQRT(B21^2*B17^2+(1-B21)^2*C17^2+2*B21*(1-B21)*B18)\n24\n25\n26 Data table to determine the frontier\nProportion\n27 of x Sigma Mean\n28 27.27% 6.73%\n29 -1.0 86.20% 18.93% 25%\n30 -0.8 75.74% 17.41%\n31 -0.6 65.49% 15.88% 20%\n32 -0.4 55.55% 14.36%\n33 -0.2 46.12% 12.83% 15%\n34 0.0 37.60% 11.30%\n35 0.2 30.75% 9.78% 10%\n36 0.4 26.87% 8.25%\n37 0.6 27.27% 6.73% 5%\n38 0.8 31.78% 5.20%\n39 1.0 39.01% 3.67% 0%\n40 1.2 47.73% 2.15% 0% 20% 40% 60% 80% 100%\n41 1.4 57.27% 0.62% -5%\n42 1.6 67.27% -0.90%\n43 1.8 77.57% -2.43% -10%\n44 2.0 88.05% -3.96%\nNote 3: The Portfolio Associated with c = r I s Optimal\nf\nW e\u2019 v e said all this before in our discussion of Proposition 1, but it\u2019 s worth\nrepeating. 2 If we set c to be equal to the risk-free rate of interest, and if the\nS\u22121{ E( r)\u2212c}\nresulting optimizing portfolio x= Sum[ S\u22121{ E( r)\u2212c}] is effi cient, then this\nportfolio is the optimal investment portfolio for an investor whose preferences\nare defi ned solely in terms of the mean and standard deviation of portfolio\n239 Calculating Effi cient Portfolios\nreturns. In the example below, we assume that r = 4%. Locating the\nf\nS\u22121{ E( r)\u2212c}\noptimizing portfolio x= Sum[ S\u22121{ E( r)\u2212c}] on the envelope shows that it\nis effi cient. Therefore, the optimal investment portfolio for this case is given\nby x .\nA B C D E F G\nIF c = r AND THE OPTIMIZING PORTFOLIO IS EFFICIENT, THEN THE\nf\nENVELOPE PORTFOLIO IS OPTIMAL\n1 The portfolio x determined by the constant c = 4% is optimal\nExpected\n2 Variance-covariance matrix returns\n3 0.40 0.03 0.02 0.00 0.06\n4 0.03 0.20 0.00 -0.06 0.05\n5 0.02 0.00 0.30 0.03 0.07\n6 0.00 -0.06 0.03 0.10 0.08\n7\n8 Constant 0.04\n9\n10 Computing an envelope portfolio with constant = 0.04\nEnvelope\nz portfolio\n11 x\n12 0.0330 <-- {=MMULT(MINVERSE(A3:D6),F3:F6-B8)} 0.0423 <-- {=A12:A15/SUM(A12:A15)}\n13 0.1959 0.2514\n14 0.0468 0.0601\n15 0.5035 0.6462\n16 Sum 1.0000 <-- =SUM(F12:F15)\n17\n18\n19 E(r x) 0.0710 7.6%\n20 \u03c3 0.1995\nx\n21 7.4%\n22\n7.1%\n23\n24 6.9%\n25\n26 6.7%\n27\n28 6.5%\n29 18% 19% 20% 21% 22% 23%\n30"
        ],
        "9.7": [
            "What is the Capital Market Line (CML) in financial modeling?\nCan you define the efficient portfolio?\nWhat is a risk-free asset?\nWhat is the market portfolio?\nWhat is the significance of the weight of the risk-free asset in a portfolio?\nWhat is the formula for a portfolio return?\nWhat is the relationship between a portfolio's standard deviation and the Capital Market Line (CML)?\nCan you explain the representation of the Efficient Frontier with CML graph?\nWhat does it signify if all optimal portfolios lie on the CML?\nWhy is the portfolio 'M' the only portfolio of risky assets included in any optimal portfolio?\nHow is each asset in the market portfolio 'M' weighted?\nWhat is the significance of a variance-covariance matrix in creating an efficient portfolio?\nHow does the risk-free rate influence the determination of the efficient portfolio?\nHow is the efficient portfolio determined from the constant 'c', given the risk-free rate 'r'?\nWhat changes occur when the risk-free rate changes in relation to the \u201cmarket\u201d portfolio?\nCan you describe what 'M' represents in financial modeling?\nCan you explain how to solve for the efficient portfolio given a certain constant? \nWhat is the envelope portfolio in respect to the market portfolio?\nHow to compute the portfolio expected return using variance-covariance matrix and the expected returns?\nIn financial portfolio theory, what does portfolio standard deviation mean?",
            "9.7 Finding the Market Portfolio: The Capital Market Line (CML)\n\nS uppose a risk-free asset exists, and suppose that this asset has expected return\nr . Let M be the effi cient portfolio which is the solution to the system of\nf\n240 Chapter 9\nE( r)\u2212r =Sz\nf\nz\nM = i\ni \u2211N\nz\ni\ni=1\nN ow consider a convex combination of the portfolio M and the risk-free asset\nr ; for example, suppose that the weight of the risk-free asset in such a portfolio\nf\nis a . It follows from the standard equations for portfolio return and \u03c3 that:\nE(\nr\n)=ar +( 1\u2212a) E(\nr\n)\np f M\n\u03c3 = a2\u03c32 +( 1\u2212a)2\u03c32 +2a( 1\u2212a) Cov(r,r ) =( 11\u2212a)\u03c3\np rf M f y M\nThe locus of all such combinations for a \u2265 0 is known as the c apital market\nline (CML). It is graphed below along with the effi cient frontier:\nEfficient Frontier with CML\nPortfolio standard deviation\nnruter\nnaem\noiloftroP\nCapital market line, CML\nMarket\nportfolio, M\nRisk-free rate, rf\nThe portfolio M is called the m arket portfolio for several reasons:\n\u2022 S uppose investors agree about the statistical portfolio information (i.e., the\nvector of expected returns E ( r) and the variance-covariance matrix S ). Suppose\n241 Calculating Effi cient Portfolios\nreturn given portfolio standard deviation \u03c3 . Then it follows that all optimal\nportfolios will lie on the CML .\n\u2022 In the case above, it further follows that t he portfolio M is the only portfolio\nof risky assets included in any optimal portfolio . M must therefore include all\nthe risky assets, with each asset weighted in proportion to its market value .\nThat is:\nV\nweightof riskyassetiin portfolioM = i\n\u2211N\nV\ni\ni=1\nwhereV isthemarkettvalueof asseti\ni\nI t is not diffi cult to fi nd M when we know r : We merely have to solve for\nf\nthe effi cient portfolio given that the constant c = r . When r changes, we get\nf f\na different \u201cmarket\u201d portfolio\u2014this is just the effi cient portfolio given a con-\nstant of r . For example, in our numerical example, suppose that the risk-free\nf\nrate is r = 5%. Then solving the system E ( r ) \u2212 r = Sz gives:\nf f\nA B C D E F G H\nWHEN c = r THE ENVELOPE PORTFOLIO\nf,\nIS THE MARKET PORTFOLIO M\n1\nExpected\nVariance-covariance matrix returns\n2 E(r)\n3 0.40 0.03 0.02 0.00 0.06\n4 0.03 0.20 0.00 -0.06 0.05\n5 0.02 0.00 0.30 0.03 0.07\n6 0.00 -0.06 0.03 0.10 0.08\n7\n8 Constant 0.05\n9\nEnvelope\nportfolio\nis market\n10 portfolio M\n11 0.0314 <-- {=MMULT(MINVERSE(A3:D6),F3:F6-B8)/SUM(MMULT(MINVERSE(A3:D6),F3:F6-B8))}\n12 0.2059\n13 0.0597\n14 0.7031\n15\nPortfolio\nexpected\n16 return, E(rM) 7.26%<-- =SUMPRODUCT(A11:A14,F3:F6)\nPortfolio\nstandard\n242 Chapter 9"
        ],
        "9.8": [
            "What are the propositions 3-5 mentioned in testing the SML in a financial model?\nCan you explain the concept of efficient portfolios in financial modeling?\nWhat does the variance-covariance matrix represent in financial modeling?\nWhat is the method of proposition 1.3 used for computing efficient portfolios?\nCan you elaborate on the concept of first pass regression in financial modeling?\nWhat does the term 'beta' refer to in financial modeling?\nWhat is the meaning of 'alpha' in the context of financial modeling?\nWhat is the second pass regression in financial modeling?\nWhat proposition states that in the second-pass regression, \u03b3 = E(r) and \u03b3 = E(r) - E(r), where z is a portfolio whose covariance with w is zero?\nHow does Proposition 4 guarantee that a portfolio w is efficient?\nWhat are the ideal results supposed to be provided by propositions 3-5?\nWhat would happen if a different constant value is used in the model?\nIn the context of this chapter, what role does the constant c play?\nIn a regression model, what does R-squared value represent?\nWhat is troposition 5's claim if there is a riskless asset with return c = r?\nWhat is the definition of the Security Market Line (SML) in the context of financial modeling?\nIn financial modeling, how is the term 'efficient portfolio' defined?\nWhat steps are involved in testing the Security Market Line (SML) for a given data set?\nWhat are the typical ways to test Propositions 3 & 4 in financial modeling?\nHow are the calculations done using a different constant value represented?\nWhat methods are used to compute the variance-covariance matrix in financial modeling?\nWhat is the importance of running a two-stage regression of any portfolio?",
            "9.8 Testing the SML\u2014Implementing Propositions 3\u20135\n\nTo illustrate Propositions 3\u20135 consider the following data for four risky assets:\nA B C D E F\n1 ILLUSTRATING PROPOSITIONS 3-5\n2 Dates Asset 1 Asset 2 Asset 3 Asset 4\n3 1 -6.63% -2.49% -4.27% 11.72%\n4 2 8.53% 2.44% -3.15% -8.33%\n5 3 1.79% 4.46% 1.92% 19.18%\n6 4 7.25% 17.90% -6.53% -7.41%\n7 5 0.75% -8.22% -1.76% -1.44%\n8 6 -1.57% 0.83% 12.88% -5.92%\n9 7 -2.10% 5.14% 13.41% -0.46%\n10\n11 Mean 1.15% 2.87% 1.79% 1.05%<-- =AVERAGE(E3:E9)\nThe asset returns on seven dates are given in rows 3\u20137, and the average return\nis given in row 11.\nWe use some sophisticated array functions to compute the variance-\ncovariance matrix:\nA B C D E F G\n13 Variance-covariance matrix\n14 Asset 1 Asset 2 Asset 3 Asset 4\n15 Asset 1 0.0024 0.0019 -0.0015 -0.0024\n16 Asset 2 0.0019 0.0056 -0.0007 -0.0016 cells B15:E18 contain the formula\n17 Asset 3 -0.0015 -0.0007 0.0057 -0.0005 {=MMULT(TRANSPOSE(B3:E9-B11:E11),B3:E9-\n18 Asset 4 -0.0024 -0.0016 -0.0005 0.0094 B11:E11)/7}\n19\n20 Finding an efficient portfolio w\n21 Constant 0.50%\n22\n23 Asset 1 0.3129\n24 Asset 2 0.2464 Cells B23:B26 contain the formula\n25 Asset 3 0.2690 {=MMULT(MINVERSE(B15:E18),TRANSPOSE(B11:E11)-\n26 Asset 4 0.1717 B21)/SUM(MMULT(MINVERSE(B15:E18),TRANSPOSE(B11:E11)-B21))}\nThe effi cient portfolio given the constant c = 0.5% is given in cells B23:B26;\nwe compute this portfolio using the method of Proposition 1.3 We call this\nportfolio w. The returns of portfolio w on dates 1\u20137 are given in column G\nbelow:\n3. Following the discussion in section 9.6, a careful reader will recall that Proposition 1 only\n243 Calculating Effi cient Portfolios\nA B C D E F G H\n2 Dates Asset 1 Asset 2 Asset 3 Asset 4 Efficient portfolio w\n3 1 -6.63% -2.49% -4.27% 11.72% -1.82% <-- {=MMULT(B3:E9,B23:B26)}\n4 2 8.53% 2.44% -3.15% -8.33% 0.99%\n5 3 1.79% 4.46% 1.92% 19.18% 5.47%\n6 4 7.25% 17.90% -6.53% -7.41% 3.65%\n7 5 0.75% -8.22% -1.76% -1.44% -2.51%\n8 6 -1.57% 0.83% 12.88% -5.92% 2.16%\n9 7 -2.10% 5.14% 13.41% -0.46% 4.14%\n10\n11 Mean 1.15% 2.87% 1.79% 1.05%<-- =AVERAGE(E3:E9) 1.73%\nWe illustrate Propositions 3\u20135 in two steps:\n\u2022 Step 1: We regress the returns of each asset on the returns of the effi cient\nportfolio: For i = 1, \u2026 , 4 we run the regression r = \u03b1 + \u03b2 r + \u03b5 .\nit i i wt it\nThis regression is often called the fi rst pass regression. The results are given\nbelow.\nA B C D E F G\n29 Implementing propositions 3-5\u2014finding the SML\n30 Step 1: Regress each asset's returns on those of the efficient portfolio w\n31 Asset 1 Asset 2 Asset 3 Asset 4\n32 Alpha 0.0024 -0.0047 -0.0002 0.0028<-- =INTERCEPT(E3:E9,$G$3:$G$9)\n33 Beta 0.5284 1.9301 1.0490 0.4478<-- =SLOPE(E3:E9,$G$3:$G$9)\n34 R-squared 0.0897 0.5241 0.1505 0.0167<-- =RSQ(E3:E9,$G$3:$G$9)\n\u2022 Step 2: We now regress the betas of the assets on their mean returns. Running\nthis regression, r =\u03b3 +\u03b3\u03b2+\u03b5 , gives:\ni 0 1 i i\nA B C D E\n36 Step 2: Regress the asset mean returns on their betas\n37 Intercept 0.005 <-- =INTERCEPT(B11:E11,B33:E33)\n38 Slope 0.0123 <-- =SLOPE(B11:E11,B33:E33)\n39 R-squared 1.0000 <-- =RSQ(B11:E11,B33:E33)\nTo check the results of Propositions 3\u20135, we run a test:\nA B C D E\nCheck Propositions 3 & 4: Step 2 coefficients should be:\n41 Intercept = c, Slope = E(r w) - c\n42 Intercept = c ? yes <-- =IF(B36=B20,\"yes\",\"no\")\n43 Slope = E(r ) - c ? yes <-- =IF(B38=G11-B21,\"yes\",\"no\")\n244 Chapter 9\nThe \u201cperfect\u201d regression results (note the R2 = 1 in cell B39) are the results\npromised us by Propositions 3\u20135:\n\u2022 The second-pass regression intercept is equal to c and the slope is equal to\nE ( r ) \u2212 c .\nw\n\u2022 If there is a riskless asset with return c = r , then Proposition 5 promises that\nf\nin the second-pass regression r =\u03b3 +\u03b3\u03b2+\u03b5 , \u03b3 = r and \u03b3 = E ( r ) \u2212 r .\ni 0 1 i i 0 f 1 w f\n\u2022 If there is no riskless asset, then Proposition 3 states that in the second-pass\nregression \u03b3 = E ( r ) and \u03b3 = E ( r ) \u2212 E ( r) , where z is a portfolio whose covari-\n0 z 1 w z\nance with w is zero.\n\u2022 F inally, if we run a two-stage regression of the type described on any port-\nfolio w and get a \u201cperfect regression,\u201d then Proposition 4 guarantees that w is\nin fact effi cient.\nTo drive home the point that this technique always works, we show you all\nthe calculations using a different value for c (cell B21, highlighted below). As\nproved in Propositions 3\u20135, the result is still a perfect regression of the means\n245 Calculating Effi cient Portfolios\nA B C D E F G H\nILLUSTRATING PROPOSITIONS 3-5\n1 This time the constant is 2% (cell B21)\n2 Dates Asset 1 Asset 2 Asset 3 Asset 4 Efficient portfolio w\n3 1 -6.63% -2.49% -4.27% 11.72% -2.95% <-- {=MMULT(B3:E9,B23:B26)}\n4 2 8.53% 2.44% -3.15% -8.33% 3.64%\n5 3 1.79% 4.46% 1.92% 19.18% 5.16%\n6 4 7.25% 17.90% -6.53% -7.41% -2.40%\n7 5 0.75% -8.22% -1.76% -1.44% 2.24%\n8 6 -1.57% 0.83% 12.88% -5.92% 0.01%\n9 7 -2.10% 5.14% 13.41% -0.46% -0.26%\n10\n11Mean 1.15% 2.87% 1.79% 1.05%<-- =AVERAGE(E3:E9) 0.78%\n12\n13Variance-covariance matrix\n14 Asset 1 Asset 2 Asset 3 Asset 4\n15Asset 1 0.0024 0.0019 -0.0015 -0.0024<-- {=MMULT(TRANSPOSE(B3:E9-B11:E11),B3:E9-B11:E11)/7}\n16Asset 2 0.0019 0.0056 -0.0007 -0.0016\n17Asset 3 -0.0015 -0.0007 0.0057 -0.0005\n18Asset 4 -0.0024 -0.0016 -0.0005 0.0094\n19\n20Finding an efficient portfolio w\n21Constant 2.00%\n22\n23Asset 1 0.8234<-- {=MMULT(MINVERSE(B15:E18),TRANSPOSE(B11:E11)-B21)/SUM(MMULT(MINVERSE(B15:E18),TRANSPOSE(B11:E11)-B21))}\n24Asset 2 -0.2869\n25Asset 3 0.2278\n26Asset 4 0.2357\n27\n28\n29 Implementing propositions 3-5--finding the SML\n30Step 1: Regress each asset's returns on those of the efficient portfolio w\n31 Asset 1 Asset 2 Asset 3 Asset 4\n32Alpha 0.0061 0.0342 0.0165 0.0044<-- =INTERCEPT(E3:E9,$G$3:$G$9)\n33Beta 0.6968 -0.7075 0.1752 0.7776<-- =SLOPE(E3:E9,$G$3:$G$9)\n34R-squared 0.1570 0.0709 0.0042 0.0506<-- =RSQ(E3:E9,$G$3:$G$9)\n35\n36Step 2: Regress the asset mean returns on their betas\n37Intercept 0.02<-- =INTERCEPT(B11:E11,B33:E33)\n38Slope -0.0122<-- =SLOPE(B11:E11,B33:E33)\n39R-squared 1.0000<-- =RSQ(B11:E11,B33:E33)\n40\nCheck Propositions 3 & 4: Step 2 coefficients should be:\n41Intercept = c, Slope = E(rw) - c\n42Intercept = c ? yes <-- =IF(B36=B20,\"yes\",\"no\")\n43Slope = E(rw) - c ? yes <-- =IF(B38=G11-B21,\"yes\",\"no\")"
        ],
        "9.9": [
            "What are the theorems related to efficient portfolios?\nHow are the theorems relating to efficient portfolios implemented to find the efficient frontier?\nWhat are the basic propositions used to derive portfolios on the envelope of the feasible set of portfolios and the envelope itself?\nHow do the further propositions relate the expected returns of any asset or portfolio to the expected returns on any efficient portfolio?\nIn what scenarios would this allow us to derive the security market line (SML) and the capital market line (CML)?\nWhat is the classic capital asset pricing model (CAPM)?\nHow is the implementation of the CAPM discussed?\nWhat are the methods to compute the variance-covariance matrix?\nHow would you test the security market line (SML)?\nWhat are the advantages of optimizing in the presence of short-sale?\nWhat is the Black-Litterman model and its importance in efficient set mathematics?\nWhat is the envelope of the feasible set of portfolios?\nWhat is the efficient frontier in portfolio management?\nWhat is the relationship between the security market line and the capital market line?\nWhat is the importance of the variance-covariance matrix in financial modeling?\nCan you explain what is meant by \"short-sale routines\"?\nWhat are the circumstances that allow us to derive the security market line (SML) and the capital market line (CML) in portfolio management?",
            "9.9 Summary\n\nI n this chapter we have presented theorems relating to effi cient portfolios and\nthen showed how to implement these theorems to fi nd the effi cient frontier.\nTwo basic propositions allow us to derive portfolios on the envelope of the\nfeasible set of portfolios and the envelope itself. Three further propositions\nrelate the expected returns of any asset or portfolio to the expected returns on\nany effi cient portfolio. Under certain circumstances, this allows us to derive\nthe security market line (SML) and the capital market line (CML) of the classic\ncapital asset pricing model (CAPM).\nI n subsequent chapters we discuss the implementation of the CAPM. We\nshow how to compute the variance-covariance matrix (Chapter 10), how to\ntest the SML (Chapter 11), how to optimize in the presence of short-sale\n246 Chapter 9\nroutines from our knowledge of effi cient set mathematics (Chapter 13, which\ndiscusses the Black-Litterman model)."
        ]
    },
    "10": {
        "10.1": [
            "What is a variance-covariance matrix in the context of financial modeling?\nWhat is the importance of calculating a variance-covariance matrix from return data for stocks?\nHow are efficient portfolios related to the variance-covariance matrix?\nWhat calculations are typically performed in Excel for financial modeling?\nWhat do we mean by a 'sample variance-covariance matrix'?\nWhat is the 'excess return matrix' and how is it used in calculating the sample variance-covariance matrix?\nWhat role does VBA play in calculating the sample variance-covariance matrix?\nWhy might the sample variance-covariance matrix not be the best estimate of variances and covariances?\nWhat issues arise from the use of the sample variance-covariance matrix in financial modeling?\nWhat are \"shrinkage\" methods in context of improving the estimate of the variance-covariance matrix?\nWhat is the role of array functions in financial models?\nWhat is the purpose of the Transpose() and MMult() functions in Excel?\nWhat characteristics distinguish \"home-grown\" array functions from standard Excel functions? \nCan you explain how the parameters of the sample variance-covariance matrix can often be unrealistic?\nHow does the sample variance-covariance matrix's inability to predict impact financial modeling?\nWhy might someone prefer the \"shrinkage\" method over using the sample variance-covariance matrix?",
            "10.1 Overview\n\nIn order to calculate effi cient portfolios, we must be able to compute the\nvariance-covariance matrix from return data for stocks. In this chapter we\ndiscuss this computation, showing how to do the calculations in Excel. The\nmost obvious calculation is the sample variance-covariance matrix : This is\nthe matrix computed directly from the historic returns. We illustrate several\nmethods for calculating the sample variance-covariance matrix, including a\ndirect calculation in the spreadsheet using the excess return matrix and an\nimplementation of this method with VBA.\nW hile the sample variance-covariance matrix may appear to be an obvious\nchoice, a large literature recognizes that it may not be the best estimate\nof variances and covariances. Disappointment with the sample variance-\ncovariance matrix stems both from its often unrealistic parameters and from\nits inability to predict. These issues are discussed briefl y in sections 10.5 and\n10.6. As an alternative to the sample matrix, sections 10.7\u201310.10 discuss\nso-called \u201cshrinkage\u201d methods for improving the estimate of the variance-\ncovariance matrix.1\nB efore starting this chapter, you may want to peruse Chapter 34 which\ndiscusses array functions. These are Excel functions whose arguments are\nvectors and matrices; their implementation is slightly different from standard\nExcel functions. This chapter makes heavy use of the array functions T rans-\npose( ) and MMult( ) as well as some other \u201chome-grown\u201d array functions."
        ],
        "10.2": [
            "- What is the sample variance-covariance matrix in financial modeling?\n- How is the variance-covariance matrix calculated?\n- What are the return data for N assets over M periods in financial modeling?\n- How is the covariance of the return of asset i and asset j calculated? \n- What does the excess return matrix involve in financial modeling?\n- What are the calculations involved while multiplying A T times A and dividing through by M \u2013 1 to get the sample variance-covariance matrix?\n- What role does prediction play in computing the Sample Variance-Covariance Matrix?\n- How does the computational aspects of Excel function help in calculating Variance-Covariance Matrix using return data for multiple stocks over a period of time?\n- How can someone automate the computation of variance-covariance matrix procedure with the help of VBA function?\n- In financial modeling, what is the Excel function used to compute the monthly returns?\n- How is the sample variance-covariance matrix calculated using Excel function Covariance_S in VBA?\n- How is the excess return and the variance-covariance matrix calculated in a spreadsheet?\n- How is Covariance_S for every entry of the variance-covariance matrix computed in VBA?\n- What does it mean to compute Covariance_S in every entry of the variance-covariance matrix in VBA?\n- Should we divide by M \u2013 1 or by M while calculating sample variance and covariances? \n- What is the difference between Covariance.S and Covariance.P in Excel?\n- What is the significance of variance and covariance in financial modelling?\n- How do the terms M\u20131 and M affect the calculation of variance and covariance in financial modeling?\n- What changes were made in Excel 2010 concerning the calculations of the variance and covariance?\n- How does VBA Function help to Compute the Variance-Covariance Matrix?\n- How can VBA be used to automate the calculation of a variance-covariance matrix?",
            "10.2 Computing the Sample Variance-Covariance Matrix\n\nS uppose we have return data for N assets over M periods. Writing the return\nof asset i in period t as r , we write the mean return of asset i as:\nit\nr =\n1 \u2211M\nr ,i=1,\u2026,N\ni M it\nt=1\nThen the covariance of the return of asset i and asset j is calculated as:\n\u03c3 =Cov(i, j)= 1 \u2211M ( r \u2212r)\u22c5( r \u2212r) ,i, j=1,\u2026,N\nij M\u22121 it i jt j\nt=1\n1. We return to the issue of prediction in Chapter 13, which discusses the Black-Litterman model\n252 Chapter 10\nT he matrix of these covariances (which includes, of course, the variances when\ni = j) is thes a mple variance-covariance matrix. Our problem is to calculate\nthese covariances effi ciently. Defi ne the excess return matrix to be:\n\u23a1r \u2212r (cid:2) r \u2212r \u23a4\n11 1 N1 N\n\u23a2 \u23a5\nr \u2212r (cid:2) r \u2212r\nA=matrixof excessreturns=\u23a2 12 1 N2 N \u23a5\n\u23a2 (cid:3) (cid:3) \u23a5\n\u23a2 \u23a5\n\u23a3r \u2212r (cid:2)(cid:2) r \u2212r \u23a6\n1M 1 NM N\nColumns of matrix A subtract the mean asset return from the individual asset\nreturns. The transpose of this matrix is:\n\u23a1 r \u2212r r \u2212r (cid:2) (cid:2) r \u2212r \u23a4\n11 1 12 1 1M 1\n\u23a2 \u23a5\nAT =\n\u23a2\n(cid:3) (cid:3) (cid:3)\n\u23a5\n\u23a3\u23a2r \u2212r r \u2212r (cid:2) (cid:2) r \u2212r \u23a6\u23a5\nN1 N N2 N NM N\nMultiplying A T times A and dividing through by M \u2212 1 gives the sample\nvariance-covariance matrix:\nS=[\u03c3 ]=\nAT\u22c5A\nij M\u22121\nTo consider the computational aspects, we use M = 60 months of return data\nfor N = 10 stocks. The spreadsheet below shows the price data (adjusted for\ndividends) and the computed returns:\nA B C D E F G H I J K L\n1 FIVE YEARS OF PRICES FOR 10 STOCKS AND THE SP500\nArcelor- General Bank of\n2 McDonalds US Steel Mi(cid:425)al Microso(cid:332) Apple Kellogg Electric America Pfizer Exxon S&P500\n3 Date MCD X MT MSFT AAPL K GE BAC PFE XOM ^GSPC\n4 1-Feb-07 37.57 84.74 44.84 25.53 84.61 43.45 28.97 44.68 19.57 64.20 1406.82\n5 1-Mar-07 38.74 94.76 46.63 25.26 92.91 44.83 29.34 44.85 19.80 67.58 1420.86\n6 2-Apr-07 41.52 97.03 47.10 27.14 99.80 46.12 30.59 44.74 20.74 71.10 1482.37\n57 1-Jul-11 85.26 39.80 30.54 27.02 390.48 54.85 17.57 9.68 18.65 78.37 1292.28\n58 1-Aug-11 89.74 30.01 21.74 26.40 384.83 53.84 16.00 8.15 18.60 73.18 1218.89\n59 1-Sep-11 87.16 21.94 15.74 24.70 381.32 52.72 15.07 6.11 17.32 71.81 1131.42\n60 3-Oct-11 92.16 25.27 20.51 26.43 404.78 53.73 16.55 6.82 18.87 77.20 1253.30\n61 1-Nov-11 95.52 27.26 18.89 25.58 382.20 49.16 15.76 5.44 19.86 80.00 1246.96\n62 1-Dec-11 100.33 26.42 18.19 25.96 405.00 50.57 17.91 5.56 21.42 84.30 1257.60\n63 3-Jan-12 99.05 30.14 20.52 29.53 456.48 49.52 18.71 7.13 21.18 83.28 1312.41\n253 Calculating the Variance-Covariance Matrix\nUsing the Excel function Ln(P /P ) , we compute the monthly returns:\nt t \u2212 1\nA B C D E F G H I J K L\n1 FIVE YEARS OF MONTHLY RETURNS FOR 10 STOCKS AND THE SP500\n2 Date MCD X MT MSFT AAPL K GE BAC PFE XOM ^GSPC\n3 1-Mar-07 3.07% 11.18% 3.91% -1.06% 9.36% 3.13% 1.27% 0.38% 1.17% 5.13% 0.99%\n4 2-Apr-07 6.93% 2.37% 1.00% 7.18% 7.15% 2.84% 4.17% -0.25% 4.64% 5.08% 4.24%\n5 1-May-07 4.59% 11.02% 12.16% 2.80% 19.42% 2.55% 1.91% 0.73% 4.89% 5.09% 3.20%\n6 1-Jun-07 0.41% -3.98% 3.93% -4.06% 0.70% -4.14% 2.60% -3.66% -7.23% 0.85% -1.80%\n7 2-Jul-07 -5.85% -10.11% -2.23% -1.66% 7.66% 0.04% 1.24% -3.06% -8.39% 1.49% -3.25%\n8 1-Aug-07 2.83% -3.72% 8.65% -0.53% 4.97% 6.42% 0.28% 6.66% 6.70% 1.09% 1.28%\n54 1-Jun-11 3.35% -0.15% 3.86% 3.86% -3.56% -2.97% -3.24% -6.90% -4.07% -2.53% -1.84%\n55 1-Jul-11 2.53% -14.09% -10.97% 5.24% 15.12% 0.82% -5.16% -12.05% -6.79% -1.97% -2.17%\n56 1-Aug-11 5.12% -28.23% -33.99% -2.32% -1.46% -1.86% -9.36% -17.20% -0.27% -6.85% -5.85%\n57 1-Sep-11 -2.92% -31.32% -32.29% -6.66% -0.92% -2.10% -5.99% -28.81% -7.13% -1.89% -7.45%\n58 3-Oct-11 5.58% 14.13% 26.47% 6.77% 5.97% 1.90% 9.37% 10.99% 8.57% 7.24% 10.23%\n59 1-Nov-11 3.58% 7.58% -8.23% -3.27% -5.74% -8.89% -4.89% -22.61% 5.11% 3.56% -0.51%\n60 1-Dec-11 4.91% -3.13% -3.78% 1.47% 5.79% 2.83% 12.79% 2.18% 7.56% 5.24% 0.85%\n61 3-Jan-12 -1.28% 13.17% 12.05% 12.88% 11.97% -2.10% 4.37% 24.87% -1.13% -1.22% 4.27%\n62 1-Feb-12 0.94% 2.85% 12.71% 4.11% 7.73% 1.38% 2.22% 13.74% -0.19% 1.90% 2.97%\n63\n64 Mean 1.63% -1.68% -1.09% 0.31% 2.94% 0.24% -0.69% -2.83% 0.13% 0.47% -0.07%\nBelow we compute the excess returns and the variance-covariance matrix:\nA B C D E F G H I J K L\n66 Variance-Covariance Matrix\n67 MCD X MT MSFT AAPL K GE BAC PFE XOM\n68 MCD 0.0020 0.0037 0.0028 0.0015 0.0017 0.0007 0.0020 0.0031 0.0015 0.0011\n69 X 0.0037 0.0380 0.0284 0.0076 0.0111 0.0031 0.0127 0.0176 0.0043 0.0043\n70 MT 0.0028 0.0284 0.0267 0.0065 0.0097 0.0031 0.0102 0.0133 0.0038 0.0039\n71 MSFT 0.0015 0.0076 0.0065 0.0063 0.0049 0.0010 0.0046 0.0079 0.0018 0.0014\n72 AAPL 0.0017 0.0111 0.0097 0.0049 0.0126 0.0016 0.0049 0.0049 0.0007 0.0020\n73 K 0.0007 0.0031 0.0031 0.0010 0.0016 0.0026 0.0028 0.0046 0.0011 0.0003\n74 GE 0.0020 0.0127 0.0102 0.0046 0.0049 0.0028 0.0122 0.0163 0.0041 0.0022\n75 BAC 0.0031 0.0176 0.0133 0.0079 0.0049 0.0046 0.0163 0.0393 0.0080 0.0017\n76 PFE 0.0015 0.0043 0.0038 0.0018 0.0007 0.0011 0.0041 0.0080 0.0041 0.0011\n77 XOM 0.0011 0.0043 0.0039 0.0014 0.0020 0.0003 0.0022 0.0017 0.0011 0.0026\n78 <-- {=MMULT(TRANSPOSE(B83:K142),B83:K142)/59}\n79\n80\n81 Excess returns: rij-ri\n82 MCD X MT MSFT AAPL K GE BAC PFE XOM\n83 1-Mar-07 0.0144 0.1285 0.0501 -0.0137 0.0642 0.0289 0.0196 0.0321 0.0104 0.0467<-- =K3-K$64\n84 2-Apr-07 0.0530 0.0404 0.0209 0.0687 0.0422 0.0260 0.0486 0.0258 0.0451 0.0461<-- =K4-K$64\n85 1-May-07 0.0296 0.1269 0.1325 0.0249 0.1648 0.0231 0.0260 0.0356 0.0476 0.0462<-- =K5-K$64\n86 1-Jun-07 -0.0122 -0.0231 0.0502 -0.0437 -0.0224 -0.0438 0.0329 -0.0083 -0.0736 0.0039<-- =K6-K$64\n87 2-Jul-07 -0.0748 -0.0843 -0.0114 -0.0197 0.0473 -0.0020 0.0193 -0.0023 -0.0852 0.0102\n88 1-Aug-07 0.0119 -0.0205 0.0974 -0.0084 0.0204 0.0618 0.0097 0.0949 0.0657 0.0063\n89 4-Sep-07 0.0845 0.1313 0.1795 0.0217 0.0734 0.0168 0.0768 0.0327 -0.0180 0.0720\n90 1-Oct-07 0.0762 0.0351 0.0310 0.2197 0.1839 -0.0615 0.0009 -0.0121 0.0058 -0.0108\n91 1-Nov-07 -0.0120 -0.0806 -0.0644 -0.0911 -0.0709 0.0268 -0.0652 -0.0171 -0.0238 -0.0321\n92 3-Dec-07 -0.0088 0.2299 0.0576 0.0547 0.0541 -0.0327 -0.0170 -0.0690 -0.0458 0.0449\n93 2-Jan-08 -0.1111 -0.1537 -0.1419 -0.0913 -0.4101 -0.0948 -0.0403 0.0960 0.0260 -0.0937\n94 1-Feb-08 0.0003 0.0810 0.1464 -0.1801 -0.1088 0.0629 -0.0489 -0.0770 -0.0345 0.0148\n95 3-Mar-08 0.0140 0.1737 0.0892 0.0392 0.1085 0.0332 0.1172 -0.0022 -0.0637 -0.0331\n96 1-Apr-08 0.0497 0.2102 0.0963 0.0019 0.1631 -0.0292 -0.1169 0.0186 -0.0416 0.0910\n97 1-May-08 -0.0207 0.1332 0.1197 -0.0066 0.0523 0.0163 -0.0553 -0.0705 -0.0233 -0.0476\n254 Chapter 10\nA VBA Function to Compute the Variance-Covariance Matrix\nT o automate this procedure, we write a VBA function that computes the\nvariance-covariance matrix using the Excel function C ovariance.S . When\nExcel functions with periods, such as C ovariance.S, are used in VBA, the\nperiod becomes an underscore: C ovariance_S :\n\u2018My thanks to Amir Kirsh\n\u2018Revised 2012 by Benjamin Czaczkes and _\nSimon Benninga\nFunction VarCovar(rng As Range) As Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = rng.Columns.Count\nnumrows = rng.Rows.Count\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\nFor i = 1 To numcols\nFor j = 1 To numcols\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction.\nCovariance_S(rng.Columns(i), _\nrng.Columns(j))\nNext j\nNext i\nVarCovar = matrix\n255 Calculating the Variance-Covariance Matrix\nT he VBA computes Covariance_S for every entry of the variance-\ncovariance matrix.2 Here \u2019 s the result:\nA B C D E F G H I J K L\n1 PORTFOLIO ANALYSIS FOR MONTHLY DATA\n2 Variance-Covariance Matrix\n3 MCD X MT MSFT AAPL K GE BAC PFE XOM\n4 MCD 0.0020 0.0037 0.0028 0.0015 0.0017 0.0007 0.0020 0.0031 0.0015 0.0011<-- {=varcovar('Page 253'!B3:K62)}\n5 X 0.0037 0.0380 0.0284 0.0076 0.0111 0.0031 0.0127 0.0176 0.0043 0.0043\n6 MT 0.0028 0.0284 0.0267 0.0065 0.0097 0.0031 0.0102 0.0133 0.0038 0.0039\n7 MSFT 0.0015 0.0076 0.0065 0.0063 0.0049 0.0010 0.0046 0.0079 0.0018 0.0014\n8 AAPL 0.0017 0.0111 0.0097 0.0049 0.0126 0.0016 0.0049 0.0049 0.0007 0.0020\n9 K 0.0007 0.0031 0.0031 0.0010 0.0016 0.0026 0.0028 0.0046 0.0011 0.0003\n10 GE 0.0020 0.0127 0.0102 0.0046 0.0049 0.0028 0.0122 0.0163 0.0041 0.0022\n11 BAC 0.0031 0.0176 0.0133 0.0079 0.0049 0.0046 0.0163 0.0393 0.0080 0.0017\n12 PFE 0.0015 0.0043 0.0038 0.0018 0.0007 0.0011 0.0041 0.0080 0.0041 0.0011\n13 XOM 0.0011 0.0043 0.0039 0.0014 0.0020 0.0003 0.0022 0.0017 0.0011 0.0026\nShould We Divide by M \u2013 1 or by M\nI n the above calculations, we use the sample covariance (in Excel Covariance.S\nand in VBA C ovariance_S ) to divide by M \u2013 1 instead of M in order to get\nthe unbiased estimate of the variances and covariances. We don \u2019 t think this\nmatters very much, but for reference to a higher authority, we suggest our\ndiscussion of M versus M \u2013 1 in section 8.2.\nStarting with Excel 2010, Microsoft has cleared up considerable confusion\nthat once existed in Excel about whether to divide by M or M \u2013 1. The new\nversions of Excel have standardized the nomenclature and computations for\nthese functions:\nExcel 2010 Other (older) Comments When used in VBA\nand later versions of\nthis function\n(still work)\nCovariance.S Sample covariance, Application.\ndivides by M\u20131 WorksheetFunction.\nCovariance_S\nCovariance.P C ovar Population covariance, Application.\ndivides by M WorksheetFunction.\nCovariance_P\n2 . S ince the covariance matrix is symmetric, we\u2019 v e actually done too many computations. But\n256 Chapter 10\nExcel 2010 Other (older) Comments When used in VBA\nand later versions of\nthis function\n(still work)\nVar.S V arS Sample variance A pplication.\nWorksheetFunction.Var_S\nApplication.\nWorksheetFunction.VarS\nVar.P V arP Population variance Application.\nWorksheetFunction.\nVar_P\nApplication.\nWorksheetFunction.VarP\nConfused? Don \u2019 t worry! As the discussion in Chapter 8 indicates, perhaps\nit doesn \u2019 t matter very much."
        ],
        "10.3": [
            "What is a correlation matrix?\nHow is the correlation matrix computed using Excel's Correl function?\nWhat is the function of rng.Columns.Count in the Excel function for calculating the correlation matrix?\nWhat is meant by 'returns' in the context of financial modeling and correlation matrix?\nWhat variations are there in the calculation of the correlation matrix and how do they affect modeling?\nWhat does a triangular correlation matrix refer to and how is it different from a regular correlation matrix?\nCan you explain the significance of a high correlation value in a correlation matrix?\nWhat average correlation is typically observed in a sample of stocks?\nHow the average correlation is usually estimated in the financial industry?\nWhat could be the implications of a high correlation between the returns of two companies?\nWhat is the significance of the smallest and largest correlations in a correlation matrix?\nHow are average, smallest and largest correlations calculated in Excel for a correlation matrix?\nWhat could be the economic explanations of high correlation between the returns of two particular companies?\nHow does row and column count in a range affect the calculation of a correlation matrix in Excel?",
            "10.3 The Correlation Matrix\n\nU sing the Excel function C orrel we can compute the correlation matrix of the\nreturns:\nFunction CorrMatrix(rng As Range) As Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = rng.Columns.Count\nnumrows = rng.Rows.Count\nDim matrix() As Double\n257 Calculating the Variance-Covariance Matrix\nFor i = 1 To numcols\nFor j = 1 To numcols\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction.Correl(rng. _\nColumns(i), rng.Columns(j))\nNext j\nNext i\nCorrMatrix = matrix\nEnd Function\nA B C D E F G H I J K\n1 CORRELATION MATRIX\nArcelor- General Bank of\n2 McDonalds US Steel Mi(cid:425)al Microso(cid:332) Apple Kellogg Electric America Pfizer Exxon\n3 MCD X MT MSFT AAPL K GE BAC PFE XOM\n4 MCD 1.0000 0.4199 0.3859 0.4238 0.3379 0.2920 0.4064 0.3506 0.5411 0.4741\n5 X 0.4199 1.0000 0.8898 0.4898 0.5062 0.3078 0.5904 0.4556 0.3491 0.4361\n6 MT 0.3859 0.8898 1.0000 0.5044 0.5277 0.3692 0.5659 0.4103 0.3602 0.4620\n7 MSFT 0.4238 0.4898 0.5044 1.0000 0.5497 0.2416 0.5312 0.5050 0.3542 0.3581\n8 AAPL 0.3379 0.5062 0.5277 0.5497 1.0000 0.2827 0.3964 0.2205 0.0945 0.3425\n9 K 0.2920 0.3078 0.3692 0.2416 0.2827 1.0000 0.4846 0.4559 0.3487 0.1234\n10 GE 0.4064 0.5904 0.5659 0.5312 0.3964 0.4846 1.0000 0.7461 0.5842 0.3926\n11 BAC 0.3506 0.4556 0.4103 0.5050 0.2205 0.4559 0.7461 1.0000 0.6328 0.1723\n12 PFE 0.5411 0.3491 0.3602 0.3542 0.0945 0.3487 0.5842 0.6328 1.0000 0.3435\n13 XOM 0.4741 0.4361 0.4620 0.3581 0.3425 0.1234 0.3926 0.1723 0.3435 1.0000\n14 <-- {=CorrMatrix('Page 253'!B3:K62)}\nHere \u2019 s another version of the correlation matrix, this time only the upper\nhalf:\n\u2019 Triangular correlation matrix\nFunction CorrMatrixTriangular(rng As Range) _\nAs Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = rng.Columns.Count\nnumrows = rng.Rows.Count\nDim matrix() As Variant\n258 Chapter 10\nFor i = 1 To numcols\nFor j = 1 To numcols\nIf i < = j Then\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction.Correl(rng. _\nColumns(i), rng.Columns(j))\nElse\nmatrix(i - 1, j - 1) = \u201c\u201d\nEnd If\nNext j\nNext i\nCorrMatrixTriangular = matrix\nEnd Function\nA B C D E F G H I J K\nArcelor- General Bank of\n16 McDonalds US Steel Mi(cid:425)al Microso(cid:332) Apple Kellogg Electric America Pfizer Exxon\n17 MCD X MT MSFT AAPL K GE BAC PFE XOM\n18 MCD 1.0000 0.4199 0.3859 0.4238 0.3379 0.2920 0.4064 0.3506 0.5411 0.4741\n19 X 1.0000 0.8898 0.4898 0.5062 0.3078 0.5904 0.4556 0.3491 0.4361\n20 MT 1.0000 0.5044 0.5277 0.3692 0.5659 0.4103 0.3602 0.4620\n21 MSFT 1.0000 0.5497 0.2416 0.5312 0.5050 0.3542 0.3581\n22 AAPL 1.0000 0.2827 0.3964 0.2205 0.0945 0.3425\n23 K 1.0000 0.4846 0.4559 0.3487 0.1234\n24 GE 1.0000 0.7461 0.5842 0.3926\n25 BAC 1.0000 0.6328 0.1723\n26 PFE 1.0000 0.3435\n27 XOM 1.0000\n28 <-- {=CorrMatrixTriangular('Page 253'!B3:K62)}\nH ere are some statistics for the correlations. The average correlation for our\nsample (0.4226) is a bit high (usually a sample of stocks will give average\ncorrelation of 0.2\u20130.3). The largest correlations (\u03c1 = 0.8898,\nArcelor,US Steel\n\u03c1 = 0.7461) look quite high, though perhaps there are economic\nGE,BankAmerica\nexplanations.3\n3 . A rcelor and U.S. Steel are, of course, both steel companies. GE has one of the largest fi nancing\noperations in the world; perhaps this explains the high correlation between the returns of Bank\n259 Calculating the Variance-Covariance Matrix\nA B C D E F G H I J\n30 Some correla(cid:415)on sta(cid:415)s(cid:415)cs\n31 Average 0.4226<-- =AVERAGEIF(B18:K27,\"<1\")\n32 Largest 0.8898<-- =LARGE(B18:K27,11) Smallest 0.0945<-- =SMALL($B$18:$K$27,1)\n33 Next largest 0.7461<-- =LARGE(B18:K27,12) Next small 0.1234<-- =SMALL($B$18:$K$27,2)\n34 etc. 0.6328<-- =LARGE(B18:K27,13) etc. 0.1723<-- =SMALL($B$18:$K$27,3)\n35 etc. 0.5904<-- =LARGE(B18:K27,14) etc. 0.2416<-- =SMALL($B$18:$K$27,5)\n36 etc. 0.5842<-- =LARGE(B18:K27,15) etc. 0.2416<-- =SMALL($B$18:$K$27,5)"
        ],
        "10.4": [
            "What are the two most prominent uses of the variance-covariance matrix in financial modeling?\nWhat does the term Global Minimum Variance Portfolio (GMVP) refer to in the context of financial modeling?\nWhat are the challenges of working with sample data in financial modeling?\nHow is the minimum variance portfolio defined and computed?\nIn what context is the N-dimensional row vector of ones used during the computation of the GMVP?\nWho is credited with the formulation of the minimum variance portfolio?\nWhy is the minimum variance portfolio considered to be fascinating in financial modeling?\nDoes the computation of the minimum variance portfolio require the asset's expected returns?\nWhat determines the mean and variance of the minimum variance portfolio?\nHow are the VBA functions for the unit column and row vectors implemented as part of this financial model?\nCan you give an example of computing the Global Minimum Variance Portfolio (GMVP)?\nWhat is the significance of variance-covariance matrix in calculating the Global Minimum Variance Portfolio?\nHow does one calculate the mean and variance in the Global Minimum Variance Portfolio?\nWhat is the role of the N-dimensional column vector of ones in computing the Global Minimum Variance Portfolio?",
            "10.4 Computing the Global Minimum Variance Portfolio (GMVP)\n\nT he two most prominent uses of the variance-covariance matrix are to fi nd the\nglobal minimum variance portfolio (GMVP) and to fi nd effi cient portfolios.\nBoth uses illustrate the problematics of working with sample data and provide\nus with the introduction needed for sections 10.7\u201310.10, which discuss alterna-\ntives to the sample variance-covariance matrix. In this section we discuss\nthe GMPV.\nSuppose there are N assets having a variance-covariance matrix S . The\nGMVP is the portfolio x = { x , x , \u2026 , x } which has the lowest variance from\n1 2 N\namong all feasible portfolios. The minimum variance portfolio is defi ned by\nx ={ x ,x ,\u2026,x }= 1 row\u22c5S\u22121 ,\nGMVP GMVP,1 GMVP,2 GMVP,N 1 \u22c5S\u22121\u22c51T\nrow row\nwhhere1\nrow\n={ (cid:4)1,(cid:6)1,(cid:5)\u2026 (cid:6),(cid:7)1}= Sum1\n(\nnro uw m\u22c5\u22c5S e\u2212 r1\nator)\n\u2191\nN-dimensional\nrow vector of1s\n\u23a7x \u23ab \u23a71\u23ab\nGMVP,1\n\u23aa \u23aa \u23aa \u23aa\n\u23aax \u23aa S\u221211 \u23aa1\u23aa\nx =\u23a8 GMVP,2\u23ac= column ,where1 = \u23a8 \u23ac\nGMVP \u23aa (cid:3) \u23aa 1T \u22c5S\u22121\u22c51 column \u23aa\u23aa(cid:3) \u23aa\ncolumn column\n\u23a9\u23aa\nx\nGMVP,N\u23ad\u23ad\u23aa \u23aa\n\u23a9\n(cid:8)1\u23ad\u23aa\n\u2191\nN-dimensional\ncolumn vector of1s\nS\u221211\n= column\n( )\n260 Chapter 10\nThis formula is due to Merton. 4\nThe particular fascination of the minimum variance portfolio is that it is the\nonly portfolio on the effi cient frontier whose computation does not require the\nasset expected returns. The mean \u03bc and the variance \u03c3 2 of the minimum\nGMVP GMVP\nvariance portfolio are given by:\n\u03bc =x \u22c5E( r) ,\u03c32 =x \u22c5S\u22c5xT\nGMVP GMVP GMVP GMVP GMVP\nHere \u2019 s an implementation of these formulas for our particular example. We\nuse two VBA functions for the unit column and row vectors:\n\u2018I thank Priyush Singh and Ayal Itzkovitz\nFunction UnitrowVector(numcols As Integer) _\nAs Variant\nDim i As Integer\nDim vector() As Integer\nReDim vector(0, numcols - 1)\nFor i = 1 To numcols\nvector(0, i - 1) = 1\nNext i\nUnitrowVector = vector\nEnd Function\nFunction UnitColVector(numrows As Integer) _\nAs Variant\nDim i As Integer\nDim vector() As Integer\nReDim vector(numrows - 1, 0)\nFor i = 1 To numrows\nvector(i - 1, 0) = 1\nNext i\nUnitColVector = vector\nEnd Function\n4. Robert C. Merton, \u201cAn Analytical Derivation of the Effi cient Portfolio Frontier,\u201d Journal of\n261 Calculating the Variance-Covariance Matrix\nApplying this to our 10-asset example:\nA B C D E F G H I J K\n1 COMPUTING THE GLOBAL MINIMUM VARIANCE PORTFOLIO\n2 Variance-Covariance Matrix\n3 MCD X MT MSFT AAPL K GE BAC PFE XOM\n4 MCD 0.0020 0.0037 0.0028 0.0015 0.0017 0.0007 0.0020 0.0031 0.0015 0.0011\n5 X 0.0037 0.0380 0.0284 0.0076 0.0111 0.0031 0.0127 0.0176 0.0043 0.0043\n6 MT 0.0028 0.0284 0.0267 0.0065 0.0097 0.0031 0.0102 0.0133 0.0038 0.0039\n7 MSFT 0.0015 0.0076 0.0065 0.0063 0.0049 0.0010 0.0046 0.0079 0.0018 0.0014\n8 AAPL 0.0017 0.0111 0.0097 0.0049 0.0126 0.0016 0.0049 0.0049 0.0007 0.0020\n9 K 0.0007 0.0031 0.0031 0.0010 0.0016 0.0026 0.0028 0.0046 0.0011 0.0003\n10 GE 0.0020 0.0127 0.0102 0.0046 0.0049 0.0028 0.0122 0.0163 0.0041 0.0022\n11 BAC 0.0031 0.0176 0.0133 0.0079 0.0049 0.0046 0.0163 0.0393 0.0080 0.0017\n12 PFE 0.0015 0.0043 0.0038 0.0018 0.0007 0.0011 0.0041 0.0080 0.0041 0.0011\n13 XOM 0.0011 0.0043 0.0039 0.0014 0.0020 0.0003 0.0022 0.0017 0.0011 0.0026\n14\n15 GMVP as row 0.0326 0.2117 0.1754 0.0705 0.0873 0.0340 0.1166 0.1891 0.0493 0.0335\n16 <-- {=MMULT(unitrowvector(10),B4:K13)/SUM(MMULT(unitrowvector(10),B4:K13))}\n17\n18 0.0326\nGMVP as\n19 0.2117<-- {=MMULT(B4:K13,unitcolvector(10))/SUM(MMULT(B4:K13,unitcolvector(10)))}\ncolumn\n20 0.1754\n21 0.0705\n22 0.0873\n23 0.0340\n24 0.1166\n25 0.1891\n26 0.0493\n27 0.0335\n28\n29 GMVP sta(cid:415)s(cid:415)cs\n30 Mean -0.80%T(B15:K15,'Page 253'!B64:K64)\n31 Variance 0.0130<-- {=MMULT(MMULT(B15:K15,B4:K13),B18:B27)}\n32 Sigma 11.40%<-- =SQRT(B31)"
        ],
        "10.5": [
            "What are the four alternatives to the sample variance-covariance matrix in financial modeling?\nWhat does the single-index model assume in variance risk?\nWhat assumptions are made by the constant correlation model regarding asset returns?\nCan you explain the concept of shrinkage methods in financial modeling?\nHow do shrinkage methods help in calculating the variance-covariance matrix?\nWhat role do option methods play in calculating the variance-covariance matrix?\nWhat purpose does combining the option methods with the constant correlation method serve in financial modelling?\nWhat are the challenges or limitations of using return data for generating covariances in financial modelling?\nWhy does the fourth method assume that even the sample variances are an inaccurate prediction of future variance?\nWhat is the role of betas in the single-index model?\nWhat assumption does the constant correlation model make about the correlation between all asset returns? \nHow does the distrust of return data for generating the covariances affect the financial modelling? \nHow does the fourth method use options to derive the standard deviations of returns for the assets?\nWhat does a convex combination in conjunction to the variance-covariance matrix refer to in shrinkage methods?",
            "10.5 Four Alternatives to the Sample Variance-Covariance Matrix\n\nIn succeeding sections we illustrate four alternatives to the sample variance-\ncovariance matrix:\n\u2022 The single-index model assumes that the only sources of variance risk are\nthe market variance and the betas of the assets.\n\u2022 The constant correlation model assumes the correlation between all asset\nreturns is constant, so that \u03c3 = \u03c1 \u03c3 \u03c3 .\n262 Chapter 10\n\u2022 Shrinkage methods assume that the variance-covariance matrix is a convex\ncombination of the sample variance-covariance and a matrix with variances\non the diagonal and zeros elsewhere.\n\u2022 Option methods use options to derive the standard deviations of returns for\nthe assets. We combine this in section 10.9 with the constant correlation\nmethod to compute a variance-covariance matrix.\nThe fi rst three models arise out of a distrust of return data for generating\nthe covariances of the data in the future. The fourth method\u2014using option\ndata\u2014goes further and assumes that even the sample variances are an inac-\ncurate prediction of future variance."
        ],
        "10.6": [
            "What does the single-index model (SIM) simplify in financial modeling?\nWhat is the key assumption of the Single-Index Model (SIM)?\nHow is the correlation between the terms \u03b5i and \u03b5j defined in the Single-Index Model?\nHow does the Single-Index Model (SIM) alter the estimates of the covariances?\nWhat does not change in the Single-Index Model when it comes to computing the Variance-Covariance Matrix?\nCan you provide a sample VBA code for automating the Single-Index Model for financial modeling?\nWhat is the purpose of the 'Var_S' function in the mentioned VBA code?\nWhat is the purpose of the 'Application.WorksheetFunction.Slope' function in the context of the given VBA code for SIM?\nWhat values are the two arguments of the function in the VBA Code used for calculating SIM?\nWhy is 'marketdata' as a variable important in the presented VBA code?\nWhat do the alpha and beta terms represent in the Single-Index Model equation for asset returns?\nHow is the Single-Index Variance-Covariance Matrix computed in financial modeling?\nHow does Single-Index Model (SIM) relate to the variance-covariance matrix in financial modeling?",
            "10.6 Alternatives to the Sample Variance-Covariance: The Single-Index\n\nModel (SIM)\nThe single-index model (SIM) began as an attempt to simplify some of the\ncomputational complexities of calculating the variance-covariance matrix.5\nThe basic assumption of the SIM is that the returns of each asset can be linearly\nregressed on a market index x :\nr(cid:2) =\u03b1 +\u03b2r(cid:2) +\u03b5(cid:2)\ni i i x i\nwhere the correlation between \u03b5 and \u03b5 is zero. Given this assumption, it is\ni j\neasy to establish the following two facts:\n\u2022 E( r(cid:2))=\u03b1 +\u03b2E( r(cid:2) )\ni i i x\n\u23a7\u03b2\u03b2\u03c32 wheni\u2260 j\n\u2022\n\u03c3 =\u23a8 i j x\nij \u23a9 \u03c32 wheni= j\ni\n263 Calculating the Variance-Covariance Matrix\nE ssentially the SIM involves changes in the estimates of the covariances,\nbut not the sample variance. We can automate the procedure for computing\nthe SIM by writing some VBA code:\nFunction sim(assetdata As Range, marketdata As Range) _\nAs Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = assetdata.Columns.Count\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\nFor i = 1 To numcols\nFor j = 1 To numcols\nIf i = j Then\nmatrix(i - 1, j - 1) = Application. _\nWorksheetFunction.Var_S(assetdata.Columns(i))\nElse\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction.Slope(assetdata. _\nColumns(i), marketdata) * _\nApplication.WorksheetFunction.Slope(assetdata. _\nColumns(j), marketdata) * _\nApplication.WorksheetFunction.Var_S(marketdata)\nEnd If\nNext j\nNext i\nsim = matrix\n264 Chapter 10\nT he two arguments of this function are the asset returns and the market\nreturns. Applying this code in our example:\nA B C D E F G H I J K L\n1 COMPUTING THE SINGLE-INDEX VARIANCE-COVARIANCE MATRIX\n2 MCD X MT MSFT AAPL K GE BAC PFE XOM\n3 MCD 0.0020 0.0036 0.0031 0.0013 0.0016 0.0006 0.0021 0.0032 0.0009 0.0006\n4 X 0.0036 0.0380 0.0198 0.0085 0.0105 0.0038 0.0137 0.0204 0.0059 0.0042\n5 MT 0.0031 0.0198 0.0267 0.0073 0.0090 0.0033 0.0117 0.0175 0.0051 0.0036\n6 MSFT 0.0013 0.0085 0.0073 0.0063 0.0038 0.0014 0.0050 0.0075 0.0022 0.0015\n7 AAPL 0.0016 0.0105 0.0090 0.0038 0.0126 0.0017 0.0062 0.0092 0.0027 0.0019\n8 K 0.0006 0.0038 0.0033 0.0014 0.0017 0.0026 0.0022 0.0034 0.0010 0.0007\n9 GE 0.0021 0.0137 0.0117 0.0050 0.0062 0.0022 0.0122 0.0121 0.0035 0.0025\n10 BAC 0.0032 0.0204 0.0175 0.0075 0.0092 0.0034 0.0121 0.0393 0.0052 0.0037\n11 PFE 0.0009 0.0059 0.0051 0.0022 0.0027 0.0010 0.0035 0.0052 0.0041 0.0011\n12 XOM 0.0006 0.0042 0.0036 0.0015 0.0019 0.0007 0.0025 0.0037 0.0011 0.0026\n13 <-- {=sim(B16:K75,L16:L75)}\n14\n15 Date MCD X MT MSFT AAPL K GE BAC PFE XOM ^GSPC\n16 1-Mar-07 3.07% 11.18% 3.91% -1.06% 9.36% 3.13% 1.27% 0.38% 1.17% 5.13% 0.99%\n17 2-Apr-07 6.93% 2.37% 1.00% 7.18% 7.15% 2.84% 4.17% -0.25% 4.64% 5.08% 4.24%\n18 1-May-07 4.59% 11.02% 12.16% 2.80% 19.42% 2.55% 1.91% 0.73% 4.89% 5.09% 3.20%\n19 1-Jun-07 0.41% -3.98% 3.93% -4.06% 0.70% -4.14% 2.60% -3.66% -7.23% 0.85% -1.80%\n20 2-Jul-07 -5.85% -10.11% -2.23% -1.66% 7.66% 0.04% 1.24% -3.06% -8.39% 1.49% -3.25%\n21 1-Aug-07 2.83% -3.72% 8.65% -0.53% 4.97% 6.42% 0.28% 6.66% 6.70% 1.09% 1.28%\n67 1-Jun-11 3.35% -0.15% 3.86% 3.86% -3.56% -2.97% -3.24% -6.90% -4.07% -2.53% -1.84%\n68 1-Jul-11 2.53% -14.09% -10.97% 5.24% 15.12% 0.82% -5.16% -12.05% -6.79% -1.97% -2.17%\n69 1-Aug-11 5.12% -28.23% -33.99% -2.32% -1.46% -1.86% -9.36% -17.20% -0.27% -6.85% -5.85%\n70 1-Sep-11 -2.92% -31.32% -32.29% -6.66% -0.92% -2.10% -5.99% -28.81% -7.13% -1.89% -7.45%\n71 3-Oct-11 5.58% 14.13% 26.47% 6.77% 5.97% 1.90% 9.37% 10.99% 8.57% 7.24% 10.23%\n72 1-Nov-11 3.58% 7.58% -8.23% -3.27% -5.74% -8.89% -4.89% -22.61% 5.11% 3.56% -0.51%\n73 1-Dec-11 4.91% -3.13% -3.78% 1.47% 5.79% 2.83% 12.79% 2.18% 7.56% 5.24% 0.85%\n74 3-Jan-12 -1.28% 13.17% 12.05% 12.88% 11.97% -2.10% 4.37% 24.87% -1.13% -1.22% 4.27%\n75 1-Feb-12 0.94% 2.85% 12.71% 4.11% 7.73% 1.38% 2.22% 13.74% -0.19% 1.90% 2.97%"
        ],
        "10.7": [
            "What is the constant correlation model of Elton and Gruber (1973)?\nHow does the constant correlation model compute the variance-covariance matrix?\nWhat is assumed in the constant correlation model about the variances and covariances of asset returns?\nWhat is generally taken to be the average correlation coefficient of the assets in the constant correlation model?\nHow do the variances and covariances relate in the constant correlation model when 'i' is not equal to 'j'?\nHow do you compute the correlations of all the stocks in the constant correlation model? \nWhat is the use of Visual Basic for Applications (VBA) function in calculating the constant correlation matrix?\nWhat is the significance of the value of 'corr' in the VBA function while calculating the constant correlation matrix?\nHow does the VBA function use the 'Var_S' worksheet function from Excel in making computations?\nWhat happens in the VBA function when the value of 'corr' is greater than or equal to 1? \nWhat is the function of 'VarCovar(data)' in the VBA function?\nHow does the 'For' loop contribute in computing the constant correlation model?",
            "10.7 Alternatives to the Sample Variance-Covariance: Constant Correlation\n\nThe constant correlation model of Elton and Gruber (1973) computes the\nvariance-covariance matrix by assuming that the variances of the asset returns\nare the sample returns, but that the covariances are all related by the same\ncorrelation coeffi cient, which is generally taken to be the average correlation\ncoeffi cient of the assets in question. Since Cov ( r , r ) = \u03c3 =\u03c1 \u03c3 \u03c3 , this means\ni j ij ij i j\nthat in the constant correlation model:\n\u23a7 \u03c3 =\u03c32 wheni= j\n\u03c3 =\u23a8 ii i\nij \u23a9\u03c3 =\u03c1\u03c3\u03c3 wheni\u2260 j\n265 Calculating the Variance-Covariance Matrix\nUsing our data for the 10 stocks, we can implement the constant correlation\nmodel. We fi rst compute the correlations of all the stocks:\nA B C D E F G H I J K\nESTIMATING THE CONSTANT CORRELATION VARIANCE-COVARIANCE MATRIX\n1\n2 Correlation 0.20\n3\n4 MCD X MT MSFT AAPL K GE BAC PFE XOM\n5 MCD 0.0020 0.0018 0.0015 0.0007 0.0010 0.0005 0.0010 0.0018 0.0006 0.0005\n6 X 0.0018 0.0380 0.0064 0.0031 0.0044 0.0020 0.0043 0.0077 0.0025 0.0020\n7 MT 0.0015 0.0064 0.0267 0.0026 0.0037 0.0017 0.0036 0.0065 0.0021 0.0017\n8 MSFT 0.0007 0.0031 0.0026 0.0063 0.0018 0.0008 0.0017 0.0031 0.0010 0.0008\n9 AAPL 0.0010 0.0044 0.0037 0.0018 0.0126 0.0012 0.0025 0.0044 0.0014 0.0011\n10 K 0.0005 0.0020 0.0017 0.0008 0.0012 0.0026 0.0011 0.0020 0.0007 0.0005\n11 GE 0.0010 0.0043 0.0036 0.0017 0.0025 0.0011 0.0122 0.0044 0.0014 0.0011\n12 BAC 0.0018 0.0077 0.0065 0.0031 0.0044 0.0020 0.0044 0.0393 0.0025 0.0020\n13 PFE 0.0006 0.0025 0.0021 0.0010 0.0014 0.0007 0.0014 0.0025 0.0041 0.0007\n14 XOM 0.0005 0.0020 0.0017 0.0008 0.0011 0.0005 0.0011 0.0020 0.0007 0.0026\n15 <-- {=constantcorr('Page 253'!B3:K62,'Page 265'!B2)}\nWe \u2019 ve written a VBA function to compute this matrix from the return data:\nFunction constantcorr(data As Range, corr As Double) _\nAs Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = data.Columns.Count\nnumrows = data.Rows.Count\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\nIf Abs(corr) > = 1 Then GoTo Out\nFor i = 1 To numcols\nFor j = 1 To numcols\nIf i = j Then\nmatrix(i - 1, j - 1) = Application. _\nWorksheetFunction.Var_S(data.Columns(i))\n266 Chapter 10\nmatrix(i - 1, j - 1) = corr * jjunk(data, i) * _\njjunk(data, j)\nEnd If\nNext j\nNext i\nOut:\nIf Abs(corr) > = 1 Then constantcorr = VarCovar(data) _\nElse constantcorr = matrix\nEnd Function"
        ],
        "10.8": [
            "What are the shrinkage methods in financial modelling?\nWhat is the variance-covariance matrix and how is it estimated?\nWhat is a sample variance-covariance matrix?\nWhat is the role of lambda in the shrinkage variance-covariance matrix?\nWhat is meant by the term \"convex combination\" in the context of the variance-covariance matrix in financial modelling?\nWhat does it mean for the GMVP to be \"wholly positive\" in financial modelling?\nWhat is a diagonal matrix of variances?\nHow do shrinkage methods work in estimating the variance-covariance matrix?\nWhat is the purpose of the shrinkage factor in the shrinkage approach?\nWhy are alternatives necessary for the sample variance-covariance?\nWhat mathematical formulae can be used to compute the shrinkage covariance matrix?\nHow is weight assigned to matrices in the shrinkage variance-covariance matrix?\nWhat is the role of a diagonal matrix of variances in the context of shrinkage methods?\nIn what context is the \"other\" matrix used in shrinkage methods?\nWhat is the significance of the term \"wholly positive GMVP\" in financial modelling?\nWhat is the role of estimating the variance-covariance matrix in financial modelling?\nWhat is the need for a shrinkage method in calculating the variance-covariance matrix?\nWhat role does the Sample Variance-Covariance matrix play in Shrinkage methods?\nWhat is the purpose of the so-called \"Shrinkage Factor\" in the Shrinkage methods for calculating the variance-covariance matrix?\nWhat considerations are made in choosing the proper shrinkage estimator in financial modeling?",
            "10.8 Alternatives to the Sample Variance-Covariance: Shrinkage Methods\n\nA third class of methods of estimating the variance-covariance matrix has\nrecently achieved popularity. So-called s hrinkage methods assume that the\nvariance-covariance matrix is a convex combination of the sample covariance\nmatrix and some other matrix:\nShrinkagevariance-covariancematrix=\n\u03bb*Samplevar-cov+( 1\u2212\u03bb)\n*Otthermatrix\nI n the example below, the \u201cother\u201d matrix is a diagonal matrix of only vari-\n267 Calculating the Variance-Covariance Matrix\nA B C D E F G H\nESTIMATING THE VARIANCE-COVARIANCE MATRIX USING\nTHE SHRINKAGE APPROACH\nGives weight 0.30 (the shrinkage factor) to sample var-cov and\nweight 0.70 to a diagonal matrix of only variances\n1\n2 Return data\n3 Date GE MSFT JNJ K BA IBM\n4 03-Jan-94 56.44% -1.50% 6.01% -9.79% 58.73% 21.51%\n5 03-Jan-95 18.23% 33.21% 41.56% 7.46% -0.24% 6.04%\n6 02-Jan-96 56.93% 44.28% 57.71% 37.76% 65.55% 27.33%\n7 02-Jan-97 42.87% 79.12% 22.94% -5.09% 54.34% 41.08%\n8 02-Jan-98 47.11% 38.04% 17.62% 32.04% 37.11% 2.63%\n9 04-Jan-99 34.55% 85.25% 26.62% -10.74% 15.05% -2.11%\n10 03-Jan-00 28.15% 11.20% 3.41% -48.93% 43.53% 23.76%\n11 02-Jan-01 4.61% -47.19% 10.69% 11.67% 28.29% 21.76%\n12 02-Jan-02 -19.74% 4.27% 23.11% 19.90% -15.09% 4.55%\n13 02-Jan-03 -44.78% -29.47% -5.67% 10.88% -23.23% 15.54%\n14 02-Jan-04 35.90% 18.01% -1.27% 15.49% 39.82% 31.80%\n15\n16 Average 23.66% 21.38% 18.43% 5.51% 27.63% 17.63%<-- =AVERAGE(G4:G14)\n17 Standard deviation 32.17% 40.71% 18.97% 23.86% 29.93% 13.56%<-- =STDEV(G4:G14)\n18 Variance 0.1035 0.1657 0.0360 0.0570 0.0896 0.0184<-- =VAR(G4:G14)\n19\n20 Shrinkage factor \u03bb 0.3<-- This is the weight put on the sample var-cov\n21\nShrinkage matrix\n22 Uses the array formula {=B20*B34:G39+(1-B20)*B44:G49} to compute the shrinkage covariance matrix\n23 GE MSFT JNJ K BA IBM\n24 GE 0.1035 0.0228 0.0066 -0.0013 0.0257 0.0037\n25 MSFT 0.0228 0.1657 0.0124 -0.0016 0.0114 -0.0007\n26 JNJ 0.0066 0.0124 0.0360 0.0054 0.0030 -0.0012\n27 K -0.0013 -0.0016 0.0054 0.0570 -0.0023 -0.0014\n28 BA 0.0257 0.0114 0.0030 -0.0023 0.0896 0.0074\n29 IBM 0.0037 -0.0007 -0.0012 -0.0014 0.0074 0.0184\n30\n31\nUses the array formula {=MMULT(TRANSPOSE(B4:G14-B16:G16),B4:G14-B16:G16)/10} to compute the constant\n32 sample covariance matrix. In the shrinkage var-cov, this matrix is given weight lambda.\n33 GE MSFT JNJ K BA IBM\n34 GE 0.1035 0.0758 0.0222 -0.0043 0.0857 0.0123\n35 MSFT 0.0758 0.1657 0.0412 -0.0052 0.0379 -0.0022\n36 JNJ 0.0222 0.0412 0.0360 0.0181 0.0101 -0.0039\n37 K -0.0043 -0.0052 0.0181 0.0570 -0.0076 -0.0046\n38 BA 0.0857 0.0379 0.0101 -0.0076 0.0896 0.0248\n39 IBM 0.0123 -0.0022 -0.0039 -0.0046 0.0248 0.0184\n40\n41\nUses the array formula {=MMULT(TRANSPOSE(B4:G14-B16:G16),B4:G14-B16:G16)/10*IF(A44:A49=B43:G43,1,0)} to\ncompute a matrix with only variances on diagonal and zeros elsewhere. In the shrinkage var-cov this matrix is given\n42 weight 1-lambda.\n43 GE MSFT JNJ K BA IBM\n44 GE 0.1035 0.0000 0.0000 0.0000 0.0000 0.0000\n45 MSFT 0.0000 0.1657 0.0000 0.0000 0.0000 0.0000\n46 JNJ 0.0000 0.0000 0.0360 0.0000 0.0000 0.0000\n47 K 0.0000 0.0000 0.0000 0.0570 0.0000 0.0000\n48 BA 0.0000 0.0000 0.0000 0.0000 0.0896 0.0000\n268 Chapter 10\nT here is little theory about choosing the proper shrinkage estimator. 6 Our\nsuggestion is to choose a shrinkage operator \u03bb so that the GMVP is wholly\npositive (see next section for details)."
        ],
        "10.9": [
            "What is the variance matrix in financial modeling?\nCan the information from the options market be used to compute the variance matrix?\nWhat is the implied volatility in the context of stock options?\nHow can historical volatility be computed using five years of return data?\nWhat is the use of constant correlation variance-covariance matrix in financial modeling?\nWhat is the significance of implied volatilities in the context of a constant correlation variance-covariance matrix?\nHow are implied volatilities calculated for stocks using call options?\nWhat does the programming function, 'ImpliedVolVarCov' represent in the context of financial modeling?\nWhat does the programming variable 'varcovarmatrix' represent in the function 'ImpliedVolVarCov'?\nWhat is the use of 'matrix' variable in the 'ImpliedVolVarCov' function?\nWhat is the purpose of the 'corr' variable in the 'ImpliedVolVarCov' function?\nWhat happens in the programming function 'ImpliedVolVarCov' when 'corr' is greater than or equal to 1?\nCan you explain the process of calculating the variance-covariance matrix with implied volatilities? \nHow does the constant correlation matrix using implied volatilities work in financial modeling? \nWhat role does correlation play in the constant correlation matrix with implied volatilities? \nWhat is the significance of the strike price in calculating implied volatility? \nWhy is current date and expire date important for calculating implied volatility? \nWhat is the importance of interest rate in calculating implied volatility? \nCan you explain how the correlation between implied and historical volatility is determined in financial modeling?",
            "10.9 Using Option Information to Compute the Variance Matrix 7\n\nA nother way to compute the variance matrix is to use the information from\nthe options market. We use the implied volatility for each of the stocks from\ntheir at-the-money call options and then compute the variance matrix using\nconstant correlation:\n\u23a7 \u03c32 ifi= j\n\u03c3 =\u23a8 i,implied\nij \u23a9\u03c1\u03c3 \u03c3 ifi\u2260 j\ni,implied j,implied\nHere \u2019 s an example for our 10-stock case. We use data from the options\nmarkets and the function C allVolatility discussed in Chapter 17 to compute\nthe implied volatility for each of the 10 stocks and the S&P 500. We use our\ndata set of fi ve years of returns to compute the historical volatility:\n6 . T hree papers by Olivier Ledoit and Michael Wolf may offer some guidance: \u201cImproved Estima-\ntion of the Covariance Matrix of Stock Returns with an Application to Portfolio Selection,\u201d\nJournal of Empirical Finance , 2003. \u201cA Well-Conditioned Estimator for Large-Dimensional\nCovariance Matrices,\u201d J ournal of Multivariate Analysis, 2004. \u201cHoney, I Shrunk the Sample\nCovariance Matrix,\u201d Journal of Portfolio Management , 2004.\n269 Calculating the Variance-Covariance Matrix\nA B C D E F G\n1 COMPARING IMPLIED AND HISTORICAL VOLATILITY\n2 Current date 10-Jul-12\n3 Expire date 17-Aug-12 =callvolatility(B7,C7,($B$3-$B$2)/365,$B$4,D7)\n4 Interest 1.00%\n5\nStock Implied Historical\n6 price Strike Price volatility volatility\n7 MCD 90.25 90.00 2.09 16.50% 15.42%<-- {=TRANSPOSE('Betas etc'!B11:L11)}\n8 X 20.28 20.00 1.58 55.05% 67.00%\n9 MT 14.67 15.00 0.75 47.12% 56.18%\n10 MSFT 29.74 30.00 1.07 30.74% 27.21%\n11 AAPL 608.21 610.00 25.30 33.04% 38.53%\n12 K 48.98 50.00 0.40 12.44% 17.67%\n13 GE 19.62 20.00 0.39 21.63% 37.91%\n14 BAC 7.48 8.00 0.22 43.04% 68.10%\n15 PFE 22.44 23.00 0.18 13.38% 21.87%\n16 XOM 83.11 85.00 0.90 15.23% 17.55%\n17 ^GSPC 1,341.47 1,350.00 22.50 14.96% 19.21%\n18\n19\n20\n21\n22\n23 80%\n24 70%\n25 60%\n26\n50%\n27\n28 40%\n29 30%\n30 20%\n31 10%\n32\n0%\n33\n34\n35\nW e can now use the implied volatilities as the basis for a constant correla-\ntion variance-covariance matrix:\nMCD X MT MSFT AAPL K GE BAC PFE XOM ^GSPC\nComparing Implied and Historical Vola(cid:415)li(cid:415)es\nHistorical: 2007 -2012, Implied: July 10, 2012\nImplied vola(cid:415)lity\n270 Chapter 10\nA B C D E F G H I J K\n1 CONSTANT CORRELATION MATRIX WITH IMPLIED VOLATILITIES\n2 Correlation 0.20\n3\n4 MCD X MT MSFT AAPL K GE BAC PFE XOM\n5 MCD 0.0272 0.0182 0.0156 0.0101 0.0109 0.0041 0.0071 0.0142 0.0044 0.0050\n6 X 0.0182 0.3031 0.0519 0.0338 0.0364 0.0137 0.0238 0.0474 0.0147 0.0168\n7 MT 0.0156 0.0519 0.2221 0.0290 0.0311 0.0117 0.0204 0.0406 0.0126 0.0143\n8 MSFT 0.0101 0.0338 0.0290 0.0945 0.0203 0.0076 0.0133 0.0265 0.0082 0.0094\n9 AAPL 0.0109 0.0364 0.0311 0.0203 0.1091 0.0082 0.0143 0.0284 0.0088 0.0101\n10 K 0.0041 0.0137 0.0117 0.0076 0.0082 0.0155 0.0054 0.0107 0.0033 0.0038\n11 GE 0.0071 0.0238 0.0204 0.0133 0.0143 0.0054 0.0468 0.0186 0.0058 0.0066\n12 BAC 0.0142 0.0474 0.0406 0.0265 0.0284 0.0107 0.0186 0.1852 0.0115 0.0131\n13 PFE 0.0044 0.0147 0.0126 0.0082 0.0088 0.0033 0.0058 0.0115 0.0179 0.0041\n14 XOM 0.0050 0.0168 0.0143 0.0094 0.0101 0.0038 0.0066 0.0131 0.0041 0.0232\n15 <-- {=ImpliedVol(B5:K14,E22:E31,B2)}\n16\n17 Current date 10-Jul-12\n18 Expire date 17-Aug-12\n19 Interest 1.00%\n20\nStock Implied\n21 price Strike Price volatility\n22 MCD 90.25 90.00 2.09 16.50%<-- =callvolatility(B22,C22,($B$18-$B$17)/365,$B$19,D22)\n23 X 20.28 20.00 1.58 55.05%\n24 MT 14.67 15.00 0.75 47.12%\n25 MSFT 29.74 30.00 1.07 30.74%\n26 AAPL 608.21 610.00 25.30 33.04%\n27 K 48.98 50.00 0.40 12.44%\n28 GE 19.62 20.00 0.39 21.63%\n29 BAC 7.48 8.00 0.22 43.04%\n30 PFE 22.44 23.00 0.18 13.38%\n31 XOM 83.11 85.00 0.90 15.23%\nThe programming of the ImpliedVolVarCov is similar to previous VBAs\nin this chapter:\nFunction ImpliedVolVarCov(varcovarmatrix As _\nRange, volatilities As Range, corr As Double)\nAs Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = varcovarmatrix.Columns.Count\nnumrows = numcols\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\n271 Calculating the Variance-Covariance Matrix\nFor i = 1 To numcols\nFor j = 1 To numcols\nIf i = j Then\nmatrix(i - 1, j - 1) = volatilities(i) \u2227 2\nElse\nmatrix(i - 1, j - 1) = corr * _\nvolatilities(i) * volatilities(j)\nEnd If\nNext j\nNext i\nOut:\nIf Abs(corr) > = 1 Then ImpliedVolVarCov = _\n\u201cERR\u201d Else ImpliedVolVarCov = matrix\nEnd Function"
        ],
        "10.10": [
            "What are the five alternatives to computing the variance-covariance matrix mentioned in financial modeling?\nWhat do we mean by the sample variance-covariance?\nCan you explain the single-index model used in calculating the variance-covariance matrix?\nWhat defines the constant correlation approach when computing the variance-covariance matrix?\nCan you elaborate on the idea of Shrinkage methods in the context of computing the variance-covariance matrix?\nWhat does it mean by Implied volatility-based variance-covariance matrices in financial modeling?\nHow might we compare the alternatives to compute the variance-covariance matrix?\nWhat factors could be considered in choosing a method to compute the variance-covariance matrix?\nWhat does it mean if we strongly believe that the past predicts the future in choosing the method to calculate variance-covariance matrix?\nWhat is an option-based volatility model in the context of financial modeling?\nWhat situation would require an option-based volatility model with a changing correlation?\nWhat is the recommended \"normal\" correlation value for \"normal\" times in financial modeling?\nWhat recommendation is given for the correlation value during times of crisis?",
            "10.10 Which Method to Compute the Variance-Covariance Matrix?\n\nThis chapter gives fi ve alternatives to computing the variance-covariance\nmatrix:\n\u2022 The sample variance-covariance\n\u2022 The single-index model\n\u2022 The constant correlation approach\n\u2022 Shrinkage methods\n\u2022 Implied volatility-based variance-covariance matrices\nHow do we compare these alternatives? Which one should we choose? We\ncould compare the technical outcomes of using each of these methods\u2014for\nexample, show the alternative values of the GMVP using different methods\u2014\nbut this largely misses the point.\nT he choice of how to compute the variance-covariance matrix is largely a\nquestion of how you view capital markets. If you strongly believe that the past\npredicts the future, then perhaps your choice should be to use the sample\nvarcov matrix. This author prefers to get away from history \u2026 our preference\nis to use an option-based volatility model with a changing correlation:\nIn \u201cnormal\u201d times we would use a \u201cnormal\u201d correlation of between 0.2 and\n0.3; in times of crisis, we would use a much higher correlation, say, \u03c1 =\n272 Chapter 10"
        ],
        "10.11": [
            "What is a variance-covariance matrix?\nHow is a variance-covariance matrix calculated?\nWhat is its connection to portfolio optimization?\nWhat is standard sample variance-covariance matrix?\nHow can you compute alternatives to the standard sample variance-covariance matrix?\nWhat are some of the alternatives to variance-covariance matrix that have appeared in the literature?\nWhat role do these alternative computations play in improving portfolio calculations?\nWhat is the significance of the variance-covariance matrix in financial modeling?",
            "10.11 Summary\n\nIn this chapter we considered how to compute the variance-covariance matrix\nwhich is central to all portfolio optimization. Starting with the standard sample\nvariance-covariance matrix, we also showed how to compute several alterna-\ntives that have appeared in the literature as perhaps improving portfolio\ncomputations."
        ]
    },
    "11": {
        "11.1": [
            "What is the Capital Asset Pricing Model (CAPM)?\nWhat are the two important implications of the Capital Asset Pricing Model (CAPM)?\nWhat is the individual optimal portfolio defined by the Capital Market Line (CML)?\nWhat does the Security Market Line (SML) define?\nWhat differentiates the scenarios when a risk-free asset exists and when it doesn't in the Capital Asset Pricing Model (CAPM)?\nIn the context of Capital Asset Pricing Model (CAPM), what does individual optimization mean when a risk-free asset exists?\nIn the context of Capital Asset Pricing Model (CAPM), what does individual optimization mean when no risk-free asset exists?\nWhat does the existence or non-existence of a risk-free asset imply in general equilibrium in the context of Capital Asset Pricing Model (CAPM)?\nWhat is a market portfolio in the context of Capital Asset Pricing Model (CAPM)?\nWhat is asset's beta in the context of Capital Asset Pricing Model (CAPM)?\nHow is the Security Market Line (SML) defined when a risk-free asset doesn't exist?\nWhat is Black\u2019s 1972 zero-beta model?\nWhat is the efficient frontier in the context of portfolio optimization?\nHow does the general equilibrium work in the absence of a risk-free asset in the context of Capital Asset Pricing Model (CAPM)?\nWhat does it imply when all portfolios are located on the same line or frontier according to the Capital Asset Pricing Model (CAPM)?\nWhat are the prescriptive and descriptive roles of the Capital Asset Pricing Model (CAPM)?\nHow does the Capital Asset Pricing Model (CAPM) assist a mean-variance investor in choosing an optimal portfolio?\nWhat conditions does the Capital Asset Pricing Model (CAPM) provide to generalize about the structure of expected returns in the market?\nWhat is the significance of betas in testing the descriptive part of the Capital Asset Pricing Model (CAPM)?\nWhat is the Security Market Line (SML) in the context of Capital Asset Pricing Model (CAPM)?",
            "11.1 Overview\n\nThe capital asset pricing model (CAPM) is one of the two most influential\ninnovations in financial theory in the latter half of the twentieth century.1 By\nintegrating the portfolio decision with utility theory and the statistical behavior\nof asset prices, the formulators of the CAPM defined the paradigm which is\nnow generally used for the analysis of stock prices.\nWhat does the CAPM actually say? What are its empirical implications?\nRoughly speaking, we can differentiate between two kinds of implications of\nthe CAPM. First, the capital market line (CML) defines the individual optimal\nportfolios for an investor interested in the mean and variance of her optimal\nportfolio. Second, given agreement between investors on the statistical proper-\nties of asset returns and on the importance of mean-variance optimization, the\nsecurity market line (SML) defines the r isk-return relation for e ach individual\nasset .\nIt is useful to differentiate between the case wherein a risk-free asset exists\nand the case wherein there is no risk-free asset. 2\nCase 1: A Risk-Free Asset Exists\nSuppose a risk-free asset exists and has return r . We can differentiate between\nf\nthe individual optimization of investors and the general equilibrium implica-\ntions of the CAPM:\n\u2022 Individual optimization: Assuming that investors optimize based on the\nexpected return and standard deviation of their portfolio returns (in the jargon\nof finance\u2014they have \u201cmean-variance\u201d preferences), the CAPM states\nthat each individual investor \u2019 s optimal portfolio falls on the line\nE( r )=r +\u03c3 [ E( r )\u2212r ] , where portfolio x is a portfolio which maximizes\np f p x f\nE(\nr\n)\u2212r\ny f for all feasible portfolios y. Proposition 1 of Chapter 9 shows\n\u03c3\ny\nthat x can be computed by x={ x 1,x 2,\u2026,x N}= \u2211S S\u22121 \u2212[ 1E [ E( r () r\u2212 )\u2212r f r] ] , where\nf\n1 . T he other remarkable innovation is option pricing theory, which is discussed in Chapters\n15\u201319. These two innovations together have accounted for a number of Nobel Prizes in Econom-\nics: Harry Markowitz (1990), William Sharpe (1990), Myron Scholes (1997), and Robert Merton\n(1997). But for their untimely demise, others associated with these theories\u2014Jan Mossin (1936\u2013\n1987), and Fischer Black (1938\u20131995)\u2014would doubtless also have received the Nobel.\n2. The existence (or non-existence) of a risk-free asset is closely related to the investment horizon.\n274 Chapter 11\nS is the variance-covariance matrix of risky asset returns and\nE( r)={ E( r) ,E(\nr\n) ,\u2026,E(\nr\n)}\nis the vector of expected asset returns.\n1 2 N\n\u2022 General equilibrium: If all investors agree about the statistical assumptions\nof the model\u2014the variance-covariance matrix S and the vector of expected\nasset returns E ( r )\u2014and if a risk-free asset exists, then individual asset returns\nare defined by the security market line (SML):\n( )\nE( r)=r +Cov r i,r M [ E( r )\u2212r ]\ni f \u03c32 M f\nM\nwhere M denotes the market portfolio\u2014the value-weighted portfolio of all\n( )\nCov r,r\nrisky assets. The expression i M is generally termed the asset \u2019 s beta :\n\u03c32\nM\n( )\nCov r,r\n\u03b2 = i M .\ni \u03c32\nM\nCase 2: No Risk-Free Asset Exists\nIf there is no risk-free asset, then the implications of the CAPM both for\nindividual optimization and for general equilibrium are defined by Black \u2019 s\n(1972) zero-beta model (Proposition 3 of Chapter 9):\n\u2022 Individual optimization: In the absence of a risk-free asset, individual optimal\nportfolios will fall along the e fficient frontier . As shown in Proposition 2 of\nChapter 9, this frontier is the upward-sloping portion of the mean-\nsigma combinations created by the convex combination of any two optimizing\nS\u22121[ E( r)\u2212c ] S\u22121[ E( r)\u2212c ]\nportfolios x= \u2211 S\u22121[ E( r)\u22121\nc\n] and y= \u2211 S\u22121[ E( r)\u22122\nc\n] , where c 1 and c 2\n1 2\nare two arbitrary constants.\n\u2022 General equilibrium: In the absence of a risk-free asset, if all investors agree\nabout the statistical assumptions of the model\u2014the variance-covariance matrix\nS and the vector of expected asset returns E ( r) \u2014then individual asset returns\nare defined by the security market line (SML):\n( )\nE( r)=E( r )+Cov r i,r y [ E( r )\u2212E( r )]\ni z \u03c32 y z\ny\nwhere y is any efficient portfolio and z is a portfolio which has zero covariance\n275 Estimating Betas and the Security Market Line\nThe case of no risk-free asset is obviously weaker than the case of a risk-\nfree asset. If there is a risk-free asset, the general equilibrium version of the\nCAPM says that all portfolios are situated on a single, agreed-upon line. If\nthere is no risk-free asset, then all optimal portfolios are on the same frontier;\nbut in this case asset betas can differ, since there are many portfolios y which\n( )\nfulfill the equation E( r)=E( r )+Cov r i,r y [ E( r )\u2212E( r )] .\ni z \u03c32 y z\ny\nThe CAPM as a Prescriptive and a Descriptive Tool\nA s you can see from the discussion above, the CAPM is both p rescriptive and\ndescriptive .\nA s a prescriptive tool, the CAPM tells a mean-variance investor how\nto choose his optimal portfolio. By finding a portfolio of the form\nS\u22121[ E( r)\u2212c ]\n\u2211 S\u22121[ E( r)\u22121\nc\n], the investor can identify an optimal portfolio from the\n1\ndata set.\nA s a descriptive tool, the CAPM gives conditions under which we can\ngeneralize about the structure of expected returns in the market. Whether or\nnot a risk-free asset exists, these conditions assume that investors agree on the\nstatistical structure of asset returns\u2014the variance-covariance matrix and the\nexpected returns. In this case all the returns are expected to lie on a security\n( )\nmarket line (SML) of the form E( r)=r +Cov r i,r M [ E( r )\u2212r ] (if there is\ni f \u03c32 M f\nM\n( )\na risk-free asset) or of the form E( r)=E( r )+Cov r i,r y [ E( r )\u2212E( r )] if\ni z \u03c32 y z\ny\nthere is no risk-free asset.\nThis Chapter\nI n this chapter we look at some typical capital market data and replicate a\nsimple test of the descriptive part of the CAPM. This means that we have to\ncalculate the betas for a set of assets, and we then have to determine the equa-\ntion of the security market line (SML). The test in this chapter is the simplest\npossible test of the CAPM. There is an enormous literature in which the pos-\n276 Chapter 11\nplaces to begin are textbooks by Elton, Gruber, Brown, and Goetzmann (2009),\nand Bodie, Kane, and Marcus (2010). 3"
        ],
        "11.2": [
            "What is the security market line (SML) in financial modeling?\nCan you explain the process of testing the security market line (SML)?\nHow do financial models use return data on a set of risky assets?\nWhat is meant by the 'market portfolio M' in the context of SML testing?\nWhat is the role of the Standard & Poor\u2019s 500 Index in SML testing?\nWhat is meant by the 'theoretical market portfolio' in financial modeling?\nHow does the choice of the market surrogate impact the r-squared of a regression test of the CAPM?\nWhat is 'first-pass regression' in the context of determining the asset beta?\nWhat does the second-pass regression entail in SML testing?\nCan you explain the process of transforming price data to returns in the context of estimating Betas and the security market line?\nWhat is the significance of mean returns in the first-pass regression?\nWhat are alpha, beta and R2 in the context of financial modeling?\nHow is the mean return of each security related to its beta according to the SML?\nCan you explain the terms Case 1 and Case 2 in section 11.1 in the context of SML?\nWhy would the CAPM not hold in the market?\nWhat does it indicate if both the t-statistics for the intercept and the slope are not statistically different from zero?\nWhat does it mean for the CAPM to have prescriptive validity?\nWhy is it unrealistic to assume that there are no short-sale restrictions in the derivation of the CAPM?\nWhat implications does restricting short sales have on the computation of efficient portfolios?\nWhy might the SML not hold if individuals do not have homogeneous probability assessments?\nWhat happens if the CAPM holds only for portfolios and not for single assets?\nWhat is the implication if the market portfolio isn\u2019t efficient?\nWhy would the CAPM hold only if the market returns are positive?\nWhat is the interpretation if the period surveyed has negative average market returns?",
            "11.2 Testing the SML\n\nT ypical tests of the security market line (SML) start with return data on a set\nof risky assets. The steps in the test are as follows:\n\u2022 Determine a candidate for the market portfolio M . In our example we will\nuse the Standard & Poor\u2019 s 500 Index (S&P 500) as a candidate for M . This is\na critical step: In principle, the \u201ctrue\u201d market portfolio should\u2014as pointed\nout in Chapter 9\u2014contain all the market \u2019 s risky assets in proportion to their\nvalue. It is clearly impossible to calculate this theoretical market portfolio,\nand we must therefore make do with a surrogate. As you will see in the next\ntwo sections, the propositions of Chapter 9 can shed much light on how the\nchoice of the market surrogate affects the r - squared of our regression test of\nthe CAPM.\n( )\nCov r,r\n\u2022 F or each of the assets in question, determine the asset beta, \u03b2 = i M .\ni \u03c32\nM\nThis is often called the first-pass regression .\n\u2022 R egress the mean returns of the assets on their respective betas (the second-\npass regression ):\nr =\u03b3 +\u03b3\u03b2\ni 0 1 i\nI f the CAPM in its descriptive format holds, then the second-pass regression\nshould be the security market line. 4\nW e illustrate the tests of the CAPM with a simple numerical example that\nuses data for the 30 stocks in the Dow-Jones Industrials. We start with the\nprices of the S&P 500 (symbol \u2227G SPC) and the stocks in the DJ30 (some of\nthe rows and columns are not shown):\n3. For further references, see the Selected References at the end of this book. Our personal\nexpositional favorite is a paper by Roll, \u201cAmbiguity When Performance Is Measured by the\nSecurities Market Line,\u201d Journal of Finance (1978).\n277 Estimating Betas and the Security Market Line\nA B C D E F G H I J K L M N\nPRICE DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\nJuly 2001 - July 2006\n1\nAmerican\nS&P500 American General General\nAlcoa International Boeing Citigroup Caterpillar DuPont Disney Home Honeywell\nDate Index Express Electric Motors\nAA Group BA C CAT DD DIS Depot HD HON\n2 ^GSPC AIG AXP GE GM\n3 03-Jul-01 1211.23 35.37 81.32 33.73 53.64 40.97 24.73 36.29 25.02 38.33 49.72 48.26 32.75\n4 01-Aug-01 1133.58 34.50 76.43 30.46 47.06 37.49 22.45 35.01 24.14 36.04 43.14 44.06 33.27\n5 04-Sep-01 1040.94 28.06 76.24 24.30 30.79 33.15 20.11 32.07 17.68 32.93 33.81 36.79 23.57\n6 01-Oct-01 1059.78 29.34 76.82 24.68 29.97 37.26 20.23 34.18 17.65 32.23 32.56 36.66 26.38\n7 01-Nov-01 1139.45 35.09 80.54 27.60 32.43 39.34 21.45 38.21 19.43 34.08 39.63 44.78 29.77\n8 03-Dec-01 1148.08 32.32 77.64 29.93 35.83 41.46 23.63 36.63 19.88 35.63 38.75 48.97 30.38\n9 02-Jan-02 1130.20 32.59 72.51 30.13 37.83 39.06 22.91 38.06 20.21 33.03 40.77 48.09 30.19\n10 01-Feb-02 1106.73 34.31 72.38 30.64 42.64 37.29 25.29 40.68 22.07 34.39 42.67 48.00 34.43\n51 01-Jul-05 1234.18 27.48 59.76 47.68 65.02 42.62 53.28 41.22 25.37 33.53 34.89 42.97 38.43\n52 01-Aug-05 1220.33 26.38 58.92 47.89 66.26 42.89 54.85 38.55 24.93 32.66 32.86 39.92 37.66\n53 01-Sep-05 1228.81 24.05 61.67 49.79 67.18 44.60 58.07 38.16 23.88 32.94 29.42 37.76 36.89\n54 03-Oct-05 1207.01 23.92 64.49 49.41 63.91 44.86 52.22 40.62 24.11 33.17 26.33 40.63 33.65\n55 01-Nov-05 1249.48 27.16 66.82 51.04 67.67 48.04 57.37 42.02 24.67 34.94 21.44 41.46 36.15\n56 01-Dec-05 1248.29 29.30 67.91 51.08 69.71 48.02 57.36 41.77 23.97 34.53 19.01 40.17 36.85\n57 03-Jan-06 1280.08 31.21 65.15 52.19 67.79 46.09 67.69 38.48 25.31 32.27 23.56 40.24 38.01\nWe first transform these price data to returns:\nA B C D E F G H I J K L M N\nRETURN DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\n1 July 2001 - July 2006\nAmerican\nS&P 500 American General General\nAlcoa International Boeing Citigroup Caterpillar DuPont Disney Home Honeywell\nDate Index Express Electric Motors\n2 ^GSPC AA G Aro IGup AXP BA C CAT DD DIS GE GM Depot HD HON\n3 =AVERAGE(C9:C68)\n4 Average return 0.07% -0.09% -0.54% 0.72% 0.67% 0.30% 1.79% 0.18% 0.29% -0.23% -0.87% -0.52% 0.29%\n5 Beta 1.00 1.90 0=.9S9LOPE(C91.:3C868,$B$91:.1$5B$68) 1.30 1.39 1.00 1.28 0.84 1.41 1.55 1.66\n6 Alpha 0 -0.23% -0.61% 0.62% 0.58% 0.21% 1.69% 0.11% 0.20% -0.30% -0.97% -0.63% 0.17%\n7 R-squared 1 0.6085 =I0N.3T5E1R8CEPT0(.C7905:C268,$B0.$2948:$7B$680).5972 0.5158 0.4362 0.3845 0.3221 0.2607 0.5288 0.5473\n8\n9 01-Aug-01 -6.63% -2.49% -6.20% -10.20% -13.09% -8.88% -9.67% -3.59% -3.58% -6.16% -14.20% -9.11% 1.58%\n10 04-Sep-01 -8.53% -20.66% =R-S0Q.2(5C%9:C6-82,2$.5B9$%9:$B-$4628.4)2% -12.30% -11.01% -8.77% -31.14% -9.02% -24.37% -18.03% -34.47%\n11 01-Oct-01 1.79% 4.46% 0.76% 1.55% -2.70% 11.69% 0.59% 6.37% -0.17% -2.15% -3.77% -0.35% 11.26%\n12 01-Nov-01 7.25% 17.90% 4.73% 11.18% 7.89% 5.43% 5.86% 11.15% 9.61% 5.58% 19.65% 20.01% 12.09%\n13 03-Dec-01 0.75% -8.22% -3.67% 8.10% 9.97% 5.25% 9.68% -4.22% 2.29% 4.45% -2.25% 8.94% 2.03%\n14 02-Jan-02 -1.57% 0.83% -6.84% 0.67% 5.43% -5.96% -3.09% 3.83% 1.65% -7.58% 5.08% -1.81% -0.63%\n15 01-Feb-02 -2.10% 5.14% -0.18% 1.68% 11.97% -4.64% 9.88% 6.66% 8.80% 4.03% 4.55% -0.19% 13.14%\n16 01-Mar-02 3.61% 0.47% -2.52% 11.66% 4.85% 9.02% 2.38% 0.66% 0.36% -2.89% 13.20% -2.72% 0.41%\nThe First-Pass Regression\nR ow 4 gives each asset\u2019 s average monthly return over the 60-month period\n(to annualize these returns, we would multiply by 12). Rows 5\u20137 report the\nresults of the first-pass regression. For each asset i we report the regression\nr = \u03b1 + \u03b2 r . We use the Excel function Slope to compute the \u03b2 of each\nit i i SP,t\nasset, and the functions Intercept and R sq to compute the \u03b1 and R2 for each\n278 Chapter 11\nAs a check, we also compute the \u03b1 , \u03b2 , and R 2 for the S&P 500 index (column\nB). Not surprisingly, \u03b1 = 0,\u03b2 = 1, R 2 = 1.\nSP SP\nThe Second-Pass Regression\nThe SML postulates that the mean return of each security should be linearly\nrelated to its beta. Assuming that the historic data provide an accurate descrip-\ntion of the distribution of future returns, we postulate that E ( R ) = \u03b1 + \u03b2 \u03a0 +\ni i\n\u03b5 , where the definitions of \u03b1 and \u03a0 depend on whether we are in Case 1 or\ni\nCase 2 of section 11.1:\n\u23a7 r Case1:thereexistsarisk-freeasset\n\u23aa f\n\u03b1=\u23a8\n( ) Case2:norisk-freeaasset.zhaszero\n\u23aaE r\n\u23a9 z correlationwithefficientportfolioy\n\u23a7 E( r )\u2212r Case1\n\u03a0=\u23a8 MM f\n\u23a9E(\nr\n)\u2212E(\nr\n)\nCase2\ny z\nIn the second step of our test of the CAPM, we examine this hypothesis by\nregressing the mean returns on the \u03b2 \u2019 s.\nA B C D E F G H\n1 THE SECOND-PASS REGRESSION\nAverage\nmonthly\n2 Stock return Beta Alpha\n3 Alcoa A A -0.09% 1.9028 -0.0023 Second-pass regression, regressing monthly returns on Beta\n4 American International Group AIG -0.54% 0.9936 -0.0061 Intercept 0.0036<-- =INTERCEPT(B3:B32,C3:C32)\n5 American Express AXP 0.72% 1.3784 0.0062 Slope -0.0020<-- =SLOPE(B3:B32,C3:C32)\n6 Boeing BA 0.67% 1.1515 0.0058 R-squared 0.0238<-- =RSQ(B3:B32,C3:C32)\n7 Citigroup C 0.30% 1.2952 0.0021\n8 Caterpillar CAT 1.79% 1.3903 0.0169 t-statistic, intercept 1.2381<-- =tintercept(B3:B32,C3:C32)\n9 DuPont DD 0.18% 1.0009 0.0011 t-statistic, slope -0.8254<-- =tslope(B3:B32,C3:C32)\n10 Disney DIS 0.29% 1.2805 0.0020\n11 General Electric GE -0.23% 0.8420 -0.0030\n12 General Motors GM -0.87% 1.4060 -0.0097\n13 Home Depot HD -0.52% 1.5528 -0.0063\n14 Honeywell HON 0.29% 1.6640 0.0017\n15 Hewlett Packard HPQ 0.61% 1.9594 0.0046\n16 IBM -0.47% 1.5764 -0.0058\n17 Intel I NTC -0.73% 2.2648 -0.0089\n18 Johnson & Johnson JNJ 0.34% 0.2471 0.0032\n19 JP Morgan JPM 0.18% 1.7917 0.0005\n20 Coca Cola KO 0.12% 0.3590 0.0009\n21 McDonalds M CD 0.35% 1.2646 0.0025\n22 3M M MM 0.64% 0.6504 0.0059\n23 AltriaM O 1.30% 0.6633 0.0125\n24 Merck M RK -0.63% 0.6099 -0.0068\n25 Microsoft MSFT -0.35% 1.1219 -0.0043\n26 Pfizer P FE -0.74% 0.5572 -0.0078\n27 Proctor Gamble P G 0.94% 0.1687 0.0093\n28 AT&T T -0.41% 1.1275 -0.0050\n29 United Technologies UTX 1.03% 1.0659 0.0095\n30 Verizon V Z -0.49% 1.0231 -0.0057\n31 Walmart W MT -0.25% 0.6000 -0.0030\n279 Estimating Betas and the Security Market Line\nThe results (cells F4:G6) are very disappointing. Our test yields the follow-\ning SML:\nE( r)=0(cid:2).0(cid:3)0(cid:4)36\u22120(cid:2).0(cid:3)0(cid:4)20\u03b2,R2 =0.0238\ni i\n\u2191 \u2191\n\u03b3 \u03b3\n0 1\nThere is nothing about these numbers which inspires confidence:\n\u2022 \u03b3 should correspond to the risk-free rate over the period. In section 11.9 we\n0\ndiscuss this rate, which changed wildly over the 60 months surveyed. At this\npoint it is enough to point out that the average monthly risk-free interest rate\nwas 0.18% (or 0.0018, exactly half of \u03b3 ).\n0\n\u2022 \u03b3 should correspond to E ( r ) \u2212 r. The average monthly return of the\n1 M f\nS&P 500 over the period was \u2212 0.10% and the average monthly risk-free inter-\nest rate was 0.18%, so that \u03b3 should be approximated by \u2212 0.28% (or 0.0028).\n1\n\u2022 Both the t -statistics for the i (cell G8) and the slope (cell G9) indicate that\nthey are not statistically different from zero.5\nO ur test of the SML has failed. The CAPM may have prescriptive validity,\nbut it does not describe our data.\nWhy Are the Results So Bad?\nThe experiment we did\u2014checking the CAPM by plotting the security market\nline\u2014does not appear to have worked out very well. There does not appear to\nbe much evidence in favor of the SML: Neither the R2 of the regression nor\nthe t -statistics give much evidence that there is a relation between expected\nreturn and portfolio \u03b2 .\nThere are a number of reasons why these disappointing results may hold:\n\u2022 O ne reason is that perhaps the CAPM itself does not hold. This could be\ntrue for a variety of reasons:\n(cid:4283)(cid:3) Perhaps in the market short sales of assets are restricted. Our derivation\nof the CAPM (see Chapter 9 on efficient portfolios) assumes that there\nare no short-sale restrictions. Clearly this is an unrealistic assumption.\nThe computation of efficient portfolios when short sales are restricted is\n5. The functions TIntercept and T Slope were created by the author. They are attached to the\n280 Chapter 11\nconsidered in Chapter 12. In this case, however, there are no simple relations\n(such as those proved in Chapter 9) between the returns of assets and their\nbetas. In particular, if short sales are restricted, there is no reason to expect\nthe SML to hold.\n(cid:4283) P erhaps individuals do not have homogeneous probability assessments,\nor perhaps they do not have the same expectations of asset returns, variances,\nand covariances.\n\u2022 Perhaps the CAPM holds only for portfolios and not for single assets.\n\u2022 P erhaps our set of assets isn\u2019 t large enough: After all, the CAPM talks about\nall risky assets, whereas we have chosen\u2014for illustrative purposes\u2014to do our\ntest on a very small subset of these assets. The literature on CAPM testing\nrecords tests in which the set of risky assets has been expanded to include\nbonds, real estate, and even non-diversifiable assets such as human capital.\n\u2022 Perhaps the \u201cmarket portfolio\u201d isn \u2019 t efficient. This possibility is suggested\nby the mathematics of Chapter 9 on efficient portfolios, and it is this sugges-\ntion which we further explore in the next section.\n\u2022 Perhaps the CAPM holds only if the market returns are positive (in the\nperiod surveyed they were, on average, negative)."
        ],
        "11.3": [
            "What does the term 'beta' signify in the context of financial modeling?\nCan you explain what the 'Security Market Line' refers to?\nWhat is the role of regression models in describing individual asset returns?\nWhat can be interpreted from a high or low 'R2' value in financial modeling?\nWhat does SP500 refer to in financial modeling and how it is coupled with 'beta'?\nWhat is the significance of beta when regressed on SP500?\nWhat can be deduced from an exercise that provides disappointing results in financial modeling? \nCan a disappointing result from an exercise in financial modeling indicate a positive learning? \nWhat lessons can we learn from financial modeling exercises that don't yield the expected results?",
            "11.3 Did We Learn Something?\n\nT he results of our exercise in section 11.1 are quite disappointing. Did we\nlearn anything positive from this exercise? Absolutely. For example, the regres-\nsion model does a pretty good job of describing individual asset returns in\n281 Estimating Betas and the Security Market Line\nBeta and R2for Each Stock\n2.50 as Regressed on SP500\n2.00\nBeta"
        ],
        "11.4": [
            "What is the SML as mentioned in financial modelling?\nWhat does the term \"efficient portfolio\" mean in financial modelling?\nHow does the SML relate to the returns of the market portfolio?\nCan you explain the concept of r-squared in financial modelling?\nWhat is the role of a variance-covariance matrix in constructing an efficient portfolio?\nHow is the efficiency of a portfolio determined? \nWhat does regress our asset returns on an efficient portfolio mean? \nWhat does a r-squared value of 100% signify for a portfolio? \nWhat is the significance of beta in the context of security market line and portfolio efficiency?\nHow is the intercept of the second-pass regression calculated in the financial modelling?\nWhat implications does an R-squared value of 100% have on a portfolio?\nExplain the term \"second-pass regression\" in financial modeling.\nWhat is the process for constructing an efficient portfolio using the variance-covariance matrix?\nWhat is the significance of the 'alpha' in financial modelling?\nWhat does R-squared value signify in the context of individual first-pass regressions in financial modelling? \nWhat does a mysterious portfolio refer to in the context of financial modeling? \nWhat is the relation between the \"mysterious portfolio\" and the SML?\nWhen we do not find adequate results from SML, what can be the possible reasons based on efficient portfolio theory?\nIn the context of financial modelling, what does term 'intercept' mean when dealing with the second-pass regression?\nWhat happens when we choose to regress our asset returns on a portfolio that is not efficient?\nHow is solving \u2211 S\u22121[ E( r)\u2212c] helpful for calculating an efficient portfolio?",
            "11.4 The Non-Efficiency of the \u201cMarket Portfolio\u201d\n\nWhen we calculated the SML in section 11.1, we regressed the mean return\nof each asset on the returns of the market portfolio. The propositions of\nChapter 9 on efficient portfolios suggest that our failure to find adequate\nresults may stem from the fact that the S&P 500 portfolio is not efficient rela-\ntive to the set of the six assets which we have chosen. Proposition 3 of Chapter\n9 states that if we had chosen to regress our asset returns on a portfolio that\nis efficient with respect to the asset set itself, we would get an r -squared of\n100%. Proposition 4 of Chapter 9 shows that if we get an r -squared of 100%\nthen the portfolio on which we regress the asset returns is necessarily efficient\nwith respect to the set of assets. In this section we give a numerical illustration\nof these propositions.\nI n the spreadsheet below we create a \u201cmysterious portfolio\u201d in column B.\nThis portfolio (its construction is described in the next subsection) is efficient\nwith respect to the Dow-Jones 30. As you can see in cells A10:B12, when we\nperform the second-pass regression\u2014regressing the individual average returns\nof the assets on their betas computed with respect to the mysterious portfo-\nlio\u2014the results are perfect. The resulting regression has an intercept of 0.0030\nand a slope of 0.0425. Most important\u2014it has an R 2 of 100%.\nA B C D E F G H I J K L M N\nRETURN DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\n1 July 2001 - July 2006\nDate Mysterious Alcoa InA tem rne ari tc ioa nn a l A Em xper ri ec sa sn Boeing Citigroup Caterpillar DuPont Disney G Ele en ce trr ia cl G Me on te or ra sl DH eo pm oe t Honeywell\n2 portfolio AA G Aro IGup AXP BA C CAT DD DIS GE GM HD HON\n3\n4 Average return 4.55% -0.09% -0.54% 0.72% 0.67% 0.30% 1.79% 0.18% 0.29% -0.23% -0.87% -0.52% 0.29%\n5 Beta -0.09 -0.20 0.10 0.09 0.00 0.35 -0.03 0.00 -0.13 -0.28 -0.19 0.00\n6 Alpha 0.33% 0.36% 0.27% 0.27% 0.30% 0.19% 0.31% 0.30% 0.34% 0.38% 0.36% 0.30%\n7 R-squared 0.0025 0.0242 0.0064 0.0024 0.0000 0.0579 0.0006 0.0000 0.0126 0.0176 0.0143 0.0000\n8\n9 SML--regressing the average returns on the betas\n10Intercept 0.0030<-- =INTERCEPT(C4:AF4,C5:AF5)\n11Slope 0.0425<-- =SLOPE(C4:AF4,C5:AF5)\n12R-squared 1.0000<-- =RSQ(C4:AF4,C5:AF5)\n13\n14\n15 01-Aug-01 -1.01% -2.49% -6.20% -10.20% -13.09% -8.88% -9.67% -3.59% -3.58% -6.16% -14.20% -9.11% 1.58%\n16 04-Sep-01 0.40% -20.66% -0.25% -22.59% -42.42% -12.30% -11.01% -8.77% -31.14% -9.02% -24.37% -18.03% -34.47%\n17 01-Oct-01 4.71% 4.46% 0.76% 1.55% -2.70% 11.69% 0.59% 6.37% -0.17% -2.15% -3.77% -0.35% 11.26%\n18 01-Nov-01 -1.33% 17.90% 4.73% 11.18% 7.89% 5.43% 5.86% 11.15% 9.61% 5.58% 19.65% 20.01% 12.09%\n19 03-Dec-01 8.11% -8.22% -3.67% 8.10% 9.97% 5.25% 9.68% -4.22% 2.29% 4.45% -2.25% 8.94% 2.03%\nThe Mysterious Portfolio Is Efficient\nT he propositions of Chapter 9 leave us with only one conclusion: The \u201cmys-\n284 Chapter 11\nthe spreadsheet below we show the construction of this efficient portfolio,\nwhich follows the propositions of Chapter 9.\n\u2022 We first construct the variance-covariance matrix S using the function Var-\ncovar defined in Chapter 10.\nS\u22121[ E( r)\u2212c]\n\u2022 W e then compute the efficient portfolio by solving \u2211 S\u22121[ E( r)\u2212c] . In the\nspreadsheet below we use c = 0.0030, which then turns out to be the intercept\nof the second-pass regression.\nA B C D E F G H I J K L M N\nRETURN DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\n1 July 2001 - July 2006\n2\nDate S I ^nP Sd P5 e0 Xx0 A Alc Aoa InA tem Gr An re oa Ir Gi utc i poa nn a l ExA pm ree sr sic Aan X P Bo Be Aing Citig Croup Cat Cer Ap Tillar Du DP Dont Di Ds In Sey ElG ece tn re icr a Gl E G Me o Gn t Me or ra sl DeH po om t He DHon He Oy Nwell\n3 =AVERAGE(C9:C68)\n4 Average return 0.07% -0.09% -0.54% 0.72% 0.67% 0.30% 1.79% 0.18% 0.29% -0.23% -0.87% -0.52% 0.29%\n5 Beta 1.00 1.90 =0.S9L9OPE(C9:C618.3,8$B$9:$B1$.1658) 1.30 1.39 1.00 1.28 0.84 1.41 1.55 1.66\n6 Alpha 0 -0.23% -0.61% 0.62% 0.58% 0.21% 1.69% 0.11% 0.20% -0.30% -0.97% -0.63% 0.17%\n7 R-squared 1 0.6085 =I0N.3T5E1R8CEPT(C90:.C760852,$B$90:$.2B4$8678) 0.5972 0.5158 0.4362 0.3845 0.3221 0.2607 0.5288 0.5473\n8\n9 01-Aug-01 -6.63% -2.49% -6.20% -10.20% -13.09% -8.88% -9.67% -3.59% -3.58% -6.16% -14.20% -9.11% 1.58%\n10 04-Sep-01 -8.53% -20.66% =RS-0Q.2(5C%9:C68,$-B2$29.5:9$%B$68-)42.42% -12.30% -11.01% -8.77% -31.14% -9.02% -24.37% -18.03% -34.47%\n11 01-Oct-01 1.79% 4.46% 0.76% 1.55% -2.70% 11.69% 0.59% 6.37% -0.17% -2.15% -3.77% -0.35% 11.26%\n12 01-Nov-01 7.25% 17.90% 4.73% 11.18% 7.89% 5.43% 5.86% 11.15% 9.61% 5.58% 19.65% 20.01% 12.09%\n13 03-Dec-01 0.75% -8.22% -3.67% 8.10% 9.97% 5.25% 9.68% -4.22% 2.29% 4.45% -2.25% 8.94% 2.03%\n14 02-Jan-02 -1.57% 0.83% -6.84% 0.67% 5.43% -5.96% -3.09% 3.83% 1.65% -7.58% 5.08% -1.81% -0.63%\n15 01-Feb-02 -2.10% 5.14% -0.18% 1.68% 11.97% -4.64% 9.88% 6.66% 8.80% 4.03% 4.55% -0.19% 13.14%\n67 01-Jun-06 0.01% 2.00% -2.92% -2.13% -1.62% -2.15% 2.08% -2.21% -1.65% -3.14% 10.09% -5.91% -2.16%\n68 03-Jul-06 -0.37% 3.61% -0.14% -2.08% -2.37% 1.71% -2.58% -2.58% -0.57% 1.03% -1.05% -1.18% -3.38%\n69\n70\n71The cells below compute the variance-covariance matrix for the DJ30 by using the formula {=varcovar(C9:AF68)}\n72 AA AIG AXP BA C CAT DD DIS GE GM HD HON HPQ\n73 AA 0.0093 0.0032 0.0038 0.0045 0.0033 0.0046 0.0040 0.0042 0.0024 0.0046 0.0046 0.0061 0.0060\n74 AIG 0.0032 0.0044 0.0020 0.0010 0.0023 0.0022 0.0022 0.0015 0.0015 0.0019 0.0021 0.0027 0.0024\n75 AXP 0.0038 0.0020 0.0042 0.0030 0.0031 0.0029 0.0020 0.0037 0.0019 0.0033 0.0033 0.0042 0.0050\n76 BA 0.0045 0.0010 0.0030 0.0083 0.0014 0.0029 0.0021 0.0037 0.0020 0.0043 0.0026 0.0053 0.0042\n99 UTX 0.0038 0.0012 0.0031 0.0050 0.0022 0.0026 0.0021 0.0038 0.0018 0.0030 0.0023 0.0049 0.0048\n100 VZ 0.0028 0.0018 0.0019 0.0007 0.0023 0.0022 0.0018 0.0014 0.0013 0.0006 0.0016 0.0024 0.0030\n101 WMT 0.0018 0.0014 0.0011 0.0003 0.0015 0.0011 0.0014 0.0009 0.0009 0.0012 0.0024 0.0008 0.0008\n102 XOM 0.0024 0.0010 0.0010 0.0017 0.0009 0.0021 0.0012 0.0004 0.0007 0.0020 0.0007 0.0020 0.0012\n103\n104Finding an efficient portfolio\n105Constant 0.30%\n106\n107 AA 5.45%<-- {=MMULT(MINVERSE(varcov),TRANSPOSE(C4:AF4)-B105)/SUM(MMULT(MINVERSE(varcov),TRANSPOSE(C4:AF4)-B105))}\n108 AIG -11.77%\n109 AXP -5.78%\n110 BA -13.94%\n111 C -36.60%\n112 CAT 76.26%\n113 DD -22.55%\n114 DIS -17.05%\n115 GE -8.80%\n116 GM -37.73%\n117 HD -37.21%\n118 HON -17.40%\n119 HPQ 39.79%\n120 IBM -26.38%\n121 INTC -18.62%\n122 JNJ 65.08%\n123 JPM 53.61%\n124 KO -12.95%\n125 MCD -12.18%\n126 MMM -2.07%\n127 MP 42.15%\n128 MRK 8.29%\n129 MSFT 3.61%\n130 PFE -61.19%\n131 PG 54.67%\n132 T -8.38%\n133 UTX 44.05%\n134 VZ -36.55%\n135 WMT 64.78%\n136 XOM 29.40%\n285 Estimating Betas and the Security Market Line\nT he \u201cmysterious portfolio\u201d is not unique. Following we show results using\nanother constant c, which gives another version of the SML.\nA B C D E F G H I J K L M N\nRETURN DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\n1 July 2001 - July 2006\nAmerican American General General Home\nDate Mysterious Alcoa International Express Boeing Citigroup Caterpillar DuPont Disney Electric Motors Depot Honeywell\n2 portfolio AA G Aro IGup AXP BA C CAT DD DIS GE GM HD HON\n3\n4 Average return 8.88% -0.09% -0.54% 0.72% 0.67% 0.30% 1.79% 0.18% 0.29% -0.23% -0.87% -0.52% 0.29%\n5 Beta -0.07 -0.12 0.03 0.02 -0.02 0.15 -0.04 -0.02 -0.09 -0.16 -0.12 -0.03\n6 Alpha 0.54% 0.56% 0.49% 0.49% 0.51% 0.42% 0.52% 0.51% 0.54% 0.58% 0.56% 0.51%\n7 R-squared 0.0061 0.0399 0.0019 0.0005 0.0015 0.0467 0.0045 0.0010 0.0256 0.0259 0.0237 0.0009\n8\n9 SML--regressing the average returns on the betas\n10Intercept 0.0050<-- =INTERCEPT(C4:AF4,C5:AF5)\n11Slope 0.0838<-- =SLOPE(C4:AF4,C5:AF5)\n12R-squared 1.0000<-- =RSQ(C4:AF4,C5:AF5)\nNote also that even though the R 2 of the second pass regression is 100%\n(since the \u201cmysterious portfolio\u201d is efficient), the R2 \u2019 s of the individual first-\npass regressions are far from notable."
        ],
        "11.5": [
            "What is the \"mysterious\" portfolio in the context of financial markets?\nHow does the \"mysterious\" portfolio relate to the stocks of the Dow Jones?\nWhat might be a reason that the \"mysterious\" portfolio could not be the true market portfolio?\nWhy is it significant that many of the stocks appear in the \"mysterious portfolio\" with negative weights?\nWhy is it crucial for a true market portfolio to have all shares appear in it with positive proportions?\nWho suggested the only test of the CAPM and what does the test entail?\nWhat is meant by \"mean-variance efficient\" in relation to the true market portfolio?\nWhat does Proposition 3 of Chapter 9 imply about the relationship between the mean of each portfolio and its beta?\nHow can a table of asset proportions of portfolios on the efficient frontier reveal more about the market portfolio and the CAPM?\nWhat does the data table reveal about the portfolios for the DJ30?\nWhy would some efficient portfolios for the DJ30 contain significant short positions?\nHow does Excel's Data Table tool contribute to building a table of the largest short and long positions for a series of efficient portfolios?\nWhat conclusion can be drawn if the data for the DJ30 and the S&P 500 are representative?\nHow can it be concluded that the CAPM as a descriptive theory of capital markets may not work?",
            "11.5 So What \u2019 s the Real Market Portfolio? How Can We Test the CAPM?\n\nA little reflection will reveal that although the \u201cmysterious\u201d portfolio of the\nprevious section may be efficient with respect to the 30 stocks of the Dow-\nJones, it could not be the true market portfolio, even if the DJ30 stocks rep-\nresented the whole universe of risky securities. This is because many of the\nstocks appear in the \u201cmysterious portfolio\u201d with negative weights. Surely a\nminimal characteristic of the market portfolio must be that all shares appear\nin it with positive proportions .\nRoll (1977, 1978) suggests that the only test of the CAPM is to answer the\nquestion: Is the true market portfolio mean-variance efficient? If the answer\nto this question is \u201cyes,\u201d then it follows from Proposition 3 of Chapter 9 that\na linear relation holds between the mean of each portfolio and its \u03b2 . In our\nexample, we can shed some light on this question by building a table of the\nasset proportions of portfolios on the efficient frontier.\nI n the table below we give some evidence that all efficient portfolios for the\nDJ30 contain significant short positions. Using the wonders of Excel \u2019 s Data\nTable , we compute the largest short and long positions for a series of efficient\nportfolios, each defined by its own constant c . All of these portfolios contain\n286 Chapter 11\nA B C D E F G H I\nData table: computing the largest short and\n105An efficient portfolio long position for a given constant c\nLargest Largest\n106Constant 0.30% short long\n107 Constant c <-- Data table hidden: =B141\n108 AA 5.5% 0.00% -32.64% 52.33%\n109 AIG -11.8% 0.05% -35.51% 53.58%\n110 AXP -5.8% 0.10% -38.87% 55.05%\n111 BA -13.9% 0.15% -42.86% 56.79%\n112 C -36.6% 0.20% -47.69% 59.70%\n113 CAT 76.3% 0.25% -53.65% 67.01%\n114 DD -22.6% 0.30% -61.19% 76.26%\n115 DIS -17.0% 0.35% -71.01% 88.32%\n116 GE -8.8% 0.40% -84.36% 104.71%\n117 GM -37.7% 0.45% -103.56% 128.28%\n118 HD -37.2% 0.50% -133.51% 165.05%\n119 HON -17.4% 0.55% -186.77% 230.42%\n120 HPQ 39.8% 0.60% -307.86% 379.08%\n121 IBM -26.4% 0.65% -853.66% 1049.09%\n122 INTC -18.6% 0.70% -1398.93% 1140.50%\n123 JNJ 65.1% 0.75% -422.59% 345.18%\n124 JPM 53.6% 0.80% -249.90% 204.50%\n125 KO -13.0%\n126 MCD -12.2%\n127 MMM -2.1%\n128 MP 42.1%\n129 MRK 8.3%\n130 MSFT 3.6%\n131 PFE -61.2%\n132 PG 54.7%\n133 T -8.4%\n134 UTX 44.1%\n135 VZ -36.6%\n136 WMT 64.8%\n137 XOM 29.4%\n138 Sum 100.0%\n139\n140Largest short -61.2%<-- =MIN(B108:B137)\n141Largest long 76.3%<-- =MAX(B108:B137)\nO ur depressing conclusion: If the data for the DJ30 and the S&P 500 are\nrepresentative, the CAPM as a descriptive theory of capital markets appears\nnot to work. 7"
        ],
        "11.6": [
            "What is the definition of 'excess returns' in financial modeling?\nHow can 'excess returns' be used in performing the variation in the experiment of the Capital Asset Pricing Model (CAPM)?\nHow are treasury bill returns related to excess returns in financial modeling?\nWhat is the significance of 'Beta' in financial modeling?\nWhat role does 'Alpha' play in financial modeling and how is it related to excess returns?\nWhy is the concept of 'R-squared' critical in financial modeling?\nWhat is a 'second-pass regression' in the context of financial modeling?\nHow are excess returns, Beta, and Alpha used in the second-pass regression analysis?\nCan the use of 'excess returns' significantly improve the analysis of the CAPM experiment?\nHow is financial modeling applied to the analysis of stock returns?\nWhat are the implications of Alpha, Beta, and R-squared values in interpreting regression results in financial modeling?\nWhat could be the consequences if one conducts an experiment on the Capital Asset Pricing Model (CAPM) in terms of excess returns?",
            "11.6 Using Excess Returns\n\nPerhaps we should have conducted our experiment on the CAPM in terms of\nexcess returns\u2014the difference between the stocks\u2019 monthly returns and the\nrisk-free rates? In this section we perform this variation on the experiment and\nshow that it does little to improve our analysis.\n7 . A ll is not lost! In Chapter 13 we examine the Black-Litterman model, which is a more positivist\n287 Estimating Betas and the Security Market Line\nBelow we show the same Dow-Jones data, with an additional column\nappended for Treasury bill returns; these varied wildly over the period:\nA B C D E F G H I J K L M N O\nEXCESS RETURN DATA FOR THE DOW-JONES INDUSTRIAL STOCKS AND THE STANDARD AND POORS 500\nMonthly returns minus monthly Treasury bill return\n1 July 2001 - July 2006\n2 Date bT ri ir l sle r kra a-es tft eru u er r ey n S ^& I GnP d S e P5 x0 C0 A Alc Aoa InA tem Gr An re oa Ir Gi utc i poa nn a l A Em x Ape Xr ri e Pc sa sn Bo Be Aing Citig Croup Cat Cer Ap Tillar Du DP Dont Di Ds In Sey G Ele e Gn c Ee trr ia cl G Me o Gn t Me or ra sl DeH po om t e H D Hon He Oy Nwell\n3\n4 Average return -0.22% -0.38% -0.83% 0.43% 0.37% 0.01% 1.50% -0.11% 0.00% -0.53% -1.16% -0.81% 0.00%\n5 Beta 1.00 1.90 0.99 1.38 1.15 1.30 1.39 1.00 1.28 0.84 1.41 1.55 1.66\n6 Alpha 0 0.04% -0.61% 0.73% 0.63% 0.29% 1.81% 0.11% 0.28% -0.34% -0.86% -0.47% 0.36%\n7 R-squared 1 0.6085 0.3518 0.7052 0.2487 0.5972 0.5158 0.4362 0.3845 0.3221 0.2607 0.5288 0.5473\n8\n9 01-Aug-01 0.29% -6.92% -2.78% -6.49% -10.49% -13.38% -9.17% -9.97% -3.88% -3.87% -6.45% -14.49% -9.40% 1.28%\n10 04-Sep-01 0.28% -8.82% -20.95% -0.54% -22.89% -42.72% -12.60% -11.30% -9.06% -31.44% -9.32% -24.66% -18.33% -34.76%\n11 01-Oct-01 0.22% 1.50% 4.17% 0.47% 1.26% -2.99% 11.40% 0.30% 6.08% -0.46% -2.44% -4.06% -0.65% 10.97%\n12 01-Nov-01 0.18% 6.96% 17.60% 4.44% 10.89% 7.60% 5.14% 5.56% 10.85% 9.32% 5.29% 19.36% 19.72% 11.80%\n13 03-Dec-01 0.16% 0.46% -8.52% -3.96% 7.81% 9.68% 4.96% 9.39% -4.52% 2.00% 4.16% -2.54% 8.65% 1.74%\n14 02-Jan-02 0.14% -1.86% 0.405.%54% -7.13% 0.37% 5.14% -6.26% -3.39% 3.54% 1.35% -7.87% 4.79% -2.11% -0.92%\n15 01-Feb-02 0.14% -2.39% 4.85% -0.47% 1.39% 11.68% -4.93% 9.59% 6.36% 8.51% 3.74% 4.26% -0.48% 12.85%\n16 01-Mar-02 0.14% 3.32% 0.400.%17% -2.81% 11.37% 4.56% 8.73% 2.09% 0.37% 0.07% -3.18% 12.91% -3.02% 0.11%\n17 01-Apr-02 0.15% -6.63% 0-.1305.%64% -4.56% 0.03% -8.14% -13.70% -3.67% -6.07% 0.11% -17.32% 5.65% -5.00% -4.55%\n18 01-May-02 0.14% -1.20% 2.91% -3.45% 3.29% -4.39% -0.18% -4.70% 3.81% -1.47% -1.58% -2.72% -10.94% 6.84%\n19 03-Jun-02 0.14% -7.81% 0.3-50.%67% 1.63% -16.02% 5.07% -11.10% -6.85% -3.86% -19.55% -6.64% -15.37% -12.83% -10.96%\n20 01-Jul-02 0.14% -8.52% 0-.2205.%04% -6.82% -3.04% -8.36% -14.72% -8.56% -6.04% -6.67% 10.00% -14.12% -17.65% -8.81%\n21 01-Aug-02 0.14% 0.19% -7.82% -2.05% 1.97% -11.16% 4.83% -2.69% -3.36% -12.53% -6.86% 3.63% 6.16% -7.45%\n22 03-Sep-02 0.14% -11.95% 0-.2260.%52% -14.03% -14.84% -8.55% -10.25% -16.22% -11.40% -3.81% -19.74% -21.01% -23.41% -32.66%\n23 01-Oct-02 0.14% 8.00% 0.1135.%04% 13.11% 15.33% -14.04% 22.23% 9.92% 13.12% 9.47% 2.10% -16.00% 9.83% 9.71%\n24 01-Nov-02 0.13% 5.26% 15.03% 3.78% 6.52% 13.76% 4.80% 19.76% 8.38% 16.87% 6.88% 18.89% -9.27% 8.80%\n25 02-Dec-02 0.10% -6.52% 0-.1110.%76% -12.10% -9.71% -3.46% -10.27% -9.04% -5.38% -18.59% -10.31% -7.70% -9.51% -8.34%\n26 02-Jan-03 0.10% -3.07% -14.44% -6.96% 0.21% -4.64% -2.15% -3.44% -11.59% 6.77% -5.42% -1.74% -14.19% 1.50%\n27 03-Feb-03 0.10% -2.01% 0.045.%08% -9.65% -5.92% -13.40% -3.27% 6.35% -2.57% -2.85% 4.38% -6.21% 11.20% -6.01%\n28 03-Mar-03 0.10% 0.54% 0.0-50.%87% 0.14% -1.35% -9.79% 2.98% 4.26% 5.51% -0.53% 5.55% -0.75% 3.77% -7.21%\n29 01-Apr-03 0.09% 7.50% 17.16% 15.56% 12.98% 8.20% 12.76% 7.04% 8.74% 8.95% 14.11% 6.71% 14.09% 9.69%\n30 01-May-03 0.09% 4.67% 6.77% -0.42% 9.27% 11.98% 4.61% -1.14% -0.40% 4.87% -2.87% -0.92% 14.14% 10.89%\n31 02-Jun-03 0.09% 0.83% 3.27% -4.98% 0.07% 10.95% 3.97% 6.22% -1.50% 0.23% 0.31% 1.57% 1.81% 2.17%\n32 01-Jul-03 0.08% 1.32% 8.24% 14.85% 5.45% -3.85% 5.05% 19.55% 5.10% 10.09% -1.16% 3.59% -6.29% 4.91%\n33 01-Aug-03 0.08% 1.48% 3.09% -7.78% 1.68% 12.36% -3.60% 5.95% 2.31% -6.94% 3.62% 10.41% 2.73% 2.84%\n34 02-Sep-03 0.08% -1.49% -9.09% -3.36% -0.29% -8.84% 4.56% -4.54% -11.47% -1.96% 1.12% -0.71% -1.03% -9.82%\nAug-01 Oct-01 Dec-01 Feb-02 Apr-02 Jun-02 Aug-02 Oct-02 Dec-02 Feb-03 Apr-03 Jun-03 Aug-03 Oct-03 Dec-03 Feb-04 Apr-04 Jun-04 Aug-04 Oct-04 Dec-04 Feb-05 Apr-05 Jun-05 Aug-05 Oct-05 Dec-05 Mar-06 May-06 Jul-06\nMonthly Treasury Bill Rates, Aug2001-July2006\nR unning the second-pass regression shows only minor changes from the\nresults of section 11.2:\nA B C D E F G H\n1 THE SECOND-PASS REGRESSION FOR EXCESS RETURNS\nAverage\nmonthly\nStock Beta Alpha\nexcess\n2 return\n3 Alcoa A A -0.38% 1.9028 0.0004 Second-pass regression, regressing monthly returns on Beta\n4 American International Group A IG -0.83% 0.9936 -0.0061 Intercept 0.0007<-- =INTERCEPT(B3:B32,C3:C32)\n5 American Express AXP 0.43% 1.3784 0.0073 Slope -0.0020<-- =SLOPE(B3:B32,C3:C32)\n6 Boeing BA 0.37% 1.1515 0.0063 R-squared 0.0238<-- =RSQ(B3:B32,C3:C32)\n7 Citigroup C 0.01% 1.2952 0.0029\n8 Caterpillar CAT 1.50% 1.3903 0.0181 t-statistic, intercept 0.2439<-- =tintercept(B3:B32,C3:C32)\n9 Du Pont DD -0.11% 1.0009 0.0011 t-statistic, slope -0.8254<-- =tslope(B3:B32,C3:C32)\n10 Disney DIS 0.00% 1.2805 0.0028\n11 General Electric GE -0.53% 0.8420 -0.0034\n288 Chapter 11"
        ],
        "11.7": [
            "What is the purpose of the CAPM in financial modeling?\nWhat does beta represent in the Capital Asset Pricing Model (CAPM)?\nCan the mean returns be described by their regression on a market portfolio in the CAPM?\nIs the CAPM a normative description of how to choose portfolios?\nIn the context of the CAPM, what does a larger diversified portfolio mean?\nWhat can be said about the average beta of a well-diversified portfolio?\nDoes the beta of an asset measure the dependence of the asset's returns on the market returns?\nIs the beta of an asset an important measure of the asset's risk in financial modeling?\nWhat could be the reasonable description of a well-diversified portfolio's risk?\nWhat does the CAPM suggest about the relationship between an asset's risk and its beta?",
            "11.7 Summary: Does the CAPM Have Any Uses?\n\nIs the game lost? Do we have to give up on the CAPM? Not totally:\n\u2022 First of all, it could be that the mean returns are approximately described\nby their regression on a market portfolio. In this alternative description of the\nCAPM, we claim (with some justification) that the \u03b2 of an asset (which mea-\nsures the dependence of the asset \u2019s returns on the market returns) is an impor-\ntant measure of the asset\u2019 s risk.\n\u2022 Second, the CAPM might be a good normative description of how to\nchoose portfolios. As we showed in the appendix of Chapter 3, larger diversi-\nfied portfolios are quite well described by their betas, so that the average\nbeta of a well-diversified portfolio may be a reasonable description of the\nportfolio \u2019 s risk."
        ]
    },
    "12": {
        "12.1": [
            "What does it mean to find an efficient portfolio?\nWhat is the envelope of the feasible set of portfolios?\nCan you explain the concept of a tangent portfolio?\nWhat does the variable 'sigma' denote in the context of financial modeling?\nCan you explain the methodology given in Proposition 1 of Chapter 9 for solving portfolio efficiency problems?\nWhat is the implication when 'x' is less than 0 in the context of financial modeling?\nCan you explain the concept of short selling in finance?\nWhat happens to the proceeds from a short sale?\nWhat are some of the complicating factors in reality around the model of short sales?\nHow common is it for all of the short-sale proceeds to become available to the investor at the time of investment?\nWhat is typically done with the proceeds of a short sale by brokerage houses?\nWhat restrictions might an investor face when trying to make short sales?\nHow does the assumption that short sales are impossible affect small investors?\nWhat does it mean to restrict short sales in the context of finding efficient portfolios?\nHow can one use Excel's Solver to find efficient portfolios of assets?\nWhat assumptions does the model make about the availability of short-sale proceeds to the investor?",
            "12.1 Overview\n\nIn Chapter 9 we discussed the problem of finding an efficient portfolio. As\nshown there, this problem can be written as finding a tangent portfolio on the\nenvelope of the feasible set of portfolios:\nFinding Envelope Portfolios\nsigma\nnaem\nx\nc\nT he proof in the Appendix to Chapter 9 for solving for such an efficient\nportfolio involved finding the solution to the following problem:\nE(r )\u2212c\nmax\u0398= x\n\u03c3\np\nsuchthat\n\u2211N\nx =1\ni\ni=1\nwhere\nE(r )=xT\n\u22c5R=\u2211\u2211N\nxE(r)\nx i i\ni=1\n\u03c3 = xTSx =\n\u2211N \u2211N\nxx\u03c3\np i j ij\ni=1 j=1\nProposition 1 of Chapter 9 gives a methodology for solving this problem.\n292 Chapter 12\nwhen x < 0 , this assumes that the i t h security is sold short by the investor and\ni\nthat the proceeds from this short sale become immediately available to the\ninvestor.\nR eality is, of course, considerably more complicated than this academic\nmodel of short sales. In particular, it is rare for all of the short-sale proceeds\nto become available to the investor at the time of investment, since brokerage\nhouses typically escrow some or even all of the proceeds. It may also be that\nthe investor is completely prohibited from making any short sales (indeed,\nmost small investors seem to proceed on the assumption that short sales are\nimpossible).1\nIn this chapter we investigate these problems. We show how to use Excel \u2019 s\nSolver to find efficient portfolios of assets when we restrict short sales.2"
        ],
        "12.2": [
            "What is the problem that is attempted to be solved in the context of finding an optimal portfolio when no short sales are allowed?\nWhat does the short-sales constraint x > 0 signify in this context?\nWhat is the role of the Kuhn-Tucker conditions in the context of efficient set mathematics when short sales of assets are restricted?\nHow is the portfolio optimization problem solved without any short-sale constraints?\nWhat is the Sharpe ratio of the portfolio in the context of portfolio optimization and how is it calculated?\nHow does the Solver solution assist in maximizing the Sharpe ratio \u03b8? \nHow does the Solver add-in help to achieve a solution when Tools|Solver doesn't work?\nWhy is a short position in asset 4 considered in the optimal solution?\nHow is short selling restricted when solving a constrained portfolio problem?\nHow does one add a no-short-sale constraint to Solver?\nWhat is the implication of the portfolio proportions summing to 1 in the context of the Solver dialogue box?\nWhat is the method of \"Make Unconstrained\" used for in Solver?\nHow does changing the value of constant c in the spreadsheet help compute other portfolios?\nWhat determines the effectiveness of the short-sale restriction in a portfolio?\nWhat happens when c gets lower, as shown in the example with c=3%?\nIn the context of portfolio optimization, what is the implication of having only asset 4 included in the maximizing portfolio for very high c's, such as c = 11%?",
            "12.2 A Numerical Example\n\nWe start with the problem of finding an optimal portfolio when no short sales\nare allowed. The problem we solve is similar to the maximization problem\nstated above, with the addition of the short-sales constraint x > 0 for the asset\ni\nproportions:\nE(r )\u2212c\nmax\u0398= x\n\u03c3\np\nsuchthat\n\u2211N\nx =1\ni\ni=1\nx \u22650,i=1,\u2026,N\ni\nwhere\n1. The actual procedures for implementing a short sale are not simple. A well-written academic\nsurvey is a recent paper by Gene D\u2019Avolio, \u201cThe Market for Borrowing Stock,\u201d J ournal of Finan-\ncial Economics (2003). There\u2019 s also a wonderful article, \u201cGet Shorty,\u201d in the 1 December 2003\nissue of The New Yorker magazine by James Surowiecki.\n2. We do not go into the efficient set mathematics when short sales of assets are restricted. This\ninvolves the Kuhn-Tucker conditions, a discussion of which can be found in Edwin Elton, Martin\nGruber, Stephen Brown, and W. N. Goetzmann, Modern Portfolio Theory and Investment Analysis\n293 Efficient Portfolios Without Short Sales\nE(r )=xT\n\u22c5R=\u2211N\nxE(r)\nx i i\ni=1\n\u03c3 = xTSx =\n\u2211N \u2211N\nxx\u03c3\np i j ij\ni=1 j=1\nSolving an Unconstrained Portfolio Problem\nTo set the scene, we consider the optimization problem below, which we\nsolve without any short-sale constraints. The spreadsheet shows a four-asset\nvariance-covariance matrix and associated expected returns. Given a constant\nc = 8%, the optimal portfolio is given in cells B11:B14. Notice \u03b8 in cell B19:\nThis is the Sharpe ratio of the portfolio, the ratio of its excess return over the\nE(\nr\n)\u2212c\nconstant c to its standard deviation: \u03b8 = x . The optimal portfolio\n\u03c3\nx\nmaximizes the Sharpe ratio \u03b8 .\nA B C D E F G H\nPORTFOLIO OPTIMIZATION ALLOWING SHORT SALES\n1 Follows Proposition 1, Chapter 9\n2 Variance-covariance matrix Means\n3 0.10 0.03 -0.08 0.05 8%\n4 0.03 0.20 0.02 0.03 9%\n5 -0.08 0.02 0.30 0.20 10%\n6 0.05 0.03 0.20 0.90 11%\n7\n8 c 3.0%<-- This is the constant\n9\n10 Optimal portfolio without short sale restrictions (Chapter 9, Proposition 1)\n11 x1 0.6219<-- {=MMULT(MINVERSE(B3:E6),G3:G6-C8)/SUM(MMULT(MINVERSE(B3:E6),G3:G6-C8))}\n12 x2 0.0804\n13 x3 0.3542\n14 x4 -0.0565\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 8.62%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 19.39%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))}\n\u03b8 = Theta =\n19 (mean-constant)/sigma 28.99%<-- =(B17-C8)/B18\nT here is another way to solve this unconstrained problem. Starting from an\narbitrary portfolio (the spreadsheet below uses x = x = x = x = 0.25), we\n1 2 3 4\n294 Chapter 12\nThe Solver solution maximizes \u03b8 (cell B19) subject to the constraint that\ncell B15, which contains the sum of the portfolio positions, equals 1.3 When\nwe press Solve we get the solution we achieved before:\n3. If Tools|Solver doesn \u2019 t work, you may not have loaded the Solver add-in. To do so, go to\n295 Efficient Portfolios Without Short Sales\nSolving a Constrained Portfolio Problem\nThe optimal solution above contains a short position in asset 4. To restrict the\nshort selling, we add a no-short-sale constraint to Solver . Starting from an\narbitrary solution, we bring up S olver as shown below:\nPressing Solve yields the following solution:\nA B C D E F G H\nPORTFOLIO OPTIMIZATION WITHOUT SHORT SALES\nSolution with Solver, starting from an arbitrary feasible portfolio\n1\n2 Variance-covariance matrix Means\n3 0.10 0.03 -0.08 0.05 8%\n4 0.03 0.20 0.02 0.03 9%\n5 -0.08 0.02 0.30 0.20 10%\n6 0.05 0.03 0.20 0.90 11%\n7\n8 c 3.0%<-- This is the constant\n9\n10 Here we start with an arbitrary feasible portfolio and use Solver\n11 x1 0.5856\n12 x2 0.0965\n13 x3 0.3179\n14 x4 0.0000\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 8.73%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 20.32%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))}\n\u03b8= Theta =\n296 Chapter 12\nT he non-negativity constraints is added by clicking on the Add button in\nthe S olver dialogue box. This brings up the following window (shown here\nfilled in):\nT he second constraint (which constrains the portfolio proportions to sum to\n1) is added in a similar fashion.\nAn Alternative Method\nT here\u2019 s another way of doing this. Solver has an option: \u201cMake Unconstrained\n297 Efficient Portfolios Without Short Sales\nBy changing the value of c in the spreadsheet, we can compute other port-\nfolios; in the following example, we have set the constant c = 8.5%:\nA B C D E F G H\nPORTFOLIO OPTIMIZATION WITHOUT SHORT SALES\nSolution with Solver, starting from an arbitrary feasible portfolio\n1\n2 Variance-covariance matrix Means\n3 0.10 0.03 -0.08 0.05 8%\n4 0.03 0.20 0.02 0.03 9%\n5 -0.08 0.02 0.30 0.20 10%\n6 0.05 0.03 0.20 0.90 11%\n7\n8 c 8.5%<-- This is the constant\n9\n10 Here we start with an arbitrary feasible portfolio and use Solver\n11 x1 0.0000\n12 x2 0.2515\n13 x3 0.4885\n14 x4 0.2601\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 10.01%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 45.25%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))}\n\u03b8= Theta =\n19 (mean-constant)/sigma 3.33%<-- =(B17-C8)/B18\nIn both examples, the short-sale restriction is effective, with zero positions\nin some asset. However, not all values of c give portfolios in which the short-\nsale constraints are effective. For example, if the constant is 8%, we get:\nA B C D E F G H\nPORTFOLIO OPTIMIZATION WITHOUT SHORT SALES\nSolution with Solver, starting from an arbitrary feasible portfolio\n1\n2 Variance-covariance matrix Means\n3 0.10 0.03 -0.08 0.05 8%\n4 0.03 0.20 0.02 0.03 9%\n5 -0.08 0.02 0.30 0.20 10%\n6 0.05 0.03 0.20 0.90 11%\n7\n8 c 8.0%<-- This is the constant\n9\n10 Here we start with an arbitrary feasible portfolio and use Solver\n11 x1 0.2004\n12 x2 0.2587\n13 x3 0.4219\n14 x4 0.1190\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 9.46%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 31.91%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))}\n\u03b8= Theta =\n298 Chapter 12\nA s we saw for the example where c = 3%, as c gets lower, the short-sale\nconstraint begins to be effective with respect to asset 4. For very high c \u2019 s (the\ncase below illustrates c = 11%), only asset 4 is included in the maximizing\nportfolio:\nA B C D E F G H\n8 c 11.0%<-- This is the constant\n9\n10 Here we start with an arbitrary feasible portfolio and use Solver\n11 x1 0.0000\n12 x2 0.0000\n13 x3 0.0000\n14 x4 1.0000\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 11.00%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 94.87%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))}\n\u03b8= Theta =\n19 (mean-constant)/sigma 0.00%<-- =(B17-C8)/B18"
        ],
        "12.3": [
            "What is the efficient frontier in financial modeling?\nWhat are short-sale restrictions in financial modeling?\nWhat changes occur when short-sale restrictions are imposed while graphing the efficient frontier?\nWhat's the function of a VBA program in determining the efficient frontier with short-sale restrictions?\nHow does the efficient frontier with short-sale restrictions differ from the one without short-sale restrictions?\nWhat is the impact of short-sale restrictions on the maximization problem in financial modeling?\nCan the two efficient frontiers - with and without short sales, coincide at some points? If yes, give an example of such a scenario.\nWhat is the impact on portfolios with higher returns and sigmas due to short-sale restrictions? \nHow do short-sale restrictions imfluence the shape of the graph of the efficient frontier in the context of financial modelling? \nWhat additional constraints does short-sale restrictions introduce in financial modeling? \nWhich software or programming language often supports the process of plotting the efficient frontier with short-sale restrictions?",
            "12.3 The Efficient Frontier with Short-Sale Restrictions\n\nW e want to graph the efficient frontier with short-sale restrictions. Recall that\nin the case of no short-sale restrictions discussed in Chapter 9, it was enough\nto find two efficient portfolios in order to determine the whole efficient frontier\n(this was proved in Proposition 2 of Chapter 9). When we impose short-sale\nrestrictions, this statement is no longer true. In this case the determination of\nthe efficient frontier requires the plotting of a large number of points. The only\nefficient (pardon the pun!) way of doing this is with a VBA program which\nrepeatedly applies the S olver and puts the solutions in a table.\nIn section 12.3 we describe such a program. Once we have the program and\nthe graph of the efficient frontier without short sales, we can compare this\n299 Efficient Portfolios Without Short Sales\n13%\n12%\n11%\n10%\n9%\n8%\n7%\n6%\n18% 28% 38% 48% 58% 68% 78% 88% 98%\nThe relation between these two graphs is not all that surprising:\n\u2022 In general, the efficient frontier with short sales dominates the efficient\nfrontier without short sales. This must clearly be so, since the short-sales\nrestriction imposes an extra constraint on the maximization problem.\n\u2022 F or some cases, the two efficient frontiers coincide. One such point occurs,\nas we saw above, when c = 8%.\nPutting these two graphs on one set of axes shows that the effect of the\nshort-sale restrictions is mainly for portfolios with higher returns and sigmas."
        ],
        "12.4": [
            "What is an efficient frontier in the context of financial modeling?\nWhat does a VBA program do in the context of financial modeling?\nWhat is the significance of short sales in creating an efficient portfolio?\nWhat does the 'Solve' subroutine do in a VBA program for financial modeling?\nWhat does the 'Doit' subroutine do in the VBA program for financial modeling?\nWhat is the purpose of Solver in VBA for financial modeling applications?\nHow does substituting a constant ranging affect the optimal portfolio?\nHow does short sales restriction influence the efficiency frontier?\nWhat is the role of variance-covariance matrix in the calculation of efficient portfolios?\nWhat is the use of functions like MMULT and TRANSPOSE in financial modeling with VBA?\nHow can Solver be added as a reference in VBA?\nWhat happens to efficient portfolios for no-short sales when a program iteratively substitutes a constant?\nWhat does the 'Theta' term signify in the output of the program?\nHow do modifications in the constant value affect the output variables like portfolio mean, sigma and Theta?\nHow is the concept of \"no short sales\" represented in a VBA program for financial modeling?\nCan the efficiency of portfolios be compared when short sales are allowed versus not allowed, and if so, how does it impact the returns?",
            "12.4 A VBA Program for the Efficient Frontier Without Short Sales\n\nThe output for the restricted short-sale case shown in section 12.3 was pro-\nduced with the following VBA program:\n)%(\nnruteR\nnaeM\nComparing Two Efficient Frontiers\nFor low sigmas the two frontiers coincide\nFor higher sigmas, no restrictions on short sales\ngives higher returns\nNo short sales\nShort sales allowed\n300 Chapter 12\nSub Solve()\nSolverOk SetCell: = \u201d$B$19\u201d, MaxMinVal: = 1,\nValueOf: = \u201d0\u201d, ByChange: = \u201d$B$11:$B$14\u201d\nSolverSolve UserFinish: = True\nEnd Sub\nSub Doit()\nRange(\u201cResults\u201d).ClearContents\nFor counter = 1 To 40\nRange(\u201cconstant\u201d) = -0.04 + counter * 0.005\nSolve\nApplication.SendKeys (\u201c{Enter}\u201d)\nRange(\u201cResults\u201d).Cells(counter, 1) _\nActiveSheet.Range(\u201cconstant\u201d)\nRange(\u201cResults\u201d).Cells(counter, 2) _\nActiveSheet.Range(\u201cportfolio_sigma\u201d)\nRange(\u201cResults\u201d).Cells(counter, 3) _\nActiveSheet.Range(\u201cportfolio_mean\u201d)\nRange(\u201cResults\u201d).Cells(counter, 4) _\nActiveSheet.Range(\u201cx_1\u201d)\nRange(\u201cResults\u201d).Cells(counter, 5) _\nActiveSheet.Range(\u201cx_2\u201d)\nRange(\u201cResults\u201d).Cells(counter, 6) _\nActiveSheet.Range(\u201cx_3\u201d)\nRange(\u201cResults\u201d).Cells(counter, 7) _\nActiveSheet.Range(\u201cx_4\u201d)\nNext counter\nEnd Sub A ctiveSheet.Range(\u201cx_3\u201d)\nRange(\u201cResults\u201d).Cells(counter, 7) = _\nActiveSheet.Range(\u201cx_4\u201d)\nNext counter\nEnd Sub\nT he program includes two subroutines: S olve calls the Excel Solver; and\nthe subroutine D oit repeatedly calls the solver for different values of the\nrange named Constant (this is cell C8 in the spreadsheet), putting the output\n301 Efficient Portfolios Without Short Sales\nThe final output looks like this:\nA B C D E F G H I J K L M N O\n1 PORTFOLIO OPTIMIZATION WITHOUT SHORT SALES RESULTS\n2 Variance-covariance matrix Means c Sigma Mean x1 x2 x3\n3 0.10 0.03 -0.08 0.05 8% Ctrl+A works the VBA program -0.035 20.24% 8.70% 0.6049 0.0885 0.3066\n4 0.03 0.20 0.02 0.03 9% which calculates efficient -0.03 20.25% 8.70% 0.6042 0.0887 0.3070\n5 -0.08 0.02 0.30 0.20 10% portfolios for no-short sales. -0.025 20.25% 8.70% 0.6035 0.0890 0.3075\n6 0.05 0.03 0.20 0.90 11% This program iteratively -0.02 20.25% 8.71% 0.6027 0.0893 0.3080\n7 substitutes a constant ranging -0.015 20.25% 8.71% 0.6017 0.0897 0.3086\n8 c 16.0%<-- This is the constant from -3.5% 'till 16% (1/2% -0.01 20.26% 8.71% 0.6007 0.0901 0.3092\n9 jumps) and calculates the -0.005 20.26% 8.71% 0.5994 0.0908 0.3098\n10 optimal portfolio. 0 20.27% 8.71% 0.5982 0.0912 0.3106\n11 x1 0.0000 0 0.005 20.27% 8.71% 0.5968 0.0917 0.3115\n12 x2 0.0000 0 0.01 20.28% 8.72% 0.5950 0.0926 0.3123\n13 x3 0.0000 0 0.015 20.29% 8.72% 0.5932 0.0934 0.3134\n14 x4 1.0000 0 0.02 20.30% 8.72% 0.5910 0.0943 0.3147\n15Total 1.0000<-- =SUM(B11:B14) 0.025 20.31% 8.73% 0.5885 0.0953 0.3161\n16 0.03 20.32% 8.73% 0.5856 0.0965 0.3179\n17Portfolio mean 11.00%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)} 0.035 20.34% 8.74% 0.5821 0.0980 0.3199\n18Portfolio sigma 94.87%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3:E6,B11:B14)))} 0.04 20.37% 8.74% 0.5779 0.0998 0.3224\n19Theta -5.27%<-- =(B17-C8)/B18 0.045 20.41% 8.75% 0.5726 0.1019 0.3255\n20 0.05 20.46% 8.76% 0.5659 0.1047 0.3294\n21 0.055 20.54% 8.78% 0.5572 0.1083 0.3345\n22 0.06 20.67% 8.80% 0.5452 0.1133 0.3415\n23 0.065 20.90% 8.82% 0.5277 0.1205 0.3518\n24 0.07 21.36% 8.87% 0.4992 0.1324 0.3684\n25 0.075 23.27% 9.01% 0.4267 0.1630 0.3856\nAdding a Reference to Solver in VBA\nI f the above routine does not work, you may need to add a reference to S olver\nin the VBA editor. Press [Alt] + F11 to get to the editor and then go to\nTools|References :\nIf this reference is missing, go to T ools|References on the VBA menu and\n302 Chapter 12"
        ],
        "12.5": [
            "What is a position limit in the context of investment portfolios?\nWhat is the importance of position restrictions in financial modeling?\nWhat role does Excel and Solver play in Financial Modelling related to position restrictions?\nHow can an investor limit the percentage of a portfolio invested in a particular asset using Excel and Solver?\nWhat is a feasible portfolio in the context of portfolio optimization?\nWhat does a Variance-covariance matrix indicate in the context of financial modeling and portfolio optimization?\nHow is Theta calculated in the given financial model? \nWhat does a portfolio mean and sigma indicate?\nWhat are the kinds of constraints that might be considered in portfolio optimization?\nHow is the portfolio mean calculated in portfolio optimization?\nWhat relevance does a constant hold in financial modeling for portfolio optimization?\nWhat does the figure 5.0% denote in the text related to financial modelling and portfolio optimization?\nIn financial modelling, what could signify a minimum of 5% and a maximum of 40% investment in an asset?",
            "12.5 Other Position Restrictions\n\nI t goes without saying that Excel and S olver can accommodate other position\nlimits. Suppose, for example, that the investor wants at least 5% of her port-\nfolio invested in any asset and no more than 40% of the portfolio invested in\n303 Efficient Portfolios Without Short Sales\nThis solves to give:\nA B C D E F G\nPORTFOLIO OPTIMIZATION\nWITH MORE COMPLICATED CONSTRAINTS\n1\n2 Variance-covariance matrix Means\n3 0.10 0.03 -0.08 0.05 8%\n4 0.03 0.20 0.02 0.03 9%\n5 -0.08 0.02 0.30 0.20 10%\n6 0.05 0.03 0.20 0.90 11%\n7\n8 c 5.0%<-- This is the constant\n9\n10 Here we start with an arbitrary feasible portfolio and use Solver\n11 x1 0.4000\n12 x2 0.2270\n13 x3 0.3230\n14 x4 0.0500\n15 Total 1<-- =SUM(B11:B14)\n16\n17 Portfolio mean 9.02%<-- {=MMULT(TRANSPOSE(B11:B14),G3:G6)}\n18 Portfolio sigma 23.81%<-- {=SQRT(MMULT(TRANSPOSE(B11:B14),MMULT(B3\n\u03b8 = Theta =\n19 (mean-constant)/sigma 16.89%<-- =(B17-C8)/B18"
        ],
        "12.6": [
            "What is the main use of Excel in the context of portfolio maximization?\nHow does Excel Solver assist in setting up portfolio maximization problems?\nWhat are the crucial principles involved in portfolio maximization that can be illustrated using Excel?\nWhat are the steps involved in calculating the efficient frontier assuming no short sales are allowed?\nHow can we calculate the efficient frontier assuming that short sales are allowed?\nHow do you graph both efficient frontiers on the same set of axes?\nWhat is the methodology used to calculate returns in the given exercise?\nWhat's the significance of short-sale constraints in portfolio maximization?\nWhat is the Black-Litterman Approach to Portfolio Optimization?\nHow does allowing or disallowing short sales impact the efficient frontier of a portfolio?\nDefine \"efficient frontier\" in terms of portfolio management.",
            "12.6 Summary\n\nNo one would claim that Excel offers a quick way to solve for portfolio maxi-\nmization, with or without short-sale constraints. However, it can be used to\nillustrate the principles involved, and the Excel S olver provides an easy-to-use\nand intuitive interface for setting up these problems.\nExercise\nGiven the data below:\na. Calculate the efficient frontier assuming no short sales are allowed.\nb. Calculate the efficient frontier assuming that short sales are allowed.\nc. Graph both frontiers on the same set of axes.\nA B C D E F G H I\nMean\nA B C D E F\n3 returns\n4 A 0.0100 0.0000 0.0000 0.0000 0.0000 0.0000 0.0100\n5 B 0.0000 0.0400 0.0000 0.0000 0.0000 0.0000 0.0200\n6 C 0.0000 0.0000 0.0900 0.0000 0.0000 0.0000 0.0300\n7 D 0.0000 0.0000 0.0000 0.1500 0.0000 0.0000 0.0400\n8 E 0.0000 0.0000 0.0000 0.0000 0.2000 0.0000 0.0500\n13 The Black-Litterman Approach to Portfolio Optimization"
        ]
    },
    "13": {
        "13.1": [
            "What is the classic approach to portfolio optimization?\nWho were the main contributors to the classic approach to portfolio optimization?\nWhat are the implications of the terms 'beta' and 'alpha' in discussions of portfolio performance?\nWhat was the impact of modern portfolio theory on investment management?\nWhat is the criticism of the Modern Portfolio Theory?\nWhat are the challenges associated with implementing portfolio optimization using market data?\nHow do the limitations on short sales affect portfolio optimization?\nWhy do historical asset return data often result in inaccurate predictions for future asset returns?\nWhat issues might be encountered while using the standard portfolio optimization method?\nWhat is the Black-Litterman model in portfolio optimization?\nWho were the developers of the Black-Litterman approach to portfolio optimization?\nWhat is the main assumption of the Black-Litterman model?\nWhy is it difficult to outperform a well-diversified benchmark?\nWhat does the Black-Litterman model imply about the expected returns of the components in a given portfolio?\nHow does Black-Litterman model incorporate an investor's opinions into the optimization problem?\nWhat is the role and significance of a 'benchmark portfolio' as per the Black-Litterman model?\nHow does Black-Litterman approach modify the traditional constraints of Modern Portfolio Theory?",
            "13.1 Overview\n\nC hapters 8\u201312 have set out the classic approach to portfolio optimization\nwhich was first explicated by Harry Markowitz in the 1950s and subsequently\nexpanded by Sharpe (1964), Lintner (1965), and Mossin (1966). An enormous\nacademic and practitioner literature (as well as several Nobel Prizes in Eco-\nnomics) testifies to the impact of this new point of view on asset valuation and\nportfolio choice. It is hardly an exaggeration to say that today no conversation\nabout a stock\u2019 s risk is complete without mentioning its beta, and discussions\nof portfolio performance regularly invoke the alpha (both of these topics are\ndiscussed in Chapter 11).\nMarkowitz, Sharpe, Lintner, and Mossin changed the paradigm of invest-\nment management. Well before Markowitz et al., individual investors knew\nthat they should \u201cdiversify\u201d and not \u201cput all their eggs in one basket.\u201d But\nMarkowitz and those who followed him gave statistical and implementational\nmeaning to these clich\u00e9s. Modern portfolio theory (MPT) changed the way\nintelligent investors discuss investment.\nN evertheless, MPT has disappointed. It is possible to come away from a\nstandard textbook discussion of portfolio optimization with the impression that\na fixed set of mechanical optimization rules, combined with a bit of knowledge\nabout personal preferences, suffices to define an investor \u2019 s optimal portfolio.\nAnyone who has tried to implement portfolio optimization using market data\nknows that the dream is often a nightmare. Implementations of portfolio theory\nproduce wildly unrealistic portfolios, with huge short positions and corre-\nspondingly imaginary long positions. It might be thought that limiting short\nsales, as we have illustrated in Chapter 12, could solve some of these problems.\nHowever, short-sale limitations severely restrict the investible asset universe.\nT he main problem with the mechanical implementation of portfolio optimi-\nzation is that historical asset return data produce bad predictions for future\nasset returns. The estimation of the covariances between asset returns and the\nestimation of expected returns\u2014the underpinnings of portfolio theory\u2014from\nhistorical data often produces unbelievable numbers.\nIn Chapter 10 we alluded to some of these problems in the context of estimat-\ning the variance-covariance matrix. There we showed that historical data may\n306 Chapter 13\nso-called \u201cshrinkage\u201d methods\u2014may produce more reliable estimates of the\ncovariances. In this chapter we take things a step further. We illustrate the prob-\nlems of standard portfolio optimization by using a 10-asset portfolio problem.\nThe MPT optimization for our data produces an insane \u201coptimal\u201d portfolio,\nwith many huge long and short positions. The problems of portfolio optimiza-\ntion illustrated in our example are, unfortunately, not unusual. Using the data\nin a mechanical way to derive \u201coptimal\u201d portfolios simply doesn \u2019 t work.1\nIn 1991 Fischer Black and Robert Litterman of Goldman Sachs published\nan approach which deals with many of the problematics of portfolio optimiza-\ntion. 2 Black and Litterman start with the assumption that an investor chooses\nhis optimal portfolio from among a given group of assets. This group of\nassets\u2014it might be the Standard & Poor \u2019 s 500 Index, the Russell 2000, or a\nmix of international indices\u2014defines the framework within which the investor\nchooses his portfolio. The investor \u2019 s universe of assets defines a b enchmark\nportfolio.\nT he Black-Litterman model takes as its starting point the assumption that,\nin the absence of additional information, the benchmark cannot be outper-\nformed. This assumption is based on much research, which shows that it is\nvery difficult to outperform a typical well-diversified benchmark.3\nI n effect the Black-Litterman model turns modern portfolio theory on its\nhead\u2014instead of inputting data and deriving an optimal portfolio, the BL\n1. A paper by DeMiguel, Garlappi, and Uppal, \u201cOptimal Versus Naive Diversification: How\nInefficient Is the 1/N Portfolio Strategy?\u201d in T he Review of Financial Studies (2009), illustrates\nhow badly mechanical optimization works. The authors examine optimal allocations among\n10 sector portfolios. They find that a naive portfolio allocation rule of investing equal proportions\nin each portfolio\u2014irrespective of market values\u2014outperforms more sophisticated data-based\noptimizations.\n2. Fischer Black and Robert Litterman, \u201cGlobal Asset Allocation with Equities, Bonds, and Cur-\nrencies,\u201d Goldman, Sachs & Co., Fixed Income Research (1991). Black and Litterman were\napparently unaware of an earlier paper, which includes much of their research, by Sharpe, \u201cImput-\ning Expected Security Returns from Portfolio Composition,\u201d Journal of Financial and Quantita-\ntive Research (1974). Sharpe\u2019 s paper discusses the \u201creverse engineering\u201d of the portfolio returns\nfrom portfolio composition.\n3 . \u201c According to Lipper Analytical Services, over the 10 years ended in June 2000, more than\n80% of \u2018general equity\u2019 mutual funds, meaning garden variety stock funds, underperformed the\nStandard and Poor\u2019 s 500 Index\u2014the major benchmark for stock mutual funds\u201d (quoted in www.\nfool.com/Seminars/OLA/2001/Retire1_4C.htm). Or, from a well-known academic: \u201cProfessional\ninvestment managers, both in the U.S. and abroad, do not outperform their index benchmarks\u201d\nBurton G. Malkiel, \u201cReflections on the Efficient Market Hypothesis: 30 Years Later,\u201d T he Finan-\n307 The Black-Litterman Approach to Portfolio Optimization\napproach assumes that a given portfolio is optimal and from this assumption\nderives the expected returns of the benchmark components. The implied vector\nof expected benchmark returns is the starting point of the BL model.\nT he BL implied asset returns can be interpreted as the market\u2019 s information\nabout the future returns of each asset in the benchmark portfolio. If our investor\nagrees with this market assessment, he \u2019 s finished: He can then buy the bench-\nmark, knowing that it is optimal. But what if he disagrees with one or more\nof the implied returns? BL shows how the investor \u2019 s opinions can be incorpo-\nrated into the optimization problem to produce a portfolio which is better for\nthe investor.\nIn this chapter we start with an illustration of the problematics of MPT. We\nthen go on to illustrate the Black-Litterman approach."
        ],
        "13.2": [
            "What is the Black-Litterman approach to portfolio optimization?\nCan you describe a naive problem in portfolio optimization?\nWhat's a benchmark portfolio and what does it represent?\nWho is a portfolio analyst and what is their role?\nHow is portfolio theory applied in the real world setting?\nHow is optimal portfolio holdings determined?\nWhat is the significance of capturing 5 years of monthly price data on stocks for portfolio optimization?\nWhat is the role of market capitalisation in portfolio optimization?\nWhat are benchmark proportions and how are they calculated?\nWhat is 'return data' for a portfolio?\nCan you explain the term 'variance-covariance matrix' as it applies to returns in portfolio optimization?\nWhat is meant by 'optimal portfolio' in financial modeling?\nWhat causes a portfolio optimization to fail in some cases?\nWhat are the implications of negative expected returns in portfolio optimization?\nHow do large correlations between asset returns affect portfolio optimization?\nWhat is the concept of 'shrinkage' in the context of variance-covariance matrix in portfolio optimization?\nHow does shrinkage affect the performance of a portfolio?\nHow can we improve a portfolio that includes negative historical returns?\nWhat is a variance-covariance matrix and why is it used in portfolio optimization?\nWhat does a negative short position in a portfolio imply?\nWhat are the potential problems with using past returns as proxies for future expected returns? \nHow does adjusting the variance-covariance matrix affect portfolio optimization?\nWhat are some methods to improve portfolio optimization?",
            "13.2 A Naive Problem\n\nW e start with a naive, though representative problem: The Super Duper Fund\nhas set its benchmark portfolio to be a portfolio composed of 10 leading stocks.\nJoanna Roe, a new portfolio analyst for the Super Duper Fund, has decided to\nuse portfolio theory to recommend optimal portfolio holdings based on this\nbenchmark. The screen below gives 5 years of monthly price data on these\nstocks as of 1 July 2006 (note that some of the rows have been hidden):\nA B C D E F G H I J K L\n1 PRICE AND MARKET CAP DATA FOR 10 COMPANIES\nGeneral Home International Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot Paper Packard Express Aluminum MMM\nMO DD MRK\n2 GM HD IP HPQ AXP AA\nMarket capitalization\n3 (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n4 Benchmark proportion 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%<-- =K3/SUM($B$3:$K$3)\n5\n6 Monthly price data (includes dividends)\n7 1-Jun-01 50.31 45.26 31.22 26.47 38.74 32.47 36.06 40.88 50.74 51.56\n8 2-Jul-01 49.72 48.26 35.64 22.83 35.61 33.82 35.37 36.29 53.98 50.55\n9 1-Aug-01 43.14 44.06 35.32 21.48 37.10 30.54 34.50 35.01 51.96 47.30\n10 4-Sep-01 33.81 36.79 30.66 14.92 37.79 24.37 28.06 32.07 53.16 44.71\n11 1-Oct-01 32.56 36.66 31.50 15.65 36.63 24.75 29.34 34.18 50.93 47.43\n12 1-Nov-01 39.63 44.78 35.37 20.45 36.92 27.68 35.09 38.21 54.07 52.33\n13 3-Dec-01 38.75 48.97 35.73 19.17 36.34 30.02 32.32 36.63 47.18 53.99\n14 2-Jan-02 40.77 48.09 36.99 20.64 39.71 30.22 32.59 38.06 47.48 50.70\n15 1-Feb-02 42.67 48.00 38.96 18.78 41.73 30.72 34.31 40.68 49.21 54.16\n16 1-Mar-02 48.69 46.71 38.30 16.81 42.21 34.52 34.47 40.95 46.46 52.81\n17 1-Apr-02 51.67 44.56 36.90 16.02 43.62 34.64 31.08 38.65 43.85 57.77\n61 1-Dec-05 19.01 40.17 33.12 28.48 73.08 51.23 29.30 41.77 31.10 76.60\n62 3-Jan-06 23.56 40.24 32.15 31.02 70.75 52.33 31.21 38.48 33.73 71.91\n63 1-Feb-06 20.11 41.83 32.53 32.64 70.32 53.76 29.19 39.91 34.09 73.20\n64 1-Mar-06 21.06 42.13 34.32 32.81 70.06 52.43 30.43 41.87 34.83 75.29\n65 3-Apr-06 22.66 39.77 36.09 32.38 72.34 53.81 33.63 43.74 34.03 84.98\n66 1-May-06 26.93 37.97 33.98 32.29 71.54 54.36 31.72 42.53 33.29 83.66\n308 Chapter 13\nR ow 3 gives the current total equity value of each of the benchmark stocks,\nand row 4 computes the benchmark proportions\u2014the individual equity values\ndivided by the total market capitalization of the benchmark.\nFollowing the procedures described in Chapters 8 and 9, Joanna first trans-\nforms the price data to returns and then computes a variance-covariance matrix\nfor these returns:\nA B C D E F G H I J K\n1 RETURN DATA FOR THE SUPER-DUPER BENCHMARK PORTFOLIO\nGeneral Home International Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot Paper Packard Express Aluminum MMM\nMO DD MRK\n2 GM HD IP HPQ AXP AA\n3 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n4 Benchmark proportion 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n5\n6 Mean return -0.87% -0.39% 0.06% 0.30% 1.07% 0.82% -0.18% 0.03% -0.55% 0.75%\n7 Return sigma 10.78% 8.41% 6.23% 10.80% 8.71% 6.43% 9.54% 6.12% 8.06% 5.54%\n8\n9 Date GM HD IP HPQ MO AXP AA DD MRK MMM\n10 02-Jul-01 -1.18% 6.42% 13.24% -14.79% -8.42% 4.07% -1.93% -11.91% 6.19% -1.98%\n11 01-Aug-01 -14.20% -9.11% -0.90% -6.10% 4.10% -10.20% -2.49% -3.59% -3.81% -6.65%\n12 04-Sep-01 -24.37% -18.03% -14.15% -36.44% 1.84% -22.57% -20.66% -8.77% 2.28% -5.63%\n13 01-Oct-01 -3.77% -0.35% 2.70% 4.78% -3.12% 1.55% 4.46% 6.37% -4.29% 5.91%\n14 01-Nov-01 19.65% 20.01% 11.59% 26.75% 0.79% 11.19% 17.90% 11.15% 5.98% 9.83%\n15 03-Dec-01 -2.25% 8.94% 1.01% -6.46% -1.58% 8.12% -8.22% -4.22% -13.63% 3.12%\n16 02-Jan-02 5.08% -1.81% 3.47% 7.39% 8.87% 0.66% 0.83% 3.83% 0.63% -6.29%\n60 01-Sep-05 -11.06% -5.56% -3.48% 5.32% 5.28% 3.90% -9.25% -1.02% -3.66% 3.05%\n61 03-Oct-05 -11.10% 7.33% -2.08% -4.05% 1.81% -0.78% -0.54% 6.25% 3.63% 3.50%\n62 01-Nov-05 -20.55% 2.02% 8.56% 5.66% -3.06% 3.28% 12.70% 3.39% 5.40% 3.77%\n63 01-Dec-05 -12.03% -3.16% 6.39% -3.32% 3.67% 0.08% 7.58% -0.60% 7.86% -1.26%\n64 03-Jan-06 21.46% 0.17% -2.97% 8.54% -3.24% 2.12% 6.32% -8.20% 8.12% -6.32%\n65 01-Feb-06 -15.83% 3.88% 1.18% 5.09% -0.61% 2.70% -6.69% 3.65% 1.06% 1.78%\n66 01-Mar-06 4.62% 0.71% 5.36% 0.52% -0.37% -2.51% 4.16% 4.79% 2.15% 2.82%\n67 03-Apr-06 7.32% -5.76% 5.03% -1.32% 3.20% 2.60% 10.00% 4.37% -2.32% 12.11%\n68 01-May-06 17.26% -4.63% -6.02% -0.28% -1.11% 1.02% -5.85% -2.81% -2.20% -1.57%\n309 The Black-Litterman Approach to Portfolio Optimization\nNaive Optimization\nUsing the return data, Joanna computes the sample variance-covariance\nmatrix of excess returns as illustrated in Chapter 10. To implement the port-\nfolio optimization, she needs data on the T-bill rate: The 1 July 2006 T-bill\nrate is 4.83% annually and 4.83%/12 = 0.40% monthly. Using the variance-\ncovariance matrix, the T-bill rate, and the historical mean returns, she com-\nputes an \u201coptimal\u201d portfolio by solving the equation:\n\u23a1 r \u2212r \u23a4\nGM f\n\u23a2 \u23a5\nr \u2212r\nS\u22121\u23a2 HD f \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2\u23a2 \u23a5\nOptimal portfolio{ x,x ,\u2026,x }=\n\u23a3r\nMMM\n\u2212r f\u23a6\n1 2 10 \u23a1 r \u2212r \u23a4\nGM f\n\u23a2 \u23a5\nr \u2212r\n[ 1,1,\u2026,1] *S\u22121*\u23a2 HD f \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3r \u2212r \u23a6\nMMM f\n\u23a1 rr \u2212r \u23a4\nGM f\n\u23a2 \u23a5\nr \u2212r\nS\u22121\u23a2 HD f \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3r \u2212r \u23a6\n= MMM f\n\u23a1 \u23a1 r \u2212r \u23a4\u23a4\nGM f\n\u23a2 \u23a2 \u23a5\u23a5\nr \u2212r\nSum\u23a2 S\u22121*\u23a2 HD f \u23a5\u23a5\n\u23a2 \u23a2 (cid:2) \u23a5\u23a5\n\u23a2 \u23a2 \u23a5\u23a5\n\u23a3 \u23a3r \u2212rr \u23a6\u23a6\n310 Chapter 13\nThis portfolio is shown below (highlighted):\nA B C D E F G H I J K L M\n1 SUPER DUPER BENCHMARK PORTFOLIO\u2014NAIVE OPTIMIZATION\nGeneral Home Internatio Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot nal paper Packard Express Aluminum MMM\nMO DD MRK\n2 GM HD IP HPQ AXP AA\n3 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n4 Benchmark proportion 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n5\n6 Variance-covariance matrix of excess returns\nMean\n7 GM HD IP HPQ MO AXP AA DD MRK MMM return\n8 GM 0.0118 0.0031 0.0024 0.0042 0.0014 0.0033 0.0046 0.0018 0.0010 0.0014 -0.87%\n9 HD 0.0031 0.0072 0.0019 0.0043 0.0022 0.0033 0.0046 0.0020 0.0002 0.0018 -0.39%\n10 IP 0.0024 0.0019 0.0040 0.0031 0.0001 0.0024 0.0043 0.0021 0.0012 0.0016 0.06%\n11 HPQ 0.0042 0.0043 0.0031 0.0119 0.0026 0.0049 0.0061 0.0033 0.0020 0.0022 0.30%\n12 MO 0.0014 0.0022 0.0001 0.0026 0.0077 0.0016 0.0018 0.0009 0.0007 0.0008 1.07%\n13 AXP 0.0033 0.0033 0.0024 0.0049 0.0016 0.0042 0.0038 0.0019 0.0011 0.0014 0.82%\n14 AA 0.0046 0.0046 0.0043 0.0061 0.0018 0.0038 0.0093 0.0041 0.0018 0.0024 -0.18%\n15 DD 0.0018 0.0020 0.0021 0.0033 0.0009 0.0019 0.0041 0.0038 0.0017 0.0019 0.03%\n16 MRK 0.0010 0.0002 0.0012 0.0020 0.0007 0.0011 0.0018 0.0017 0.0066 0.0005 -0.55%\n17 MMM 0.0014 0.0018 0.0016 0.0022 0.0008 0.0014 0.0024 0.0019 0.0005 0.0031 0.75%\n18\n19 Current t-bill rate 0.40%<-- =4.83%/12\n20\n21 \"Optimal\" portfolio\n22 GM 480.2%<-- {=MMULT(MINVERSE(B8:K17),M8:M17-B19)/SUM(MMULT(MINVERSE(B8:K17),M8:M17-B19))}\n23 HD 981.8%\n24 IP 689.3%\n25 HPQ 221.3%\n26 MO -263.7%\n27 AXP -1763.7%\n28 AA -324.5%\n29 DD 528.8%\n30 MRK 469.5%\n31 MMM -918.9%\n32 Sum of proportions 1.00000<-- =SUM(B22:B31)\nT he \u201coptimal\u201d portfolio shown in cells B22:B31 is clearly not practically\nimplementable: It contains too many large positions (both negative and posi-\ntive). Note, for example, the \u20131763.7% short position in AXP and the 528.8%\nposition in DD. Most mutual funds are prevented from taking short positions,\nand even funds which short sell will find it difficult to short sell 17.63 times\nthe fund value in AXP or to invest 9.19 times the fund value in MMM. The\nenormous long positions which result from these short-sale positions (e.g.,\n9.82 times fund value invested long in HD) are similarly impracticable.\nWhy Does Naive Optimization Fail?\nIn some sense the strange portfolio \u201coptimization\u201d positions were predictable.\nThe spreadsheet below highlights some disturbing features of the data which\n311 The Black-Litterman Approach to Portfolio Optimization\n\u2022 A number of the historical mean returns are negative. If we ignore the effects\nof correlations, a negative expected return should imply a short position in the\nstock. 4 There is, however, a deeper philosophical question about using past\nreturns as proxies for future expected returns: Even though the past returns are\nnegative, there is no reason to assume that this means that the future, expected\nreturns from a stock should be negative. This is one of the problems when we\nuse historical data to extract anticipations about the future.\n\u2022 T he correlations between asset returns are in some cases very large. Large\ncorrelations for a particular stock can lead us to prefer other stocks with\nsmaller returns but more moderate correlations.\nT he spreadsheet below highlights stocks with negative historical returns and\nstocks whose correlations are greater than 0.5.\nA B C D E F G H I J K L\n1 NEGATIVE RETURNS AND HIGH CORRELATIONS\n2\nG Me Gon t Me or ra sl H Do Hem p Doe t Inte Prn a Ia Ppt eio rnal PH ae Hcw Pkl Qe at rt d- A Mlt Oria A Em x Ae p Xr ri e Pc sa sn AlA uml Ac Ao ina u m Du DP Dont M Me Rrc Kk MMM\n3 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n4 Benchmark proportion 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n5\n6 Mean return -0.87% -0.39% 0.06% 0.30% 1.07% 0.82% -0.18% 0.03% -0.55% 0.75%\n7 Return sigma 10.78% 8.41% 6.23% 10.80% 8.71% 6.43% 9.54% 6.12% 8.06% 5.54%\n8\n9\n10 GM HD IP HPQ MO AXP AA DD MRK MMM\n11 GM 1.0000 0.3320 0.3459 0.3534 0.1428 0.4676 0.4430 0.2737 0.1109 0.2277<-- =CORREL($B$24:$B$83,K24:K83)\n12 HD 1.0000 0.3512 0.4618 0.3012 0.6061 0.5618 0.3891 0.0260 0.3800<-- =CORREL($C$24:$C$83,K24:K83)\n13 IP 1.0000 0.4580 0.0159 0.5772 0.7181 0.5400 0.2362 0.4575<-- =CORREL($D$24:$D$83,K24:K83)\n14 HPQ 1.0000 0.2682 0.6965 0.5770 0.4924 0.2232 0.3666\n15 MO 1.0000 0.2839 0.2145 0.1647 0.0955 0.1645\n16 AXP 1.0000 0.6034 0.4855 0.2038 0.3798\n17 AA 1.0000 0.6863 0.2294 0.4525\n18 DD 1.0000 0.3287 0.5606\n19 MRK 1.0000 0.1079\n20 MMM 1.0000\nWhat About Changing the Variance-Covariance Matrix?\nIn Chapter 10 we discussed various methods for shrinking the variance-\ncovariance matrix. \u201cShrinkage,\u201d you will recall, is a bit of jargon for taking a\nconvex combination of the sample variance-covariance matrix with a diagonal\nmatrix of only the variances. Shrinkage methods have been shown to be effec-\ntive at improving the performance of the global minimum variance portfolio\n(GMVP).\n4. In principle you might want to include a negative-return stock in your portfolio if it has a\nnegative correlation with enough other stocks to lower the total portfolio variance. However, this\n312 Chapter 13\nW ill shrinkage help us solve the extreme positions of the naive portfolio\noptimization? We try this in the next spreadsheet, where cells B11:K20 contain\na weighted combination of the sample covariance matrix (B41:K50) and an\nall-diagonal matrix of only the variances (B54:K63). The weight \u03bb put on the\nsample covariance matrix is given in cell B7.\nFor \u03bb = 0.3, the \u201coptimal\u201d portfolio indeed contains fewer extreme long and\nshort positions. But it is clear that shrinkage can never solve the fundamental\nproblem of the data\u2014using negative historical returns as proxies for expected\nreturns will always produce some negative portfolio positions in an optimizer.\nIt is this problem which Black and Litterman solve and which we discuss in\nthe next section.\nA B C D E F G H I J K L M\nSUPER DUPER BENCHMARK PORTFOLIO\u2014NAIVE OPTIMIZATION WITH\n1 SHRUNK VARIANCE-COVARIANCE MATRIX\nGeneral Home International Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot paper Packard Express Aluminum MMM\nMO DD MRK\n2 GM HD IP HPQ AXP AA\n3 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n4 Benchmark proportion 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n5\n6 Variance-covariance matrix of excess returns\n7 Shrinkage factor,\u03bb 0.3<-- Weight on sample var-cov matrix\n8\nThe matrix below is a weighted combination of the sample variance-covariance matrix and a pure diagonal matrix of only variances.\n9 {=B7*B39:K48+(1-B7)*B52:K61}\nMean\n10 GM HD IP HPQ MO AXP AA DD MRK MMM return\n11 GM 0.0118 0.0009 0.0007 0.0013 0.0004 0.0010 0.0014 0.0006 0.0003 0.0004 -0.87%\n12 HD 0.0009 0.0072 0.0006 0.0013 0.0007 0.0010 0.0014 0.0006 0.0001 0.0005 -0.39%\n13 IP 0.0007 0.0006 0.0040 0.0009 0.0000 0.0007 0.0013 0.0006 0.0004 0.0005 0.06%\n14 HPQ 0.0013 0.0013 0.0009 0.0119 0.0008 0.0015 0.0018 0.0010 0.0006 0.0007 0.30%\n15 MO 0.0004 0.0007 0.0000 0.0008 0.0077 0.0005 0.0005 0.0003 0.0002 0.0002 1.07%\n16 AXP 0.0010 0.0010 0.0007 0.0015 0.0005 0.0042 0.0011 0.0006 0.0003 0.0004 0.82%\n17 AA 0.0014 0.0014 0.0013 0.0018 0.0005 0.0011 0.0093 0.0012 0.0005 0.0007 -0.18%\n18 DD 0.0006 0.0006 0.0006 0.0010 0.0003 0.0006 0.0012 0.0038 0.0005 0.0006 0.03%\n19 MRK 0.0003 0.0001 0.0004 0.0006 0.0002 0.0003 0.0005 0.0005 0.0066 0.0001 -0.55%\n20 MMM 0.0004 0.0005 0.0005 0.0007 0.0002 0.0004 0.0007 0.0006 0.0001 0.0031 0.75%\n21\n22 Current T-bill rate 0.40%<-- =4.83%/12\n23\n24 \"Optimal\" portfolio\n25 GM 84.3%<--{=MMULT(MINVERSE(B11:K20),M11:M20-B22)/SUM(MMULT(MINVERSE(B11:K20),M11:M20-B22))}\n26 HD 96.4%\n27 IP 50.2%\n28 HPQ -3.6%\n29 MO -76.1%\n30 AXP -134.6%\n31 AA 32.5%\n32 DD 62.5%\n33 MRK 112.1%\n34 MMM -123.8%\n313 The Black-Litterman Approach to Portfolio Optimization"
        ],
        "13.3": [
            "What is the Black-Litterman approach to portfolio optimization?\nWhat are the two steps of the Black-Litterman approach?\nWhat is the main assumption made in the first step of the Black-Litterman approach?\nHow does the Black-Litterman approach determine the expected returns of each asset?\nWhat does it mean to say that an investor is deriving the expected returns of each asset in the Black-Litterman approach?\nHow does the second step of the Black-Litterman approach differ from the first step?\nWhat is the role of an investor's opinions in the Black-Litterman approach?\nHow does an investor's opinion about a particular asset's returns affect the expected returns of other assets in the Black-Litterman approach?\nWhy is it important to adjust all asset returns for an investor's opinion in the Black-Litterman approach?\nWhat does it mean for an investor to adjust the market weights by adding his own opinions in the Black-Litterman approach?\nHow does the Black-Litterman procedure account for correlations between asset returns? \nHow does the Black-Litterman approach take into account the difficulty of beating the returns of benchmark portfolios?\nWhat is meant by the optimality of a benchmark in the context of the Black-Litterman approach?",
            "13.3 Black and Litterman \u2019 s Solution to the Optimization Problem\n\nThe Black-Litterman (BL) approach provides an initial solution to the optimi-\nzation problem above. The BL approach is composed of two parts:\nStep 1 : What does the market think? A vast amount of financial research shows\nthat it is difficult to beat the returns of benchmark portfolios. The first step of\nthe BL approach takes this research as a starting point. It assumes that the\nbenchmark is optimal and derives the expected returns of each asset under this\nassumption. Another way of saying this is that in Step 1 we compute the\nexpected returns of the assets which would make the investor choose the\nbenchmark using the optimization techniques in Chapters 9\u201311.\nStep 2 : Incorporating investor opinions. In Step 1, BL shows how to compute\nthe benchmark asset returns based on the assumption of optimality. Suppose\nthe investor has divergent opinions from these market-based expected returns.\nStep 2 shows how to incorporate these opinions into the optimization proce-\ndure. Note that\u2014because of the correlations between asset returns\u2014an inves-\ntor\u2019 s opinion about any particular asset\u2019 s returns will affect all the other\nexpected returns. A critical part in Step 2 is to adjust all asset returns for an\ninvestor \u2019 s opinion about any return.\nA n investor who follows the Black-Litterman procedure starts off by seeing\nwhat the market weights imply for the expected returns. He can then adjust\nthese weights by adding his own opinions about any asset\u2019s expected returns.\nIn the next two sections we discuss these two steps in detail."
        ],
        "13.4": [
            "What is the Black-Litterman Approach to Portfolio Optimization?\nWhat does the term 'optimal portfolio' mean in financial modeling?\nWhat is the significance of the variance-covariance matrix in financial modeling?\nHow is an efficient portfolio determined according to the Black-Litterman Approach?\nWhat does the term 'expected portfolio returns' imply in the context of financial modeling?\nWhat is the role of the normalizing factor in the Black-Litterman Approach?\nWhat is the term 'benchmark return' and how is it calculated in financial modeling?\nWhat does 'current market weights of the portfolio indicate the efficiency weights' mean?\nHow does the normalizing factor affect the expected returns of a portfolio?\nWhat is the significance of the Risk-free rate in Portfolio Optimization?\nWhat do the terms 'market cap' and 'benchmark proportions' signify in portfolio optimization?\nWhat is the relevance of the variance-covariance matrix in determining the optimal portfolio?\nHow are the weights in the portfolio related to the expected benchmark return?\nWhat does the 'current T-bill rate' indicate in the context of portfolio optimization?\nWhat is the method to calculate the normalizing factor in portfolio optimization?\nWhat are the implications of a low or high normalizing factor in a financial model?\nHow are anticipated benchmark return and current T-bill rate used in achieving an expected benchmark return?\nWhat is the process of checking the optimal portfolio as suggested by the Black-Litterman Approach? \nWhat does it mean when the 'expected return of the benchmark is 0.29% per month as opposed to the 1% per month posited by Joanna'? \nWhat does it mean when 'current T-bill rate of 0.40% and the expected returns in M12:M21 gives back the benchmark proportions in row 8'?",
            "13.4 BL Step 1: What Does the Market Think?\n\nAs shown in Chapter 9, an optimal portfolio must solve the equation:\n\u23a1 Efficient \u23a4 \u23a1Variance-\u23a4\u22121 \u23a7\u23a1Expected\u23a4 \u23ab\n\u23a2 \u23a5 \u23a2 \u23a5 \u23aa\u23a2 \u23a5 Rissk-free\u23aa\nportfolio = covariancee *\u23a8 portfolio \u2212 \u23ac\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\n\u23aa rate \u23aa\n\u23a3\u23a2proportions\u23a6\u23a5 \u23a3\u23a2 (cid:3)(cid:5)m(cid:5)at(cid:5)rix(cid:5)(cid:5)\u23a6\u23a5 (cid:5)(cid:5)\u23a9\u23a3\u23a2 (cid:5)(cid:4)ret(cid:5)ur(cid:5)ns(cid:5)\u23a6\u23a5 (cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:6)\u23ad\n\u2191\n314 Chapter 13\nS olving the equation for the vector of expected portfolio returns, this means\nthat an efficient portfolio must solve the following equation:\n\u23a1Expected\u23a4 \u23a1Variance-\u23a4\u23a1 Efficient \u23a4\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5 Normallizing Risk-free\nportfolio = covariance portfolio * +\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5\nfactor rate\n\u23a3\u23a2 returns \u23a6\u23a5 \u23a3\u23a2 matriix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\nJ oanna assumes that, in the absence of any additional knowledge or opinions\nabout the market, the current market weights of the portfolio indicate the\nefficiency weights. She estimates that the expected benchmark return over the\nnext month will be 1%, and uses this estimation to set the normalizing factor. 5\nWe illustrate below.\nSolving the first part of the last equation (without the normalizing factor)\ngives:\nA B C D E F G H I J K L M\nSUPER DUPER BENCHMARK PORTFOLIO\u2014WHAT DOES THE MARKET THINK?\n1 No normalizing factor\n2 Anticipated benchmark return 1.00%<-- =12%/12\n3 Current T-bill rate 0.40%\n4\nGeneral Home International Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot Paper Packard Express Aluminum MMM\nMO DD MRK\n5 GM HD IP HPQ AXP AA\n6 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n7 Benchmark proportions 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n8\n9 Variance-covariance matrix\nWithout\nnormalizing\n10 GM HD IP HPQ MO AXP AA DD MRK MMM factor\n11 GM 0.0118 0.0031 0.0024 0.0042 0.0014 0.0033 0.0046 0.0018 0.0010 0.0014 0.28%\n12 HD 0.0031 0.0072 0.0019 0.0043 0.0022 0.0033 0.0046 0.0020 0.0002 0.0018 0.32%\n13 IP 0.0024 0.0019 0.0040 0.0031 0.0001 0.0024 0.0043 0.0021 0.0012 0.0016 0.18%\n14 HPQ 0.0042 0.0043 0.0031 0.0119 0.0026 0.0049 0.0061 0.0033 0.0020 0.0022 0.47%\n15 MO 0.0014 0.0022 0.0001 0.0026 0.0077 0.0016 0.0018 0.0009 0.0007 0.0008 0.31%\n16 AXP 0.0033 0.0033 0.0024 0.0049 0.0016 0.0042 0.0038 0.0019 0.0011 0.0014 0.28%\n17 AA 0.0046 0.0046 0.0043 0.0061 0.0018 0.0038 0.0093 0.0041 0.0018 0.0024 0.38%\n18 DD 0.0018 0.0020 0.0021 0.0033 0.0009 0.0019 0.0041 0.0038 0.0017 0.0019 0.22%\n19 MRK 0.0010 0.0002 0.0012 0.0020 0.0007 0.0011 0.0018 0.0017 0.0066 0.0005 0.18%\n20 MMM 0.0014 0.0018 0.0016 0.0022 0.0008 0.0014 0.0024 0.0019 0.0005 0.0031 0.16%\n21\nCheck: The expected return\n22 of the benchmark? 0.29%<-- {=MMULT(B7:K7,M11:M20)} Cells M11:M20 contain the array formula\n23 {=MMULT(B11:K20,TRANSPOSE(B7:K7)+B3)}\n24\n5 . O ne percent per month is equivalent to estimating an annual expected benchmark return\n315 The Black-Litterman Approach to Portfolio Optimization\nNote that given the weights in row 7, the expected benchmark return is 0.29%\nper month as opposed to the 1% per month posited by Joanna (cell B2). To\nachieve this expected benchmark returns we multiply row 7 by a normalizing\nfactor:\n\u23a1Benchmark\u23a4 \u23a1Variance-\u23a4\u23a1Benchmark\u23a4\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5 Normaalizing Risk-free\nportfolio = covariance portfolio * +\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5\nfactor rate\n\u23a3\u23a2 returns \u23a6\u23a5 \u23a3\u23a2 matrrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\n\u23a1Variance-\u23a4\u23a1Benchmark\u23a4\n\u23a2 \u23a5\u23a2 \u23a5\n= covariance portfolio\n\u23a2 \u23a5\u23a2 \u23a5\n\u23a3\u23a2\u23a2 matrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\n\u239b Expectedbencchmarkreturn\u2212Risk-freerate \u239e\n\u239c\u239b\u23a1Benchmark\u23a4T \u23a1Variance-\u23a4\u23a1Benchmark\u23a4\u239e\u239f\nRisk-free\n*\u239c\n\u239c\u23a2\u23a2 \u23a5 \u23a2 \u23a5\u23a2\n\u23a5\u239f\u239f+\n\u239c \u239c\u23a2portfolio \u23a5 \u23a2covariance \u23a5\u23a2 portffolio \u23a5\u239f\u239f rate\n\u239d\u239c \u239d\u239c \u23a3\u23a2proportions\u23a6\u23a5 \u23a3\u23a2 matrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\u23a0\u239f \u23a0\u239f\n(cid:3)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:4)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:6)\n\u2191\nThe normaalizing factor\n316 Chapter 13\nA B C D E F G H I J K L M\nSUPER DUPER BENCHMARK PORTFOLIO\u2014WHAT DOES THE MARKET THINK?\nNormalizing factor computed in cell B4, based on anticipated benchmark return\n1 The expected returns make the benchmark optimal\n2 Anticipated benchmark return 1.00%<-- =12%/12\n3 Current T-bill rate 0.40%\n4 Normalizing factor 2.12<-- {=(B2-B3)/MMULT(MMULT(B8:K8,B12:K21),TRANSPOSE(B8:K8))}\n5\nGeneral Home International Hewlett- American Alcoa\nAltria DuPont Merck\nMotors Depot Paper Packard Express Aluminum MMM\nMO DD MRK\n6 GM HD IP HPQ AXP AA\n7 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n8 Benchmark proportions 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n9\n10 Variance-covariance matrix\nWith\nnormalizing\n11 GM HD IP HPQ MO AXP AA DD MRK MMM factor\n12 GM 0.0118 0.0031 0.0024 0.0042 0.0014 0.0033 0.0046 0.0018 0.0010 0.0014 0.96%\n13 HD 0.0031 0.0072 0.0019 0.0043 0.0022 0.0033 0.0046 0.0020 0.0002 0.0018 1.05%\n14 IP 0.0024 0.0019 0.0040 0.0031 0.0001 0.0024 0.0043 0.0021 0.0012 0.0016 0.77%\n15 HPQ 0.0042 0.0043 0.0031 0.0119 0.0026 0.0049 0.0061 0.0033 0.0020 0.0022 1.36%\n16 MO 0.0014 0.0022 0.0001 0.0026 0.0077 0.0016 0.0018 0.0009 0.0007 0.0008 1.05%\n17 AXP 0.0033 0.0033 0.0024 0.0049 0.0016 0.0042 0.0038 0.0019 0.0011 0.0014 0.97%\n18 AA 0.0046 0.0046 0.0043 0.0061 0.0018 0.0038 0.0093 0.0041 0.0018 0.0024 1.17%\n19 DD 0.0018 0.0020 0.0021 0.0033 0.0009 0.0019 0.0041 0.0038 0.0017 0.0019 0.84%\n20 MRK 0.0010 0.0002 0.0012 0.0020 0.0007 0.0011 0.0018 0.0017 0.0066 0.0005 0.77%\n21 MMM 0.0014 0.0018 0.0016 0.0022 0.0008 0.0014 0.0024 0.0019 0.0005 0.0031 0.73%\n22\nCheck: The expected return\n23 of the benchmark? 1.00%<-- {=MMULT(B8:K8,M12:M21)} Cells M12:M21 contain the array formula\n24 {=(MMULT(B12:K21,TRANSPOSE(B8:K8))*B4)+B3}\n25\n26\nAdditional check:\n27 Optimal portfolio\n28 GM 2.71%<--{=MMULT(MINVERSE(B12:K21),M12:M21-B3)/SUM(MMULT(MINVERSE(B12:K21),M12:M21-B3))}\n29 HD 11.91%\n30 IP 2.56%\n31 HPQ 14.23% Note that Chapter 9 optimization on\n32 MO 24.69% the expected returns in cells\n33 AXP 10.57% M11:M20 and the variance-\n34 AA 4.53% covariance matrix produces the\n35 DD 6.17% market weights as the optimal\n36 MRK 12.80% portfolio.\n37 MMM 9.81%\n38 Sum of proportions 100.0%<-- =SUM(B28:B37)\nIn the spreadsheet above, we have performed an additional check by deriv-\ning the optimal portfolio given the current T-bill rate of 0.40% and the expected\nreturns in M12:M21. This should give us back the benchmark proportions in\nrow 8\u2014and it does!"
        ],
        "13.5": [
            "- What does the Black-Litterman Approach to Portfolio Optimization entail?\n- How does the Black-Litterman model incorporate investor's opinions in the process of portfolio optimization?\n- What are the two initial assumptions made by Joanna in the Black-Litterman Approach to portfolio optimization?\n- How does Joanna derive the expected return for each of the benchmark components?\n- What does it mean when we say that the benchmark is efficient?\n- How does the opinion of an investor affect the decision-making process in the Black-Litterman model?\n- Can you explain how asset returns are correlated in the Black-Litterman model?\n- What is the significance of a market's opinion of asset returns in the Black-Litterman model?\n- How are opinions adjusted in the Black-Litterman model when an analyst's opinion differs from the market opinion?\n- What is the delta in the Black-Litterman model?\n- What role does the variance-covariance matrix play in the Black-Litterman portfolio optimization model?\n- In the Black-Litterman model, how does one asset's returns affect the anticipated returns for all other assets?\n- What is the effect of a positive analyst opinion about a particular asset return in the Black-Litterman model?\n- How are the proportions of the portfolio determined in the Black-Litterman model?\n- What is the Black-Litterman Tracking Matrix? \n- How does introducing multiple opinions about stocks affect the portfolio optimization process in the Black-Litterman approach?\n- Could you explain the implementation of the Black-Litterman tracking matrix using the VBA function BLtracking?\n- How does the interpretation of an analyst's opinions differ in the Black-Litterman model?\n- How can an analyst's confidence in their opinions be incorporated in the Black-Litterman model?\n- What is the concept of Bayesian adjustments with respect to the Black-Litterman model?",
            "13.5 BL Step 2: Introducing Opinions\u2014What Does Joanna Think?\n\nHaving made two assumptions\u2014(i) that the benchmark is efficient and (ii) that\nthe expected benchmark return is 1% per month\u2014Joanna has derived the\nexpected returns for each of the benchmark components (cells M12:M21). We\nare now ready to introduce Joanna \u2019 s opinions about asset returns. The rough\n317 The Black-Litterman Approach to Portfolio Optimization\nprocedure from Chapter 9 to derive a portfolio whose proportions differ from\nthose of the benchmark.\nW e have to be careful, however: Because asset returns are correlated, any\nopinion Joanna has about one asset \u2019 s returns will translate to an opinion about\nall other asset returns. To illustrate this point, suppose that Joanna thinks that\nthe return on GM will be 1.1% over the next month instead of the market\nopinion of 0.96%. Then this translates to:\nA B C D E F G H I J K\nADJUSTING THE BENCHMARK FOR AN ANALYST'S OPINION\nIn this example the only opinion is about GM\n1\n2 Anticipated benchmark return 1.00%<-- =12%/12\n3 Current T-bill rate 0.40%\n4 Normalizing factor 2.12<-- {=(B2-B3)/MMULT(MMULT(B8:K8,B12:K21),TRANSPOSE(B8:K8))}\n5\nGeneral Home International Hewlett- American Alcoa\nMotors Depot Paper Packard Altria Express Aluminum DuPont Merck\n6 GM HD IP HPQ MO AXP AA DD MRK MMM\n7 Market cap (billion $) 16.85 73.98 15.92 88.37 153.33 65.66 28.16 38.32 79.51 60.9\n8 Benchmark proportions 2.71% 11.91% 2.56% 14.23% 24.69% 10.57% 4.53% 6.17% 12.80% 9.81%\n9\n10 Variance-covariance matrix\n11 GM HD IP HPQ MO AXP AA DD MRK MMM\n12 GM 0.0118 0.0031 0.0024 0.0042 0.0014 0.0033 0.0046 0.0018 0.0010 0.0014\n13 HD 0.0031 0.0072 0.0019 0.0043 0.0022 0.0033 0.0046 0.0020 0.0002 0.0018\n14 IP 0.0024 0.0019 0.0040 0.0031 0.0001 0.0024 0.0043 0.0021 0.0012 0.0016\n15 HPQ 0.0042 0.0043 0.0031 0.0119 0.0026 0.0049 0.0061 0.0033 0.0020 0.0022\n16 MO 0.0014 0.0022 0.0001 0.0026 0.0077 0.0016 0.0018 0.0009 0.0007 0.0008\n17 AXP 0.0033 0.0033 0.0024 0.0049 0.0016 0.0042 0.0038 0.0019 0.0011 0.0014\n18 AA 0.0046 0.0046 0.0043 0.0061 0.0018 0.0038 0.0093 0.0041 0.0018 0.0024\n19 DD 0.0018 0.0020 0.0021 0.0033 0.0009 0.0019 0.0041 0.0038 0.0017 0.0019\n20 MRK 0.0010 0.0002 0.0012 0.0020 0.0007 0.0011 0.0018 0.0017 0.0066 0.0005\n21 MMM 0.0014 0.0018 0.0016 0.0022 0.0008 0.0014 0.0024 0.0019 0.0005 0.0031\n22\n23\nOpinion-\nAnalyst Returns\nExpected benchmark returns, adjusted\nopinion, adjusted for\nno opinions delta, \u03b4 opinions optimized\n24 portfolio\n25 0.96% 0.14% GM 1.10%<-- =A25+B12/$B$12*$B$25 7.85% GM\n26 1.05% 0.00% HD 1.08%<-- =A26+B13/$B$12*$B$25 11.28% HD\n27 0.77% 0.00% IP 0.80%<-- =A27+B14/$B$12*$B$25 2.43% IP\n28 1.36% 0.00% HPQ 1.41% 13.48% HPQ\n29 1.05% 0.00% MO 1.07% Cells J25:J34 contain the array 23.39% MO\n30 0.97% 0.00% AXP 1.00% formula 10.01% AXP\n31 1.17% 0.00% AA 1.23% {=MMULT(MINVERSE(B12:K21),D 4.30% AA\n32 0.84% 0.00% DD 0.86% 25:D34- 5.84% DD\n33 0.77% 0.00% MRK 0.78% B3)/SUM(MMULT(MINVERSE(B12: 12.13% MRK\n34 0.73% 0.00% MMM 0.75% K21),D25:D34-B3))} 9.29% MMM\nThe \u03b4 introduced in cell B25 above indicates Joanna \u2019 s deviation from the\nBlack-Litterman base case. In the example above, Joanna thinks that GM will\ndiffer from the market \u2019 s return of 0.96% (cell A25) by \u03b4 = 0.14% (cell B25).\nGM\nWhat this example illustrates is that\u2014because asset returns are correlated\n318 Chapter 13\n(in this GM) also affects Joanna\u2019 s anticipated returns for all other assets.\nBecause of the covariance between asset returns, for example, this means that\nthe HD return she expects is 1.08%:\n( )\nCov r ,r\nr =r + HD GM \u03b4 =1.088%\nHD,opinionadjusted HD,market Var( r ) GM\nGM\n( )\nCov r ,r\nr =r + IP GM \u03b4 =00.80%\nIP,opinionadjusted IP,market Var( r ) GM\nGM\nand so on.\nT he newly optimized portfolio is given in cells J24:J33. Joanna\u2019 s positive\nopinion about GM returns has, predictably, increased the proportion of GM in\nher portfolio. But her opinion about GM has also affected all the other portfolio\nweights:\nJ K L\nOpinion-\nPortfolio\nadjusted\nbenchmark,\noptimized\nno opinions\n24 portfolio\n25 7.85% GM 2.71%\n26 11.28% HD 11.91%\n27 2.43% IP 2.56%\n28 13.48% HPQ 14.23%\n29 23.39% MO 24.69%\n30 10.01% AXP 10.57%\n31 4.30% AA 4.53%\n32 5.84% DD 6.17%\n33 12.13% MRK 12.80%\n319 The Black-Litterman Approach to Portfolio Optimization\nThe Black-Litterman Tracking Matrix\nW hen Joanna has opinions about multiple stocks, the effect of these opinions\non other stocks looks like a multivariate regression:\n\u03c3 \u03c3\nr =r + GM,GM \u03b4 + HD,GM \u03b4\nGM,opinionadjusted GM,market \u03c32 GM \u03c32 HD\nGM GM\n\u03c3 \u03c3\n++ IP,GM \u03b4 +\u2026+ MMM,GM \u03b4\n\u03c32 IP \u03c32 MMM\nGM GM\n\u03c3 \u03c3\nr =r + GM,HD\u03b4 + HD,HD\u03b4\nHD,opinionadjusted HD,maarket \u03c32 GM \u03c32 HD\nHD HD\n\u03c3 \u03c3\n+ IP,HD\u03b4 +\u2026+ MMM,HD\u03b4\n\u03c32 IP \u03c3\u03c32 MMM\nHD HD\nWe define the Black-Litterman tracking matrix as:\n\u23a1 \u03c3 \u03c3 \u03c3 \u23a4\nGM,GM GM,HD (cid:7) GM,MMM\n\u23a2 \u23a5\n\u03c32 \u03c32 \u03c32\n\u23a2 GM GM GM \u23a5\n\u23a2 \u03c3 \u03c3 \u03c3 \u23a5\nHD,GM HD,HDD (cid:7) HD,MMM\n\u23a2 \u23a5\nBLtracking= \u03c32 \u03c32 \u03c32\n\u23a2 HD HD HD \u23a5\n\u23a2 (cid:7) (cid:7) (cid:7) (cid:7) \u23a5\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c3\n\u23a2 MMM,GM MMM,HP (cid:7) MMM,MMM\u23a5\n\u23a3\u23a2 \u03c32 \u03c32 \u03c32 \u23a6\u23a5\nMMM MMM MMMM\n\u23a1 \u03c3 \u03c3 \u23a4\n\u23a2 1 GM,HD (cid:7) GM,MMM \u23a5\u23a5\n\u03c32 \u03c32\n\u23a2 GM GM \u23a5\n\u23a2 \u03c3 \u03c3 \u23a5\n\u23a2 HD,GM 1 (cid:7) HD,MMM \u23a5\n= \u03c322 \u03c32\n\u23a2 HD HD \u23a5\n\u23a2 (cid:7) (cid:7) (cid:7) (cid:7) \u23a5\n\u23a2 \u23a5\n\u03c3 \u03c3\n\u23a2 MMM,GM MMM,HP (cid:7) 1 \u23a5\n\u23a3\u23a2 \u03c32 \u03c32 \u23a6\u23a5\nMMM MMM\n320 Chapter 13\n\u23a1 \u03c3 \u03c3 \u23a4\n\u23a1\n\u23a2\nr GM,market \u23a4\n\u23a5\n\u23a2 1 \u03c3GM 2,HHD (cid:7) G \u03c3M 2,MMM \u23a5 \u23a1\n\u23a2\n\u03b4 GM \u23a4\u23a4\n\u23a5\n\u23a2 GM GM \u23a5\n\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 r HD,market \u23a5 \u23a2 \u23a2 \u03c3 HD,GM 1 (cid:7) \u03c3 HD,MMM \u23a5 \u23a5 \u23a2 \u03b4 HD \u23a5\n\u23a2 \u23a5+ \u03c32 \u03c32 *\u23a2 \u23a5\n\u23a2 HD HD \u23a5\n\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 (cid:7) (cid:7) (cid:7) (cid:7) \u23a5\n\u23a2 (cid:2) \u23a5 \u23a2 \u23a5 \u23a2 (cid:2) \u23a5\n\u23a2 \u23a5 \u03c3 \u03c3\u03c3 \u23a2 \u23a5\n\u23a3\u23a2r MMM,market\u23a6\u23a5 \u23a3\u23a2\n\u23a2\n\u03c3MM 2M,GM \u03c3MM 2M,HP (cid:7) 1 \u23a6\u23a5\n\u23a5\n\u23a3\u03b4 MMM\u23a6\nMMM MMM\n\u23a1 r \u23a4\nGM,opinion-adjusted\n\u23a2 \u23a5\n\u23a2 \u23a5\n\u23a2r \u23a5\nHD,market.opinion-adjusted\n=\u23a2 \u23a5\n\u23a2 \u23a5\n\u23a2 (cid:2)(cid:2) \u23a5\n\u23a2 \u23a5\n\u23a3\u23a2 r \u23a6\u23a5\nMMM,opinion-adjusted\nT he VBA function BLtracking takes the variance-covariance matrix as its\nargument and is defined as:\n\u2018BLtracking \u2019 s argument is the variance-\n\u2018covariance matrix\nFunction BLtracking(rng As Range) As Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = rng.Columns.Count\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\nFor i = 1 To numcols\nFor j = 1 To numcols\nmatrix(i - 1, j - 1) = rng(i, j) _\n/ rng(i, i)\nNext j\nNext i\nBLtracking = matrix\n321 The Black-Litterman Approach to Portfolio Optimization\nHere are the computations for our example:\nA B C D E F G H I J K\nBLACK-LITTERMAN TRACKING MATRIX\n1 Tracking factors = cov(i,j)/var(i)\n2 Tracking matrix\n3 GM HD IP HPQ MO AXP AA DD MRK MMM\n4 GM 1.0000 0.2589 0.1999 0.3540 0.1153 0.2788 0.3920 0.1555 0.0829 0.1169\n5 HD 0.4257 1.0000 0.2603 0.5934 0.3119 0.4635 0.6376 0.2834 0.0250 0.2501\n6 IP 0.5985 0.4738 1.0000 0.7940 0.0222 0.5954 1.0994 0.5306 0.3056 0.4063\n7 HPQ 0.3527 0.3594 0.2642 1.0000 0.2162 0.4145 0.5097 0.2791 0.1665 0.1878\n8 MO 0.1769 0.2909 0.0114 0.3328 1.0000 0.2096 0.2351 0.1158 0.0884 0.1046\n9 AXP 0.7843 0.7927 0.5595 1.1704 0.3845 1.0000 0.8956 0.4624 0.2556 0.3270\n10 AA 0.5006 0.4950 0.4690 0.6533 0.1957 0.4066 1.0000 0.4404 0.1938 0.2625\n11 DD 0.4820 0.5343 0.5496 0.8687 0.2342 0.5097 1.0694 1.0000 0.4327 0.5067\n12 MRK 0.1483 0.0272 0.1826 0.2991 0.1032 0.1626 0.2715 0.2497 1.0000 0.0741\n13 MMM 0.4437 0.5772 0.5151 0.7156 0.2588 0.4412 0.7802 0.6202 0.1571 1.0000\n14 <-- {=bltracking(B18:K27)}\n15\n16 Variance-covariance matrix\n17 GM HD IP HPQ MO AXP AA DD MRK MMM\n18 GM 0.0118 0.0031 0.0024 0.0042 0.0014 0.0033 0.0046 0.0018 0.0010 0.0014\n19 HD 0.0031 0.0072 0.0019 0.0043 0.0022 0.0033 0.0046 0.0020 0.0002 0.0018\n20 IP 0.0024 0.0019 0.0040 0.0031 0.0001 0.0024 0.0043 0.0021 0.0012 0.0016\n21 HPQ 0.0042 0.0043 0.0031 0.0119 0.0026 0.0049 0.0061 0.0033 0.0020 0.0022\n22 MO 0.0014 0.0022 0.0001 0.0026 0.0077 0.0016 0.0018 0.0009 0.0007 0.0008\n23 AXP 0.0033 0.0033 0.0024 0.0049 0.0016 0.0042 0.0038 0.0019 0.0011 0.0014\n24 AA 0.0046 0.0046 0.0043 0.0061 0.0018 0.0038 0.0093 0.0041 0.0018 0.0024\n25 DD 0.0018 0.0020 0.0021 0.0033 0.0009 0.0019 0.0041 0.0038 0.0017 0.0019\n26 MRK 0.0010 0.0002 0.0012 0.0020 0.0007 0.0011 0.0018 0.0017 0.0066 0.0005\n27 MMM 0.0014 0.0018 0.0016 0.0022 0.0008 0.0014 0.0024 0.0019 0.0005 0.0031\nW e can now use the tracking matrix to discuss the situation where there is\nmore than one opinion.\nTwo or More Opinions\nS uppose Joanna believes the GM monthly return will be 1.10% instead of its\nmarket return of 0.96% and the HD monthly return to be 1% instead of its\nequilibrium return of 1.05%. Joanna also believes that the expected returns on\nall other assets other than GM and HD are correct.\nH ow can we reflect Joanna\u2019 s opinions? We use the BLtracking matrix to\n322 Chapter 13\n( )\nCov r ,r\nr =r + HD GM \u03b4 =1.088%\nHD,opinionadjusted HD,market Var( r ) GM\nGM\n( )\nCov r ,r\nr =r + IP GM \u03b4 =00.80%\nIP,opinionadjusted IP,market Var( r ) GM\nGM\nHere \u2019 s the implementation in Excel:\nA B C D E F G H I J K L\nOpinion-\nAnalyst Portfolio\nExpected benchmark returns, Joanna's adjusted\nopinion, benchmark,\nno opinions opinions optimized\ndelta no opinions\n23 portfolio\n24 0.96% 0.19% GM 1.10%<-- 0.011 10.35% GM 2.71%\n25 1.05% -0.09% HD 1.00%<-- =1% 6.04% HD 11.91%\n26 0.77% -0.01% IP 0.77%<-- =A26 1.28% IP 2.56%\n27 1.36% 0.00% HPQ 1.36%<-- =A27 14.09% HPQ 14.23%\n28 1.05% 0.01% MO 1.05%<-- =A28 Cells J24:J33 contain the array 25.07% MO 24.69%\n29 0.97% -0.06% AXP 0.97%<-- =A29 formula 9.65% AXP 10.57%\n30 1.17% -0.04% AA 1.17% {=MMULT(MINVERSE(B11:K20),D 3.88% AA 4.53%\n31 0.84% 0.03% DD 0.84% 24:D33- 7.16% DD 6.17%\n32 0.77% -0.01% MRK 0.77% B3)/SUM(MMULT(MINVERSE(B11: 11.91% MRK 12.80%\n33 0.73% 0.01% MMM 0.73%<-- =A33 K20),D24:D33-B3))} 10.57% MMM 9.81%\n34 \u2191 {=MMULT(MINVERSE(tracking),D24:D33-A24:A33)}\n35\n36 Tracking matrix\n37 GM HD IP HPQ MO AXP AA DD MRK MMM\n38 GM 1.0000 0.2589 0.1999 0.3540 0.1153 0.2788 0.3920 0.1555 0.0829 0.1169\n39 HD 0.4257 1.0000 0.2603 0.5934 0.3119 0.4635 0.6376 0.2834 0.0250 0.2501\n40 IP 0.5985 0.4738 1.0000 0.7940 0.0222 0.5954 1.0994 0.5306 0.3056 0.4063\n41 HPQ 0.3527 0.3594 0.2642 1.0000 0.2162 0.4145 0.5097 0.2791 0.1665 0.1878\n42 MO 0.1769 0.2909 0.0114 0.3328 1.0000 0.2096 0.2351 0.1158 0.0884 0.1046\n43 AXP 0.7843 0.7927 0.5595 1.1704 0.3845 1.0000 0.8956 0.4624 0.2556 0.3270\n44 AA 0.5006 0.4950 0.4690 0.6533 0.1957 0.4066 1.0000 0.4404 0.1938 0.2625\n45 DD 0.4820 0.5343 0.5496 0.8687 0.2342 0.5097 1.0694 1.0000 0.4327 0.5067\n46 MRK 0.1483 0.0272 0.1826 0.2991 0.1032 0.1626 0.2715 0.2497 1.0000 0.0741\n47 MMM 0.4437 0.5772 0.5151 0.7156 0.2588 0.4412 0.7802 0.6202 0.1571 1.0000\nHere are three comments:\n\u2022 The \u03b4 s in B24:B33 are computed so that the expected returns of GM and\nHD reflect Joanna \u2019 s opinions and so that the expected returns of all other assets\nare unchanged from the initial computation.\n\u2022 The formula for computing this \u03b4 -vector is given in row 34.\n\u2022 T he revised optimal portfolio\u2014given the two opinions about GM and HD\u2014\nis computed in J24:J33.\nTwo or More Opinions, a Different Interpretation\nT here is another interpretation to Joanna\u2019 s opinions. Suppose she believes the\nGM monthly return will be 1.10% instead of its market return of 0.96% and\n323 The Black-Litterman Approach to Portfolio Optimization\nthat she realizes that her two opinions reflect both on each other (i.e., that \u03b4\nGM\ninfluences the return on HD and vice versa) and on all the other returns.\nWith this alternative interpretation, we can easily solve for the new optimal\nportfolio:\nA B C D E F G H I J K L\nMonthly Opinion-\nAnalyst Portfolio\nExpected benchmark returns, returns adjusted\nopinion, benchmark,\nno opinions adjusted for optimized\ndelta no opinions\n23 opinions portfolio\n24 0.96% 0.14% GM 1.08% 6.19% GM 2.71%\n25 1.05% -0.05% HD 1.06%<-- {=A24:A33+MMULT(tracking,B24:B33)} 6.71% HD 11.91%\n26 0.77% 0.00% IP 0.83% 6.97% IP 2.56%\n27 1.36% 0.00% HPQ 1.39% 9.10% HPQ 14.23%\n28 1.05% 0.00% MO 1.06% Cells J24:J33 contain the array 22.19% MO 24.69%\n29 0.97% 0.00% AXP 1.04% formula 18.88% AXP 10.57%\n30 1.17% 0.00% AA 1.22% {=MMULT(MINVERSE(B11:K20),D 0.19% AA 4.53%\n31 0.84% 0.00% DD 0.88% 24:D33- 9.11% DD 6.17%\n32 0.77% 0.00% MRK 0.79% B3)/SUM(MMULT(MINVERSE(B11: 10.61% MRK 12.80%\n33 0.73% 0.00% MMM 0.77% K20),D24:D33-B3))} 10.05% MMM 9.81%\nW e leave it to you to decide which of these conflicting versions of Joanna\u2019 s\nopinions is correct. There is, of course, no \u201cscientific\u201d answer to this\nquestion.\nDo You Believe Your Opinions?\nDo we really believe our own opinions? Do we actually have confidence in\nwhat we believe? There is a whole theory of Bayesian adjustments to our\nbeliefs, which is explained in Theil (1971).6 An application to portfolio model-\ning can be found in Black and Litterman (1999) and other associated papers.\nThis author finds these papers dauntingly complicated and difficult to imple-\nment. A simpler approach to the confidence question is to form a portfolio\nbased on a convex combination of the market weights and the opinion-adjusted\nweights:\nPortfolioproportions=( 1\u2212\u03b3)\u2217Marketweights\n+\u03b3\u2217Opinion-adjusteddweights\nwhere \u03b3 is our degree of confidence in our opinions. An application to our last\nexample is given below:\n324 Chapter 13\nA B C D E F G H I J K L\nOpinion-\nAnalyst Returns Portfolio\nExpected benchmark returns, adjusted\nopinion, adjusted for benchmark,\nno opinions optimized\ndelta opinions no opinions\n23 portfolio\n24 0.96% 0.19% GM 1.10%<-- 0.011 10.35% GM 2.71%\n25 1.05% -0.09% HD 1.00%<-- =1% 6.04% HD 11.91%\n26 0.77% -0.01% IP 0.77%<-- =A26 1.28% IP 2.56%\n27 1.36% 0.00% HPQ 1.36%<-- =A27 14.09% HPQ 14.23%\n28 1.05% 0.01% MO 1.05%<-- =A28 Cells J24:J33 contain the array 25.07% MO 24.69%\n29 0.97% -0.01% AXP 0.97%<-- =A29 formula 9.65% AXP 10.57%\n30 1.17% -0.01% AA 1.17% {=MMULT(MINVERSE(B11:K20),D 3.88% AA 4.53%\n31 0.84% 0.01% DD 0.84% 24:D33- 7.16% DD 6.17%\n32 0.77% -0.01% MRK 0.77% B3)/SUM(MMULT(MINVERSE(B11: 11.91% MRK 12.80%\n33 0.73% 0.01% MMM 0.73%<-- =A33 K20),D24:D33-B3))} 10.57% MMM 9.81%\n34 \u2191 {=MMULT(MINVERSE(B52:K61),D24:D33-A24:A33)}\n35\n36\u03b3, opinion confidence 0.6<-- Weight attached to analyst opinion\n37\nOpinion and confidence-\n38 adjusted portfolio\n39 GM 7.29%<-- {=B36*J24:J33+(1-B36)*L24:L33}\n40 HD 8.39%\n41 IP 1.79%\n42 HPQ 14.15%\n43 MO 24.92%\n44 AXP 10.02%\n45 AA 4.14%\n46 DD 6.77%\n47 MRK 12.27%\n48 MMM 10.27%"
        ],
        "13.6": [
            "What is the Black-Litterman approach to portfolio optimization?\n\nWhat is the S&P 500 index?\n\nWhat does the MSCI World ex-US index comprise of?\n\nCan you explain what the Russell 2000 Index is?\n\nWhat is the composition of the MSCI Emerging Markets index?\n\nCan you describe the LB Global Aggregate index?\n\nHow is a composite portfolio's value weights calculated, using an example from the end of December 2005?\n\nWhat does the standard deviation of each index component represent in a composite portfolio?\n\nHow is the variance-covariance matrix calculated for a set of indices using the correlation matrix?\n\nHow do Excel array functions assist in computing the variance-covariance matrix for the indices?\n\nWhat is the meaning of the transposition operation in portfolio modeling?\n\nWhat does the operation I4:I8*Transpose(I4:I8)*B4:F8 mean in the financial modeling context?\n\nHow is the variance-covariance matrix created through the multiplication of the correlation matrix?\n\nCan you explain the formula I4:I8*Transpose(I4:I8)*B4:F8 in the context of financial modeling, regarding its entry with the keys [Ctrl] + [Shift] + [Enter]?\n\nHow does one compute the standard deviation of the five-index portfolio?\n\nWhat are the Black-Litterman implied expected returns based on?\n\nWhat are the assumptions for the weighted portfolio of five indices to be mean-variance optimal?\n\nHow does the risk free rate affect Black-Litterman implied expected returns calculation?\n\nHow is the expected return of the S&P 500 index used in Black-Litterman implied expected returns calculation?\n\nWhat calculation does the formula =MMult(B14:F18,H4:H8)*(B26-B25)/Index((MMult(B14:F18,H4:H8))),1,1)+B25 represent?\n\nHow does the Black-Litterman model contribute to determining the returns from each component of an efficient world portfolio? \n\nIn the Black-Litterman model, how is the risk-free rate and an assumption on expected returns (for example: the expected return of the S&P 500 index) used to calculate the anticipated returns from each portfolio component? \n\nHow can variations in these assumptions potentially impact model outcomes?",
            "13.6 Using Black-Litterman for International Asset Allocation7\n\nW e end this chapter by implementing the BL model on data for five interna-\ntional indices. The spreadsheet below gives data on five major world stock\nmarket indices:\n\u2022 The S&P 500, a value-weighted index of the 500 largest U.S. stocks.\n\u2022 The MSCI World ex-US index: The Morgan Stanley Capital International\n(MSCI) World Ex-US Index comprises 21 developed countries based on GDP\nper capita.\n\u2022 The Russell 2000 Index: The Russell 3000 Index, which is market cap\nweighted and captures about 98% of the investable U.S. marketplace. The\nRussell 2000 Index consists of the 2,000 smallest companies in the Russell\n3000 Index.\n\u2022 The MSCI Emerging Markets index: The Morgan Stanley Capital Interna-\ntional (MSCI) Emerging Markets index consists of indices for 26 emerging\neconomies.\n7. I thank Steven Schoenfeld of Northern Trust for providing me with the data and some\n325 The Black-Litterman Approach to Portfolio Optimization\n\u2022 The LB Global Aggregate index: This Lehman Brothers index covers the\nmost liquid portion of the global investment-grade, fixed-rate bond market,\nincluding government, credit, and collateralized securities.\nA B C D E F G H I\n1 INDEX DATA, 2001-2005\n5 YEARS ENDING\n2 DEC05\nMSCI\nRussell MSCI LB Global Standard\nCorrelation S&P500 World ex- Weight\n2000 Emerging aggregate deviation\nUS\n3\n4 S&P500 1.0000 0.8800 0.8400 0.8100 -0.1600 24% 14.90%\n5 MSCI World ex-US 0.8800 1.0000 0.8300 0.8700 0.0700 26% 15.60%\n6 Russell 2000 0.8400 0.8300 1.0000 0.8300 -0.1400 3% 19.20%\n7 MSCI Emerging 0.8100 0.8700 0.8300 1.0000 -0.0500 3% 21.00%\n8 LB Global aggregate -0.1600 0.0700 -0.1400 -0.0500 1.0000 44% 5.80%\n9 100%\nC olumn H gives the value weights on each index in a composite portfolio\nas of end of December 2005, and column I gives the standard deviation of\neach index component.\nThe Variance-Covariance Matrix\nWe use Excel array functions (Chapter 34) to compute the variance-covariance\nmatrix for the five indices from the correlation matrix above\nA B C D E F G H\nVariance-covariance matrix: cells below contain formula\n12 {=I4:I8*TRANSPOSE(I4:I8)*B4:F8}\nMSCI\nVariance-covariance Russell MSCI LB Global\nS&P500 World ex-\nmatrix 2000 Emerging aggregate\n13 US\n14 S&P500 0.0222 0.0205 0.0240 0.0253 -0.0014\n15 MSCI World ex-US 0.0205 0.0243 0.0249 0.0285 0.0006\n16 Russell 2000 0.0240 0.0249 0.0369 0.0335 -0.0016\n17 MSCI Emerging 0.0253 0.0285 0.0335 0.0441 -0.0006\n18 LB Global aggregate -0.0014 0.0006 -0.0016 -0.0006 0.0034\n19\n20 Checks\n21 First row of var-cov 0.0222 0.0205 0.0240 0.0253 -0.0014<-- =I4*I8*F4\nStandard deviation of\n326 Chapter 13\nThe strange formula, I4:I8*Transpose(I4:I8)*B4:F8, in the cells B14:F19\nis composed of two parts:\n\u2022 I4:I8*Transpose(I4:I8) multiplies the column vector I4:I8 times its trans-\npose. This is equivalent to multiplying\n\u23a1 \u03c3 \u23a4\u23a4\nSP500\n\u23a2 \u23a5\n\u03c3\n\u23a2 MSCIWorld \u23a5\n\u23a2 \u03c3 \u23a5*[\u03c3 \u03c3 \u03c3 \u03c3 \u03c3 ]\n\u23a2 Russell2000 \u23a5 SP500 MSCIWorld Russell2000 MSCIEmerging LBGlobaal\n\u03c3\n\u23a2 MSCIEmerging\u23a5\n\u23a3\u23a2 \u03c3 \u23a6\u23a5\nLBGlobal\nwhich\u2014in the wonderful world of array functions\u2014gives a matrix of the\ncovariances:\n\u23a1 \u03c32 \u03c3 \u03c3 \u03c3 \u03c3 \u03c3 \u03c3 \u23a4\nSP500 SP500 MSCIWorld SP500 Russell2000 SP500 LBGlobal\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c32 (cid:7)\n\u23a2 MSSCIWorld SP500 MSCIWorld \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a2 \u23a5\n\u23a2 (cid:2) \u23a5\n\u23a3\u23a2\u03c3 \u03c3 \u03c3 \u03c3 (cid:7) (cid:7) \u03c32 \u23a6\u23a5\nLBGlobal SP500 LBGlobal MSCIWWorld LBGlobal\n\u2022 Multiplying the above by the matrix of correlations B4:F8 gives the\nvariance-covariance matrix.\n\u2022 Of course the whole array formula I4:I8*Transpose(I4:I8)*B4:F8 is\nentered with [Ctrl] + [Shift] + [Enter].\nIn rows 21 and 22 we perform two checks on our computation: Row 21\ncontains brute-force computations of the first row of the variance-covariance\nmatrix\u2014just to make sure our array formula works as advertised. In cell B22\nwe compute the standard deviation of the five-index portfolio using their rela-\n327 The Black-Litterman Approach to Portfolio Optimization\nA B C D E F\n25 Risk-free rate 5.00%\nExpected return on\n26 S&P 500 12.00%\n27\n28 Black-Litterman implied returns\n29 S&P 500 12.00%\n<-- {=MMULT(B14:F18,H4:H8)*(B26-\n30 MSCI World ex-US 12.97%\nB25)/INDEX((MMULT(B14:F18,H4:H8)),1,1)+B25}\n31 Russell 2000 13.30%\n32 MSCI Emerging 14.45%\n33 LB Global aggregate 5.76%\nT he Black-Litterman implied expected returns are based on three\nassumptions:\n\u2022 The weighted portfolio of the five indices is mean-variance optimal.\n\u2022 The anticipated risk-free rate is 5%.\n\u2022 The expected return of the S&P 500 index is 12%.\nGiven these assumptions the expected returns on the five-index portfolio are\ngiven in cells B29:B33. Note the array formula given in these cells:\n=MMult(B14:F18,H4:H8)\u2217(B26-B25)\n/Index((MMult(B14:F18,H4:H8))),1,1)+B25\nThis formula uses the expected return on the S&P 500 to normalize the returns.\n328 Chapter 13\n\u23a1Benchmark\u23a4 \u23a1Variance-\u23a4\u23a1Benchmark\u23a4\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5 Normaalizing Risk-free\nportfolio = covariance portfolio * +\n\u23a2 \u23a5 \u23a2 \u23a5\u23a2 \u23a5\nfactor rate\n\u23a3\u23a2 returns \u23a6\u23a5 \u23a3\u23a2 matrrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\n\u23a1Variance-\u23a4\u23a1Benchmark\u23a4\n\u23a2 \u23a5\u23a2 \u23a5\n= covariance portfolio\n\u23a2 \u23a5\u23a2 \u23a5\n\u23a2\u23a2\u23a3 matrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\n\u239b SP500expecteedreturn\u2212Risk-freerate \u239e\n\u239c\u239b\u23a1Benchmark\u23a4T \u23a1Variance-\u23a4\u23a1Benchmark\u23a4\u239e\u239f\nRisk-free\n*\u239c\n\u239c\u23a2 \u23a5 \u23a2 \u23a5\u23a2\n\u23a5\u239f\u239f+\n\u239c \u239c\u23a2portfolio \u23a5 \u23a2covariance \u23a5\u23a2 portfolioo \u23a5\u239f\u239f rate\n\u239d\u239c \u239d\u239c \u23a3\u23a2proportions\u23a6\u23a6\u23a5 \u23a3\u23a2 matrix \u23a6\u23a5\u23a3\u23a2proportions\u23a6\u23a5\u23a0\u239f \u23a0\u239f\n(cid:3)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:4)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:6)\n\u2191\nThe normaliziing factor\nWhat \u2019 s the Upshot?\nI f we believe that the world portfolio is efficient (and in the absence of further\ninformation, there is little reason to believe otherwise), then the anticipated\nreturns from each of its components are given by the Black-Litterman model,\nby the risk-free rate, and by an additional assumption on expected returns (in\nour case: the expected return of the S&P 500 index). The exercises to this\nchapter explore some other variations to the latter assumption."
        ],
        "13.7": [
            "What is the Black-Litterman approach to portfolio optimization?\nHow are historical market data used in portfolio theory? \nWhat are the limitations of using sample data to derive optimal portfolios?\nHow does the Black-Litterman approach circumvent the absurdities arising from blindly applying sample data?\nWhat assumptions does the Black-Litterman approach make in the absence of analyst opinions and other information? \nCan the resulting asset returns be adjusted in the Black-Litterman approach? \nHow do benchmark market weights and current risk-free interest rate predict the future asset returns according to the Black-Litterman approach?",
            "13.7 Summary\n\nA pplying portfolio theory is not merely a matter of using historical market\ndata to derive covariances and expected returns. Blindly applying sample data\nto derive optimal portfolios (as in section 13.1) usually leads to absurd results.\nThe Black-Litterman approach gets around these absurdities by first assuming\nthat\u2014in the absence of analyst opinions and other information\u2014the bench-\nmark market weights and current risk-free interest rate correctly predict the\nfuture asset returns. The resulting asset returns can then be adjusted for opin-\n329 The Black-Litterman Approach to Portfolio Optimization"
        ]
    },
    "14": {
        "14.1": [
            "What are event studies in the context of financial modeling?\nWhat is the purpose of an event study?\nWhich model is commonly used in event studies?\nHow does event study methodology aim to differentiate between company-specific and market-specific events?\nHow is an event study related to market efficiency?\nWhat is meant by abnormal returns in an event study?\nHow are abnormal returns calculated in an event study?\nWhich model is typically used to estimate a stock's expected return in an event study?\nWhat does the market model in an event study measure?\nWhat is the role of a stock's market index in estimating its expected return in the context of an event study?\nWhat is meant by the term 'cumulative abnormal return' (CAR) in an event study?\nHow is the concept of the event window related to an event study? \nWhat is the relevance of the correlation between an individual stock's returns and its corresponding market returns in an event study?\nHow does the cumulative abnormal return measure the total impact of an event?",
            "14.1 Overview\n\nE vent studies are some of the most powerful and widely used applications of\nthe capital asset pricing model (CAPM) discussed in Chapters 8\u201311 of Finan-\ncial Modeling. An event study is an attempt to determine whether a particular\nevent in the capital market or in the life of a company affected a company\u2019 s\nstock market performance. The event-study methodology aims to separate\ncompany-specific events from market- and/or industry-specific events, and has\noften been used as evidence for or against market efficiency.\nAn event study aims to determine if an event or announcement caused an\nabnormal movement in a company\u2019 s stock price. The abnormal returns (AR)\nare calculated as the difference between a stock \u2019 s actual return and its expected\nreturn, where the stock \u2019 s expected return is typically measured using the\nmarket model, which relies only on a stock \u2019 s market index to estimate its\nexpected return.1 Using the market model, we can measure the correlation\nbetween an individual stock \u2019 s returns and its corresponding market returns. In\nsome cases, we sum the abnormal returns to arrive at the c umulative abnormal\nreturn (CAR), which measures the total impact of an event through a particular\ntime period, also called the event window."
        ],
        "14.2": [
            "What is the methodology of an event study?\nWhat are the three time frames that compose an event study?\nCan you describe the term 'estimation window' in an event study?\nWhat is 'abnormal return' in financial modeling?\nHow do we identify the 'normal' behavior of the stock in an event study?\nWhat does the post-announcement effect indicate in an event study?\nCan you define an 'event' in the context of financial modeling?\nWhy is the length of the event window often started a few trading days before the actual event day?\nWhat does the estimation window help us determine in an event study?\nWhat could be the usual length of the estimation window in an event study?\nWhat is the significance of the post-event window in an event study?\nHow is the stock's behavior measured in the estimation and event windows in an event study?\nWhat does the industry index represent in an event study?\nHow is the impact of an event on the stock\u2019s return measured in an event window of an event study?\nWhat does the abnormal return during the event window indicate?\nWhat is the cumulative abnormal return (CAR) in an event study?\nHow are the Market-Adjusted and Two-Factor Models utilized in calculating a security\u2019s expected return?\nWhat parameters are used to calculate a stock's expected return in the two-factor model?\nHow is an abnormal return calculated in the market-adjusted model?\nWhy are the industry returns included in the two-factor model?\nWhat does Brown and Warner's study suggest about the sensitivity of the results to the choice of estimation model in an event study?",
            "14.2 Outline of an Event Study\n\nI n this section we outline the methodology of an event study. In succeeding\nsections we apply the methodology to a number of different cases.\nAn event study is composed of three time frames: the e stimation window\n(sometimes referred to as the control period), the e vent window, and the post-\nevent window . The following chart illustrates these time frames.\n* T his chapter was co-authored with Dr. Torben Voetmann, Principal at the Brattle Group (T orben.\nVoetmann@brattle.com ) and adjunct professor at the University of San Francisco.\n1 . A bnormal returns are also referred to as residual returns and both terms are used interchange-\n332 Chapter 14\nTHE EVENT STUDY TIME LINE\nT0 T1 T1 + 1 0 T2 T2 + 1 T3\nStart date for End date for Start date for End date for\nStart date for Event End date for\nestimation estimation post-event post-event\nevent window date event window\nwindow window window window\nEVENT WINDOW POST-EVENT WINDOW\nESTIMATION WINDOW We use data from this window, in conjunction\nThe estimation window is used to with the \u03b1and \u03b2of the stock or stocks to Used to investigate longer-term company\ndetermine the normal behavior of the determine whether: performance following the event.\nstock wrt market factors. Most often we\nuse the regression Rit= \u03b1+ \u03b2Rmtto i) The event announcement was anticipated or\ndetermine this \"normal\" behavior. leaked.\nii) The \"post-announcement effect\": How long\nit took for the event information to be absorbed\nby the market.\nThe time line illustrates the timing sequence of an event. The length of the\nestimation window is represented as T to T . The event occurs at time 0 and\n0 1\nthe event window is represented as T + 1 to T . The length of the post-event\n1 2\nwindow is represented as T + 1 to T .\n2 3\nAn event is defined as a point in time when a company makes an announce-\nment or when a significant market event occurs. For example, if we are study-\ning the impact of mergers and acquisitions on the stock market, the\nannouncement date is normally the point of interest. If we are examining how\nthe market reacts to earnings restatements, the event window begins on the\nevent date when a company announces its restatement. In practice, it is common\nto expand the event window to 2 trading days, the event date and the following\ntrading day. This is done to capture the market movement if the event was\nannounced immediately before the market closed or after market closing.\nThe event window often starts a few trading days before the actual event\nday. The length of the event window is centered on the announcement and is\nnormally 3, 5, or 10. This enables us to investigate pre-event leakage of\ninformation.\nThe estimation window is also used to determine the normal behavior of a\nstock\u2019 s return with respect to a market or industry index. The estimation of\nthe stock \u2019 s return in the estimation window requires us to define a model of\n\u201cnormal\u201d behavior: Most often we use a regression model for this purpose.2\n2 . T he regression model is similar to the first-pass regression discussed in Chapter 11. See further\n333 Event Studies\nT he usual length of the estimation window is 252 trading days (or 1 calendar\nyear), but you may not always have this many days in your sample. If not, you\nneed to determine whether the number of observations you do have is sufficient\nto produce robust results. As a guideline, you should have a minimum of 126\nobservations; if you have less than 126 observations in the estimation window\nit is possible that the parameters of the market model will not indicate the true\nstock price movements, and thus the relationship between the stock returns\nand the market returns. The estimation window that you select is supposedly\na period that was free of any problems, i.e., a period that reflects the stock \u2019 s\nnormal price movements. 3\nThe post-event window is most often used to investigate the performance of\na company following announcements such as a major acquisition or an IPO.\nThe post-event window allows us to measure the longer-term impact of the\nevent. The post-event window can be as short as 1 month and as long as several\nyears depending on the event.\nMeasuring the Stock \u2019 s Behavior in the Estimation Window and the Event Window\nAs its name implies, the e stimation window is used to estimate a model of the\nstock\u2019 s returns under \u201cnormal\u201d circumstances. The most common model used\nfor this purpose is the market model, which is essentially a regression of the\ncompany \u2019 s stock returns and the returns of the market index.4 The market\nmodel for a stock i can be expressed as:\nr =\u03b1 +\u03b2r\nit i i Mt\nHere r and r represent the stock and the market return on day t . The coef-\nit Mt\nficients \u03b1 and \u03b2 are estimated by running an ordinary least-square regression\ni i\nover the estimation window.\nThe most common criteria for selecting market and/or industry indices are\nwhether the company is listed on NYSE/AMEX or Nasdaq and whether any\nrestrictions are imposed by data availability. In general, the market index\n3 . O f course something will always be going on in such a long window\u2014quarterly earnings\nannouncements, dividend announcements, news about the companies being considered, etc. Our\nassumption is that these other events constitute at most \u201cnoise\u201d and are not material for the event\nbeing studied.\n4. Financial economists most often use the market model to estimate the expected return of a\nsecurity, although they sometimes use the market-adjusted model or the two-factor market model.\n334 Chapter 14\nshould be a broad-based value-weighted index or a float-weighted index. The\nindustry index should be specific to the company being analyzed. For litigation\npurposes, it is common to construct the industry index instead of using alterna-\ntive S&P 500 or MSCI indices. Most industry indices are available from\nYahoo. 5\nG iven the equation r = \u03b1 + \u03b2 r in the estimation window, we can now\nit i i Mt\nmeasure the impact of an event on the stock\u2019 s return in the event window. For\na particular day t in the event window, we define the stock\u2019 s abnormal return\nas the difference between its actual return and its predicted return:\nAR\nit\n= r(cid:2)it \u2212 (( (cid:3)\u03b1 (cid:5)(cid:5)i+ (cid:4)\u03b2 (cid:5)ir M(cid:6)t)\n\u2191 \u2191\nActual stock Return predicted\nreturn in event by the stock\u2032s \u03b1,\nwindow day t \u03b2,and market return\nW e interpret the abnormal return during the event window as a measure of the\nimpact the event had on the market value of the security. This assumes that\nthe event is exogenous with respect to the change in the security\u2019 s market\nvalue.\nThe cumulative abnormal return is a measure of the total abnormal returns\nduring the event window. CAR is the sum of all the abnormal returns from the\nt\nbeginning of the event window T until a particular day t in the window:\n1\nCAR\n=\u2211t\nAR\nt T1+j\nj=1\nMarket-Adjusted and Two-Factor Models\nAs mentioned above, you can use several alternative models to calculate a\nsecurity \u2019 s expected return. The market-adjusted model is simplest in design\nand is often used to get a first impression of stock price movements. When\nusing the market-adjusted model, you calculate the abnormal return by taking\nthe difference between the actual return of the security and the actual return\n5 . Y ahoo is probably not the best source for index data (though it is free!). A widely used source\nfor industry data is Bloomberg. A wonderful free source of industry portfolio data is available\n335 Event Studies\nof the market index. Thus, there is no need to run ordinary least squares (OLS)\nregressions to estimate parameters. In fact, all you need is the returns at the\ntime of the event. However, when testing the abnormal returns for statistical\nsignificance, you still need to gather returns for the estimation period.\nThe two-factor model utilizes the returns from the market and the industry.\nYou calculate a stock \u2019 s expected return using parameters from a regression of\nthe actual returns against the market and industry returns during the estimation\nperiod. The industry returns are included primarily to account for industry-\nspecific information in addition to the market-specific information. To calcu-\nlate the abnormal return you subtract from the actual return the portion that\ncan be explained by the intercept, the market, and the industry. The two-factor\nmodel is illustrated in detail in section 14.3.\nAs Brown and Warner (1985) showed, the results in a large sample of\nevents are not especially sensitive to your choice of estimation model. 6\nHowever, if you are dealing with a small sample you should explore alternative\nmodels."
        ],
        "14.3": [
            "What is an event study in financial modeling? \nWhat was the impact of Procter & Gamble's bid for Gillette Company?\nWhat is an estimation window in an event study? \nHow do we determine the estimation window in an event study? \nWhat was the effect of Procter & Gamble's acquisition announcement on the returns of Gillette and Procter & Gamble? \nHow can we measure the significance of abnormal returns in an event study? \nWhat is a market model in an event study? \nWhat was the impact of Procter & Gamble's acquisition announcement on Gillette's abnormal returns? \nWhat is the significance of the standard error of the regression prediction in an event study? \nHow do we calculate the test statistic in an event study? \nWhat is the role of Steyx in an event study? \nWhat was the influence of the event on Gillette and Procter & Gamble's stock returns? \nWhat is the significance level of an abnormal return in an event study? \nWhat concepts are involved in measuring the synergies in the event window? \nWhy is the true variance of the market model the estimation variance from Steyx and the additional variance due to the sampling error? \nCan you explain how to measure the short-term synergies of an acquisition announcement by multiplying the CAR for the involved companies? \nWhat were the effects of Procter & Gamble's acquisition announcement on the stock prices of Gillette and Procter & Gamble on the announcement date and the day after? \nWhat could be the possible reason for a negative synergy in the short period of time measured by the event window in the case of Procter & Gamble's acquisition of Gillette? \nWhat is the significance of the regression results in an event study?\nWhat is the \"event window\" and how is it defined in an event study?",
            "14.3 An Initial Event Study: Procter & Gamble Buys Gillette\n\nO n 28 January 2005, Procter & Gamble announced a bid for Gillette Company.\nAs can be seen from the press release on page 341, the bid valued Gillette at\na premium of 18% over its market price. As might be expected, the bid had a\ndramatic effect on Gillette \u2019 s stock price:\n6 . S tephen Brown and Jerold Warner, \u201cUsing Daily Stock Returns: The Case of Event Studies,\u201d\n336 Chapter 14\nGillette Company and Procter & Gamble\nClosing Stock Price\n6/30/04 \u201312/31/05\nStock\nPrice\n$60 1/28/05 10/3/05\nAnnouncement Date Completion Date\nProcter & Gamble\n$55\n$50\n$45\n$40\nGillette Company\n$35\n$30\n30-06-04 23-08-04 17-10-04 11-12-04 04-02-05 31-03-05 25-05-05 19-07-05 12-09-05 06-11-05 31-12-05\nF rom the graph it appears that there might have also been a decrease in the\nprice of Procter & Gamble.\nThe Estimation Window\nW e will attempt an event study to judge the impact of the takeover announce-\nment on the returns of Gillette and Procter & Gamble. To do this, we first\ndetermine the estimation window as the 252 trading days preceding the 2 days\n337 Event Studies\nA B C D E F G\nGILLETTE RETURNS: ESTIMATION WINDOW\nAND EVENT WINDOW\n1\n2 Intercept 0.0007 <-- =INTERCEPT($C$11:$C$262,$B$11:$B$262)\n3 Slope 0.6364 <-- =SLOPE($C$11:$C$262,$B$11:$B$262)\n4 R-squared 0.1315 <-- =RSQ($C$11:$C$262,$B$11:$B$262)\n5 Steyx 0.0113 <-- =STEYX($C$11:$C$262,$B$11:$B$262)\n6\nDays in estimation\n7 window 252<-- =COUNT(A11:A262)\n8\n9 EVENT WINDOW\nCumulative\nExpected Abnormal\nDate NYSE Gillette abnormal\n10 return return (AR) return (CAR)\n11 27-Jan-04 -0.48% -0.42%\n12 28-Jan-04 -1.26% -1.27%\n13 29-Jan-04 0.00% -0.94%\nCell D263 contains formula\n=$B$2+$B$3*B263\n14 30-Jan-04 -0.06% -1.39%\n15 2-Feb-04 0.26% -0.74%\n258 19-Jan-05 -0.78% -0.09%\nCell E263 contains formula =C263-\n259 20-Jan-05 -0.69% -0.56% D263\n260 21-Jan-05 -0.20% -1.50%\n261 24-Jan-05 -0.18% 0.57%\n262 25-Jan-05 0.21% 1.44%\n263 26-Jan-05 0.68% 0.07% 0.50% -0.44% -0.44%<-- =E263\n264 27-Jan-05 0.04% 1.89% 0.09% 1.80% 1.36%<-- =F263+E264\n265 28-Jan-05 -0.24% 12.94% -0.09% 13.03% 14.39%<-- =F264+E265\n266 31-Jan-05 0.82% -1.71% 0.59% -2.30% 12.09%\n267 1-Feb-05 0.80% -0.83% 0.57% -1.40% 10.69%\n268 2-Feb-05 0.32% 0.80% 0.27% 0.52% 11.21%\n269 3-Feb-05 -0.29% -0.59%\n270 4-Feb-05 0.97% -1.29%\n271 176-F%eb-05 -0.23% -0.38%\n272 8-Feb-05 0.09% -0.75%\n273 194-F%eb-05 -0.63% -1.20%\n274 10-Feb-05 0.68% 0.37%\n275 1112-%Feb-05 0.71% 1.58%\n276 14-Feb-05 0.26% 0.67%\n277 1150-%Feb-05 0.32% 1.68%\n278 16-Feb-05 0.04% -0.41%\n279 178-%Feb-05 -0.47% 0.18%\n280 18-Feb-05 0.21% 0.10%\n281 226-%Feb-05 -1.05% -1.82%\n282 23-Feb-05 0.45% 2.05%\n283 24-Feb-05 0.55% 0.81%\n4%\n284 25-Feb-05 1.08% 0.57%\n285 28-Feb-05 -0.55% -2.33%\n286 12-M%ar-05 0.41% 1.19%\n287\n288 0%\n289\n290 -2%\n291\n292 -4%\n293\n294\n26jan05 27jan05 28jan05 31jan05 1feb05 2feb05\nExpected return\nAbnormal return (AR)\nCumulative abnormal return\n338 Chapter 14\nT he regression results indicate the normal behavior of Gillette in the estima-\ntion window: r = 0.0007+ 0.6364 r . The Steyx function measures the\nGillette,t NYSE,t\nstandard error of the regression-predicted y - values. Below we show how to\nuse this value to measure the significance of the event \u2019 s abnormal returns.\nThe Event Window\nW e define the event window as 2 days before and 3 days after the announce-\nment. To measure the impact of the announcement effect in the event window\nwe use the market model r = 0.0007 + 0.6346 r . The formulas in the\nGillette,t NYSE,t\nevent window are in the spreadsheet above. As you can see, the announcement\nof the acquisition of Gillette by Procter & Gamble led to several large Gillette\nabnormal returns in the event window.\nW e can use Steyx, the standard error of the regression prediction to measure\nthe significance of the abnormal returns. Only two of the abnormal returns\u2014on\nthe event date 28 January and the day following\u2014are actually significant\nat the 5% level:\nA B C D E F G H I\nGILLETTE RETURNS: THE SIGNIFICANCE\nOF THE ABNORMAL RETURNS\n1\n2 Intercept 0 .0007 <-- =INTERCEPT($C$11:$C$262,$B$11:$B$262)\n3 Slope 0 .6364 <-- =SLOPE($C$11:$C$262,$B$11:$B$262)\n4 R-squared 0 .1315 <-- =RSQ($C$11:$C$262,$B$11:$B$262)\n5 Steyx 0 .0113 <-- =STEYX($C$11:$C$262,$B$11:$B$262)\n6\nDays in estimation\n7 window 252<-- =COUNT(A11:A262)\n8\n9 EVENT WINDOW\nAbnormal AR AR\n10 Date NYSE Gillette return (AR) t-test significant?\n11 27-Jan-04 -0.48% -0.42%\n12 28-Jan-04 -1.26% -1.27%\n13 29-Jan-04 0.00% -0.94%\nCell D263 contains formula\n14 30-Jan-04 -0.06% -1.39% =C263-($B$2+$B$3*B263)\n15 2-Feb-04 0.26% -0.74%\n258 19-Jan-05 -0.78% -0.09%\nCell E263 contains formula\n259 20-Jan-05 -0.69% -0.56% =D263/$B$5\n260 21-Jan-05 -0.20% -1.50%\nCell F263 contains formula\n=IF(ABS(E263)<1.96,\"no\",\"yes\")\n261 24-Jan-05 -0.18% 0.57%\n262 25-Jan-05 0.21% 1.44%\n263 26-Jan-05 0.68% 0.07% -0.44% -0.39 no\n264 27-Jan-05 0.04% 1.89% 1.80% 1.59 no\n265 28-Jan-05 -0.24% 12.94% 13.03% 11.56 yes\n266 31-Jan-05 0.82% -1.71% -2.30% -2.04 yes\n267 1-Feb-05 0.80% -0.83% -1.40% -1.24 no\n268 2-Feb-05 0.32% 0.80% 0.52% 0.46 no\n339 Event Studies\nW e calculate the test statistic by dividing the abnormal returns by the Steyx\nin cell B5. Assuming that the regression residuals are normally distributed, if\nthe absolute value of the test statistic is larger than 1.96, then the abnormal\nreturn is significant at the 95% level (meaning that the chances that the abnor-\nmal return is random and insignificant are less than 5%). If the test statistic is\nlarger than 2.58, its significance level is 1%. As can be seen from rows\n263\u2013268 above, at the 1% level, only the announcement itself has a significant\nabnormal return.7\nWhat About Procter & Gamble?\nThus far we have concentrated on the event influence on the takeover target,\nGillette. Applying the same methodology to Procter & Gamble\u2019 s stock returns\nshows that the announcement had a negative impact on its stock returns. There\nmay also have been some leakage of the information prior to the announcement\non 28 January 2005:\n7. One limitation of Steyx is that the variance is slightly understated. The true variance of the\nmarket model is the estimation variance from Steyx and the additional variance due to the sam-\npling error in \u03b1 and \u03b2 . However, the sampling error approaches zero as the length of the estima-\ni i\ntion window increases. Since we suggest using 252 trading days in the estimation window, the\neffect of the sampling error is minimal and it is, therefore, often disregarded when calculating the\n340 Chapter 14\nA B C D E F G H\nPROCTER & GAMBLE RETURNS: ESTIMATION WINDOW\n1 AND EVENT WINDOW\n2 Intercept 0.0004 <-- =INTERCEPT($C$11:$C$262,$B$11:$B$262)\n3 Slope 0.5877 <-- =SLOPE($C$11:$C$262,$B$11:$B$262)\n4 R-squared 0.1872 <-- =RSQ($C$11:$C$262,$B$11:$B$262)\n5 Steyx 0.0084 <-- =STEYX($C$11:$C$262,$B$11:$B$262)\n6\nDays in estimation\n7 window 252<-- =COUNT(A11:A262)\n8\n9 EVENT WINDOW\nCumulative\nAbnormal AR AR\nDate NYSE Procter-Gamble abnormal\n10 return (AR) t-test significant? return\n11 27-Jan-04 -0.48% -0.65%\n12 28-Jan-04 -1.26% -0.56%\n13 29-Jan-04 0.00% 2.41%\nCell D263 contains formula\n14 30-Jan-04 -0.06% 0.08% =C263-($B$2+$B$3*B263)\n15 2-Feb-04 0.26% 0.59%\n258 19-Jan-05 -0.78% 1.69%\nCell E263 contains formula\n259 20-Jan-05 -0.69% 0.04% =D263/$B$5\n260 21-Jan-05 -0.20% -1.85%\nCell F263 contains formula\n261 24-Jan-05 -0.18% -0.79% =IF(ABS(E263)<1.96,\"no\",\"yes\")\n262 25-Jan-05 0.21% 0.94%\n263 26-Jan-05 0.68% -0.52% -0.96% -1.14 no -0.96%<-- =D263\n264 27-Jan-05 0.04% -0.22% -0.28% -0.33 no -1.25%<-- =G263+D264\n265 28-Jan-05 -0.24% -2.12% -2.02% -2.39 yes -3.26%<-- =G264+D265\n266 31-Jan-05 0.82% -1.70% -2.23% -2.64 yes -5.49%\n267 1-Feb-05 0.80% -0.68% -1.19% -1.41 no -6.67%\n268 2-Feb-05 0.32% 1.00% 0.77% 0.91 no -5.90%\n269 3-Feb-05 -0.29% -0.30%\n270 4-Feb-05 0.97% -1.16%\n271 71-%Feb-05 26-Jan -0.23%27-Jan -0.17%28-Jan 31-Jan 01-Feb 02-Feb\n272 8-Feb-05 0.09% -1.05%\n273 9-Feb-05 -0.63% -0.90%\n0%\n274 10-Feb-05 0.68% 0.21%\n275 11-Feb-05 0.71% 1.03%\n276 1-14%-Feb-05 0.26% 1.05%\n277 15-Feb-05 0.32% 1.48%\n278 1-26%-Feb-05 0.04% -0.32%\n279 17-Feb-05 -0.47% 0.04%\n280 1-38%-Feb-05 0.21% 0.32%\n281 22-Feb-05 -1.05% -2.34%\n282 23-Feb-05 0.45% 2.37%\n-4%\n283 24-Feb-05 0.55% 0.64%\n284 25-Feb-05 A1b.n0o8rm%al return (AR) 0.67%\n285 2-58%-Feb-05 C-0u.m55ul%ative abnormal re-t2u.r0n3%\n286 1-Mar-05 0.41% 0.79%\n287 -6%\n288\n289 -7%\n290\n341 Event Studies\nSummarizing: What Happened on the Announcement Date?\nO n 28 January 2005, Procter & Gamble announced the purchase of Gillette.\nEach share of Gillette was purchased for 0.975 shares of Procter & Gamble.\nAt the 5% significance level, the acquisition announcement had significant\neffects on the stock prices of Gillette and Procter & Gamble only on the\nannouncement date and the day after. After an initial positive impact on\nGillette (a 13.03% increase in the normally anticipated stock return on the\nevent date 28 January and a further \u2212 2 .30% on 31 January) and an initial\nnegative impact on Procter & Gamble (\u2212 2 .02% on 28 January and \u2212 2.23% on\n31 January), there were no additional significant effects on the stock prices\n342 Chapter 14\nA B C D E F G H I\nGILLETTE PURCHASED BY PROCTER & GAMBLE\nMeasuring the synergies in event window\n1\nMarket\nShares Share\nvalue,\noutstanding price,\n25jan05\n2 (thousands) 25jan05 (billion $)\n3 Gillette 1,000,000 44.53 44.53\n4 P&G 2,741,000 53.49 146.62\n5 Cell F12 contains formula\n6 =$D$3*SUM($B$12:B12)/1000\n7\n8 Cell G12 contains formula\n9 =$D$4*SUM($C$12:C12)/1000\nCumulative abnormal valuations\n10 Date Abnormal returns (AR) (billion $)\n11 Gillette P&G Sum Gillette P&G Sum\n12 26-Jan-05 -0.44% -0.96% -1.40% -0.19 -1.41 -1.61<-- =F12+G12\n13 27-Jan-05 1.80% -0.28% 1.52% 0.61 -1.83 -1.22\n14 28-Jan-05 13.03% -2.02% 11.01% 6.41 -4.78 1.63\n15 31-Jan-05 -2.30% -2.23% -4.52% 5.38 -8.04 -2.66\n16 1-Feb-05 -1.40% -1.19% -2.59% 4.76 -9.78 -5.02\n17 2-Feb-05 0.52% 0.77% 1.29% 4.99 -8.66 -3.66\nThe table above attempts to measure the short-term synergies of the\nannouncement by multiplying the CAR for Gillette and P&G times their\nmarket value on the day before the event window. In the short period of time\nmeasured by this event window, the cumulative synergy appears to be negative,\nwith the positive value creation for Gillette shareholders outweighed by the\nnegative impact on P&G.8"
        ],
        "14.4": [
            "What is an event study in financial modeling?\nCan you explain how a merger announcement can impact the returns of both the takeover target and the acquirer?\nHow can the event-study methodology be used to explore the impact of a merger announcement?\nWhat does it mean to aggregate the returns of an event in finance?\nHow do earnings announcements impact the stocks of grocery industry stores?\nIn context of an event study, what does the \"market reaction\" refer to?\nCan you describe the concept of \"Earnings per share\" (EPS) in the scenario of an earnings announcement?\nHow did Safeway's stock performance compare with the S&P 500 after their earnings announcement on 20 July 2006?\nWhat is meant by a \"positive earnings surprise\" in the context of an earnings announcement?\nWhat does a regression of a company's returns on the S&P returns using the market model represent?\nWhat is the implication of a high value of t-statistic for the return of a company?\nWhat are some sources for obtaining historical analyst estimates and actual earnings numbers? \nWhat is the significance of abnormal return in evaluating the impact of an earnings announcement?\nCan you explain the concept of \"cumulative abnormal returns\" in the context of an event study?\nWhat do we mean by \"average abnormal returns (AAR)\" and how is it computed in an event study?\nWhat is the significance of 'intercept' and 'slope' in market-model regression?\nHow can we interpret the market model of a stock in relation to the S&P 500? \nWhat does it indicate when there's confounding information announced along with an event?\nWhat factors might affect the interpretation of abnormal returns?\nWhat does the term \"event window\" refer to in an event study?\nWhat is the significance of t-statistics in financial modeling and event studies in particular?",
            "14.4 A Fuller Event Study: Impact of Earnings Announcements on Stock Prices\n\nIn the previous section we used the event-study methodology to explore the\nimpact of a merger announcement on the returns of both the takeover target\n(Gillette) and acquirer (Procter & Gamble). In this section we show how to\naggregate the returns of an event in order to evaluate the market response to\na particular type of event. We consider the effect of earning announcements\non a set of stores in the grocery industry.\n8. A study commissioned by the Massachusetts Secretary of the Commonwealth William F.\nGalvin after the merger offer suggests that the synergies of the merger, between $22 and $28\nbillion, were largely captured by Procter & Gamble. See the report and an article from Business\n343 Event Studies\nAn Initial Example: Safeway \u2019 s Positive Earnings Surprise on 20 July 2006\nT o set the stage, consider the earnings announcement made by Safeway on 20\nJuly 2006. On this date Safeway announced earnings per share (EPS) of $0.42,\na number which exceeded by 6 cents the market consensus estimate of $0.36. 9\nOn the same day, the S&P 500 declined by 0.85%, and Safeway stock rose by\n8.39%. The spreadsheet below shows the example of Safeway\u2019 s earnings\nannouncement on 20 July 2006. We use the event-study methodology to gauge\nthe market reaction to this earnings surprise:\nA B C\nTHE MARKET REACTION TO A POSITIVE EARNINGS SURPRISE BY\nSAFEWAY, 20 July 2006\n1\n2 Announcement date 20-Jul-06\n3 Earnings per share $0.42\n4 Consensus earnings estimate $0.36\n5 Earnings surprise (forecast error) $0.06\n6\n7 How did the market interpret the earnings surprise?\n8 Safeway 8.39%\n9 S&P 500 -0.85%\n10\nRegressing Safeway returns on the S&P returns using\nthe market model:\n11 Safeway = 0.0001 + 0.9289*SP\n12 Intercept 0.0001<-- =INTERCEPT(OFFSET('Stock\n13 Slope 0.9289Prices'!$A$2,138,8,252,1),OFFSET('Stock\n14 Steyx 0.0118Prices'!$A$2,138,2,252,1))\n15\nThe residual return:\n16 Expected stock returns versus actual returns\n17 Expected return -0.78%<-- =B13*B9+B12\n18 Residual return 9.17%<-- =B8-B17\n19 t-statistic 7.75 <-- =B18/B14\nI n cells B12:B14 we have regressed Safeway daily returns on those of the\nS&P 500 for the 252 trading days preceding the announcement. The regression\nshows that r = 0.0001 + 0.9289* r and that the standard error of the\nSafeway S&P500\nestimate is 0.0118.\nG iven these data, we can see that on the day of the announcement the\nanticipated return of Safeway, given the negative 0.85% return of the S&P and\nabsent the earnings surprise, should have been \u22120 .78%. This means that the\nabnormal return, measuring the impact of the earnings announcement, was\n344 Chapter 14\n9.17% (cell B18, above). The t -statistic for the return was 7.75, showing that\nit is highly significant.\nThe Earnings Surprise Numbers\nO ur earnings surprise numbers are drawn from Yahoo, as shown in the follow-\ning screenshot. While Yahoo is an admirable source of data, it does not provide\na database of historical analyst estimates and actual earnings numbers; such\ndata are available from Bloomberg \u2019 s Best Consensus Earnings Estimates and\n345 Event Studies\nAn Event Study: The Grocery Industry\nWe extend our Safeway study by considering 16 quarterly earnings announce-\nments by four grocery companies for fiscal year 2006. 10\nA B C D E F G H I J K L M N O P Q\nEARNINGS ANNOUNCEMENT IN 2006-07 FOR KROGER (KR), SUPERVALU (SVU),\n1 SAFEWAY (SWY), AND WHOLE FOODS (WFMI)\n2 Calendar Date Ticker ConsensusActual S =u Drp 3r -Cis 3e: St Pa ort ii nn tg Intercept Slope STEXY A Rc et tu ua rnl S R& eP t u5 r0 n0 =E HRx 3p e +e tu Ic 3rt *ne M:d 3 A Rb =n Leo t 3u -r Nrm n 3a :l t-stat\n3 7-Mar-06 KR 0.36 0.39 0.03 44 0.0003 0.6662 0.0123 1.36% -0.19% -0.09% 1.46% 1.1808<-- =O3/J3\n4 20-Jun-06 KR 0.42 0.42 0.00 117 0.0004 0.6063 0.0113 5.05% 0.00% 0.04% 5.01% 4.4355<-- =O4/J4\n5 12-Sep-06 KR 0.29 0.29 0.00 175 0.0006 0.5628 0.0108 -5.67% 1.03% 0.64% -6.31% -5.8201<-- =O5/J5\n6 5-Dec-06 KR 0.28 0.30 0.02 234 0.0003 0.4483 0.0118 5.08% 0.40% 0.21% 4.87% 4.1297\n7 18-Apr-06 SVU 0.56 0.55 -0.01 73 -0.0008 0.7049 0.0123 -0.28% 1.69% 1.11% -1.39% -1.1313\n8 26-Jul-06 SVU 0.57 0.53 -0.04 142 -0.0003 0.5416 0.0122 -7.09% -0.04% -0.05% -7.03% -5.7632\n9 10-Oct-06 SVU 0.53 0.61 0.08 195 -0.0002 0.6014 0.0128 4.36% 0.20% 0.10% 4.26% 3.3170\n10 9-Jan-07 SVU 0.56 0.54 -0.02 256 0.0003 0.5238 0.0130 -1.70% -0.05% 0.00% -1.70% -1.3061\n11 27-Apr-06 SWY 0.30 0.32 0.02 80 0.0001 1.0139 0.0130 2.88% 0.33% 0.34% 2.54% 1.9473\n12 20-Jul-06 SWY 0.36 0.42 0.06 138 0.0001 0.9289 0.0118 8.39% -0.85% -0.78% 9.17% 7.7519\n13 12-Oct-06 SWY 0.39 0.39 0.00 197 0.0003 0.7533 0.0134 -1.43% 0.95% 0.75% -2.18% -1.6265\n14 27-Feb-07 SWY 0.60 0.61 0.01 289 0.0012 0.7505 0.0131 -3.95% -3.53% -2.54% -1.41% -1.0814\n15 4-May-06 WFMI 0.35 0.36 0.01 85 0.0006 0.8345 0.0175 12.50% 0.32% 0.33% 12.17% 6.9434\n16 1-Aug-06 WFMI 0.34 0.35 0.01 146 -0.0007 1.2329 0.0164 -12.51% -0.45% -0.63% -11.88% -7.2345\n17 3-Nov-06 WFMI 0.29 0.29 0.00 213 -0.0014 1.3199 0.0195 -26.21% -0.22% -0.43% -25.78% -13.2186\n18 22-Feb-07 WFMI 0.40 0.38 -0.02 286 -0.0020 1.5321 0.0243 13.13% -0.09% -0.33% 13.46% 5.5465\n19\n20 P suo rs pit ri iv se e 2.65%< = 18S-- )U / CM OIF U( N$E T$ IF3 (: E$E 3:$ E1 18 8,\" ,\"> >0 0\" \",$ )O$3:$O$\n21 =COUNTIF('Stock PC rie cl el sG '!1 $8 A $c 3o :n $t Aai $n 5s 5 f 1o ,r \"m <=u \"la &: TEXT(A18,\"0\"))-252 N suo rn p- rp iso esitive -3.24%< = $1S-- 8U )M /CI OF( U$ NE T$3 IF:$ (EE 3$ :1 E8 1,\" 8< ,\"= <0 =\" 0,$ \"O )$3:$O\n22\nCell H18 contains formula:\n=INTERCEPT(OFFSET('Stock Prices'!$A$2,$G18,10,252,1),OFFSET('Stock\n23 Prices'!$A$2,$G18,2,252,1))\n24\nCell I18 contains formula:\n=SLOPE(OFFSET('Stock Prices'!$A$2,$G18,10,252,1),OFFSET('Stock\n25 Prices'!$A$2,$G18,2,252,1))\n26\nCell J18 contains formula:\n27\n=STEYX(OFFSET('Sto Pc rik\nc\neP sr 'i !c $e As $'! 2$ ,A $$ G2 1,$ 8G ,21 ,28 5,1 20 ,1,2 ))52,1),OFFSET('Stock\nFor each announcement we have determined the intercept and slope of the\nmarket-model regression for the 252 days preceding the announcement.1 1\nHere \u2019 s a specific example from the above spreadsheet:\nA B C D E F G H I J K L M N O P\n2 Calendar Date Ticker ConsensusActual S =u Drp 3r -Cis 3e: St Pa ort ii nn tg Intercept Slope STEXY A Rc et tu ua rnl S R& eP t u5 r0 n0 =E HRx 3p e +e tu Ic 3rt *ne M:d 3 A Rb =n Leo t 3u -r Nrm n 3a :l T-stat\n3 7-Mar-06 KR 0.36 0.39 0.03 44 0.0003 0.6662 0.0123 1.36% -0.19% -0.09% 1.46% 1.1808\n18 22-Feb-07 WFMI 0.40 0.38 -0.02 286 -0.0020 1.5321 0.0243 13.13% -0.09% -0.33% 13.46% 5.5465\n1 0. W e included only Kroger, Supervalu, Safeway, and Whole Foods in the sample. This is obvi-\nously an incomplete sample, both in terms of the firms covered and the number of announcements.\nHowever, this extended example is meant to impart the flavor of a full-bodied event study.\n11. The event window is defined in column G by the \u201cStarting point,\u201d which uses C ountif to\nlocate a date 252 business days before the event date in the data base of stock returns. Notice that\n346 Chapter 14\nRow 3 tracks the market model of Kroger stock to the S&P 500 in the 252\ntrading days before the earnings announcement on 7 March 2006. The market\nmodel is r = 0.0001 + 0.9289* r . Kroger\u2019 s actual return on the\nSafeway S&P500\nannouncement date, 1.36%, is 1.46% higher than the return which would\nhave been predicted by its market model. However, dividing this 1.46%\nby the standard deviation of the abnormal returns (the regression residuals)\n( Steyx = 0.0123) gives a t - statistic of 1.1808, which is not significant at the\n5% level.\nR ow 18 tracks the market model of Whole Foods stock to the S&P 500 in\nthe year before the earnings announcement after market close on 21 February\n2007. The market model is r = 0.0001 + 0.9289* r , with S teyx =\nSafeway S&P500\n0.0243. The abnormal return on the day of the announcement, 13.46%, is\nsignificant at the 1% level (hence the boldface in cell P18). To temper this\ninterpretation, note that on the day of the earnings announcement, Whole\nFoods announced the merger with Wild Oats Markets; this makes it difficult\nto interpret the true market reaction to the earnings release. In general, we\nhave to be careful interpreting abnormal returns when an event is announced\nwith confounding information.\nThe Cumulative Abnormal Returns\nW e restate the data in slightly different form in the spreadsheet below\u2014using\nthe Offset function\u2014and then compute the abnormal returns in an\nevent window which goes from \u2212 10 to + 10 days around the earnings\n347 Event Studies\nA B C D E F G H I J K L M N O P Q\n1 CUMULATIVE ABNORMAL RETURNS IN THE WINDOW -10 TO +10\n2 Calendar Date7-Mar-0620-Jun-0612-Sep-06 5-Dec-0618-Apr-0626-Jul-06 10-Oct-069-Jan-0727-Apr-06 20-Jul-06 12-Oct-0627-Feb-074-May-061-Aug-06 3-Nov-0622-Feb-07\n3 Ticker KR KR KR KR SVU SVU SVU SVU SWY SWY SWY SWY WFMI WFMI WFMI WFMI\n4 Consensus 0.36 0.42 0.29 0.28 0.56 0.57 0.53 0.56 0.3 0.36 0.39 0.6 0.35 0.34 0.29 0.4\n5 Actual 0.39 0.42 0.29 0.3 0.55 0.53 0.61 0.54 0.32 0.42 0.39 0.61 0.36 0.35 0.29 0.38\n6 Surprise 0.03 0.00 0.00 0.02 -0.01 -0.04 0.08 -0.02 0.02 0.06 0.00 0.01 0.01 0.01 0.00 -0.02\n7\n8 Starting Point 44 117 175 234 73 142 195 256 80 138 197 289 85 146 213 286\n9 Intercept 0.0003 0.0004 0.0006 0.0003 -0.0008 -0.0003 -0.0002 0.0003 0.0001 0.0001 0.0003 0.0012 0.0006 -0.0007 -0.0014 -0.0020\n10Slope 0.6662 0.6063 0.5628 0.4483 0.7049 0.5416 0.6014 0.5238 1.0139 0.9289 0.7533 0.7505 0.8345 1.2329 1.3199 1.5321\n11STEXY 0.0123 0.0113 0.0108 0.0118 0.0123 0.0122 0.0128 0.0130 0.0130 0.0118 0.0134 0.0131 0.0175 0.0164 0.0195 0.0243\n12\n13\nDay relative ABNORMAL RETURN\n14 to event\n15 -10 0.59% -0.07% 0.72% -0.46% -0.68% -1.81% -1.04% 0.47% 0.32% -0.01% 0.36% 0.46% -0.52% -3.87% 0.05% 0.26%\n16 -9 -1.19% 0.89% 0.38% -1.20% -1.06% 0.33% -0.43% 0.36% 0.65% -0.96% -0.94% 0.29% -1.94% 0.93% -0.06% 0.94%\n17 -8 1.08% 0.58% -0.32% 0.00% 0.25% -0.35% 0.29% -0.92% -0.65% 0.21% 0.22% 0.60% -1.20% -0.33% -0.98% 1.82%\n18 -7 -0.67% -1.34% 0.85% -0.23% -0.86% 1.30% 0.05% 0.66% 0.90% -0.78% -0.16% -0.96% -1.27% -0.18% 0.53% -0.87%\n19 -6 0.98% -0.35% -0.59% -0.67% -0.55% 1.24% -0.66% -0.48% -2.40% 0.20% -3.61% 0.33% -0.59% -1.79% 0.10% -0.11%\n20 -5 -0.34% 1.41% -0.84% 0.42% 0.29% 0.13% 2.44% -1.05% -0.66% 0.19% -4.99% 0.68% -1.35% -0.97% 0.25% 0.35%\n21 -4 -0.23% 0.11% 0.49% 0.62% -0.71% 0.79% -0.63% 0.71% -0.57% 0.93% 0.88% 0.21% 0.09% -1.88% 0.31% 0.35%\n22 -3 -1.55% -1.16% -0.39% -1.92% -1.01% -0.64% -0.11% -0.46% -0.80% 0.92% 1.21% -3.80% 0.41% 0.85% -1.52% 1.22%\n23 -2 0.93% -0.59% 1.97% 0.98% 0.34% 0.49% -0.05% 0.68% 0.61% 1.79% 2.36% -1.12% -0.28% 1.38% 0.03% -1.01%\n24 -1 0.03% -0.26% 0.29% 2.63% 0.29% -0.60% 2.95% -0.79% 0.82% -1.33% 0.30% 0.60% 1.08% 0.01% -4.74% -0.39%\n25 0 1.46% 5.01% -6.31% 4.87% -1.39% -7.03% 4.26% -1.70% 2.54% 9.17% -2.18% -1.41% 12.17% -11.88% -25.78% 13.46%\n26 1 1.43% -0.63% 0.38% -1.35% -1.12% -4.37% 0.58% -1.57% -0.12% 0.83% -2.34% 1.01% 1.42% -0.14% -0.94% -2.45%\n27 2 -1.15% -0.56% 0.93% -0.15% 1.43% -2.64% 0.99% 1.59% 1.33% -1.44% 0.34% 0.37% 0.37% -0.19% 2.02% 0.06%\n28 3 1.08% 1.15% -2.90% -0.24% -0.82% 0.87% 0.20% -0.91% -3.28% -0.24% 0.35% -1.44% -1.78% 0.67% 3.11% 0.94%\n29 4 0.03% 1.37% 0.27% 2.61% 0.36% 0.20% -0.71% -0.56% -1.34% -0.23% 1.26% -0.06% -0.40% 0.24% 0.14% -1.13%\n30 5 0.11% -0.31% -0.31% 1.19% -0.99% 0.62% -0.47% -0.53% 0.58% 0.76% -1.94% -0.59% 0.04% -4.00% 0.44% -1.13%\n31 6 -0.12% 2.70% 0.50% -0.42% -0.23% -0.76% 0.83% 0.04% 1.02% -1.13% 0.93% -0.40% -0.76% -1.24% 0.84% 0.41%\n32 7 -0.20% 0.35% -0.96% 0.75% 0.63% 0.11% 0.27% 1.26% -0.45% -0.09% 0.13% 1.20% 1.25% -0.02% 0.25% 1.97%\n33 8 -0.18% 0.73% 1.90% 0.33% 0.46% -0.41% -0.02% 1.75% -1.43% 0.26% -2.28% -0.12% -0.46% -1.25% -0.34% -0.63%\n34 9 -1.34% -0.52% 0.14% -2.86% 0.23% -1.15% -0.23% 0.04% -0.82% 1.04% 0.13% -0.12% -1.59% 7.14% -0.99% -1.50%\n35 10 0.86% 0.08% -0.14% -1.19% -0.88% -1.27% 0.00% 0.48% 0.46% -0.33% 0.92% -0.12% -0.85% 2.10% -0.12% -0.63%\nWe can compute the average abnormal return (AAR) and cumulative abnor-\nmal return (CAR) for each of the days in the event window. In the following\ntable we perform this computation separately for positive versus non-positive\n348 Chapter 14\nS T U V W X Y Z AA AB\n3 Cell U11 contains formula\n4 {=SQRT(SUMPRODUCT(IF($B$6:$Q$6>0,$B$11:$Q$11),IF($\n5 B$6:$Q$6>0,$B$11:$Q$11))*(1/COUNTIF($B$6:$Q$6,\">0\")^2)\n6 )}\n7\n8\nUnadjusted cross-sectional errors - Unadjusted cross-sectional errors -\n9 Positive Non-Positive\n10\n11 0.49% 0.54%\n12\nNon-Positive Earnings\nPositive-Earnings Announcements\nAnnouncements\n13\nDay Cumulative Cumulative\nrelative AAR T-stat Abnormal AAR T-stat Abnormal\n14 to event Returns Returns\n15 -10 -0.57% -1.1615 -0.57% -0.09% -0.1632 -0.09%\n16 -9 -0.48% -0.9931 -1.05% 0.10% 0.1944 0.02%\n17 -8 0.00% 0.0026 -1.05% 0.04% 0.0670 0.05%\n18 -7 -0.39% -0.8046 -1.44% 0.01% 0.0251 0.07%\n19 -6 -0.57% -1.1777 -2.01% -0.54% -1.0058 -0.48%\n20 -5 0.05% 0.1043 -1.96% -0.55% -1.0278 -1.03%\n21 -4 -0.18% -0.3753 -2.14% 0.37% 0.6774 -0.67%\n22 -3 -0.75% -1.5410 -2.89% -0.34% -0.6376 -1.01%\n23 -2 0.53% 1.0900 -2.36% 0.54% 0.9917 -0.47%\n24 -1 0.85% 1.7437 -1.51% -0.74% -1.3685 -1.21%\n25 0 2.65% 5.4406 1.13% -3.24% -6.0062 -4.46%\n26 1 0.46% 0.9409 1.59% -1.63% -3.0190 -6.08%\n27 2 0.02% 0.0335 1.61% 0.40% 0.7356 -5.69%\n28 3 -0.63% -1.2939 0.98% 0.22% 0.4121 -5.47%\n29 4 0.02% 0.0355 0.99% 0.24% 0.4434 -5.23%\n30 5 -0.30% -0.6087 0.70% -0.52% -0.9620 -5.75%\n31 6 -0.28% -0.5690 0.42% 0.55% 1.0269 -5.19%\n32 7 0.34% 0.6998 0.76% 0.47% 0.8643 -4.72%\n33 8 -0.36% -0.7326 0.41% 0.14% 0.2680 -4.58%\n34 9 0.15% 0.3154 0.56% -0.45% -0.8382 -5.03%\n35 10 0.12% 0.2425 0.68% -0.20% -0.3614 -5.23%\n36\n37\nCell T35 contains formula Cell X35 contains formula\n=SUMIF($B$6:$Q$6,\">0\",B35:Q35)/COUNTIF($B$6:$ =SUMIF($B$6:$Q$6,\"<=0\",B35:Q35)/COUNTIF($B\n38 Q$6,\">0\") $6:$Q$6,\"<=0\")\n39\nCell U35 contains formula =T35/$U$11 Cell Y35 contains formula =X35/$Y$11\n40\n41\n42\nCell V35 contains formula =T35+V34 Cell Z35 contains formula =X35+Z34\n349 Event Studies\nThe test statistics for the positive and non-positive announcements have\nbeen computed by dividing the a verage abnormal return (AAR) for each day\nby the appropriate cross-sectional error for the specific type of return (cells\nU11 and Y11):\nSumproductof Steyx for positiveannouncements\ncell U11:\n(Numberoff positiveannouncements)2\nSumproductof Steyx fornegattiveannouncements\ncell Y11:\n(Numberof negativeannouncements)2\nGraphing the CARs gives:\nCumulative Average Abnormal Returns\n2%\nPositive Earnings Announcements\n1%\n0%\n-1%\n-2%\n-3%\n-4%\n-5%\n-6%\nNon-Positive Earnings Announcements\n-7%\n-10 -9 -8 -7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10\nEvent Days\nOn average, there appears to have been little leakage prior to the announce-\nment date of neither the good news announcements nor the bad news. The\nmarket appears to have absorbed the information in the announcements\nrapidly\u2014following the announcement date (\u201cevent day 0\u201d), there appears to\n350 Chapter 14"
        ],
        "14.5": [
            "What is a 'one factor' model in financial studies?\nWhat is the assumption made in a 'one factor' model related to stock returns?\nWhat is a 'two-factor' model in financial studies?\nWhat factors are assumed to influence stock returns in a 'two-factor' model?\nHow can a two-factor model be used to determine the influence of a specific event on returns?\nWhat event on 16 November 2006 was used for analysis in this study?\nWhat method was used to perform multiple regressions?\nWhat conclusions can be made from the Linest box derived from the regression analysis?\nWhat are standard errors in the context of a regression model? \nWhat is the importance of the 't-test' in analyzing the Wendy's event in the given scenario?\nWhat is the role of R squared value in financial modeling?\nWhat are the concepts of abnormal returns (AR) and cumulative abnormal returns (CAR)?\nHow can historical data of financial indices be used to predict the impact of events on a firm's returns?\nWhat does a significant abnormal return indicate about the impact of a specific event?\nWhat factors contributed to Wendy's abnormal returns following their announcement on 16th November 2006? \nWhat is the significance of the 'F statistic' in financial modeling? \nCan event studies help understand the influence of industry trends on specific companies?\nWhat interpretations could be made from Wendy's returns on different days after the event?\nWhat are the implications of a negative abnormal return? \nHow does an announcement impact the stock's return on the following days? \nCan the impact of an announcement be felt on the third day after the event?",
            "14.5 Using a Two-Factor Model of Returns for an Event Study\n\nThe model used in section 14.2 assumes an equilibrium model r = \u03b1 + \u03b2 r .\nit i i Mt\nThis so-called \u201cone factor\u201d model assumes that the returns on the stocks in\nquestion are driven only by one market index. In this section we illustrate a\ntwo-factor model. We assume that returns are a function of both a market and\nan industry factor: r = \u03b1 + \u03b2 r + \u03b2 r . We then use this model\nit i i,Market Mt i,Industry Industry,t\nto determine if a specific event influenced the returns and in which\ndirection.\nO ur event: On 16 November 2006, Wendy\u2019 s announced the purchase by\ntender of 22,418,000 shares at a price of $35.75 per share. This share purchase\nrepresented approximately 19% of the firm \u2019 s equity. Wendy \u2019 s stock closed on\n351 Event Studies\nDid the Repurchase Affect Wendy \u2019 s Returns?\nW e start by regressing the daily returns on Wendy\u2019 s on the S&P 500 and the\nS&P 500 Restaurant Index for the 252 days preceding the tender date of 16\nNovember 2006. We use the array function L inest to do this computation. 12\nThe Linest box looks like:\n12. The use of Linest to perform multiple regressions is discussed in Chapter 33. It is not the\n352 Chapter 14\nA B C D\n2 Industry Market Intercept\n3 Slope --> 0 .4157 0 .5095 0 .0012\n4 Standard Error --> 0 .0851 0 .1410 0 .0007\n5 R2 --> 0 .3140 0 .0103 #N/A\n6 F statistic --> 5 6.9738 2 49 #N/A\n7 SS --> 0 .0122 0 .0266 #N/A\nxy\n(Note that the #N/A above is produced by Excel and simply means that there\nis no entry for this column.)\nF rom this box we can conclude that Wendy\u2019 s return is sensitive to both the\nmarket and the industry.\nr =0.0012+ 0(cid:3).5(cid:4)0(cid:6)95 \u2217r + 0(cid:3).4(cid:4)1(cid:6)57 \u2217r\nWendys,t Mt Industry,t\n\u2191 \u2191\nMarket reaction Industry reaction\ncoefficient. coefficient..\nStandardd error: Standard error:\n0.1410 0.0851\nThis Linest box is shown again (see following). Dividing the coefficients by\ntheir respective standard errors (row 9) shows that they are both significant at\nthe 1% level. Note that cell C4 gives the standard error of the y -estimate; we\nuse this in the analysis to determine the significance of the abnormal returns.\n353 Event Studies\nA B C D E F G H I J\n1 WENDY'S RETURNS: ESTIMATION WINDOW AND EVENT WINDOW\n2 Industry Market Intercept\n3 Slope --> 0 .4157 0 .5095 0 .0012\n4 Standard Error --> 0 .0851 0 .1410 0 .0007\n5 R2 --> 0 .3140 0 .0103 #N/A Cells B3:D7 contain the array formula\n6 F statistic --> 5 6.9738 2 49 #N/A {=LINEST(B15:B266,C15:D266,,TRUE)}\n7 SSxy --> 0 .0122 0 .0266 #N/A\n8 Cell C5 is the standard error of the y estimate,\n9 t-stat 4 .8818 3 .6142 1 .8367 <-- =D3/D4 used in the t-test of the abnormal returns\n10\nDays in estimation\n11window 252<-- =COUNT(A15:A266)\n12\n13 EVENT WINDOW\nS&P 500 Expected Abnormal Cumulative T-test of\n14 Date Wendy's Intl S&P 500 Restaurant Index return return (AR) rea tb un rno r (m CAal R ) AR\n15 15-Nov-05 0.08% -0.39% -1.26%\n16 16-Nov-05 -0.37% 0.18% -0.93%\n17 17-Nov-05 0.84% 0.94% 1.60%\nCell E267 contains formula\n18 18-Nov-05 0.27% 0.44% 0.19% =$D$3+$C$3*C267+$B$3*D267\n19 21-Nov-05 1.08% 0.53% 0.92%\nCell F267 contains formula =B267-\n263 9-Nov-06 -0.89% -0.53% -0.35% E267\n264 10-Nov-06 1.46% 0.19% 0.95%\n265 13-Nov-06 0.08% 0.25% -0.05%\n266 14-Nov-06 0.73% 0.63% 0.03%\n267 15-Nov-06 0.25% 0.24% 0.21% 0.33% -0.08% -0.08%<-- =F267 -0.0741<-- =F267/$C$5\n268 16-Nov-06 0.31% 0.23% 1.26% 0.76% -0.45% -0.53%<-- =G267+F268 -0.4363\n269 17-Nov-06 -6.44% 0.10% -1.78% -0.57% -5.87% -6.40%<-- =G268+F269 -5.6805\n270 20-Nov-06 -1.59% -0.05% -0.19% 0.02% -1.61% -8.01% -1.5582\n271 21-Nov-06 0.15% 0.16% 0.07% 0.23% -0.08% -8.09% -0.0784\n272 22-Nov-06 2.80% 0.23% 0.27% 0.35% 2.45% -5.64%\n273\n274 2/47%/2005\n275 2/8/2005\n276 2/9/2005\n277 2/120%/2005\n278 2/11/2005\n279 2/14/2005\n280 2/105%/2005\n281 2/16/2005 15nov06 16nov06 17nov06 20nov06 21nov06 22nov06\n282 2/17/2005\n283 2/-128%/2005\n284 2/22/2005\n285 2/23/2005\n286 2/-244%/2005\n287 2/25/2005\n288 2/28/2005\n289 3-/61%/2005\n290 Expected return\n291\n292 -8% Abnormal return (AR)\n293 Cumulative abnormal return (CAR)\n294\n295 -10%\n296\n297\nI n rows 267\u2013272 of the spreadsheet we use the two-factor model to analyze\nthe abnormal returns (AR) and the cumulative abnormal returns (CAR) of the\nWendy\u2019 s announcement. While there is little AR or CAR on the days before\nthe announcement, it is clear that the announcement on 16 November had a\nconsiderable impact on Wendy\u2019 s returns on the day following ( \u2212 5.87% abnor-\nmal return on 17 November) and on the next day ( \u2212 1.61% AR on 20 Novem-\nber). Dividing the abnormal return by the standard error in C5 shows that only\n354 Chapter 14\nF urthermore, an analysis of the announcement broken down into the market\nand the industry factors shows that on both of the 2 days after the 16 November\nannouncement date the effects of the market index on Wendy\u2019 s returns were\nslight. On 17 November, however, there was a significant impact of the S&P\n500 Restaurant Index on Wendy \u2019 s which was lacking on 20 November.\nTo see this, we first discuss the day after the event, 17 November 2006:\nA B C D E F G H\n13 EVENT WINDOW\nCumulative\nS&P 500 Expected Abnormal\nDate Wendy's Intl S&P 500 abnormal\n14 Restaurant Index return return (AR) return (CAR)\n266 14-Nov-06 0.73% 0.63% 0.03%\n267 15-Nov-06 0.25% 0.24% 0.21% 0.33% -0.08% -0.08%<-- =F267\n268 16-Nov-06 0.31% 0.23% 1.26% 0.76% -0.45% -0.53%<-- =G267+F268\n269 17-Nov-06 -6.44% 0.10% -1.78% -0.57% -5.87% -6.40%<-- =G268+F269\n270 20-Nov-06 -1.59% -0.05% -0.19% 0.02% -1.61% -8.01%\n271 21-Nov-06 0.15% 0.16% 0.07% 0.23% -0.08% -8.09%\n272 22-Nov-06 2.80% 0.23% 0.27% 0.35% 2.45% -5.64%\nOn 17 November, the S&P 500 rose by 0.10% and the S&P 500 Restaurant\nIndex fell by 1.78%. Given the regression r = 0.0012 + 0.5095* r +\nWendys,t Mt\n0.4157* r , the change in the S&P 500 would have affected Wendy \u2019 s\nIndustry,t\nreturns by approximately + 0.05% ( =0 .5095*0.10%) and the change in the\nindustry index would have affected Wendy \u2019 s returns by approximately \u2212 0.74%\n( = 0.4157*\u2212 1.78%). But Wendy \u2019 s decreased by \u2212 6.44% on the same day, well\nin excess of the impact of either of the two factors.\nHere are the data for 20 November:\nA B C D E F G H\n13 EVENT WINDOW\nCumulative\nS&P 500 Expected Abnormal\nDate Wendy's Intl S&P 500 abnormal\n14 Restaurant Index return return (AR) return (CAR)\n266 14-Nov-06 0.73% 0.63% 0.03%\n267 15-Nov-06 0.25% 0.24% 0.21% 0.33% -0.08% -0.08%<-- =F267\n268 16-Nov-06 0.31% 0.23% 1.26% 0.76% -0.45% -0.53%<-- =G267+F268\n269 17-Nov-06 -6.44% 0.10% -1.78% -0.57% -5.87% -6.40%<-- =G268+F269\n270 20-Nov-06 -1.59% -0.05% -0.19% 0.02% -1.61% -8.01%\n271 21-Nov-06 0.15% 0.16% 0.07% 0.23% -0.08% -8.09%\n272 22-Nov-06 2.80% 0.23% 0.27% 0.35% 2.45% -5.64%\nO n 20 November, the S&P 500 fell by 0.05% and the S&P 500 Restaurant\nIndex fell by 0.19%. Given the regression r = 0.0012 + 0.5095* r +\nWendys,t Mt\n0.4157* r , the change in the S&P 500 would have affected Wendy \u2019 s\nIndustry,t\n355 Event Studies\nindex would have affected Wendy \u2019 s returns by approximately \u2212 0.03%. But\nWendy\u2019 s decreased by \u22121 .59% on the same day, which is again well in excess\nof the impact of either of the two factors.\nT he impact of the announcement was felt even in the third day after the\nevent, but we leave this analysis to the reader."
        ],
        "14.6": [
            "What is the purpose of Excel's Offset function in Financial Modeling? \nHow is regression analysis conducted for a specific stock's returns on the returns of the S&P 500 in Excel?\nWhat purpose do the functions Intercept, Slope, Rsq serve in financial modelling?\nHow is the CountIf function used in regression analysis in Excel?\nWhat is the role of the function Steyx in the context of financial modelling and data regression?\nHow does the Offset function assist in specifying a cell or a block of cells in an array in Excel?\nIn the context of financial analysis, explain the process of running a regression of the General Mills (GIS) returns on S&P 500.\nHow is the starting point of regression calculated when it is 252 trading days before a specific date?\nHow does the text function assist in translating a date to a text number?\nWhy is the condition in the CountIf function required to be a text entry?\nHow are the functions Intercept, Slope, Rsq used with Offset in financial modelling?\nHow is the row number of the data identified using CountIf data function?\nWhat is the function of the Offset command when locating rows of GIS returns? \nWhat does Rsq signify in the context of regression analysis of financial returns?",
            "14.6 Using Excel \u2019 s Offset Function to Locate a Regression in a Data Set\n\nThe analysis in section 14.2 requires us to do a regression of a specific stock \u2019 s\nreturns on the returns of the S&P 500, where the starting point of the regres-\nsion is the 252 trading days before a specific date. The technique in section\n14.2 uses a number of Excel functions:\n\u2022 The functions Intercept , Slope , Rsq give the regression intercept, slope,\nand r -squared. These functions have been illustrated in Chapter 2 and in the\nprevious portfolio chapters. The function S teyx gives the standard deviation\nof the regression residuals.\n\u2022 The function CountIf counts the number of cells in a range which meet a\nspecific condition. C ountIf has the syntax CountIf(data,condition) . However ,\nthe c ondition must be a text condition (which means that in this example we\nwill use the Excel function Text to translate a date to a text number\u2014more\nlater).\n\u2022 The function Offset (see also Chapter 33) allows us to specify a cell or a\nblock of cells in an array.\nTo illustrate the problem, consider the following data of returns for General\nMills (GIS) and the S&P 500. We want to run a regression of the GIS returns\n356 Chapter 14\nA B C D E F G\nUSING OFFSET, COUNTIF, AND TEXT\nTO LOCATE A REGRESSION IN A DATA SET\n1\nGeneral\nDate Mills Return SP500 Return\n2 GIS\n3 3-Jan-97 57.96 748.03\n4 6-Jan-97 58.19 0.0040<-- =LN(B4/B3) 747.65 -0.0005<-- =LN(E4/E3)\n5 7-Jan-97 59.33 0.0194 753.23 0.0074\n6 8-Jan-97 59.33 0.0000 748.41 -0.0064\n7 9-Jan-97 59.91 0.0097 754.85 0.0086\n8 10-Jan-97 59.91 0.0000 759.5 0.0061\n9 13-Jan-97 59.68 -0.0038 759.51 0.0000\n10 14-Jan-97 59.91 0.0038 768.86 0.0122\n11 15-Jan-97 59.56 -0.0059 767.2 -0.0022\n12 16-Jan-97 59.56 0.0000 769.75 0.0033\n13 17-Jan-97 59.56 0.0000 776.17 0.0083\n14 20-Jan-97 59.44 -0.0020 776.7 0.0007\n15 21-Jan-97 60.71 0.0211 782.72 0.0077\n16 22-Jan-97 61.4 0.0113 786.23 0.0045\n17 23-Jan-97 62.09 0.0112 777.56 -0.0111\n18 24-Jan-97 61.63 -0.0074 770.52 -0.0091\n19 27-Jan-97 61.29 -0.0055 765.02 -0.0072\n20 28-Jan-97 61.06 -0.0038 765.02 0.0000\n21 29-Jan-97 62.09 0.0167 772.5 0.0097\n22 30-Jan-97 62.21 0.0019 784.17 0.0150\n23 31-Jan-97 62.44 0.0037 786.16 0.0025\n24 3-Feb-97 62.09 -0.0056 786.73 0.0007\n25\n26 Starting date 29-Jan-97\nRows from top of data\n27 to starting date 19<-- =COUNTIF(A3:A24,\"<=\"&TEXT(B26,\"0\"))\n28 Regression\n29 Intercept 0.0022<-- =INTERCEPT(OFFSET(A3:F24,B27-11,2,10,1),OFFSET(A3:F24,B27-11,5,10,1))\n30 Slope 0.5198<-- =SLOPE(OFFSET(A3:F24,B27-11,2,10,1),OFFSET(A3:F24,B27-11,5,10,1))\n31 R-squared 0.1413<-- =RSQ(OFFSET(A3:F24,B27-11,2,10,1),OFFSET(A3:F24,B27-11,5,10,1))\n32\n33\n34 Check\n35 Intercept 0.0022<-- =INTERCEPT(C11:C20,F11:F20)\n36 Slope 0.5198<-- =SLOPE(C11:C20,F11:F20)\n37 R-squared 0.1413<-- =RSQ(C11:C20,F11:F20)\nT o run this regression, we first use CountIf(data,condition) to count the\nrow number of the data on which the starting date falls. Since condition must\nbe a text entry, we translate the date in cell B26 to a text by using Text(b26, \u2033 0 \u2033 ) .\nThe Excel function = CountIf(A3:A24, \u2033 < = \u2033 &Text(B26,\u2033 0 \u2033 )) now counts the\nnumber of cells in the column A3:A24 which are less than or equal to the date\nin cell B26. The answer, as you can see in cell B27, is 19.\nN ext, we use Offset(A3:F24,B27-11,2,10,1) to locate the 10 rows of GIS\nreturns before the 19th row indicated by the starting date. This is a tricky\n357 Event Studies\nOffset(A(cid:3)(cid:5)3(cid:4):F(cid:5)(cid:6)24,B(cid:3)(cid:5)2(cid:4)7-(cid:5)(cid:6)11, 2(cid:2) , 1(cid:2)0 , 11(cid:2) )\n\u2191 \u2191 \u2191 \u2191 \u2191\nReference Starting 2columns 10rows Only1\narray row in over from below column\nrefeerence top corner starting of data\narray of referencce (cid:3)cor(cid:5)ner(cid:4)(cid:5)(cid:6)\n(cid:3)(cid:5)(cid:5)(cid:5)(cid:4)(cid:5)a(cid:5)rray(cid:5)(cid:6)\n\u2191\n\u2191 Data considered\nFix starting\ncorner in reference\narray from which\ndaata is considered\nT he functions I ntercept , Slope , Rsq can now be used with Offset\n(A3:F24,B27-11,2,10,1) and O ffset(A3:F24,B27-11,5,10,1) :\n=Intercept(O(cid:3)f(cid:5)fse(cid:5)t((cid:5)A(cid:5)3:(cid:5)F2(cid:5)4(cid:4),B(cid:5)27(cid:5)-(cid:5)11,(cid:5)(cid:5)2,(cid:5)10(cid:5),(cid:6)1),\n\u2191\ny-data\nO(cid:3)f(cid:5)fse(cid:5)t((cid:5)A(cid:5)3:(cid:5)F2(cid:5)4(cid:4),B(cid:5)27(cid:5)-(cid:5)11,(cid:5)5,(cid:5)10(cid:5),(cid:6)1))\n\u2191\nx-data"
        ],
        "14.7": [
            "What are event studies in the context of finance?\nWhat is the use of event studies in practical finance?\nHow can Excel be used to perform an event study?\nWhat can Excel be used to perform in the context of event studies?\nWhat two types of event studies can Excel perform?\nWhat is the valuation of options?\nWhat does chapter 15 introduce in terms of finance and modelling?\nWhat is the option terminology? \nWhat is being discussed in chapter 15 regarding option payoffs?\nWhat is arbitrage proposition in relation to option payoffs?\nWhat does chapter 16 focus on in terms of option pricing model?\nWhat is the purpose of Visual Basic for Applications in building binomial option pricing functions? \nCan Visual Basic for Applications be used to build binomial option pricing functions for both European and American options?  \nWhat kind of application is discussed relating to the pricing of employee stock options?\nWhat is the Black-Scholes pricing formula?\nWhat types of options does the Black-Scholes pricing formulas apply to?\nCan the Black-Scholes model be implemented either by direct calculation in the spreadsheet or by using VBA to build new spreadsheet functions?\nWhat is an extension of the Black-Scholes model?\nWhat is the so-called Merton model?\nHow can option pricing models be applied to the valuation of structured securities?\nWhat is the computation of \u201cGreeks\u201d in terms of options?\nWhat do the \"Greeks\" show in the option-pricing formula?\nWhat are real options?\nHow are real options applied to real investments?\nWhat kind of strategies can be simulated in Excel?\nWhat are more complicated options?\nWhat is meant by path dependent payments in options?",
            "14.7 Summary\n\nE vent studies, used to determine the impact of a particular market effect on a\nspecific stock or a generic market effect on a set of stocks, are some of the\nmost widely used technologies in practical finance. While Excel may not be\nthe optimal tool for performing an event study, we have used it in this chapter\nto illustrate both uses of the event study. We have shown that Excel can readily\nbe used to perform either a one-factor or a two-factor event study. The Excel\nIII VALUATION OF OPTIONS\nChapters 15\u201319 deal with option pricing and applications. Chapter 15 is an\nintroduction to options. After defining the option terminology, Chapter 15\ndiscusses option payoffs and basic option arbitrage propositions. In Chapter\n16 we discuss the binomial option pricing model and its implementation in\nExcel. After showing how these binomial models work, we use Visual Basic\nfor Applications (VBA) to build binomial option pricing functions for both\nEuropean and American options. One of the applications discussed is the\npricing of employee stock options.\nC hapter 17 discusses the Black-Scholes pricing formulas for European calls\nand puts. These formulas can be implemented either by direct calculation in\nthe spreadsheet or by using VBA to build new spreadsheet functions. An exten-\nsion of the Black-Scholes model to the pricing of dividend paying stocks\n(the so-called Merton model) is implemented. We show how to apply the\noption pricing models to the valuation of structured securities. Chapter 18\ndiscusses the computation of \u201cGreeks\u201d\u2014the derivatives of the option-pricing\nformula which show the sensitivities of the option valuation to its various\nparameters.\nC hapter 19 discusses real options\u2014the application of the option pricing\nmodels to real investments.\nO nce you have mastered the ideas in these chapters, we refer you to the\nMonte Carlo section of this book. Chapters 24\u201330 show how option pricing\nstrategies can be simulated in Excel. These chapters also show how more\ncomplicated options\u2014whose payments are path dependent\u2014can be priced\n15\nIntroduction to Options"
        ]
    },
    "15": {
        "15.1": [
            "What is a brief introduction to options in finance?\nWhat is the basic terminology in options trading?\nWhat do graphs of option payoffs and profit diagrams demonstrate?\nWhat are some of the important option arbitrage propositions?\nWhat are linear pricing restrictions in the context of options trading?\nWhat are the two methods discussed for pricing options?\nWhat is the binomial option pricing model?\nWhat is the Black-Scholes option pricing model?\nHow are the binomial and the Black-Scholes option pricing model different?\nWhy should one read an introductory finance text regarding options if they aren't familiar with the concept?",
            "15.1 Overview\n\nIn this chapter we give a brief introduction to options. The chapter can, at best,\nserve as an introduction to the already informed. If you know nothing what-\nsoever about options, read an introduction to the topic in a basic finance text.1\nWe start with the basic definitions and options terminology, go on to discuss\ngraphs of option payoffs and \u201cprofit diagrams,\u201d and finally discuss some of\nthe more important option arbitrage propositions (sometimes referred to as\nlinear pricing restrictions). In subsequent chapters we discuss two methods of\npricing options: The binomial option pricing model (Chapter 16) and the\nBlack-Scholes option pricing model (Chapter 17)."
        ],
        "15.2": [
            "What is an option on a stock?\nDefine the term 'Call' in terms of options.\nWhat does the term 'Put' refer to in the context of options?\nWhat is the exercise price in relation to options?\nHow is the expiration date of an option defined?\nWhat does the term 'Stock price' signify in options trading?\nWhat does 'Option price' refer to?\nCan you differentiate between American and European options?\nWhat do the simplest option pricing formulas cater to; American or European options?\nWhat is meant by 'at-the-money' in the context of options?\nWhat does it mean when an option is 'in-the-money'?\nWhat is the difference between purchasing options and writing options in terms of cash flows?\nWhat is a call option payoff pattern?\nWhat is a put option payoff pattern?\nWhat is the position of the cash-flow of the writer of the option?\nWhat does it mean when an option is 'out-of-the-money'?\nWhat is the significance of the term 'exercise price' in options trading?\nHow is the current stock price denoted in the options market?\nWhat does a positive cash flow indicate in the context of American options?",
            "15.2 Basic Option Definitions and Terminology\n\nAn option on a stock is a security that gives the holder the right to buy or to\nsell one share of the stock on or before a particular date for a predetermined\nprice. Here is a brief glossary of terms and notation used in the field of options:\n\u2022 Call, C: An option that gives the holder the right to buy a share of stock on\nor before a given date at a predetermined price.\n\u2022 Put, P: An option that gives the holder the right to sell a share of stock on\nor before a given date at a predetermined price.\n\u2022 Exercise price, X: The price at which the holder can buy or sell the underly-\ning stock; sometimes also referred to as the strike price .\n\u2022 Expiration date, T: The date on or before which the holder can buy or sell\nthe underlying stock.\n\u2022 Stock price, S: The price at which the underlying stock is selling at date t .\nt\nThe current stock price is denoted S .\n0\n\u2022 Option price : The price at which the option is sold or bought.\n1. Good chapters can be found in the following books: John Hull, Options, Futures and Other\nDerivatives (Prentice Hall, 8th edition, 2011); Zvi Bodie, Alex Kane, and Alan J. Marcus, I nvest-\n362 Chapter 15\nAmerican versus European options: In the jargon of options markets, an\nAmerican option is an option which can be exercised on or before the expira-\ntion date T, whereas a European option is one which can be exercised only on\nthe expiration date T . This terminology is confusing for two reasons:\n\u2022 T he options sold on both European and American options exchanges are\nalmost invariably American options.\n\u2022 T he simplest option pricing formulas (these include the famous Black-\nScholes option pricing formula discussed in Chapter 17) are for European\noptions . As we show in section 15.6, in many cases we can price American\noptions as if they were European options.\nWe use C to denote the price of a European call on date t , and P to denote\nt t\nthe European put price. If it is clear that the option price refers to today \u2019 s price,\nwe often drop the subscript, writing C or P instead of C or P . When we need\n0 0\nfuller notation, we write C ( S ,X,T ) for the price of a call on date t when the\nt t\nprice of the underlying stock is S , the exercise price is X, and the expiration\nt\ndate is T . If we wish to specify that our option pricing formula relates to an\nAmerican option, we use the superscript A : C A,CA(S,X,T)orPA(S,X,T) .\nt t t t t\nWhen written without superscripts, the options pricing refers to European\noptions.\nAt-the-money , in-the-money , out-of-the-money: If the exercise price X of a\ncall or a put is equal to the current price of the stock S , then the option is\n0\nat-the-money. If a positive cash flow could be made by immediately exercising\nan American option (that is, S \u2212 X > 0 for a call andX \u2212 S > 0 for a put),\n0 0\nthen the option is in-the-money .2\nWriting Options Versus Purchasing Options: Cash Flows\nThe purchaser of a call option acquires the right to buy a share of stock for a\ngiven price on or before date T and pays for this right at the time of purchase.\nThe w riter or seller of this call option is the seller of this right: The writer\ncollects the option price today in return for obligating herself to deliver one\nshare of stock in the future for the exercise price, if the purchaser of the call\ndemands. In terms of cash flows, the purchaser of an option always has an\n2. It is of course not logical, that you can ever make an immediate profit by buying an American\noption and immediately exercising it. Thus, for American calls, C > S \u2212 X , and for American\n0 0\nputs, P > X \u2212 .S I n-the-money and o ut-of-the-money refers only to the relation between S and\n0 0 0\n363 Introduction to Options\ninitial negative cash flow (the price of the option) and a future cash flow which\nis at worst zero (if it is not worthwhile exercising the option) and otherwise\npositive (if the option is exercised). The cash-flow position of the writer of the\noption is reversed: An initial positive cash flow is followed by a terminal cash\nflow which is at best zero.\nCall Option Payoff Patterns\nTime 0 Time T\nPurchase call option, Terminal call payoff,\ncash flow < 0 Max[S - X,0] > 0\nT\nCash flows\nof call buyer\nBetween times 0 and T:\nCash flow = 0 for European option\nCash flow > 0 for American option\nWrite (I.e., issue) call option, Pay terminal call payoff\ncash flow > 0 - Max[S - X, 0] < 0\nT\nCash flows\nof call writer\nBetween times 0 and T:\nCash flow = 0 for European option\nCash flow < 0 for American option\nA similar payoff pattern holds for the cash flows of the purchaser and writer\n364 Chapter 15\nPut Option Payoff Patterns\nTime 0 Time T\nPurchase put option, Terminal put payoff,\ncash flow < 0 Max[X - S,0] > 0\nT\nCash flows\nof put buyer\nBetween times 0 and T:\nCash flow = 0 for European option\nCash flow > 0 for American option\nWrite (I.e., issue) call option, Pay terminal call payoff\ncash flow > 0 - Max[X - S, 0] < 0\nT\nCash flows\nof put writer\nBetween times 0 and T:\nCash flow = 0 for European option\nCash flow < 0 for American option"
        ],
        "15.3": [
            "What does an option represent in trading?\nWhat does an option trade of 100 units of the underlying imply?\nWhat is implied by the term \"open interest\" in trading?\nWhat is the significance of the number of outstanding contracts at the end of the day in trading?\nWhat does \"call\" and \"put\" denote in the context of options?\nWhat is meant by the exercise price of an option?\nProvide some examples of the most actively traded options.\nWhat is the role of options in enabling investors or speculators to make bets on broad-based market movements?\nWhy might the list of most active options be approximately evenly divided between puts and calls?\nWhat trends might occur when investors are optimistic about future market movements in relation to the most active options?\nWhy are the options in the most-active list typically short-term options?\nWhat does it mean that longer-term options are traded less than the near-term? \nHow are indices related to options trading? \nHow does \"stock price\" relate to an option? \nWhat is the \"volume\" in options trading context? \nHow do \"closing\" and \"previous day\" figures factor into options trading?\nWhat is the significance of closing stock price in trading options? \nHow is an option's expiration connected to its usage in trading?\nWhat does the 'Short description of underlying' imply in relation to options trading?\nWhat does an option's \"change from previous day\" denote in trading?",
            "15.3 Some Examples\n\nB elow we show the most actively traded options on 22 October 2012 (h ttp://\nbiz.yahoo.com/opt/stat1.html ). Each option represents a trade on 100 units of\nthe underlying (so that 36,371 Microsoft 29 November calls represent call\noptions on 3.6 million shares of MSFT with an exercise price of $29). The\n\u201copen interest\u201d is the number of outstanding contracts at the end of the day.\nFor MSFT, 36,371 calls were traded on 22 October, and at the end of the day\n365 Introduction to Options\nMOST ACTIVE OPTIONS, 22 OCTOBER 2012\nOption price\nChange\nOption from\nexercise Call or Option Closing previous Open\nRank Stock price put? expiration stock price Closing day Volume Interest Short description of underlying\n1 XLF 17 Call 17-Nov-12 16.11 0.06 0.01 433,998 2,358,344Tracks index of financial stocks\n2 SPY 143 Put 17-Nov-12 143.41 1.94 -0.23 89,617 1,803,974Tracks SP500\n3 QQQ 65 Put 17-Nov-12 66.02 0.81 -0.25 52,780 759,554Tracks Nasdaq 100\n4 IWM 78 Put 17-Nov-12 81.83 0.54 -0.09 43,168 448,734Tracks Russell 2000\n5 MSFT 29 Call 17-Nov-12 28 0.23 -0.20 36,371 206,064Microsoft\n6 HPQ 17 Put 18-May-13 14.71 3.23 -0.18 26,425 6,984Hewlett-Packard\n7 SLV 34 Call 17-Nov-12 31.39 0.15 0.01 26,250 121,974Tracks silver price\n8 UTX 72.5 Put 17-Nov-12 77.83 0.38 -0.01 24,515 22,674United Technologies\n9 FB 21 Call 17-Nov-12 19.32 0.78 0.10 24,390 183,944Facebook\n10 INTC 22 Call 17-Nov-12 21.46 0.20 0.01 23,339 190,434Intel\n11 ECA 26 Call 17-Nov-12 23.02 0.18 -0.23 20,252 219,634Encana Corp.\n12 GE 22 Call 17-Nov-12 21.7 0.31 -0.15 19,603 227,984General Electric\n13 BTU 16 Call 19-Jan-13 29.95 13.00 3.00 19,091 218,994Peabody Energy\n14 NLY 8 Put 17-Jan-15 15.94 0.66 0.05 16,771 177,934Annaly Capital Management (a REIT)\n15 CSCO 19 Call 17-Nov-12 18.19 0.36 0.00 16,654 569,894Cisco\n16 AET 45 Call 17-Nov-12 44.2 1.26 0.35 16,486 22,004Aetna\n17 EEM 41 Put 22-Dec-12 41.9 1.14 -0.22 15,454 444,464Tracks MSCI emerging markets index\n18 MS 19 Call 17-Nov-12 17.45 0.14 -0.05 14,654 289,574Morgan Stanley\n19 NXY 20 Put 22-Dec-12 24.14 0.77 0.27 14,645 71,564Nexen (energy)\n20 FXI 37 Call 17-Nov-12 37.67 1.16 0.25 13,948 1,127,324Tracks China 25 index\nA few facts stand out about this list:\n\u2022 S even of the options are on indices. The options enable investors/speculators\nto make bets on broad-based market movements.\n\u2022 T he list is approximately evenly divided between puts (8 out of 20) and calls.\nThis is not always true\u2014when investors are optimistic about future market\nmovements, calls tend to dominate the most active, and vice versa.\n\u2022 T he options in the most-active list tend to be short-term options. Although\nlonger-term options exist, these are traded less than the near-term."
        ],
        "15.4": [
            "What are the basic payoff and profit patterns of a call and a put option?\nIn the context of options, what is the payoff pattern from a purchased stock?\nHow do the profit patterns from both a purchase and a short sale of stock compare?\nWhat is the profit function from the stock?\nWhat is the profit from a short sale of stock?\nIn what scenario would we undo a short sale of a stock?\nWhat is the relationship between the profit from the short sale and the profit from the purchase?\nHow would you graph the profit patterns from both a purchase and a short sale of a stock?\nIn terms of options, what is the payoff pattern from a purchased call?\nWhat determines whether you will exercise the call of an option?\nIn options trade, what is a call writer?\nWhat is the difference between the security bought by the call purchaser and the call writer?\nWhat is the cash flow pattern of the call writer in relation to the call purchaser?\nHow does the profit of a call writer compare to that of the call purchaser?\nIn the context of options, what is the Payoff Pattern from a Purchased Put?\nWhat is the profit function from the put?\nIn options trading, what does the put writer do?\nWhat is the payoff pattern from writing a put?\nHow does the profit pattern of a purchased put compare to that of a written put?\nWhat happens when the market price is lower than the exercise price of a put option?\nWhat happens when the market price is higher than the exercise price of a call option?\nWhat is the role of the put writer in the options market?\nWhat is the difference between a purchased put and a written put in terms of profit patterns?\nCan you explain the concept of short sale of a stock in relation to options? \nWho are the typical counterparties in the options market? \nWhy does a call purchaser have an initial negative cash flow?\nWhat makes a call writer undertake an obligation as compared to a call purchaser, who has an option? \nCould you explain the concept of at-the-money call and out-of-the-money call in options trading?",
            "15.4 Option Payoff and Profit Patterns\n\nOne of the attractions of options is that they allow their owners to change the\npayoff patterns of the underlying assets. In this section we consider:\n\u2022 The basic payoff and profit patterns of a call and a put option and a share.\n366 Chapter 15\nStock Profit Patterns\nW e start with the payoff pattern from a purchased stock. Suppose you buy\na share of General Pills stock in July at its then-current market price of $40.\nIf in September the price of the stock is $70, you will have made a $30 profit;\nif its price is $30, you will have a loss (or a negative profit) of $10.3 Generalize\nthis by writing the price of the stock in September as S and its price in July\nT\nby S . Then we write the profit function from the stock as:\n0\nProfit fromstock=S \u2212S\nT 0\nPayoff from the Short Sale of a Stock\nSuppose we had sold one share of GP stock short in July, when its market\nprice was $40. If in September the market price of GP was $70, and if at that\npoint we undid the short sale (i.e., we purchase a share at the market price in\norder to return the share to the lender of the original short), then our profit\nwould be \u2212 $30:\nProfit fromshort saleof stock =S \u2212S\n0 T\n=\u2212(profit from purchaseof stocck)\nNotice that the profit from the short sale is the n egative of the profit from\nthe purchase; this is always the case (also for options, considered below).\nGraphing Stock Profit Patterns\nT he Excel graph below graphs the profit patterns from both a purchase and a\nshort sale of the GP stock described above.\n3. Our use of the word profit in this section constitutes a slight abuse of language and the standard\nfinance concept of the word, since we are ignoring the interest costs associated with buying the\n367 Introduction to Options\n50\n40\n30\n20\n10\n0\n0 10 20 30 40 50 60 70 80\n-10\n-20\n-30\n-40\n-50\nCall Option Profit Patterns\nAs in the case of a stock, we start with the payoff pattern from a purchased\ncall. We go back to the General Pills (GP) options of the previous section.\nSuppose that in July you bought one GP September 40 call for $4. 4 In Sep-\ntember you will exercise the call only if the market price of GP is higher than\n$40. If we write the initial (July) call price as C , we can write the profit func-\n0\ntion from the call in September as follows:\nCall profitinSeptember=max(S \u2212X,0)\u2212C\nT 0\n=max(S \u221240,0)\u22124\nT\n\u23a7 \u22124 ifS \u2264\u226440\n=\u23a8 T\n\u23a9S \u221244 ifS >40\nT T\ntfiorP\nSTOCK PROFIT PATTERNS\nTerminal stock price, S\nT\nBought stock Shorted stock\n4. Because the exercise price of this call is equal to the current market price of the stock, it is\ncalled an at-the-money call. When the exercise price of the call is higher than the current market\nprice, it is called an out-of-the-money call, and when the exercise price is lower than the current\n368 Chapter 15\nPayoff Pattern from a Written Call\nIn options markets the purchaser of a call buys the call from a counterparty\nwho issues the call. In the jargon of options, the issuer of the call is called the\ncall writer. It is worthwhile to spend a few minutes considering the difference\nbetween the security bought by the call purchaser and the call writer:\n\u2022 The call purchaser buys a security which gives the right to buy a share of\nstock on or before date T for price X. The cost of this privilege is the c all price\nC , which is paid at the time of the call purchase. Thus the call purchaser has\n0\nan initial negative cash flow (the purchase price C ); on the other hand, his\n0\ncash flow at date T is always non-negative: max(S \u2212 X, 0).\nT\n\u2022 The call writer gets C at the date of the call purchase. In return for this\n0\nprice, the writer of the call a grees to sell a share of the stock for price X on\nor before date T . Notice that whereas the call purchaser has an option, the\ncall writer has undertaken an obligation. Note that the cash flow pattern of the\ncall writer is opposite to that of the call purchaser: The writer \u2019 s initial cash\nflow is positive (+ C ), and her cash flow at date T is always non-positive:\n0\n\u2212 max( S \u2212 X, 0).\nT\nThe profit of a call writer is the opposite of that of the call purchaser. For the\ncase of the GP options:\nCallwriter\u2032s profitinSeptember=C \u2212max(S \u2212X,0)\n0 T\n=4\u2212max(S \u221240,0))\nT\n\u23a7 +4 ifS \u226440\n=\u23a8 T\n\u23a944\u2212S ifS >40\nT T\n369 Introduction to Options\n30\n20\n10\n0\n0 10 20 30 40 50 60 70 80\n-10\n-20\n-30\nPut Option Profit Patterns\nPayoff Pattern from a Purchased Put\nIf in July you bought one GP September 40 put for $2, then in September you\nwill exercise the put only if the market price of GP is lower than $40. If we\nwrite the initial (July) put price as P , we can write the profit function from\n0\nthe put in September as follows:\nPut profitinSeptember=max(X\u2212S ,0)\u2212P\nT 0\n=max(40\u2212S ,0)\u22122\nT\n\u23a738\u2212S ifSS \u226440\n=\u23a8 T T\n\u23a9 \u22122 ifS >40\nT\nPayoff Pattern from a Written Put\nThe put writer obligates herself to purchase one share of GP stock on or before\ndate T for the put exercise price of X. For putting herself in this invidious\nposition, the writer of the put receives, at the time the put is written, the put\nprice P . The payoff pattern from writing the GP September 40 put is\n0\ntherefore:\ntfiorP\nCALL OPTION PROFIT PATTERNS\nTerminal stock price, S\nT\n370 Chapter 15\nPutwriter\u2032s profitinSeptember=P \u2212max(X\u2212S ,0)\n0 T\n=2\u2212max(40\u2212S ,0)\nT\n\u23a7\u221238+S ifS \u226440\n==\u23a8 T T\n\u23a9 2 ifS >40\nT\nGraphing the profit patterns of the bought and the written put gives:\n40\n30\n20\n10\n0\n0 10 20 30 40 50 60 70 80\n-10\n-20\n-30\n-40\ntfiorP\nPUT OPTION PROFIT PATTERNS\nTerminal stock price, S T\nBought put Wri(cid:425)en put"
        ],
        "15.5": [
            "What is an option strategy?\nCan you describe a portfolio of options and stocks?\nIn the context of financial modeling, what are the advantages of graphing the combined profit pattern from a portfolio of options and stocks?\nWhat is meant by \"standard\" securities?\nAccording to the text, what are some examples of \"standard\" securities?\nCan you explain the Protective Put strategy in options trading?\nHow is a Protective Put strategy also referred to as \"portfolio insurance\"?\nWhat is the payoff pattern of a Protective Put strategy?\nWhat is the definition of stock profit and put profit in the context of a Protective Put strategy?\nWhat is a put-call parity theorem and how does it relate to the Protective Put strategy?\nWhat is meant by a \"spread\" in the context of the financial modeling?\nWhat is a bull spread in the context of options trading?\nWhat is the process involved in creating a bull spread?\nHow is profit calculated for a bull spread?\nCan you describe a situation where a bull spread strategy would be ideal in options trading?\nWhat is the relationship between the exercise price and the price of a call in a bull spread strategy?\nCan you explain the concept of terminal stock price in the context of options trading?",
            "15.5 Option Strategies: Payoffs from Portfolios of Options and Stocks\n\nT here is some interest in graphing the combined profit pattern from a portfolio\nof options and stocks. These patterns give an indication of how options can\nbe used to change the payoff patterns of \u201cstandard\u201d securities such as stocks\nand bonds. Here are a few examples.\nThe Protective Put\nConsider the following combination:\n\u2022 One share of stock, purchased for S\n0\n371 Introduction to Options\nT his option strategy is often called a \u201cprotective put\u201d strategy or \u201cportfolio\ninsurance\u201d; in Chapter 29 we return to this topic, exploring it in much further\ndetail. The payoff pattern of the protective put is given by:\nStock profit+Put profit=S \u2212S +max(X\u2212S ,0)\u2212P\nT 0 T 0\n\u23a7S \u2212S +X\u2212S \u2212P ifSS \u2264X\n=\u23a8 T 0 T 0 T\n\u23a9S \u2212S \u2212P ifS >X\nT 0 0 T\n\u23a7X\u2212S \u2212P ifS \u2264X\n=\u23a8 0 0 T\n\u23a9S \u2212S \u2212P ifS >X\nT 0 0 T\nWhen applied to the GP example (that is, buying a share at $40 and a put with\nX = $40 for $2) this gives the following graph:\n40\n30\n20\n10\n0\n0 10 20 30 40 50 60 70 80\n-10\n-20\n-30\n-40\ntfiorP\nPROTECTIVE PUT PROFIT\nTerminal stock price, S T\nStock Put Protec(cid:415)ve\nprofit profit put profit\nThis pattern looks very much like the payoff pattern from a call.5\n5. In section 15.5 we prove and illustrate the p ut-call parity theorem . It follows from this theorem\nthat a call must be priced at a price C such that C = P + S \u2212 X \u2212e r T . Thus, when calls are correctly\n0\npriced according to this theorem, the payoff from a put + stock combination is the same as that\n372 Chapter 15\nSpreads\nAnother combination involves buying and writing calls with different exercise\nprices. When the bought call has a low exercise price and the written call has\na higher exercise price, the combination is called a b ull spread . As an example,\nsuppose you bought a call (for $4) with an exercise price of $40 and wrote a\ncall (for $2) with an exercise price of $50. This bull spread gives a profit of\nmax(S \u221240,0)\u22124\u2212(max(S \u221250,0)\u22122)\nT T\n\u23a7\u22124+2 ifS \u226440\n\u23aa T\n=\u23a8S \u221240\u22124+2=S \u221242 iif40\u2264S \u226450\nT T T\n\u23aa\n\u23a9S \u221240\u22124\u2212(S \u221250\u22122)=8 ifS \u226550\nT T T\nT he Excel graph given below shows each of the two calls and the resulting\nspread profit:\n0 10 20 30 40 50 60 70\ntfiorP\nBull Spread Profit Chart\nPurchased\ncall, X=40\nWri(cid:425)en\ncall, X=50\nSpread\nprofit\nTerminal stock price, S\nT"
        ],
        "15.6": [
            "What is an option arbitrage proposition in financial modeling?\nWhat are the assumptions made while pricing bonds in financial modeling?\nWhat does the present value of a riskless security denote in financial modeling?\nWhat considerations are taken into account while proving an arbitrage proposition?\nWhat is the implication of the early-exercise feature of an American call option in financial modeling?\nWhat differentiates American call options from European calls in the context of financial modeling?\nHow does the put-call parity principle function in financial modeling?\nWhat is the lower bound on the value of a put option as depicted in Proposition 3?\nHow is the value of an American call option determined?\nHow does the pricing structure of American puts differentiates from that of American calls?\nWhat is the price convexity principle for call option pricing?\nCan an American call option be valued as if it were a European call option? If so, under what circumstances?\nHow does Proposition 4 prove the put-call parity?\nWhat is a butterfly strategy in financial modeling and when is it used?\nWhat is the underlying principle of Proposition 5 call option price convexity?\nWhat implications do dividend payments have on the call option bounds as per Proposition 7?",
            "15.6 Option Arbitrage Propositions\n\nIn succeeding chapters we price options given specific assumptions about the\nprobability distribution of the underlying asset (usually the stock) on which\n373 Introduction to Options\npricing of options without making these specific probability assumptions. In\nthis section we consider a number of these arbitrage restrictions on option\npricing. Our list is by no means exhaustive, and we have concentrated on those\npropositions which provide insight into the pricing of options or which will\nbe used in later sections.\nThroughout we assume that there is a single risk-free interest rate which\nprices bonds; we also assume that this risk-free rate is continuously com-\npounded, so that the present value of a riskless security which pays off X at\ntime T is given by e \u2212 r T X .\nproposition 1 C onsider a call option written on a stock which pays no divi-\ndends before the option\u2019 s expiration date T. Then the lower bound on a call\noption price is given by:\nC \u2265Max(S \u2212Xe\u2212rT,0)\n0 0\nComment B efore proving this proposition, it will be helpful to consider its\nmeaning: Suppose that the riskless interest rate is 10%, and suppose we have\nan American call option with maturity T = 1/2 (i.e., the expiration date of\nthe option is one-half year from today) with X = 80 written on a stock whose\ncurrent stock price S = 83. A naive approach to determining a lower bound\n0\non this option\u2019 s price would be to state that it is worth at least $3, since\nit could be exercised immediately with a profit of $3. Proposition 1 shows\nthat the option\u2019 s value is at least 83 \u2212 e \u2212 0.10*0.5 80 = 6.90. Furthermore, a\ncareful examination of the proof below will show that this fact does not\ndepend on the option being an American option\u2014it is also true for a European\noption.\nA B C\n1 PROPOSITION 1\u2014HIGHER LOWER BOUNDS FOR CALL PRICES\n2 Current stock price, S 83\n0\n3 Option time to maturity, T 0.5\n4 Option exercise price, X 80\n5 Interest rate, r 10%\n6\n7 Naive minimum option price, Max(S-X,0) 3<-- =MAX(B2-B4,0)\n0\n8 Proposition 1 lower bound on option price, Max(S\n0\n374 Chapter 15\nProof of Proposition 1 S tandard arbitrage proofs are built on the consider-\nation of the cash flows from a particular strategy. In this case the strategy is\nthe following:\nA t time 0 (today):\n\u2022 Buy one share of the stock\n\u2022 Borrow the PV of the option exercise price X\n\u2022 Write a call on the option.\nA t time T:\n\u2022 E xercise the option if this is profitable.\n\u2022 Repay the borrowed funds.\nThis strategy produces the following cash-flow table:\nToday At Time T\nAction Cash Flow S < X S \u2265 X\nT T\nBuy stock \u2212 S + S + S\n0 T T\nBorrow PV of X + Xe \u2212 rt \u2212 X \u2212 X\nWrite call + C 0 \u2212 ( S \u2212 X )\n0 T\nTotal \u2212 S + Xe\u2212 rT + C S \u2212 X < 0 0\n0 T\nNote that at time T , the cash flow resulting from this option is either negative\n(if the call is not exercised) or zero (when S \u2265 X ). Now a financial asset (in\nT\nthis case: the combination of purchasing a stock, borrowing X, and writing a\ncall) which has only non-positive payoffs in the future must have a positive\ninitial cash flow; this shows that:\nC \u2212S +Xe\u2212rT >0 or C >S \u2212Xe\u2212rT\n0 0 0 0\nT o finish the proof, we note that in no case can the value of a call be less\nthan zero. Thus we have that C \u2265 max( S \u2212 X \u2212e r T , 0), which proves the\n0 0\nproposition.\nProposition 1 has an immediate and very interesting consequence: In many\ncases the early-exercise feature of an American call option is worthless; this\nmeans that an American call option can be valued as if it were a European\n375 Introduction to Options\nproposition 2 Consider an American call option written on a stock which\nwill not pay any dividends before the option\u2019 s expiration date T. Then it is\nnever optimal to exercise the option before its maturity.\nProof of Proposition 2 S uppose the holder of the option is considering exer-\ncising it early, at some date t < T. The only reason to consider such early exer-\ncise is that S \u2212 X > 0, whereS is the price of the underlying stock at time\nt t\nt. However, by Proposition 1 the market value of the option at time t is at least\nS \u2212 X \u2212e r ( T \u2212 t ) , where r is the risk-free rate of interest. Since S \u2212 X \u2212e r ( T \u2212 t) > S \u2212 X ,\nt t t\nit follows that the option\u2019 s holder is better off selling the option in the market\nthan exercising it.\nProposition 2 means that many American call options can be priced as if\nthey were European calls. Note that this is not true for American puts, even if\nthe underlying stock pays no dividends; in Chapter 16 we give some examples\nin the context of a binomial model.\nproposition 3 (p ut bounds) T he lower bound on the value of a put\noption is:\nP \u2265max(0,Xe\u2212rT \u2212S )\n0 0\nProof of Proposition 3 T he proof of this proposition has the same form as\nthe proof of the previous theorem. We set up a table of strategies:\nToday At Time T\nAction Cash Flow S < X S \u2265 X\nT T\nShort stock + S \u2212 S \u2212 S\n0 T T\nLend PV of X \u2212 Xe\u2212 rT + X + X\nWrite put + P \u2212 ( X \u2212 S ) 0\n0 T\nTotal P + S \u2212 XreT 0 X \u2212 S < 0\n0 0 T\nSince the strategy has only negative or zero payoffs in the future, it must have\na positive cash flow today, so that we can conclude that:\nP \u2212Xe\u2212rT +S \u22650\n376 Chapter 15\nCombined with the fact that in no case can a put value be negative, this proves\nthe proposition.\nproposition 4 ( put - call parity ) Let C be the price of a European call\n0\nwith exercise price X written on a stock whose current price is S . Let P be\n0 0\nthe price of a European put on the same stock with the same exercise price X .\nSuppose both put and call have exercise date T , and suppose that the continu-\nously compounded interest rate is r . Then:\nC +Xe\u2212rT =P +S\n0 0 0\nProof of Proposition 4 T he proof is similar in style to that of the two previ-\nous propositions. We consider a combination of the four assets (the put, the\ncall, the stock, and a bond), and show that the pricing relation must hold:\nToday At Time T\nAction Cash Flow S < X S \u2265 X\nT T\nBuy call \u2212 C 0 + S \u2212 X\n0 T\nBuy a bond with \u2212 Xe\u2212 rT X X\npayoff X at time T\nWrite a put + P \u2212 ( X \u2212 S ) 0\n0 T\nShort one share of the + S \u2212 S \u2212 S\n0 T T\nstock\nTotal \u2212 C \u2212 X\u2212e r T + P + S 0 0\n0 0 0\nSince the strategy has future payoffs which are zero no matter what happens\nto the price of the stock, it follows that the initial cash flow of the strategy\nmust also be zero. 6 This means that:\nC +Xe\u2212rT \u2212P \u2212S =0\n0 0 0\nwhich proves the proposition.\n6 . T his is a fundamental fact of finance: If a financial strategy has future payoffs which are identi-\ncally zero, then its current cost must also be zero. Likewise, if a financial strategy has future\npayoffs which are non-negative, then its time-zero payoff must be negative (that is, it must cost\n377 Introduction to Options\nPut-call parity states that the stock price S , the price of a call C with exer-\n0 0\ncise price X and the price of a put P with exercise price X, are simultaneously\n0\ndetermined with the interest rate r . Following is an illustration which uses the\ncall price C , the option exercise price X , the current stock price S , and the\n0 0\ninterest rate r to compute the price of a put with exercise price X and time to\nmaturity T :\nA B C\n1 PUT-CALL PARITY\n2 Current stock price, S 55\n0\n3 Option time to maturity, T 0.5\n4 Option exercise price, X 60\n5 Interest rate, r 10%\n6 Call price, C 3\n0\n7 Put price, P 5.0738 <-- =B6+B4*EXP(-B5*B3)-B2\n0\n8\nThis spreadsheet uses put-call parity to derive the put price P from the call price\n0\nC, the interest rate r, the time to maturity T, and the exercise price X.\n9 0\nproposition 5 ( call option price convexity ) Consider three European\ncalls, all written on the same non-dividend paying stock and with the same\nexpiration date T. We suppose that the exercise prices on the calls are X , X ,\n1 2\nand X , and denote the associated call prices by C , C , and C . We further\n3 1 2 3\nX +X\nassume that X = 1 3 . Then\n2 2\nC +C\nC < 1 3\n2 2\n378 Chapter 15\nProof of Proposition 6 T o prove the proposition, we consider the following\nstrategy of three calls with exercise prices X < X < X . We suppose one call\n1 2 3\neach with exercise price X and X is purchased and that two calls with exercise\n1 3\nprice X are written. Such a strategy is commonly called a \u201cbutterfly.\u201d7\n2\nAt Time 0 At Time T\nAction Cash Flow S < X X \u2264 S < X X \u2264 S < X X \u2264 S\nT 1 1 T 2 2 T 3 3 T\nBuy call with \u2212 C 0 S \u2212 X S \u2212 X S \u2212 X\n1 T 1 T 1 T 1\nexercise price X\n1\nBuy call with \u2212 C 0 0 0 S \u2212 X\n3 T 3\nexercise price X\n3\nWrite two calls + 2 C 0 0 \u2212 2 ( S ) \u2212 \u2212 2 ( SX \u2212 X )\n2 T 2 T 2\nwith exercise\nprice X\n2\nTotal 2 C \u2212 C 0 S \u2212 X \u2265 02X \u2212 X \u2212 S 0\n2 1 T 1 2 1 T\n\u2212 C = X \u2212 S > 0\n3 3 T\nSince the payoffs in the future are all non-negative (with a positive probabil-\nity of being positive, it follows that the initial cash flow from the position must\nbe negative:\nC +C\n2C \u2212C \u2212C <0\u21d2C < 1 3\n2 1 3 2\n2\nX +X\nThis proves the proposition. (Note that the assumption that X = 1 3 is\n2 2\nmade for convenience and does not affect the generality of the argument.)\nWithout proof we state a similar proposition for puts:\nproposition 6 ( put price convexity ) Consider three European puts, all\nwritten on the same non-dividend paying stock and with the same expiration\ndate T . We suppose that the exercise prices on the calls are X , X , and X , and\n1 2 3\ndenote the associated put prices by P , P , and P . We further assume that\n1 2 3\nX +X\nX = 1 3 . Then the put price is a convex function of the exercise price:\n2 2\n7. Any strategy of three options (calls or puts) with three exercise prices in which one option\neach of the extreme exercise price is either bought or written and in which two options with the\n379 Introduction to Options\nP +P\nP < 1 3\n2 2\nWithout proof we state a similar proposition for a butterfly composed\nof puts.\nproposition 7 (c all option bounds with a known future dividend)\nConsider a call with exercise price X and maturity date T . Suppose that at some\ntime t < T , the stock will, with certainty, pay a dividendD . Then the lower\nbound on the call option price is given by:\nC \u2265max(S \u2212De\u2212rt \u2212Xe\u2212rT,0)\n0 0\nProof of Proposition 7 T he proof involves only a minor modification of the\nproof of Proposition 1.\nToday Time t At Time T\nAction Cash Flow S < X S \u2265 X\nT T\nBuy stock \u2212 S + D + S + S\n0 T T\nBorrow the PV of + De \u2212 rT \u2212 D\nthe dividend D\nBorrow PV of X + Xe\u2212 rT \u2212 X \u2212 X\nWrite call + C 0 \u2212 ( S \u2212 X )\n0 T\nTotal \u2212 S + D\u2212e r t 0 S \u2212 X < 0 0\n0 T\n+ Xe\u2212 rT + C\n0\nThis proves the proposition."
        ],
        "15.7": [
            "What is the basic definition of options in finance?\nWhat are the main features of options in financial modeling?\nWhat complexities do options securities present?\nWhat preknowledge is recommended for understanding options?\nWhat is the role of options in financial modeling?\nWhat are some common misunderstandings about options?\nWhat additional resources can help in understanding options?\nWhat is meant by deciphering the mysteries of options? \nWhat are some of the common alternatives to options in financial modeling?\nWhat kind of professionals typically work with options?",
            "15.7 Summary\n\nT his chapter summarizes the basic definitions and features of options. It is,\nhowever, by no means an adequate introduction to these complex securities\nfor those with no preknowledge. To decipher the mysteries of options, we\n380 Chapter 15"
        ]
    },
    "16": {
        "16.1": [
            "What is the binomial option pricing model?\nWhat are the advantages of the binomial option pricing model?\nWhat does it mean that the binomial model is easily programmed and adaptable to numerous option pricing problems?\nHow does the binomial model become powerful when extended to many periods?\nWhat types of securities can be valued using the binomial model?\nWhat role do state prices play in the binomial model?\nWhat deeper understanding do we gain about the economics of contingent asset pricing when we understand the state pricing principles underlying the binomial model?\nHow is the binomial model used in the simple uses of the binomial model?\nHow is the binomial model used in the Monte Carlo pricing of contingent securities?\nWhat is the Black-Scholes model and how does it compare to the binomial option pricing model?\nWhat are some complicated option pricing problems that the binomial model can address?\nWhat is the significance of state prices in computing the values of risky assets?",
            "16.1 Overview\n\nNext to the Black-Scholes model (discussed in Chapter 17), the binomial\noption pricing model is the most widely used option pricing model. It has\nmany advantages: It is a simple model, which\u2014in addition to giving many\ninsights into option pricing\u2014is easily programmed and adapted to numerous,\nand often quite complicated, option pricing problems. When extended to many\nperiods, the binomial model becomes one of the most powerful ways of\nvaluing securities like options whose payoffs are contingent on the market\nprices of other assets.\nT he binomial model depends on using state prices to compute the values of\nrisky assets. When the state pricing principles underlying the model are under-\nstood, we gain deeper insight into the economics of contingent asset pricing.\nIn this chapter, which illustrates the simple uses of the binomial model, we\ndevote a considerable amount of space to deriving and using state prices. In\nChapters 29 and 30 we return to the binomial model and use it in the Monte\nCarlo pricing of contingent securities."
        ],
        "16.2": [
            "What does the binomial option pricing model represent in financial modeling?\nCan you outline a simple example of two-date binomial pricing?\nWhat are the two fundamental assets mentioned in the context of binomial model?\nWhat factors does the binomial option pricing model consider about the stock?\nHow is the interest rate factored into the binomial option pricing model?\nWhat is the role of a call option in the binomial option pricing model?\nHow is the exercise price of the call option decided and how does it impact the model?\nWhat is the significance of the values denoted by U, D, and R in the binomial model?\nHow is the call option priced using the binomial model?\nWhat constitutes the payoffs of the call option in a binomial model?\nCan you explain the concept of \"pricing by arbitrage\"? \nWhat does it mean for two assets or sets of assets to have the same payoffs?\nWhat is the relationship between the price of an option and the cost of replicating its payoffs? \nHow does the binomial model approach the computation of the put price?\nCan arbitrage argument be extended to multiple periods in binomial option pricing model? \nHow does the pricing of a call option differ from the pricing of a put option in a one-period binomial model?\nIn what way does a bond come into play in binomial option pricing model?\nWhat does the term \"matures\" refer to in the context of call options in binomial option pricing model?",
            "16.2 Two-Date Binomial Pricing\n\nTo illustrate the use of the binomial model, we start with the following very\nsimple example:\n\u2022 T here is one period and two dates, date 0 = today and date 1 = one year\nfrom now.\n\u2022 T here are two \u201cfundamental\u201d assets: A stock and a bond. There is also a\nderivative asset, a call option written on the stock.\n\u2022 T he stock price today is $50 and at date 1 will either go up by 10% or go\ndown by 3%.\n\u2022 The one-period interest rate is 6%.\n\u2022 The call option matures at date 1 and has exercise price X = $50.\nH ere is a picture from a spreadsheet which incorporates this model. Notice\nthat in cells B2, B3, and B6 we have used values for 1 plus the 10% up move,\n1 plus the \u22123 % down move, and 1 plus the 6% interest. We use capital letters\nU , D , and R to denote these values.1\n1 . S hould there be a need to distinguish between 1.10\u20141 plus the 10% up move of the stock\u2014and\n384 Chapter 16\nA B C D E F G H I J\n1 BINOMIAL OPTION PRICING IN A ONE-PERIOD MODEL\n2 Up, U 1.10\n3 Down, D 0.97\n4\n5 Initial stock price 50.00\n6 Interest rate, R 1.06\n7 Exercise price 50.00\n8\n9 Stock price Bond price\n10 55.00 <-- =$B$11*B2 1.06 <-- =$G$11*$B$6\n11 50.00 1.00\n12 48.50 <-- =$B$11*B3 1.06 <-- =$G$11*$B$6\n13\n14 Call option\n15 5.00 <-- =MAX(D10-$B$7,0)\n16 ???\n17 0.00 <-- =MAX(D12-$B$7,0)\nW e wish to price the call option. We do this by showing that there is a\ncombination of the bonds and stocks which exactly replicates the call option\u2019 s\npayoffs. To show this, we use some basic linear algebra; suppose we find A\nshares of the stock and B bonds such that:\n55A+1.06B=5\n48.5A+1.06B=0\nThis system of equations solves to give\n5\nA= =0.7692\n55\u221248.5\n0\u221248.5A\nB= =\u221235.1959\n1.06\nThus purchasing 0.77 of a share of the stock and borrowing $35.20 at 6% for\none period will give payoffs of $5 if the stock price goes up and $0 if the stock\nprice goes down\u2014the payoffs of the call option. It follows that the price of\nthe option must be equal to the cost of replicating its payoffs; that is,\nCalloption price=0.7692\u2217$50\u2212$35.1959\u2212$3.2656\nThis logic is called \u201cpricing by arbitrage\u201d: If two assets or sets of assets\n(in our case\u2014the call option and the portfolio of 0.77 of the stock and\n\u2212$ 35.20 of the bonds) have the same payoffs, they must have the same market\n385 The Binomial Option Pricing Model\nA B C D E F G\n19 Solving the portfolio problem: A shares + B bonds combine to give option payoffs\n20 A 0.7692 <-- =D15/(D10-D12)\n21 B -35.1959 <-- =-D12*B20/B6\n22\n23 Call price 3.2656 <-- =B20*B5+B21\nApplying the same logic to a put gives the put price as 0.4354:\nA B C D E F GG\n1 BINOMIAL PUT OPTION PRICING IN A ONE-PERIOD MODEL\n2 Up, U 1.10\n3 Down, D 0.97 Solving the put price\n4 55*A+1.06*B=0\n5 Initial stock price 50.00 48.5*A+1.06*B=1.5\n6 Interest rate, R 1.06\n7 Exercise price 50.00 A=-1.5/(55-48.5)\n8 Put option B=-55*A/1.06\n9 0.00 <-- =MAX($B$7-B5*B2,0)\n10 ???\n11 1.50 <-- =MAX($B$7-B5*B3,0)\n12\n13 Solving the portfolio problem: A shares + B bonds combine to give option payoffs\n14 A -0.2308<-- =-D11/(B5*(B2-B3))\n15 B 11.9739<-- =-B5*B2*B14/B6\n16\n17 Put price 0.4354<-- =B14*B5+B15\nIn succeeding sections we show that this simple arbitrage argument can be\nextended to multiple periods. But in the meantime we confine ourselves in the\nnext section to generalizing the logic."
        ],
        "16.3": [
            "What is the principle of linear pricing in financial modeling?\nWhat are state prices in the context of binomial option pricing model?\nWhat is the significance of determining a price q for $1 in the up and down states of the world in financial modeling?\nHow are the bond and the stock priced using state prices?\nWhat factors can influence the movement of a stock price in a given period in the context of the binomial option pricing model?\nHow is the payoff of an asset priced by discounting its payoff in the up and down state?\nWhat is the formula to solve for state prices in the binomial option pricing model?\nHow can state prices be used to price a call and a put on the stock?\nWhat is the concept of put-call parity and how is it achieved through pricing by state prices?\nWhat are risk-neutral prices and how are they derived from state prices?\nHow does the risk-neutral prices relation to a probability distribution of states?\nWhat is the fundamental equivalence of pricing by risk-neutral prices and pricing by state prices?\nHow can an asset's date 0 price be calculated using both the state and risk-neutral prices?\nWhat are the implications of pricing an asset with state prices or with risk-neutral prices?\nHow does the concept of pseudo-probabilities apply in pricing by risk-neutral prices? \nWhat is the relationship between risk-neutral prices and state prices in the binominal option pricing model?\nHow can state prices and risk-neutral prices be used to drive home the equivalence between these two pricing methods?\nWhat are the steps to price a call and put using state prices and risk-neutral prices respectively in financial modelling?\nHow are expected asset payoff calculated using risk-neutral prices in a binomial option pricing model?",
            "16.3 State Prices\n\nThere is actually a simpler (and more general) way to solve this problem:\nViewed from today, there are only two possibilities for next period: Either the\nstock price goes up or it goes down. Think about the market determining a\nprice q for $1 in the \u201cup\u201d state of the world and a price q for $1 in the\nU D\n\u201cdown\u201d state of the world. Then both the bond and the stock have to be priced\n386 Chapter 16\nq \u2217S\u2217U+q \u2217S\u2217D=S\u21d2q U+q D=1\nU D U D\nq \u2217R+q \u2217R=1\nU D\nThe state prices are thus an illustration of the linear pricing principle: If the\nstock price can move up in one period by a factor U and down by a factor D ,\nand if 1 plus the one-period interest rate is R , then any other asset will be\npriced by discounting its payoff in the \u201cup\u201d state by q and by discounting its\nU\npayoff in the \u201cdown\u201d state by q .\nD\nThe two equations above solve to give:\nR\u2212D U\u2212R\nq = , q =\nU R(U\u2212D) D R(U\u2212D)\nIn our case these state prices are given by:\nA B C\n1 DERIVING THE STATE PRICES\n2 Up, U 1.10\n3 Down, D 0.97\n4 Interest rate, R 1.06\n5\n6 State prices\n7 q U 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n8 q D 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n9\n10 Check: Confirm that state prices actually price the stock and the bond\n11 Pricing the stock: 1 = q U*U+q D*D? 1<-- =B7*B2+B8*B3\n12 Pricing the bond: 1/R = q U+q D ? 1.06<-- =1/(B7+B8)\nIn rows 11 and 12 we check that the state prices indeed give back the interest\nrate and the stock price.\nWe can now use the state prices to price the call and the put on the stock\nand also to establish that put-call parity holds. The call and the put options\nshould be priced by:\nC=q max(S\u2217U\u2212X,0)+q max(S\u2217D\u2212X,0)\nU D\nP=q max(X\u2212S\u2217U,0)+q max(X\u2212S\u2217DD,0)\nU D\nor if priced by put call parity\n387 The Binomial Option Pricing Model\nIn a spreadsheet:\nA B C\nBINOMIAL OPTION PRICING WITH STATE PRICES IN A ONE-PERIOD\n(TWO-DATE) MODEL\n1\n2 Up, U 1.10\n3 Down, D 0.97\n4 Interest rate, R 1.06\n5 Initial stock price, S 50.00\n6 Option exercise price, X 50.00\n7\n8 State prices\n9 q U 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n10 q D 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n11\n12 Pricing the call and the put\n13 Call price 3.2656<-- =B9*MAX(B5*B2-B6,0)+B10*MAX(B5*B3-B6,0)\n14 Put price 0.4354<-- =B9*MAX(B6-B5*B2,0)+B10*MAX(B6-B5*B3,0)\n15\n16 Put-call parity\n17 Stock + put 50.4354<-- =B5+B14\n18 Call + PV(X) 50.4354<-- =B13+B6/B4\n19\nNote about PV(X) in put-call parity:\nIn the continuous-time framework (the standard Black-Scholes framework), PV(X) = X*Exp(-r*T). Because\n20 the framework here is discrete time, PV(X) is also discrete-time: PV(X)=X/(1+r)=X/R.\nThe formulas we use (with S = 50, X = 50 , U = 1.10, D = 0.97 , R = 1.06)\nare:\nC=q max(S\u2217U\u2212X,0)+q max(S\u2217D\u2212X,0)\nU D\n=0.6531\u22175+0.2903\u22170=3.2657\nfor the call, and\nP=q max(X\u2212S\u2217U,0)+q max(X\u2212S\u2217D,0)\nU D\n=0.6531\u2217max(50\u221255,0)+0.2903\u2217\u2217max(50\u221248.5,0)=0.4354\nfor the put. As expected\u2014the put-call parity theorem holds for this particular\nput and call (cells B17:B18):\nX 50\nP+S=0.4354+50=C+ =3.27+\n388 Chapter 16\nState Prices or Risk-Neutral Prices?\nM ultiplying the state prices by 1 plus the interest rate, R, gives the risk-neutral\nprices : \u03c0 = q R , \u03c0 = q R . The risk-neutral prices look like a probability\nU U D D\ndistribution of the states, since they sum to 1:\nR\u2212D U\u2212R\n\u03c0 +\u03c0 =q R+q R= R+ R=1\nU D U D R(U\u2212D) R(U\u2212D)\nF urthermore, there is a fundamental equivalence of pricing by the risk-neutral\nprices and pricing by the state prices. Suppose an asset has state-dependent\npayoffs X in the \u201cup\u201d state and X in the \u201cdown\u201d state of a 2-date model.\nU D\nThen the date 0 price of the asset using the state prices is q X + q X and\nU U D D\nthe date 0 price of the asset using the risk-neutral prices is the discounted\nexpected asset payoff, where the expectation is computed using the risk-neutral\nprices as if they are the actual state probabilities:\n\u03c0 X +\u03c0 X \u201cExpected\u201dasset payoff usingrisk-neutral prices\nU U D D =\nR 1+r\n==q X +q X\nU U D D\nP ricing with state prices or pricing with risk-neutral prices is, of course, the\nsame. This author prefers to use state prices, but many researchers are more\ncomfortable using the pseudo-probabilities of the risk-neutral prices and then\ndiscounting the \u201cexpected\u201d payoffs.\nEQUIVALENCE OF PRICING BY STATE PRICES\nAND RISK-NEUTRAL PRICES\nX\nU\nPricing by state prices q *X +q *X\nU U D D\nX\nD\nX\nU\nPricing by risk-neutral prices (p *X +p *X )/R\nU U D D\nX\nD\nRelation of risk-neutral to state prices: p =q *R, p = q *R\n389 The Binomial Option Pricing Model\nT o drive home the equivalence between state prices and risk-neutral prices,\nwe close this subsection with a numerical example:\nA B C\nRISK-NEUTRAL PRICES OR STATE PRICES?\n1\n2 Up, U 1.10\n3 Down, D 0.97\n4 Interest rate, R 1.06\n5 Initial stock price, S 50.00\n6 Option exercise price, X 50.00\n7\n8 State prices\n9 q 0.6531<-- =(B4-B3)/(B4*(B2-B3))\nU\n10 q 0.2903<-- =(B2-B4)/(B4*(B2-B3))\nD\n11\n12 Risk-neutral prices\n13 \u03c0 = q *R 0.6923<-- =B9*$B$4\nU U\n14 \u03c0 = q *R 0.3077<-- =B10*$B$4\nD D\n15\n16 Pricing the call and the put using state prices\n17 Call price 3.2656<-- =B9*MAX(B5*B2-B6,0)+B10*MAX(B5*B3-B6,0)\n18 Put price 0.4354<-- =B9*MAX(B6-B5*B2,0)+B10*MAX(B6-B5*B3,0)\n19\n20 Pricing the call and the put using risk-neutral prices\n21 Call price 3.2656<-- =(B13*MAX(B5*B2-B6,0)+B14*MAX(B5*B3-B6,0))/B4\n22 Put price 0.4354<-- =(B13*MAX(B6-B5*B2,0)+B14*MAX(B6-B5*B3,0))/B4"
        ],
        "16.4": [
            "What is a Multi-Period Binomial Model?\nWhat are the key characteristics of a Multi-Period Binomial Model based on the given text?\nHow is the call option price determined in a two-period binomial model?\nWhat is the significance of state prices in pricing a call option in a binomial model?\nWhat does the value of U, D, and R represent in the context of binomial model?\nHow does the stock price movement affect the pricing of a call option?\nCan you explain the logic of backward pricing in a binomial model?\nWhat are the terminal option payoffs in the context of the Multi-Period Binomial Model?\nWhat are \u201cup\u201d and \u201cdown\u201d movements in the context of binomial model?\nWhy is there no necessity to price the call price payoffs \u201cbackward\u201d at each node back from the terminal date?\nWhat is the implication of the logic from the example that can be extended to many periods?\nWhat is the concept of put-call parity in financial modeling? \nWhat is the significance of European call option and puts in the binomial model?\nWhat does a European call option represent in a binomial model?\nWhat is the price of a European option called in a binomial model?\nHow does one calculate the value at time 0 of a particular terminal payoff?\nHow to calculate value at time 0 of the option? \nWhat determinates the number of paths with the same terminal payoff?\nHow is the state price calculated in the binomial model? \nWhat does a stock's \"up\" or \"down\" steps refer to in the context of the binomial option pricing model?",
            "16.4 The Multi-Period Binomial Model\n\nThe binomial model can easily be extended to more than one period. Consider,\nfor example, a two-period (three-date) binomial model that has the following\ncharacteristics:\n\u2022 I n each period the stock price goes up by 10% or down by \u22123 % from what\nit was in the previous period. This means that U = 1.10, D = 0.97.\n\u2022 In each period the interest rate is 6%, so that R = 1.06.\nBecause U , D , and R are the same in each period,\nR\u2212D U\u2212R\nq = =0.6531,q = =0.2903\n390 Chapter 16\nW e can now use these state prices to price a call option written on the stock\nafter two periods. As before, we assume that the stock price is $50 initially\nand that the call exercise price is X = 50 after two periods. This gives the fol-\nlowing picture:\nStockprice Bondprice\n60.5000 1.1236\n55.0000 1.0600\n50.0000 53.3500 1.00 1.1236\n48.5000 1.0600\n47.0450 1.1236\nDate 0 Date 1 Date 2\nCall option price\n10.5000\n7.8302\n5.7492 3.3500\n2.1880\n0.0000\nHow was the call option price of 5.7492 determined? To do this, we go back-\nward, starting at period two:\nAt date two: At the end of two periods the stock price is either $60.50 (cor-\nresponding to two \u201cup\u201d movements in the price), $53.35 (one \u201cup\u201d and one\n\u201cdown\u201d movement), or $47.05 (two \u201cdown\u201d movements in the price). Given\nthe exercise price of X = 50, this means that the terminal option payoff in\nperiod 2 is $10.50, $3.35, or $0.\nAt date one : At date one, there are two possibilities: Either we have reached\nan \u201cup\u201d state, in which case the current stock price is $55 and the option will\npay off $10.50 or $3.35 in the next period:\n10.5000\n????\n3.3500\nW e use the state prices of q = 0.6531, q = 0.2903 to price the option at this\nu d\nstate:\nOption priceat\u201cup\u201dstate,date1=0.6531\u221710.50+0.2903\u22173.35=7.83002\n391 The Binomial Option Pricing Model\n3.3500\n????\n0.0000\nUsing the same state prices (which, after all, depend only on the \u201cup\u201d and\n\u201cdown\u201d movements of the stock price and the interest rate), we get:\nOption priceat\u201cdown\u201dstate,date1=0.6531\u22173.35+0.2903\u22170=2.1880\nAt date 0: Going backward in this way, we\u2019 v e now filled in the following\npicture:\n10.5000\n7.8302\n???? 3.3500\n2.1880\n0.0000\nT hus at period 0 the buyer of an option owns a security which will be worth\n$7.83 if the underlying stock has an \u201cup\u201d movement in its return and which\nwill be worth $2.19 if the stock has a \u201cdown\u201d movement in its return. We can\nagain use the state prices to value this option:\nOption priceatdate0=0.6531\u22177.830+0.2903\u22172.188=5.749\nA B C D E F G H I J K\nBINOMIAL OPTION PRICING WITH STATE PRICES IN\n1 A TWO-PERIOD (THREE-DATE) MODEL\n2 Up, U 1.10\n3 Down, D 0.97 State prices\n4 Interest rate, R 1.06 q U 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n5 Initial stock price, S 50.00 q D 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n6 Option exercise price, X 50.00\n7\n8 Stock price Bond price\n9 60.5000 1.1236\n10 55.0000 1.0600\n11 50.0000 53.3500 1.00 1.1236\n12 48.5000 1.0600\n13 47.0450 1.1236\n14\n15\n16 Call option price\n17 =q U*E18+q D*E20\n18 10.5000 <-- =MAX(E9-$B$5,0)\n19 7.8302\n20 5.7492 3.3500 <-- =MAX(E11-$B$5,0)\n21 2.1880\n22 =q U*C19+q D*C21 0.0000 <-- =MAX(E13-$B$5,0)\n23 =q U*E20+q D*E22\n392 Chapter 16\nExtending the Binomial Pricing Model to Many Periods\nIt is clear that the logic of the above example can be extended to many periods.\nHere \u2019s another Excel graphic showing a 5-date model using the same \u201cup\u201d and\n\u201cdown\u201d parameters as before:\n73.2050\nStock price 66.5500\n60.5000 64.5535\n55.0000 58.6850\n50.0000 53.3500 56.9245\n48.5000 51.7495\n47.0450 50.1970\n45.6337\n44.2646\n1.2625\nBond price 1.1910\n1.1236 1.2625\n1.0600 1.1910\n1.0000 1.1236 1.2625\n1.0600 1.1910\n1.1236 1.2625\n1.1910\n1.2625\n23.2050\nCall price 19.3802\n16.0002 14.5535\n13.0190 11.5152\n10.4360 8.8502 6.9245\n6.6593 4.5797\n3.0284 0.1970\n0.1287\n0.0000\n393 The Binomial Option Pricing Model\nDo You Really Have to Price Everything Backward?\nThe answer is \u201cno.\u201d There \u2019 s no necessity to price the call price payoffs\n\u201cbackward\u201d at each node back from the terminal date, a s long as the call is\nEuropean . 2 It is enough to price each of the terminal payoffs by the state\nprices, providing you count properly the number of paths to each terminal\nnode. Here \u2019 s an illustration, using the same example:\nA B C D E F G H\nBINOMIAL OPTION PRICING WITH STATE PRICES\n1 IN A FOUR-PERIOD (FIVE-DATE) MODEL\n2 Up, U 1.10\n3 Down, D 0.97 State prices\n4 Interest rate, R 1.06 qU 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n5 Initial stock price, S 50.00 qD 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n6 Option exercise price, X 50.00\n7\n8\nTerminal stock State price for\nNumber of \"up\" steps Number of price Option payoff terminal date Number of Value\nat terminal date a\" td to ew rmn i\"\nn\ns at\nl\ne dp as\nt e\n= S*U^(# up) at t se tr am teinal = qU^(# up) terp ma it nh as\nl\nt so\nta te\n= pp ra icy eo *f #f* ps at ta ht se\n9 *D^(# down) *qD^(# down)\n10 4 0 73.2050 23.2050 0.1820 1 4.2224\n11 3 1 64.5535 14.5535 0.0809 4 4.7078\n12 2 2 56.9245 6.9245 0.0359 6 1.4933\n13 1 3 50.1970 0.1970 0.0160 4 0.0126\n14 0 4 44.2646 0.0000 0.0071 1 0.0000\n15 Call price 10.4360 <-- =SUM(G10:G14)\n16 Put price 0.0407 <-- =G15+B6/B4^4-B5\n17\n18 Notes\n19 There are 5 dates in this model (0, 1, ... , 5) but only 4 periods and thus only 4 possible \"up\" or \"down\" steps.\n20 The put price in cell G16 is computed using put-call parity: put = call + PV(X) - stock\nHere is an explanation for the table above: For each terminal option payoff,\nwe consider:\n2 . W hen we discuss American options in section 16.5 we will see that backward pricing is\n394 Chapter 16\nHow was this Example: The terminal\nterminal payoff payoff of 14.5535 arises\nreached? How many when the stock price is\n\u201cup\u201d steps did the 64.5535. This happens\nstock make and how when the stock price\nmany \u201cdown\u201d steps goes up 3 times and\ndid it make? down once.\nWhat is the price per Example: The value at\nStateprice=q U#upstepsq D#downsteps\ndollar of the payoff time 0 of the terminal\nin the particular payoff considered above\nstate? is 0.65313 *0.2903 1 =\n0.0809.\nHow many paths are The answer is given by Example: There are\nthere with the same the binomial coefficient \u239b4\u239e\n\u239c \u239f=4 paths which give\nterminal payoff? \u239b Numberof periods \u239e \u239d3\u23a0\n\u239c \u239f\n\u239dNumberof\u201cup\u201dsteps\u23a0\nthe terminal stock price\nof 64.5535. The Excel\nfunction Combin(4,3)\ngives this binomial\ncoefficient.\nWhat is the value at The answer is the Example:\ntime 0 of a particular product of the payoff 14.5535*0.0809*4 =\nterminal payoff? times the price times 4.7078.\nthe number of paths.\nWhat is the value at The sum of the values Total value: 10.4360.\ntime 0 of the option? of each payoff. This is the multi-period\ncall option value in the\nfive date (four-period)\nbinomial model.\nE uropean puts can be priced either by using the logic above or\u2014as in cell\nG16 above\u2014by using put-call parity.\nT o recapitulate: The price of a European call option in a binomial model\n395 The Binomial Option Pricing Model\nCall\nprice=\u2211n \u239b \u239cn\u239e\n\u239fqi qn\u2212imax(S\u2217UiDn\u2212i \u2212X,0)\n\u239di\u23a0 U D\ni=0\n\u23a7 \u23aa\u2211n \u239b \u239cn\u239e\n\u239fqi qn\u2212imax(X\u2212S\u2217UiDn\u2212i,0) Direct pricing\n\u23aa \u239dii\u23a0 U D\nPut price=\u23a8i=0\n\u23aa X\n\u23a9\u23aa Call pricce+\nRn\n\u2212S Using put-call parity\nIn section 16.7 we implement these formulas in VBA."
        ],
        "16.5": [
            "What is the binomial pricing model used for?\nWhat are the key variables or parameters in a basic binomial pricing model?\nWhat types of options can the binomial pricing model be used to price? \nWhat is the difference between an American option and a European option? \nIs there a difference in the value of an American call option and a European call option on a non-dividend-paying stock?\nHow is the payoff pattern for an American put option determined? \nWhat factors does a holder of an American put consider at date two?\nCan you calculate the value of a put option in the binomial pricing model?\nWhat is the significance of exercising an American put in the binomial pricing model?\nWhat does the value of an American put depend on in state D compared to state U?\nHow do we calculate the state-dependent value of future payoffs for an American put option?\nWhat does value function means in the context of option pricing?\nWhat is the difference in payoff patterns for an American call option and an European call option?\nHow can binomial pricing model help in pricing an American call option?\nWhat are the differences between a American call option and a European call option?\nWhat is the impact of the state prices on the pricing of an American Call option in binomial pricing model? \nCan you calculate the payoff for a European call option using the binomial model? \nHow do we calculate the put and call value in the respective states in a binomial pricing model?\nWhat are the typical steps to price an American option using the binomial pricing model?\nWhat's the role of stock price, bond price and option exercise price in American put pricing?\nWhat is the significance of the state prices in the binomial option pricing model?",
            "16.5 Pricing American Options Using the Binomial Pricing Model\n\nWe can use the binomial pricing model to calculate the prices of American\noptions as well as European options. We reconsider the basic model above, in\nwhich U = 1.10, D own = 0.97, R = 1.06, S = 50, X = 50. We examine the\np\nthree-date version of the model. Recall from Chapter 15 that an American call\noption on a non-dividend-paying stock has the same value as a European call\noption. It is thus more interesting to start with the pricing of an American put.\nThe payoff patterns for the stock and the bond have been given above, and it\nremains only to consider the payoff patterns for a put option with X = 50. We\nreference the states of the world by using the following labels:\nState labels\nUU\nU\n0 UD orDU\nD\nDD\nPut Payoffs at Date Three\nHere are the values of the stock and the date three put payoffs:\nStock price American put payoffs\n60.5000 0.0000\n55.0000 ????\n50.0000 53.3500 ???? 0.0000\n48.5000 ????\n396 Chapter 16\nA t date two, the holder of an American put can choose whether to hold the\nput or to exercise it. We now have the following value function:\nPutvalue\n\u23a7Putvalueif exercised=max( X\u2212S ,0)\natdate2 =max\u23a8 U\n\u23a9q \u2217\u2217Put payoff instateUU+q \u2217Put payoff instateUD\nstateU U D\nA similar function holds for the put value in state d at date two. The resulting\ntree now looks like:\nAmerican put payoffs\n0.0000\n0.0000\n???? 0.0000\n1.5000\n2.9550\nHere \u2019 s the explanation:\n\u2022 In state U , the put is valueless. When the stock price is $55, it is not worth-\nwhile to early-exercise the put, since max(X \u2212 S, 0) = max(50 \u2212 55, 0) = 0.\nU\nOn the other hand, since the future put payoffs from state U are zero, state-\ndependent present value of these future payoffs (the second line in the previous\nformula) is also zero.\n\u2022 In state D, on the other hand, the holder of the put gets max(50 \u2212 48.5, 0)\n= 1.5 if he exercises the put; however, if he holds the put without exercise, its\nmarket value is the state-dependent value of the future payoffs:\nq \u22170+q \u22172.9550=0.6531\u22170+0.2903\u22172.9550=0.8578\nU D\nI t is clearly preferable to exercise the put in this state rather than to hold\nonto it.\nAt date 0, a similar value function recurs:\nPutvalue \u23a7Putvalueif exercised=max( X\u2212S,0)\n=max\u23a8 0\natdate0 \u23a9q \u2217Put payyoff instateU+q \u2217Put payoff instateD\n397 The Binomial Option Pricing Model\nThe spreadsheet is given below:\nA B C D E F G H I J K\n1 AMERICAN PUT PRICING IN A TWO-PERIOD MODEL\n2 Up, U 1.10\n3 Down, D 0.97 State prices\n4 Interest rate, R 1.06 q U 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n5 Initial stock price, S 50.00 q D 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n6 Option exercise price, X 50.00\n7\n8\n9\n10 Stock price Bond price\n11 60.5000 1.1236\n12 55.0000 1.0600\n13 50.0000 53.3500 1.0000 1.1236\n14 48.5000 1.0600\n15 47.0450 1.1236\n16\n17\n18 American put option\n19 =MAX(MAX(X-S*U,0),q U*put_payoff UU+q D*put_payoff UD)\n20 0.0000\n21 0\n22 0.4354 0.0000\n23 1.5\n24 2.9550 =MAX(MAX(X-S*D,0),q U*put_payoff UD+q D*put_payoff DD)\n25\n26\n27 =MAX(MAX(X-S,0),q U*put_value U+q D*put_value D)\n28\n29\n30 European put option\n31 0.0000\n32 0\n33 0.2490 0.0000\n34 0.8578\n35 2.9550\nW e can use the same logic to price an American call option, though\u2014fol-\nlowing Proposition 2 of Chapter 15, we know that the value of an American\n398 Chapter 16\nA B C D E F G H I J K\n1 AMERICAN CALL PRICING IN A TWO-PERIOD MODEL\n2 Up, U 1.10\n3 Down, D 0.97 State prices\n4 Interest rate, R 1.06 q U 0.6531<-- =(B4-B3)/(B4*(B2-B3))\n5 Initial stock price, S 50.00 q D 0.2903<-- =(B2-B4)/(B4*(B2-B3))\n6 Option exercise price, X 50.00\n7\n8\n9\n10 Stock price Bond price\n11 60.5000 1.1236\n12 55.0000 1.0600\n13 50.0000 53.3500 1.0000 1.1236\n14 48.5000 1.0600\n15 47.0450 1.1236\n16\n17\n18 American call option\n19 =MAX(MAX(S*U-X,0),q U*call_payoff UU+q D*call_payoff UD)\n20 10.5000\n21 7.8302\n22 5.7492 3.3500\n23 2.1880\n24 0.0000 =MAX(MAX(S*D-X,0),q U*call_payoff UD+q D*call_payoff DD)\n25\n26\n27 =MAX(MAX(S-X,0),q U*call_value U+q D*call_value D)\n28\n29\n30 European call option\n31 10.5000\n32 7.8302\n33 5.7492 3.3500\n34 2.1880\n35 0.0000"
        ],
        "16.6": [
            "What is the binomial option pricing model?\nWhat is the significance of using Excel's VBA programming language in programming the binomial option pricing model?\nWhat are the state prices associated with an up move and a down move in the binomial model?\nWhat is the binomial coefficient in the context of binomial option pricing model?\nHow is the Combin function in Excel used in binomial option pricing model?\nWhat are the VBA functions used to compute the value of binomial European calls and puts?\nWhat does the function \"Binomial_eur_call\" do in binomial option pricing model programming?\nCan you explain how \"put-call parity\" is used in binomial option pricing model programming?\nHow do we implement the binomial option pricing model in a spreadsheet?\nWhat is the significance of \"OptionReturnEnd\" and \"OptionReturnMiddle\" arrays in binomial option pricing model programming?\nWhat does the function \"Binomial_amer_put\" accomplish in the binomial option pricing model?\nHow do you calculate the value of an American put and call for options?\nExplain the calculation of \"Up\", \"Down\", and \"R\" in terms of \u03bc (mean), \u0394t (single period length), \u03c3 (standard deviation), and r (interest rate).\nAre the prices of an American call and a European call similar or different in a binomial option pricing model?\nWhat is the impact of dividing a basic one-year period into subperiods on binomial option pricing model calculations?\nCan the binomial option pricing model work effectively with a very large number of periods?\nWhat is meant by the 'put-call parity' in the context of financial modelling?\nWhat happens when we use Excel\u2019s Round function in the binomial option pricing model?\nWhat is the impact of standard deviation on the binomial option pricing model? \nWhat is the role of the interest rate in the binomial option pricing model?",
            "16.6 Programming the Binomial Option Pricing Model in VBA\n\nT he pricing procedure used in the above examples can easily be programmed\nusing Excel\u2019 s VBA programming language. In the binomial model the price\ncan move up or down in any time period. If q is the state price associated\nU\nwith an up move and if q is the state price associated with a down move, then\nD\nthe binomial European option prices are given by:\nBinomialEuropeancall=\u2211\u2211n \u239b \u239cn\u239e\n\u239fqi qn\u2212imax(S\u2217UiDn\u2212i \u2212X,0)\n\u239di\u23a0 U D\ni=0\n\u23a7 \u23aa\u2211nn \u239b \u239cn\u239e\n\u239fqi qn\u2212imax(X\u2212S\u2217UiDn\u2212i,0)\nBinomialEuropean put=\u23a8 \u239di\u23a0 U D\ni=0\n\u23aa\n399 The Binomial Option Pricing Model\n\u239bn\u239e\nwhere U is an up move, R is a down move in the stock price, and \u239c \u239f is the\n\u239di\u23a0\nbinomial coefficient (the number of up moves in n total moves:\n\u239bn\u239e n!\n\u239c \u239f =\n\u239di\u23a0 i!( n\u2212i)\n!\nWe use Excel \u2019 s Combin(n,i) to give values for the binomial coefficients.\nH ere are two VBA functions which compute the value of binomial European\ncalls and puts. The function B inomial_eur_put uses put-call parity to price\nthe put:\nFunction Binomial_eur_call(Up, Down, Interest, _\nStock, Exercise, Periods)\nq_up = (Interest - Down) / _\n(Interest * (Up - Down))\nq_down = 1 / Interest - q_up\nBinomial_eur_call = 0\nFor Index = 0 To Periods\nBinomial_eur_call = Binomial_eur_call _\n+ Application.Combin(Periods, Index) _\n* q_up \u2227 Index * q_down \u2227 (Periods - Index) _\n* Application.Max(Stock * Up \u2227 Index * Down _\n\u2227 (Periods - Index) - Exercise, 0)\nNext Index\nEnd Function\nFunction Binomial_eur_put(Up, Down, Interest, _\nStock, Exercise, Periods)\nBinomial_eur_put = Binomial_eur_call _\n(Up, Down, Interest, Stock, Exercise, _\nPeriods) + Exercise / Interest \u2227 Periods - Stock\n400 Chapter 16\nImplementing this in a spreadsheet, we get for the four-period example of\nsection 16.4:\nA B C\n1 VBA FUNCTIONS FOR CALLS AND PUTS\n2 Up, U 1.10\n3 Down, D 0.97\n4 Interest rate, R 1.06\n5 Initial stock price, S 50.00\n6 Option exercise price, X 50.00\n7 Number of periods, n 4\n8\n9 European call 10.4360<-- =binomial_eur_call(B2,B3,B4,B5,B6,B7)\n10 European put 0.0407<-- =binomial_eur_put(B2,B3,B4,B5,B6,B7)\n11\n12 Checking put-call parity\n13 Stock + put 50.0407<-- =B5+B10\n14 Call + PV(X) 50.0407<-- =B9+B6/B4^B7\nAmerican Put Pricing\nP roposition 2 in section 15.6 states that the price of an American call on a\nnon-dividend-paying stock is the same as that of a European option. The\npricing of an American put, however, can be different. The following VBA\nfunction below uses a binomial option pricing model like the one from section\n401 The Binomial Option Pricing Model\nFunction Binomial_amer_put(Up, Down, Interest, _\nStock, Exercise, Periods)\nq_up = (Interest - Down) / (Interest * _\n(Up - Down))\nq_down = 1 / Interest - q_up\nDim OptionReturnEnd() As Double\nDim OptionReturnMiddle() As Double\nReDim OptionReturnEnd(Periods + 1)\nFor State = 0 To Periods\nOptionReturnEnd(State) = Application.Max(Exercise _\n- Stock * Up \u2227 State * Down \u2227 (Periods - State), 0)\nNext State\nFor Index = Periods - 1 To 0 Step -1\nReDim OptionReturnMiddle(Index)\nFor State = 0 To Index\nOptionReturnMiddle(State) = Application.Max _\n(Exercise - Stock * Up \u2227 State * Down \u2227 _\n(Index - State), _\nq_down * OptionReturnEnd(State) + q_up * _\nOptionReturnEnd(State + 1))\nNext State\nReDim OptionReturnEnd(Index)\nFor State = 0 To Index\nOptionReturnEnd(State) = _\nOptionReturnMiddle(State)\nNext State\nNext Index\nBinomial_amer_put = OptionReturnMiddle(0)\n402 Chapter 16\nIn this function we use two arrays, called OptionReturnEnd and\nOptionReturnMiddle. At each date t , these arrays store the option values for\nthe date itself and the next date\u2014 t + 1.\nHere \u2019s an implementation in a spreadsheet, using the two-period, three-date,\nexample from section 16.5:\nA B C\n1 VBA FUNCTIONS FOR CALLS AND PUTS\n2 Up, U 1.10\n3 Down, D 0.97\n4 Interest rate, R 1.06\n5 Initial stock price, S 50.00\n6 Option exercise price, X 50.00\n7 Number of periods, n 2\n8\n9 American put 0.4354<-- =binomial_amer_put(B2,B3,B4,B5,B6,B7)\n10 European put 0.2490<-- =binomial_eur_put(B2,B3,B4,B5,B6,B7)\n11 American call 5.7492<-- =binomial_amer_call(B2,B3,B4,B5,B6,B7)\n12 European call 5.7492<-- =binomial_eur_call(B2,B3,B4,B5,B6,B7)\nT he values in cells B9 and B10 are for an American and a European put;\nthese values correspond to those given in section 16.5. In cell B11 we use a\nfunction similar to the American put function to price American calls. Unsur-\nprisingly\u2014given Proposition 2 of Chapter 15\u2014this function gives the same\nvalue as the binomial European call pricing function.\nThe VBA function works well for many more periods.3 In the example\nbelow we calculate the value of an American put and call for options\nwhich expire at T = 0.75 of a year. The stochastic process which defines\nthe stock returns has mean \u03bc = 15%, and standard deviation \u03c3 = 35%.\nThe annual continuously compounded interest rate is r = 6%, and each\nyear is divided into 25 subperiods, so that a single period has length\n\u0394 t = 1/25= 0.04. Given these numbers, Up, Down, and R are defined by\nU p=e\u03bc\u0394t+\u03c3 \u0394t,Down=e\u03bc\u0394t\u2212\u03c3 \u0394t,R=er\u0394t .\nHere is the pricing of an American and a European call and put:\n403 The Binomial Option Pricing Model\nA B C\nVBA FUNCTIONS FOR CALLS AND PUTS\nn divisions per year, Dt = 1/n\nUp=exp(m*Dt + s*sqrt(Dt)), Down = exp(m*Dt - s*sqrt(Dt))\n1\n2 Mean return per year, \u03bc 15%\n3 Standard deviation of annual return,\u03c3 35%\n4 Annualinterestrate,r 6%\n5\n6 Initialstockprice,S 50.00\n7 Option exercise price, X 50.00\n8 Option exercise date (years) 0.75\n9 Number of divisions of 1 year 25<-- each year divided into 25 subperiods\n10 \u0394t, the length of one division 0.04<-- =1/B9\n11 Up move per \u0394t 1.078963<-- =EXP(B2*B10+B3*SQRT(B10))\n12 Down move per \u0394t 0.938005<-- =EXP(B2*B10-B3*SQRT(B10))\n13 Interest rate per \u0394t 1.002403<-- =EXP(B4*B10)\n14\n15 Number of periods until maturity, n 19<-- =ROUND(B8*B9,0)\n16\n17 Americanput 5.1311<-- =binomial_amer_put(B11,B12,B13,B6,B7,B15)\n18 Europeanput 4.9213<-- =binomial_eur_put(B11,B12,B13,B6,B7,B15)\n19 Americancall 7.1501<-- =binomial_amer_call(B11,B12,B13,B6,B7,B15)\n20 Europeancall 7.1501<-- =binomial_eur_call(B11,B12,B13,B6,B7,B15)\nN otice that we have compromised on the number of periods, by using\nExcel \u2019 s Round function\u2014since there are 25 divisions of one year and the\noption \u2019 s maturity is T = 0.75, the actual number of periods to maturity is\n25*0.75, which is not a round number.\nThis procedure works well even for a very large number of periods. In the\nexample below, the option has a maturity T = 0.5, and the basic one-year period\nis divided into 400 subperiods. Excel easily computes the value of the\nAmerican put and call, even though a considerable amount of computation is\n404 Chapter 16\nA B C\nVBA FUNCTIONS FOR CALLS AND PUTS\nn divisions per year, \u0394t = 1/n\nUp=exp(\u03bc*\u0394t + \u03c3*sqrt(\u0394t)), Down = exp(\u03bc*\u0394t - \u03c3*sqrt(\u0394t))\n1\n2 Mean return per year, \u03bc 15%\n3 Standard deviation of annual return, \u03c3 35%\n4 Annualinterestrate,r 6%\n5\n6 Initialstockprice,S 50.00\n7 Option exercise price, X 50.00\n8 Option exercise date (years) 0.50\n9 Number of divisions of 1 year 400<-- each year divided into 400 subperiods\n10 \u0394t, the length of one division 0.0025<-- =1/B9\n11 Up move per \u0394t 1.018036<-- =EXP(B2*B10+B3*SQRT(B10))\n12 Down move per \u0394t 0.983021<-- =EXP(B2*B10-B3*SQRT(B10))\n13 Interest rate per \u0394t 1.00015<-- =EXP(B4*B10)\n14\n15 Number of periods until maturity, n 200<-- =ROUND(B8*B9,0)\n16\n17 Americanput 4.2882<-- =binomial_amer_put(B11,B12,B13,B6,B7,B15)\n18 Europeanput 4.1471<-- =binomial_eur_put(B11,B12,B13,B6,B7,B15)\n19 Americancall 5.6248<-- =binomial_amer_call(B11,B12,B13,B6,B7,B15)\n20 Europeancall 5.6248<-- =binomial_eur_call(B11,B12,B13,B6,B7,B15)"
        ],
        "16.7": [
            "What is the convergence of the binomial model in financial modeling?\nCan you explain how the up and down movements are approximated in financial models?\nWhat is the relationship between the binomial model and the Black-Scholes pricing formula?\nWhat is the Binomial Option Pricing Model and how is it used in financial modeling?\nWhat are some key parameters in the Black-Scholes and binomial pricing models?\nWhat is log-normality and how is it relevant to financial modeling?\nHow does the choice of subdivisions 'n' affect the results of the binomial model?\nWhat kind or returns does the binomial model typically result in?\nIn the context of financial modeling, what is meant by \"convergence\"?\nHow does one calculate the Up, U and Down, D in financial models?\nWhat is Sigma and how does it contribute to the riskiness of stock in financial modeling?\nExplain the relevance of Time to option exercise (T) in binomial pricing.\nWhat is the role of Annual interest rate (r) in the binomial option pricing model?\nCan you explain the concept of an alternative approximation to the lognormal in financial modeling?\nWhat is the significance of determining the current stock price (S) and option exercise price (X) in financial modeling?\nWhat happens as \u0394 t approaches 0 in the binomial option pricing model?\nWhat does it mean when the convergence of a parameterization to Black-Scholes is termed as 'less smooth'?\nWhat is the significance of mean return and standard deviation in financial models?\nIn a financial model, how does the number of subdivisions of Time affect the binomial European call and Black-Scholes call prices?\nWhat kind of approximation is guaranteed by the binomial model for option pricing formulas?",
            "16.7 Convergence of Binomial Pricing to the Black-Scholes Price\n\nIn this section we discuss the convergence of the binomial model to the Black-\nScholes pricing formula. The discussion assumes some understanding of log-\nnormality (discussed in Chapter 26) and the Black-Scholes option pricing\nformula discussed in Chapter 17. So you may want to skip this section and\ncome back to it later.\nW henever we consider a finite approximation to the option pricing formulas,\nwe have to use an approximation to the up and the down movements. One\nwidespread translation of the interest rate r and the stock \u2019 s volatility \u03c3 to an\n\u201cup\u201d or \u201cdown\u201d move necessary for the binomial model is:\n\u0394t=T/n R=er\u0394t\n405 The Binomial Option Pricing Model\nT his approximation guarantees that as \u0394 t \u2192 0 (i.e., asn \u2192 \u221e ) , the resulting\ndistribution of the stock returns approaches the lognormal distribution.4\nH ere\u2019 s an implementation of this methodology in a spreadsheet. The\nfunction B inomial_Eur_call is the same as that defined above; the function\nBSCall is the Black-Scholes formula and is defined and discussed in\nChapter 17:\nA B C\n1 BLACK-SCHOLES AND BINOMIAL PRICING\n2 S 60Current stock price\n3 X 50Option exercise price\n4 T 0.5000Time to option exercise (in years)\n5 r 8%Annual interest rate\n6 Sigma 30%Riskiness of stock\n7 n 20Number of subdivisions of T\n8\n9 \u0394t = T/n 0.0250<-- =B4/B7\n10 Up, U 1.0486<-- =EXP(B6*SQRT(B9))\n11 Down, D 0.9537<-- =EXP(-B6*SQRT(B9))\n12 Interest rate, R 1.0020<-- =EXP(B5*B9)\n13\n14 Binomial European call 12.8055<-- =binomial_eur_call(B10,B11,B12,B2,B3,B7)\n15 Black-Scholes call 12.8226<-- =BSCall(B2,B3,B4,B5,B6)\nT he binomial model gives a good approximation to the Black-Scholes (cells\nB14:B15). As the n gets larger, this approximation gets better, though the\nconvergence to the Black-Scholes price is not smooth:\n4 . A n alternative approximation which converges to a lognormal price process is given in the next\nsubsection. See also Omberg (1987), Hull (2006), and Benninga, Steinmetz, and Stroughair\n406 Chapter 16\nA B C D E F G H I J K\nBLACK-SCHOLES AND BINOMIAL PRICING:\n1 CONVERGENCE\n2 S 60Current stock price\n3 X 50Option exercise price\n4 T 0.5000Time to option exercise (in years)\n5 r 8%Annual interest rate\n6 Sigma 30%Riskiness of stock\n7 n 20Number of subdivisions of T\n8\n9 \u0394t = T/n 0.0250<-- =B4/B7\n10 Up, U 1.0486<-- =EXP(B6*SQRT(B9))\n11 Down, D 0.9537<-- =EXP(-B6*SQRT(B9))\n12 Interest rate, R 1.0020<-- =EXP(B5*B9)\n13\n14 Binomial European call 12.8055<-- =binomial_eur_call(B10,B11,B12,B2,B3,B7)\n15 Black-Scholes call 12.8226<-- =BSCall(B2,B3,B4,B5,B6)\n16\n17 Data table: Binomial price vs Black-Scholes\nn, number of\nBinomial Black-\nsubdivisions\n18 of T price Scholes price\n19 12.8055 12.8226<-- Data table headers\n20 10 12.8593 12.8226\n21 50 12.8108 12.8226 Convergence of Binomial to Black-Scholes\n22 75 12.8238 12.8226 12.87\n23 100 12.8255 12.8226\n24 125 12.8251 12.8226 12.86\n25 150 12.8240 12.8226 Binomial price\n26 175 12.8226 12.8226 12.85\n27 200 12.8205 12.8226 Black-Scholes price\n28 225 12.8204 12.8226\n12.84\n29 250 12.8230 12.8226\n30 275 12.8243 12.8226\n31 300 12.8243 12.8226 12.83\n32 325 12.8232 12.8226\n33 350 12.8210 12.8226 12.82\n34 375 12.8226 12.8226\n35 400 12.8238 12.8226 12.81\n36 425 12.8236 12.8226 n, number of subdivisions of T\n37 450 12.8221 12.8226 12.80\n38 475 12.8223 12.8226 0 50 100 150 200 250 300 350 400 450 500\n39 500 12.8236 12.8226\nAn Alternative Approximation to the Lognormal\nThe approximation of the first part of this section is not the only approximation\nwhich works. If the stock price is lognormally distributed with mean \u03bc and\nstandard deviation \u03c3 , we can also use the following approximation:\n\u0394t=T/n R=er\u0394t\nU =1+up=e\u03bc\u0394t+\u03c3 \u0394t D=1+down=e\u03bc\u0394t\u2212\u03c3 \u0394t\n407 The Binomial Option Pricing Model\nA B C D E F G H I J\nBLACK-SCHOLES AND BINOMIAL PRICING:\n1 U=exp(mDt + s*sqrt(Dt) ), D=exp(mDt - s*sqrt(Dt) )\n2 S 60Current stock price\n3 X 50Option exercise price\n4 T 0.5000Time to option exercise (in years)\n5 r 8%Annual interest rate\n6 Mean return, \u03bc 12%\n7 Sigma, \u03c3 30%Riskiness of stock\n8 n 20Number of subdivisions of T\n9\n10 \u0394t = T/n 0.0250<-- =B4/B8\n11 Up, U 1.0517<-- =EXP(B6*B10+B7*SQRT(B10))\n12 Down, D 0.9565<-- =EXP(B6*B10-B7*SQRT(B10))\n13 Interest rate, R 1.0020<-- =EXP(B5*B10)\n14\n15 Binomial European call 12.8388<-- =binomial_eur_call(B11,B12,B13,B2,B3,B8)\n16 Black-Scholes call 12.8226<-- =BSCall(B2,B3,B4,B5,B7)\n17\n18 Data table: Binomial price vs Black-Scholes\nn, number of\nBinomial Black-\nsubdivisions\n19 of T price Scholes price\n20 12.8388 12.8226<-- Data table headers\n21 10 12.8158 12.8226\n22 20 12.8388 12.8226 Convergence of Binomial to Black-Scholes\n23 60 12.8271 12.8226 12.840\n24 100 12.8237 12.8226\n25 125 12.8191 12.8226\n26 150 12.8162 12.8226 12.835\n27 175 12.8184 12.8226\nBinomial price\n28 200 12.8194 12.8226\n29 225 12.8196 12.8226 12.830 Black-Scholes price\n30 250 12.8192 12.8226\n31 275 12.8195 12.8226\n32 300 12.8210 12.8226 12.825\n33 325 12.8222 12.8226\n34 350 12.8230 12.8226\n35 375 12.8234 12.8226 12.820\n36 400 12.8233 12.8226\n37 425 12.8227 12.8226 n, number of subdivisions of T\n38 450 12.8216 12.8226 12.815\n39 475 12.8211 12.8226 0 50 100 150 200 250 300 350 400 450 500\n40 500 12.8225 12.8226\nT he convergence of this parameterization to Black-Scholes is somewhat less\nsmooth, though the ultimate result is the same. 5\n5. Note that both methods actually converge quite quickly\u2014within several dozen steps the bino-\n408 Chapter 16"
        ],
        "16.8": [
            "- What is an Employee Stock Option (ESO)?\n- Who typically gives an ESO and to whom is it generally given? \n- What factors does the value of an ESO depend upon?\n- What are special conditions typically associated with ESOs?\n- What is meant by a vesting period in an ESO?\n- What happens when an employee leaves a company before the end of the ESO's vesting period?\n- What is the typical exit rate in the context of ESOs?\n- What happens when an employee leaves the company after the vesting period?\n- What does it mean when we say that ESOs have exercise prices equal to the stock price on the date of issue?\n- What happens when the price of the stock is greater than some multiple m of the ESO\u2019s exercise price X?\n- How is the value of Employee Stock Option calculated using the Binomial Model?\n- According to the Hull and White (2004) model, under what condition an employee will choose to exercise her option?\n- What is the impact of the exit rate on the value of an ESO?\n- What is the American Financial Accounting Standards Board's (FASB) and the International Accounting Standards Board (IASB)'s stance on executive stock options pricing?\n- According to FASB 123, how should the value of options awarded be accounted for in a firm's net income?\n- What role does VBA code play in financial modeling, specifically in the Binomial Model for factoring Employee Stock Options?\n- What is a risk-neutral probability in the context of financial modelling?\n- What does the exit rate in the ESO model represent?\n- What does the Binomial Option Pricing Model suggest about the ideal time to exercise call options?\n- According to the Hull-White model, how does an employee's exit rate impact ESO valuation?\n- How does the vesting period impact an employee's decision to exercise an ESO?\n- How does the value of an ESO change when the stock price is greater than the desired multiple m of the exercise price?\n- What does early ESO exercise suggest about its optimization strategy?\n- How does the exit rate affect the value of employee stock options as per the ESO value sensitivity analysis?\n- What does the employee turnover mean in terms of ESO valuation?\n- How does increasing the multiple of the option exercise price alter the value of the ESO?",
            "16.8 Using the Binomial Model to Price Employee Stock Options6\n\nA n employee stock option (ESO) is a call option given by a company to its\nemployees as part of their remuneration package. Like all call options, the\nvalue of an ESO depends on the current price of the stock, the option \u2019 s exercise\nprice, and the time until exercise. However, ESOs typically have several\nspecial conditions:\n\u2022 T he option has a vesting period. During this period, the employee is not\nallowed to exercise the option. An employee leaving the company before the\nvesting period forfeits his option. In the model of this section we assume that\na typical employee of the company leaves at exit rate e per year.\n\u2022 A n employee leaving the company after the vesting period is forced to\nimmediately exercise his option.\n\u2022 For tax reasons, almost all ESOs have exercise prices equal to the stock price\non the date of issue.\nIn the model below, adapted from a paper by Hull and White (2004), we\nassume that an employee will choose to exercise her option when the price of\nthe stock is greater than some multiple m of the ESO \u2019 s exercise price X. We\nfirst present the model \u2019 s implementation and results and then discuss the VBA\nprogram, which gives us these results:\nA B C\nA BINOMIAL EMPLOYEE STOCK OPTION PRICING MODEL\n1 Based on Hull-White (2004)\n2 S 50Currentstockprice\n3 X 50Optionexerciseprice\n4 T 10.00Timetooptionexercise(inyears)\n5 Vesting period (years) 3.00\n6 Interest 5.00%Annualinterestrate\n7 Sigma 35%Riskinessofstock\n8 Stock dividend rate 2.50%Annual dividend rate on stock\n9 Exitrate,e 10.00%\n10 Option exercise multiple, m 3.00\n11 n 50Numberofsubdivisionsofoneyear\n12\n13 Employee stock option value 13.56<-- =ESO(B2,B3,B4,B5,B6,B7,B8,B9,B10,B11)\n14 Black-Scholes call 19.18<-- =BSCall(B2*EXP(-B8*B4),B3,B4,B6,B7)\n6. This section has benefited from discussions with Torben Voetmann of Brattle Group and Zvi\n409 The Binomial Option Pricing Model\nThe ESO function in cell B13 depends on the 10 variables listed in cells\nB2:B11. The screen for this function looks like:\nIn the example above, the employee stock option is given when the stock\nprice is $50. The ESO has exercise price X = $50. The option has a 10-year\nmaturity and a 3-year vesting period. The interest rate is 5% annually, and the\nstock pays an annual dividend of 2.5% of its stock value. The rate at which\nemployees leave the company is 10% per year. The model assumes that after\nthe vesting period, the employee will choose to exercise his option if the stock\nprice is three times or more the option\u2019 s exercise price. 7 The binomial model\nwith which the computations in cell B13 were done divides each year into 50\nsubdivisions.\nGiven these assumptions, the employee stock option is valued at $13.56\n(cell B13). A comparable Black-Scholes option on a dividend-paying stock\nwould be valued at $19.18.8\nThe ESO Valuation and FASB 123\nT he American Financial Accounting Standards Board (FASB) and the Inter-\nnational Accounting Standards Board (IASB) agree that executive stock\noptions should be priced using a model of the type explored above, and that\nthe value of options awarded should be accounted for in a firm\u2019 s net income.\nIf, for example, a firm had issued 1 million options of the type which appear\nin the previous spreadsheet, we would value these options at $13,564,600.\n7. Research cited by Hull and White (2004) shows that the average stock-price-to-exercise-price\nratio at which ESO owners exercise their options is between 2.2 and 2.8.\n8 . W e\u2019 r e getting way ahead of ourselves here! The adaptation of Black-Scholes for dividend-\n410 Chapter 16\nThe VBA Code for the ESO Model\nBelow we give the VBA code for this model. A short discussion follows\nthe code.\nFunction ESO(Stock As Double, X As Double, T As _\nDouble, Vest As Double, Interest As Double, _\nSigma As Double, Divrate As Double, _\nExitrate As Double, Multiple As Double, _\nn As Single)\nDim Up As Double, Down As Double, _\nR As Double, Div As Double, _\npiUp As Double, piDown As Double, _\nDelta As Double, i As Integer, j As Integer\nReDim Opt(T * n, T * n)\nReDim S(T * n, T * n)\nUp = Exp(Sigma * Sqr(1 / n))\nDown = Exp(-Sigma * Sqr(1 / n))\nR = Exp(Interest / n)\nDiv = Exp(-Divrate / n)\n\u2018Risk-neutral Up and Down probabilities\npiUp = (R * Div - Down) / (Up - Down)\npiDown = (Up - R * Div) / (Up - Down)\n\u2019 Defi ning the stock price\n\u2018j is the number of Up steps\nFor i = 0 To T * n\nFor j = 0 To i\nS(i, j) = Stock * Up \u2227 j _\n* Down \u2227 (i - j)\nNext j\n411 The Binomial Option Pricing Model\n\u2018Option value on the last nodes of tree\nFor i = 0 To T * n\nOpt(T * n, i) = _\nApplication.Max(S(T * n, i) - X, 0)\nNext i\n\u2018Early exercise when stock price > multiple\n\u2018 * exercise after vesting\nFor i = T * n - 1 To 0 Step -1\nFor j = 0 To i\nIf i > Vest * n And S(i, j) > = Multiple * X _\nThen Opt(i, j) = Application.Max(S(i, j) - X, 0)\nIf i > Vest * n And S(i, j) < Multiple * X _\nThen Opt(i, j) = ((1 - Exitrate / n) * _\n(piUp * Opt(i + 1, j + 1) + piDown * _\nOpt(i + 1, j)) / R + Exitrate / n * _\nApplication.Max(S(i, j) - X, 0))\nIf i < = Vest * n Then Opt(i, j) = _\n(1 - Exitrate / n) * (piUp * _\nOpt(i + 1, j + 1) + piDown * Opt(i + 1, j)) / R\nNext j\nNext i\nESO = Opt(0, 0)\n412 Chapter 16\nExplaining the VBA code9\nThe VBA code has several parts. The first part defines the variables, adjusting\nthe Up, Down, and 1 plus interest R for the n divisions of each year. Having\nmade this adjustment, the code defines the risk-neutral probabilities \u03c0 and\nUp\n\u03c0 :\nDown\nUp = Exp(Sigma * Sqr(1 / n))\nDown = Exp(-Sigma * Sqr(1 / n))\nR = Exp(Interest / n)\nDiv = Exp(-Divrate / n)\n\u2018Risk-neutral Up and Down probabilities\npiUp = (R * Div - Down) / (Up - Down)\npiDown = (Up - R * Div) / (Up - Down)\nT he stock price is defined as an array S ( i , j) , where i defines the periods, i\n= 0, 1, \u2026 , T * n , and j defines the number of Up steps at each period, j = 0, 1,\n\u2026 , i . The next part of the code defines the stock price.\n\u2018Defi ning the stock price\n\u2018j is the number of Up steps\nFor i = 0 To T * n\nFor j = 0 To i\nS(i, j) = Stock * Up \u2227 j _\n* Down \u2227 (i - j)\nNext j\nNext i\n9. This subsection is tedious and can be skipped. But take a look at the next subsection, where\n413 The Binomial Option Pricing Model\nT he option values are defined in the next piece of code, which is the heart\nof our employee stock option function. Option value is defined as an array\nOpt( i , j ):\n\u2018Option value on the last nodes of tree\nFor i = 0 To T * n\nOpt(T * n, i) = _\nApplication.Max(S(T * n, i) - X, 0)\nNext i\n\u2018Early exercise when stock price > multiple\n\u2018 * exercise after vesting\nFor i = T * n - 1 To 0 Step -1\nFor j = 0 To i\nIf i > Vest * n And S(i, j) > = Multiple * X _\nThen Opt(i, j) = Application.Max(S(i, j) - X, 0)\nIf i > Vest * n And S(i, j) < Multiple * X _\nThen Opt(i, j) = ((1 - Exitrate / n) * _\n(piUp * Opt(i + 1, j + 1) + piDown * _\nOpt(i + 1, j)) / R + Exitrate / n * _\nApplication.Max(S(i, j) - X, 0))\nIf i < = Vest * n Then Opt(i, j) = _\n(1 - Exitrate / n) * (piUp * _\nOpt(i + 1, j + 1) + piDown * Opt(i + 1, j)) / R\nNext j\n414 Chapter 16\nHere \u2019 s what this piece of code says:\n\u23a7max[S(T\u2217n, j)\u2212X,0] Terminalnodes\n\u23aa\nAfterrvesting,\n\u23aa max[S(i, j)\u2212X,0]\n\u23aa S(i, j)\u2265m\u2217X\n\u23aa\n\u23aa\n\u03c0 UpOpt(i+1, j+1)\n\u23aa +\u03c0 Optt(i+1, j) Aftervesting,\nOpt(i, j)=\u23a8(1\u2212Exitrate/n)\u2217 Down\n\u23aa R S(i, j)<m\u2217X\n\u23aa +Exitrate/n\u2217max((\nS(i,\nj)\u2212X,0)\n\u23aa\n\u23aa \u03c0 Opt(i+1,j+1)\nUp\n\u23aa\n+\u03c0 Opt(i+1,j)\n\u23aa (1\u2212Exitrate/n)\u2217 Down Beforevessting\n\u23a9\nR\nAt the terminal nodes, we simply exercise the option. Before the terminal\nnodes and after vesting, we check to see if the stock price is greater than the\ndesired multiple m of the exercise price. If it is, we exercise the option. If\nS ( i , j ) < m * X, then the ESO\u2019 s payoff depends on whether the employee exits\nthe firm or not. With a probability (1 \u2212 Exitrate / n ) the employee does not\nexit the firm, in which case the option payoff is the discounted expected next\nperiod payoff:\n\u03c0 Opt(i+1, j+1)+\u03c0 Opt(i+1, j)\n(1\u2212Exitrate/n)\u2217 Up Down\nR\nOn the other hand, if the employee exits the firm and the vesting period has\npassed, he will try to see if he can exercise the option, giving the expected\npayoff:\nExitrate/n\u2217max[ S(\ni,\nj)\u2212X,0]\nF inally, before vesting, the ESO is simply worth the expected discounted\n(by the risk-neutral probabilities) payoff of the next period values:\n\u03c0 Opt(i+1,j+1)+\u03c0 Opt(i+1,j)\n(1\u2212Exitrate/n)\u2217 Up Down\nR\nT he final step in the code is to define the value of the function ESO:\n415 The Binomial Option Pricing Model\nSome Sensitivity Analysis\nWe can use data tables to perform sensitivity analysis on our ESO function.\nA B C D E F\nESO FUNCTION SENSITIVITY TO NUMBER OF SUBDIVISIONS n OF ONE YEAR\n1\n2 S 50Current stock price\n3 X 50Option exercise price\n4 T 10.0000Time to option exercise (in years)\n5 Vesting period (years) 3.00\n6 Interest 5.00%Annual interest rate\n7 Sigma 35%Riskiness of stock\n8 Stock dividend rate 2.50%Annual dividend rate on stock\n9 Exit rate, e 10.00%\n10 Option exercise multiple, m 3.00\n11 n 25Number of subdivisions of one year\n12\n13 Employee stock option value 13.5275<-- =ESO(B2,B3,B4,B5,B6,B7,B8,B9,B10,B11)\n14 Black-Scholes call 19.1842<-- =BSCall(B2*EXP(-B8*B4),B3,B4,B6,B7)\n15\n16 Sensitivity of ESO value to number of subdivisions n\n17 n 13.5275 <-- =B13, data table header\n18 2 12.8213\n19 5 13.2870 13.60\n20 10 13.4312\n21 25 13.5275 13.50\n22 50 13.5646 13.40\n23 75 13.5733\n24 100 13.5753 13.30\n25 200 13.5810\n26 13.20\n27 13.10\n28\n29 13.00\n30\n12.90\n31\n32 12.80\n33 0 25 50 75 100 125 150 175 200\n34\n35\nOSE\nSubdivisions, n\nThe graph gives ample evidence that n = 25 or 50 and does well enough for\nvaluing ESOs. Since larger values of n become time consuming, we recom-\nmend lower numbers.\nIn the graph below, we show the sensitivity of the ESO value to the employee\n416 Chapter 16\nA B C D E F\nESO FUNCTION SENSITIVITY TO EMPLOYEE EXIT RATE e\n1\n2 S 50Current stock price\n3 X 50Option exercise price\n4 T 10.0000Time to option exercise (in years)\n5 Vesting period (years) 3.00\n6 Interest 5.00%Annual interest rate\n7 Sigma 35%Riskiness of stock\n8 Stock dividend rate 2.50%Annual dividend rate on stock\n9 Exit rate, e 10.00%\n10 Option exercise multiple, m 3.00\n11 n 50Number of subdivisions of one year\n12\n13 Employee stock option value 13.5646<-- =ESO(B2,B3,B4,B5,B6,B7,B8,B9,B10,B11)\n14 Black-Scholes call 19.1842<-- =BSCall(B2*EXP(-B8*B4),B3,B4,B6,B7)\n15\n16 Sensitivity of ESO value to exit rate e\n17 Exit rate, e 13.5646 <-- =B13, data table header\n18 0% 20.1732\n19 1% 19.3621 21.00\n20 3% 17.8536\n20.00\n21 5% 16.4828\n22 7% 15.2347 19.00\n23 9% 14.0963\n18.00\n24 11% 13.0561\n25 13% 12.1039 17.00\n26 16.00\n27\n28 15.00\n29 14.00\n30\n31 13.00\n32 12.00\n33 0% 2% 4% 6% 8% 10% 12%\n34\n35\nThe exit rate has a major effect on the value of the ESO: the higher the\nturnover of employees, the lower the value of the employee stock options.\nIn terms of FASB 123 valuation, the exit rate e is an important valuation\nfactor.\nFinally we do a sensitivity of the ESO value on the exit multiple m . Recall\nthat the Hull-White model assumes that an employee holding an ESO exercises\nher option when the stock price is a multiple m of the option exercise price X .\nBasically this locks the employee into a suboptimal strategy, since in general\ncall options should be held to maturity (though note that in this case the\noption is written on a stock which pays a dividend, which may in some cases\nmake early exercise optimal). In the example below, we clearly see the sub-\noptimality of early ESO exercise: the higher the multiple m , the higher the\nvalue of the ESO.\nOSE\n417 The Binomial Option Pricing Model\nA B C D E F\nESO FUNCTION SENSITIVITY TO OPTION EXERCISE MULTIPLE m\n1\n2 S 50Current stock price\n3 X 50Option exercise price\n4 T 10.0000Time to option exercise (in years)\n5 Vesting period (years) 3.00\n6 Interest 5.00%Annual interest rate\n7 Sigma 35%Riskiness of stock\n8 Stock dividend rate 2.50%Annual dividend rate on stock\n9 Exit rate, e 10.00%\n10 Option exercise multiple, m 3.00\n11 n 25Number of subdivisions of one year\n12\n13 Employee stock option value 13.5275<-- =ESO(B2,B3,B4,B5,B6,B7,B8,B9,B10,B11)\n14 Black-Scholes call 19.1842<-- =BSCall(B2*EXP(-B8*B4),B3,B4,B6,B7)\n15\n16 Sensitivity of ESO value to multiple m\n17 m 13.5275 <-- =B13, data table header\n18 1.0 9.1758\n19 1.3 11.1610\n20 1.6 12.2760 14\n21 1.9 12.9793\n22 2.2 13.2735\n13\n23 2.5 13.4467\n24 2.8 13.4985\n25 3.1 13.5423 12\n26\n27\n28 11\n29\n30\n10\n31\n32\n33 9\n34 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0\n35\nLast But Not Least\nThe Hull-White model is a numerical approximation of the ESO option valu-\nation, but it is not a closed-form formula. A recent paper by Cvitani\u0107 , Wiener,\nand Zapatero (2006) gives an analytical derivation of the value of employee\nstock options. The formula stretches over 16 pages of typescript and will not\nbe given here. An Excel implementation of the formula exists and can be\ndownloaded at http://pluto.mscc.huji.ac.il/\u223c mswiener/research/ESO.htm ."
        ],
        "16.9": [
            "What is the binomial option pricing model?\nHow can the binomial model be used to price non-standard options?\nCould you explain how an American option with three separate exercise prices can be valued using a binomial framework?\nWhat does it mean for an option to allow for early exercise and what impact might this have on its price?\nHow does the exercise price of an option vary with time according to the Binomial Model?\nWhat is meant by the 'exercise date' of an option?\nCould you explain the relationship between exercise dates and exercise prices in the context of non-standard options?\nHow does the concept of an American option factor into modelling the price of non-standard options?\nHow is a binomial process used to describe the stock price over time?\nCan you illustrate the valuation of American options under the binomial model?\nWhat does it mean for an option to be worth more when exercised rather than held?\nHow can American call option values be calculated using the binomial model?",
            "16.9 Using the Binomial Model to Price Non-Standard Options: An Example\n\nT he binomial model can also be used to price non-standard options. Consider\nthe following example: You hold an option to buy a share of a company. The\nOSE\nSensitivity of Hull-White Valuation\nto Exercise Multiple m\n418 Chapter 16\noption allows for early exercise, but the exercise price varies with the time at\nwhich you choose to exercise. For the case we consider, the option has the\nfollowing conditions:\n\u2022 There are n possible exercise dates o nly (i.e., the option is only exercisable\non these dates).\n\u2022 Exercise at date t precludes exercise at all dates s > t . However, if you don \u2019 t\nexercise at date s , you may still exercise at date t > s .\n\u2022 The exercise price at date t is X , meaning that the exercise price can\nt\nvary with time.\nW e want to value this option using a binomial framework. To do so, we\nrecognize that basically this is just an American option with three separate\nexercise prices.\nHere \u2019 s how we set this problem up in a spreadsheet, using the logic of the\nAmerican option valuation described in section 16.5:\nA B C D E F G H I\n1 TIME-DEPENDENT EXERCISE PRICES\n2 Initial stock price 100 Exercise prices\n3 Up 10% Date 1 100\n4 Down -5% Date 2 105\n5 Interest rate 6% Date 3 112\n6\n7 State prices\n8 qu 0.6918<-- =(B5-B4)/((1+B5)*(B3-B4))\n9 qd 0.2516<-- =(B3-B5)/((1+B5)*(B3-B4))\n10\n11 Check\n12 1/(qu+qd) 1.06<-- =1/(B8+B9)\n13 qu*(1+up)+qd*(1+down) 1<-- =B8*(1+B3)+B9*(1+B4)\n14\n15 Stock price 133.100\n16 121.000\n17 110.000 114.950\n18 100.000 104.500\n19 95.000 99.275\n20 90.250\n21 85.738\n22 =MAX(qU*H25+qD*H27,MAX(F16-E4,0))\n23 Date 0 Date 1 Date 2 Date 3\n24\n25 Value at each node 21.100<-- =MAX(H16-E6,0)\n26 16.000\n27 11.583 2.950<-- =MAX(H18-E6,0)\n28 8.368 2.041\n29 1.412 0.000\n30 0.000\n31 =MAX(qU*F28+qD*F30,MAX(D19-E3,0)) 0.000\n32\n33 Early exercise?\n34 yes\n35 no\n36 no =IF(qU*H25+qD*H27>=\n37 no MAX(F16-E4,0),\"no\",\"yes\")\n38 no\n419 The Binomial Option Pricing Model\nM ost of this spreadsheet follows section 16.5. Cells B15:H21 describe the\nstock price over time, which follows a binomial process with the \u201cUp\u201d = 1.10\nand \u201cDown\u201d = 0.95 (cells B3 and B4). Where things get interesting is in the\nvaluation:\nA B C D E F G H I\n22 =MAX(qU*H25+qD*H27,MAX(F16-E4,0))\n23 Date 0 Date 1 Date 2 Date 3\n24\n25 Value at each node 21.100<-- =MAX(H16-E6,0)\n26 16.000\n27 11.583 2.950<-- =MAX(H18-E6,0)\n28 8.368 2.041\n29 1.412 0.000\n30 0.000\n31 =MAX(qU*F28+qD*F30,MAX(D19-E3,0)) 0.000\n32\nA s is usual for an American option, at each node of the tree, we consider\nwhether the option is worth more whether exercised or whether held. But note\nthat in the above picture, the exercise price varies with the date, so that the\nexercise price at date 3 is E5, that of date 2 is E4, and that of date 1 is E3.\nA s you can see in cell B28, the value of the American call option is 8.368."
        ],
        "16.10": [
            "What is the binomial model in finance?\nHow is the binomial model implemented in financial modelling?\nWhat is the Black-Scholes pricing model?\nHow can the binomial model be put into a spreadsheet and programmed?\nWhat are the basic uses of the binomial model?\nHow is the binomial model used to price American and other non-standard options?\nWhat are employee stock options?\nWhat is the Hull-White (2004) model used for in financial modelling?\nHow does the Hull-White (2004) model value employee stock options?\nWhat is the role of state prices in implementing the binomial model?",
            "16.10 Summary\n\nT he binomial model is intuitive and easy to implement. As a widespread\nalternative to Black-Scholes pricing, the model can easily be put into a spread-\nsheet and programmed in VBA. This chapter has explored both the basic uses\nof the binomial model and its implementation to price American and other\nnon-standard options. A section on employee stock options has shown how to\nimplement the Hull-White (2004) model for valuing these options. Through-\nout, we have laid special stress on the role of state prices in implementing the\nmodel."
        ]
    },
    "17": {
        "17.1": [
            "What is the Black-Scholes model?\nWho published the Black-Scholes model?\nIn which year was the Black-Scholes model published?\nWhat type of options does the Black-Scholes model price?\nWhat does the Black-Scholes model imply about the price of more complex options?\nWhat mathematical concepts are required to fully understand the Black-Scholes model?\nHow can the Black-Scholes model be implemented in Excel?\nWhat are some potential applications of the Black-Scholes formula in valuing structured assets?\nWhy is the Black-Scholes model often considered an adequate approximation for more complex options pricing?\nHow does the Black-Scholes model approach the pricing of European call and put options on non-dividend-paying stocks?\nWhat is the prominence of the Black-Scholes model in modern finance?\nWhy is the Black-Scholes formula considered relatively easy to use?\nWhat is the role of stochastic processes in the full-blown development of the Black-Scholes model?",
            "17.1 Overview\n\nIn a path-breaking paper published in 1973, Fischer Black and Myron Scholes\nproved a formula for pricing European call and put options on non-dividend-\npaying stocks. Their model is probably the most famous model of modern\nfinance. The Black-Scholes formula is relatively easy to use, and it is often an\nadequate approximation to the price of more complicated options. I n this\nchapter we make no pretense at a full-blown development of the model; this\nrequires a knowledge of stochastic processes, and a not-inconsiderable math-\nematical investment. Instead, we shall describe the mechanics of the model\nand show how to implement it in Excel. We also illustrate several uses of the\nBlack-Scholes formula in the valuation of structured assets."
        ],
        "17.2": [
            "What is the Black-Scholes model?\nWhat are the elements involved in the Black-Scholes model formula for pricing European calls on a stock? \nWhat is a lognormally distributed stock price in terms of the Black-Scholes model?\nWhat does the symbol 'C' signify in the Black-Scholes model?\nWhat does the symbol 'S' represent in the Black-Scholes model?\nWhat does 'X' stand for in the Black-Scholes model?\nCan you explain the significance of 'T' in the Black-Scholes model?\nWhat does 'r' denote in the Black-Scholes model?\nWhat is the importance of \u2018\u03c3\u2019 in the Black-Scholes model?\nWhat does N() function denote in the Black-Scholes formula?\nWhat is the implication of the stock paying no dividends before date T in the Black-Scholes model?\nWhat is the put-call parity theorem in financial modeling?\nWhat is the Black-Scholes European put pricing formula?\nHow does the Black-Scholes formula align with the binomial option pricing model formula?\nWhat factors are assumed to contribute when implementing the Black-Scholes Formulas in a spreadsheet?\nHow does one calculate the price of a call option using the Black-Scholes formula in a spreadsheet?\nWhat parameters are taken into account when calculating the price of a call option using a spreadsheet?\nWhy is the put price calculated twice in the Black-Scholes model?\nWhat is the purpose of a sensitivity analysis in financial modeling using Black-Scholes Model?\nWhat happens to the Black-Scholes value of the call when the stock price varies?",
            "17.2 The Black-Scholes Model\n\nConsider a stock whose price is lognormally distributed.1 The Black-Scholes\nmodel uses the following formula to price European calls on a stock:\nC=SN(d )\u2212Xe\u2212rTN(d )\n1 2\nwhere\nln(S/X)+(r+\u03c32 2)T\nd =\n1 \u03c3 T\nd =d \u2212\u03c3 T\n2 1\nHere C denotes the price of a call, S is the price of the underlying stock, X\nis the exercise price of the call, T is the call \u2019 s time to exercise, r is the interest\nrate, and \u03c3 is the standard deviation of the logarithm of the stock \u2019 s return.\nN( ) denotes a value of the standard normal distribution. It is assumed that the\nstock will pay no dividends before date T .\nB y the put-call parity theorem (see Chapter 15), a put with the same exercise\ndate T and exercise price X written on the same stock will have price P = C\n\u2212 S + X \u2212e rT . Substituting for C in this equation and doing some algebra gives\nthe Black-Scholes European put pricing formula:\n1 . T he lognormal distribution is discussed in Chapter 26 though for purposes of applying the\n426 Chapter 17\nP=Xe\u2212rTN(\u2212d )\u2212SN(\u2212d )\n2 1\nIn Chapter 16 we hinted at one form of the proof of the Black-Scholes\nformula. There it was shown numerically that the Black-Scholes formula\ncoincides with the binomial option pricing model formula when (i) the length\nof a typical period \u2192 0, (ii) the \u201cUp\u201d and the \u201cDown\u201d moves in the binomial\nmodel converge to a lognormal price process, and (iii) the term structure of\ninterest rates is flat.\nImplementing the Black-Scholes Formulas in a Spreadsheet\nThe Black-Scholes formulas for call and put pricing are easily implemented\nin a spreadsheet. The following example shows how to calculate the price of\na call option written on a stock whose current price S = 50, when the exercise\nprice X = 45, the annualized interest rate r = 4%, and \u03c3 = 30%. The option\nhas T = 0.75 years to exercise. All three of the parameters T , r, and \u03c3 are\nassumed to be in annual terms.2\nA B C\n1 BLACK-SCHOLES OPTION PRICING FORMULA\n2 S 50 Current stock price\n3 X 45 Exercise price\n4 r 4.00% Risk-free rate of interest\n5 T 0.75 Time to maturity of option (in years)\n6 Sigma 30% Stock volatility, \u03c3\n7\n8 d 0.6509 <-- (LN(S/X)+(r+0.5*sigma^2)*T)/(sigma*SQRT(T))\n1\n9 d 0.3911 <-- d -sigma*SQRT(T)\n2 1\n10\n11 N(d ) 0.7424 <-- Uses formula NormSDist(d)\n1 1\n12 N(d ) 0.6521 <-- Uses formula NormSDist(d)\n2 2\n13\n14 Call price 8.64 <-- S*N(d )-X*exp(-r*T)*N(d )\n1 2\n15 Put price 2.31 <-- call price - S + X*Exp(-r*T): by Put-Call parity\n16 2.31 <-- X*exp(-r*T)*N(-d 2) - S*N(-d 1): direct formula\n2. Section 26.7 in Chapter 26 discusses how to calculate the annualized \u03c3 of the lognormal\n427 The Black-Scholes Model\nT he spreadsheet calculates the put price twice: In cell B15 the put price is\ncomputed by using put-call parity, and in cell B16 it is calculated by using the\ndirect Black-Scholes formula.\nW e can use this spreadsheet to do the usual sensitivity analysis. For example,\nthe following D ata|Table (see Chapter 31) gives\u2014as the stock price S varies\u2014\nthe Black-Scholes value of the call compared to its intrinsic value [i.e., max(S\n\u2212 X, 0)].\nC D E F G H I J K L M N\nData table: Comparing\nData table header:\nthe Black-Scholes =Max(B2-B3,0).\n18 to the intrinsic value This is the option's\nStock Call Intrinsic intrinsic value.\n19 price price value\n20 Data table header: = B14 8.6434 5\n21 5 0.0000 0 Black-ScholesPriceVersusIntrinsicValue\n22 10 0.0000 0\n23 15 0.0000 0 40\n24 20 0.0029 0 35\n25 25 0.0484 0 30\n26 30 0.3101 0\n25\n27 35 1.1077 0\n28 40 2.7319 0 20\n29 45 5.2777 0 15\n30 50 8.6434 5 10\n31 55 12.6307 10 5\n32 60 17.0378 15 0\n33 65 21.7056 20 0 10 20 30 40 50 60 70 80\n34 70 26.5256 25\n35 75 31.4304 30 Callprice Intrinsicvalue\n36 80 36.3811 35"
        ],
        "17.3": [
            "What is the Black-Scholes Pricing Function and how can it be implemented with Visual Basic for Applications (VBA) in Excel?\nWhat is the role of the dOne Function in the Black-Scholes Pricing model in VBA?\nCan you explain the function of dTwo in the Black-Scholes model implemented via VBA?\nWhat is the purpose of BSCall Function in the Black-Scholes model implemented in Excel through VBA?\nWhat is put-call parity theorem and how is it used in Black-Scholes model?\nIn the Black-Scholes model, how do you define a BSPut function in VBA?\nWhen and why would you use Excel function NormSDist in the Black-Scholes Pricing model?\nWhat is the difference between the old and new versions of the Excel function NormSDist and when to use which version?\nHow is the data table feature used in Excel to create graphs for Black-Scholes model?\nWhat parameters do functions dOne, dTwo, BSCall, and BSPut take in Black-Scholes model?",
            "17.3 Using VBA to Define a Black-Scholes Pricing Function\n\nA lthough the spreadsheet implementation of the Black-Scholes formulas illus-\ntrated in the previous section is sufficient for some purposes, we are sometimes\ninterested in having a closed form function which we can use directly in Excel.\nWe can do so with Visual Basic for Applications. Below we define functions\n428 Chapter 17\nFunction dOne(Stock, Exercise, Time, _\nInterest, sigma)\ndOne = (Log(Stock / Exercise) + _\nInterest * Time) / (sigma * Sqr(Time)) _\n+ 0.5 * sigma * Sqr(Time)\nEnd Function\nFunction dTwo(Stock, Exercise, Time, _\nInterest, sigma)\ndTwo = dOne(Stock, Exercise, Time, _\nInterest, sigma) - sigma * Sqr(Time)\nEnd Function\nFunction BSCall(Stock, Exercise, Time, _\nInterest, sigma)\nBSCall = Stock * Application.NormSDist _\n(dOne(Stock, Exercise, Time, Interest, _\nsigma)) - Exercise * Exp(-Time * Interest) * _\nApplication.NormSDist(dTwo(Stock, Exercise, _\nTime, Interest, sigma))\nEnd Function\nNote the use of the Excel function N ormSDist , which gives the standard\nnormal distribution.3\n3. We could have used the newer version of this function, N orm.S.Dist(x,TRUE or FALSE).\nTRUE gives the cumulative distribution, whereas FALSE gives the probability density. It\nseems simpler to use the old version of this function, NormSDist , which gives the cumulative\n429 The Black-Scholes Model\nPricing Puts\nBy the put-call parity theorem we know that a put is priced by the formula\nP = C \u2212 S + \u2212 r XT .e W e can implement this in another VBA function, BSPut :\nFunction BSPut(Stock, Exercise, Time, _\nInterest, sigma)\nBSPut = BSCall(Stock, Exercise, Time, _\nInterest, sigma) + Exercise * _\nExp(-Interest * Time) - Stock\nEnd Function\nUsing These Functions in an Excel Spreadsheet\nHere \u2019 s an example of these functions used in Excel. The graph was created by\na data table (in presentations, we usually hide the first row of such a table;\nhere we have shown it).\nA B C D E F G\n1 BLACK-SCHOLES MODEL IN VBA\n2 S 100 =B9\n3 X 100 =B8 Stock price Call Put\n4 T 1.00 20.3185 10.8022<--This is the header of the Data Table\n5 Interest 10.00% 40 0.1802 50.6639\n6 Sigma 40.00% 45 0.4104 45.8941\n7 50 0.8081 41.2918\n8 Call price 20.3185<-- =BSCall(B2,B3,B4,B5,B6) 55 1.4241 36.9079\n9 Put price 10.8022<-- =BSPut(B2,B3,B4,B5,B6) 60 2.3019 32.7857\n10 65 3.4739 28.9576\n11 Call and 7P0ut Prices4 .i9n6 0V0BA25.4437\n12 To the right is a data 75 6.7683 22.2520\n13 table that gives the 60 80 8.8965 19.3803\n14 call and put values for 50 85 11.3341 16.8179\n15 various stock 40 90 14.0645 14.5482\n16 prices. 95 17.0669 12.5506\n17 30 100 20.3185 10.8022\n18 20 105 23.7954 9.2791\n19 10 110 27.4740 7.9578\n20 115 31.3316 6.8154\n21 0 120 35.3469 5.8306\n40 50 60 70 80 90 100 110 120 130\n22 125 39.5002 4.9839\n23 1S3t0ock price,4 S3.7736 4.2574\n24\n25 Call Put\n430 Chapter 17"
        ],
        "17.4": [
            "What parameters does the Black-Scholes formula depend upon?\nWhat are the common methods of calculating sigma in financial modeling?\nHow is the historical return of a stock used to compute volatility in the Black-Scholes model?\nWhat time frame and frequency of returns are typically used in computation of volatility?\nHow is the volatility annualized from the periodic volatility?\nHow does the number of transaction dates per year impact the computation of volatility?\nWhat is implied volatility and how does it compare with historical volatility?\nHow is implied volatility used in the Black-Scholes formula?\nWhat is the significance of forward-looking versus backward-looking volatility?\nHow is implied volatility computed for options in the Black-Scholes model?\nWhat is the relationship between the implied volatility and the current market price of an option?\nHow are the functions CallVolatility and PutVolatility used in the Black-Scholes formula?\nWhat is the role of option's time to maturity in the calculation of implied volatility?\nHow is the historical volatility used in the pricing of options?\nHow the Black-Scholes model with full year's historical volatility performs in the pricing of call options?\nWhat is At-the-Money options and how it is priced in the Black-Scholes model?\nWhich method between historical and implied volatility is better for pricing options?\nHow do historical returns and implied volatility work in predicting future anticipated returns?\nHow does implied volatility indicate the current market thinking?\nWhen should one use both historical returns and implied volatility in financial modeling?",
            "17.4 Calculating the Volatility\n\nThe Black-Scholes formula depends on five parameters: the stock price S , the\noption exercise price X , the option\u2019 s time to maturity T, the interest rate r , and\nthe standard deviation of the returns of the stock underlying the option \u03c3 . Four\nof these five parameters are straightforward, but the fifth parameter, \u03c3 , is\nproblematic. There are two common ways of computing sigma, \u03c3 :\n\u2022 \u03c3 can be computed based on the h istorical returns of the stock.\n\u2022 \u03c3 can be computed based on the i mplied volatility of the stock.\nI n the two subsections below, we illustrate both methods of computing \u03c3\nand apply them to the pricing of options on the Standard & Poor\u2019 s 500 (symbol\nSPY, called \u201cspiders\u201d).\nThe Volatility of Historical Returns\nW e can use historical stock returns to compute the volatility. The method is\nthe following:\n\u2022 For a given time frame and frequency of returns, we compute the periodic\nvolatility. The time frame commonly used varies wildly: Some practitioners\nuse a short term of, say, 30 days, while others use a much longer (up to 1 year)\ntime frame. Similarly, the frequency of returns can be daily, weekly, or some-\ntimes monthly. Since options are mostly short term, a shorter time frame is\nmore common.\n\u2022 We annualize the periodic volatility by multiplying by the square root of the\nnumber of periods per year. Thus:\n\u23a7 12\u2217\u03c3\n\u23aa\u23aa monthly\n\u03c3 =\u23a8 52\u2217\u03c3\nannual weekly\n\u23aa\n\u23a9\u23aa 250\u2217\u03c3\ndaily\nT he number of days per year is an open question. Most practitioners use 250\nor 252 for the number of transaction dates per year. However, instances of\n431 The Black-Scholes Model\nIn the spreadsheet below we show one year \u2019 s daily prices for SPDR S&P\n500 (SPY). This is an exchange-traded fund (ETF) that tracks the Standard &\nPoor\u2019 s 500. The historical prices of the SPY and the resulting historical volatil-\nity are computed below:\nA B C D E F G H\n1 SPY HISTORICAL PRICES, DAILY DATA\n2 Date Adj Close Return Return statistics, one year\n3 10-Oct-11 117.07 Count 252<-- =COUNT(C:C)\n4 11-Oct-11 117.19 0.10%<-- =LN(B4/B3) Average daily return 0.08%<-- =AVERAGE(C:C)\n5 12-Oct-11 118.22 0.88%<-- =LN(B5/B4) Standard deviation of daily return 1.03%<-- =STDEV.S(C:C)\n6 13-Oct-11 117.98 -0.20%\n7 14-Oct-11 120 1.70% Annualized mean return 0.99%<-- =12*G4\n8 17-Oct-11 117.71 -1.93% Annualized sigma 16.34%<-- =SQRT(252)*G5\n9 18-Oct-11 120.01 1.94%\n10 19-Oct-11 118.59 -1.19% Return statistics, last half year\n11 20-Oct-11 119.11 0.44% Count 126<-- =COUNT(C130:C255)\n12 21-Oct-11 121.37 1.88% Average daily return 0.05%<-- =AVERAGE(C130:C255)\n13 24-Oct-11 122.86 1.22% Standard deviation of daily return 0.87%<-- =STDEV.S(C130:C255)\n14 25-Oct-11 120.47 -1.96%\n15 26-Oct-11 121.69 1.01% Annualized mean return 0.59%<-- =12*G12\n16 27-Oct-11 125.93 3.42% Annualized sigma 13.76%<-- =SQRT(252)*G13\n17 28-Oct-11 125.9 -0.02%\n18 31-Oct-11 122.87 -2.44%\n19 1-Nov-11 119.44 -2.83%\n20 2-Nov-11 121.39 1.62%\nT he historical volatility based on a full year of data is 16.34%, whereas the\nvolatility for the last 6 months is 13.76%.\nThe Implied Volatility\nT he implied volatility ignores history; instead it determines the option \u03c3 based\non actual option prices. Whereas the historical volatility is a backward-looking\nvolatility, the implied volatility is a forward-looking estimate.4\nT o estimate the implied volatility for the SPY calls expiring 19 January\n2013, we solve the Black-Scholes formula for the sigma, which gives the\ncurrent market price:\n4 . T he nomenclature \u201cforward-looking\u201d versus \u201cbackward-looking\u201d makes it sound as if the\n432 Chapter 17\nA B C\nIMPLIED VOLATILITY FOR THE\n1 JANUARY 2013 SPY OPTIONS\n2 Current date 09-Oct-12\n3 Option expiration date 19-Jan-13\n4\n5 Current SPY price, S 144.2\n6 Option strike price, X 144\n7 Time to maturity, T 0.279452<-- =(B3-B2)/365\n8 Interest rate 0.08%\n9\n10 Actual call price 4.74\n11 Actual put price 4.91\n12\n13 Implied call volatility 15.22%<-- =CallVolatility(B5,B6,B7,B8,B10)\n14 Proof: Black-Scholes call price 4.74<-- =BSCall(B5,B6,B7,B8,B13)\n15\n16 Implied put volatility 16.54%<-- =PutVolatility(B5,B6,B7,B8,B11)\n17 Proof: Black-Scholes put price 4.91<-- =BSPut(B5,B6,B7,B8,B16)\nThe implied volatility is 15.22% for the call and 16.54% for the put. As\nshown in cells B14 and B17, these volatilities, when inserted in the Black-\nScholes formula, give back the current market price. We have used functions\nCallVolatility and PutVolatility described below.\nPricing At-the-Money SPY Options\nWhen we price the SPY at-the-money options for all maturities at the historical\nvolatility, we see that the Black-Scholes model with the full-year\u2019 s historical\nvolatility as a proxy for \u03c3 does a reasonable job of pricing the calls:\nA B C D E F G H\nPRICING THE SPY AT-THE-MONEY OPTIONS\n1 Historical and Implied volatility\n2 Current date 09-Oct-12\n3 Current SPY price, S 144.2\n4 Exercise price, X 144\n5 Sigma, \u03c3 16.34%<-- =SPY!G8\n6\nBS,\nMarket Interest Time to historical Implied\n7 Expiration price rate maturity, T sigma volatility\n8 20-Oct-12 1.40 0.08% 0.0301 1.73<-- =BSCall($B$3,$B$4,D8,C8,$B$5) 12.99%<-- =CallVolatility($B$3,$B$4,D8,C8,B8)\n9 17-Nov-12 2.80 0.08% 0.1068 3.18<-- =BSCall($B$3,$B$4,D9,C9,$B$5) 14.33%<-- =CallVolatility($B$3,$B$4,D9,C9,B9)\n10 22-Dec-12 3.93 0.08% 0.2027 4.34 14.75%\n11 31-Dec-12 4.06 0.08% 0.2274 4.59 14.40%\n12 19-Jan-13 4.74 0.08% 0.2795 5.08 15.22%\n13 16-Mar-13 5.88 0.08% 0.4329 6.30 15.23%\n14 28-Mar-13 6.25 0.12% 0.4658 6.55 15.58%\n15 22-Jun-13 8.37 0.12% 0.7014 8.02 17.07%\n16 28-Jun-13 8.53 0.12% 0.7178 8.11 17.20%\n17 21-Sep-13 9.55 0.12% 0.9507 9.33 16.74%\n18 30-Sep-13 10.18 0.12% 0.9753 9.45 17.64%\n433 The Black-Scholes Model\nThe historical volatility does a good job of pricing the call options:\nActualCallPriceversusBlack-ScholesusingHistorical\u03c3\n14\n12\n10\n8\n6\n4\n2\n0\nMarketprice BS,historicalsigma\nSPY data for puts produce similar, though less good, results:\nActualPutPriceversusBlack-ScholesPriceusingHistoricals\n16\n14\n12\n10\n8\n6\n4\n2\n0\n434 Chapter 17\nWe also compute the implied volatilities of the at-the-money puts and calls:\n25%\n20%\n15%\n10%\n5%\n0%\n20-Oct-12 19-Nov-12 19-Dec-12 18-Jan-13 17-Feb-13 19-Mar-13 18-Apr-13 18-May-13 17-Jun-13 17-Jul-13 16-Aug-13 15-Sep-13 15-Oct-13 14-Nov-13 14-Dec-13 13-Jan-14\nComparingImpliedPutandCallVola(cid:415)lity\nImpliedcallvola(cid:415)lity Impliedputvola(cid:415)lity\nComparing Historical with Implied Volatility\nIt is impossible to say which of these two methods is better for pricing options.\nOn the one hand it is common to attribute to the historical returns some kind\nof validity as a predictor of the future anticipated returns. On the other hand\nthe implied volatility gives a good indication of what the market is currently\nthinking. Our advice: Use them both and compare."
        ],
        "17.5": [
            "What is the purpose of a VBA Function in finding the Implied Volatility?\nWhat is the relationship between the option price and the sigma?\nHow does a change in Stock volatility influence the Call Price?\nWhat parameters does the function 'CallVolatility' consider when finding '\u03c3' for a call option?\nHow is the function 'CallVolatility' defined in a VBA application?\nWhat role does the Black-Scholes Formula play in this function?\nWhat are the steps in the trial and error technique used within the function?\nWhat is the bisection method and how it is used in this context?\nWhat is the effect of changing the high and low estimates on the output of 'CallVolatility'?\nWhat is the meaning of a monotonic function in the context of the option price?\nHow does increasing the sigma affect the function?\nWhat is the significance of defining a high estimate and a low estimate in the function?\nHow does the function determine if the current '\u03c3' estimate is too high or too low?\nWhat is meant by the term 'target' in the context of the 'CallVolatility' function?\nWhat is the relevance of a 'call price' in the context of the Black-Scholes model?\nWhat does it mean when the current \u03c3 estimate is \"too high\" and how does the function handle this?\nWhat does it mean when the current \u03c3 estimate is \"too low\" and how does the function handle this?",
            "17.5 A VBA Function to Find the Implied Volatility\n\nWe design a Visual Basic for Applications (VBA) function which computes\nthe implied volatility. To do this, we first note that the option price is a mono-\ntonic and increasing function of the sigma: Here\u2019 s a Data|Table from our basic\n435 The Black-Scholes Model\nA B C D\n1 BLACK-SCHOLES OPTION PRICE IS MONOTONIC IN SIGMA\n2 S 45Current stock price\n3 X 50Exercise price\n4 T 1Time to maturity of option (in years)\n5 r 8.00% Risk-free rate of interest\n6 Sigma 30.00% Stock volatility\n7\n8 Call price 4.88<-- =BSCall(B2,B3,B4,B5,B6)\n9\n10 Data table: Call price as function of volatility s\n11 4.8759<-- =B8, table header\n12 15% 2.1858\n13 16% 2.3646\n14 17% 2.5437 4.50\n15 18% 2.7229\n4.20\n16 19% 2.9023\n3.90\n17 20% 3.0817\n18 21% 3.2612 3.60\n19 22% 3.4407 3.30\n20 23% 3.6202\n3.00\n21 24% 3.7997\n22 25% 3.9792 2.70\n23 26% 4.1587 2.40\n24 27% 4.3381 2.10\n25\n1.80\n26 15% 18% 21% 24% 27%\n27\n28\nWe use VBA to define a function CallVolatility, which finds the \u03c3 for a\ncall option. The function is defined as C allVolatility(Stock, Exercise, Time,\nInterest, Target) , where the definitions are:\nStock is the stock price S\nExercise is the option \u2019 s exercise price X\nTime is the time to the option \u2019 s maturity T\nInterest is the interest rate r\nTarget is the call price C\nThe function finds \u03c3 for which the Black-Scholes formula = C .\necirp\nllac\nSB\nCall Price and Volatility\n436 Chapter 17\nFunction CallVolatility(Stock, Exercise, Time, _\nInterest, Target)\nHigh = 2\nLow = 0\nDo While (High - Low) > 0.0001\nIf BSCall(Stock, Exercise, Time, Interest, _\n(High + Low) / 2) > Target Then\nHigh = (High + Low) / 2\nElse: Low = (High + Low) / 2\nEnd If\nLoop\nCallVolatility = (High + Low) / 2\nEnd Function\nT he technique used by the function is very similar to the technique used in\ntrial and error: We start with two estimates for the possible \u03c3 : A High estimate\nof 100% and a Low estimate of 0%. We now do the following:\n\u2022 Plug the average of the High a nd the Low into the Black-Scholes formula.\nThis gives us C allOption(Stock, Exercise, Time, Interest, (High + Low) /\n2) . (Note the function C allVolatility assumes that the function C allOption is\navailable to the spreadsheet.)\n\u2022 If CallOption(Stock, Exercise, Time, Interest, (High+ Low) / 2 > Target ,\nthen the current \u03c3 estimate of (High + Low) / 2) is too high and we replace\nHigh by (High + Low) / 2 .\n\u2022 If CallOption(Stock, Exercise, Time, Interest, (High+ Low) / 2 < Target ,\nthen the current \u03c3 estimate of ( High + Low) / 2) is too low and we replace\nLow by (High + Low) / 2 .\nWe repeat this procedure (often called the bisection method) until the dif-\n437 The Black-Scholes Model"
        ],
        "17.6": [
            "What does the Black-Scholes formula assume about the option's underlying security?\nWhat happens to the model when there are known future dividends?\nWhat is the principle underlying the adjustment for dividends in the Black-Scholes model?\nOn what value should the option be priced when the future dividend is known at the time the option is traded?\nWhat does the adjusted underlying value take into account for pricing the options?\nCan you give an example of when the stock's future dividend might be known at the time the option is traded?\nWhat happens to the pricing when anticipated dividends are taken into account?\nWhat information does the implied volatility for calls and puts provide about the effect of anticipated dividends on the pricing?\nWho proposed the model for pricing options on a stock which pays continuous dividends?\nWhat are continuous dividends and when might such an assumption be useful?\nWhat does Merton's dividend-adjusted option pricing model look at?\nWhat does the continuous dividend yield k represent in Merton's model?\nHow is the continuous dividend yield factored into Merton's model?\nWhich financial instrument is often used as an example to explain Merton's model in relation with continuous dividends?\nHow does the Merton model price currency options?\nWhat is an example of an asset underlying the option in the context of currency options according to the Merton model?\nIn the context of currency options, how is the underlying asset price calculated? \nWhat changes are observed in the Merton model when it is used to price currency options?",
            "17.6 Dividend Adjustments to the Black-Scholes\n\nT he Black-Scholes formula assumes that the option\u2019 s underlying security pays\nno dividends prior to the exercise date T . In certain cases it is easy to make\nan adjustment to the model for dividends. This section looks at two such\nadjustments: We first look at option pricing when future dividends are known\nwith certainty, and we then examine option pricing when the underlying secu-\nrity pays out a continuous dividend. The principle underlying both cases is the\nsame: The options are priced on an adjusted underlying value which nets out\nthe present value of dividends paid between the option purchase date and the\noption exercise date.\nA Known Dividend to Be Paid Before the Option Expiration\nIt often happens that a stock \u2019 s future dividend is known at the time the option\nis traded. This is most commonly the case when a dividend has already been\nannounced, but it can also happen because many stocks pay quite regular and\nrelatively inflexible dividends. In this case the option should be priced not on\nthe current stock price S but on the stock price minus the present value of the\ndividend or dividends anticipated before the option expiration date T :\nTime t Time T\nTime 0 Dividend Option\npayment expiration\nStock price = S Div Max[S - X,0]\nT\nStock price minus\nPV(dividend) =\nS \u2013 Div*exp[-rt]\nH ere\u2019 s an example: Coca-Cola (stock symbol KO) pays quarterly dividends\nin the middle of March, June, September, and November of each year. Divi-\ndends (see Figure 1 7.1) seem quite stable; on 28 July 2006, the last two divi-\n1.71\nerugiF\n.25.44$\nsi\necirp\nkcots\ngnisolc\neht\n,6002\nyluJ\n82\nnO\n.sdnedivid\neht\nfo\nytilibats\neht\netoN\n.aloC-acoC\nrof\natad\n439 The Black-Scholes Model\nC omputing the implied volatility for the January 2007 calls and puts on\nCoca-Cola shows that taking account of anticipated dividends makes a signifi-\ncant difference in the pricing. We can also deduce from the proximity of the\nprices which take dividends into account (cells B19:B20) versus the distance\nbetween the prices which do not take the dividends into account (cells B22:B23)\nthat the former are correct.\nA B C D E\n1 PRICING THE COCA-COLA JAN07 CALLS AND PUTS\n2 Current date 28-Jul-06\n3 Option expiration date 19-Jan-07\n4 Current stock price 44.52\n5 Interest rate 5.00%\n6\nAnticipated Present\nDate\n7 dividend value\n8 Mid September 13-Sep-06 0.31 0.31<-- =C8*EXP(-$B$5*((B8-$B$2)/365))\n9 End November 29-Nov-06 0.31 0.30<-- =C9*EXP(-$B$5*((B9-$B$2)/365))\n10\n11 Stock price net of PV(dividends) 43.91<-- =B4-SUM(D8:D9)\n12 Exercise price, X 45.00<-- Approximately at the money\n13 Time to maturity, T 0.4795<-- =(B3-B2)/365\n14 Interest rate, r 5.00%Risk-free rate of interest\n15 Call price 1.80<-- Call price on 28jul06\n16 Put price 1.85<-- Put price on 28jul06\n17\n18 Implied volatility\n19 Call, S net of dividends 14.95%<-- =CallVolatility(B11,B12,B13,B14,B15)\n20 Put, S net of dividends 15.15%<-- =PutVolatility(B11,B12,B13,B14,B16)\n21\n22 Call, S with dividends 12.19%<-- =CallVolatility(B4,B12,B13,B14,B15)\n23 Put, S with dividends 17.45%<-- =PutVolatility(B4,B12,B13,B14,B16)\nDividend Adjustments for Continuous Dividend Payouts\u2014The Merton Model\nI n the above subsection we looked at the case of known future dividends. This\nsubsection discusses a model due to Merton (1973) for the pricing options on\na stock which pays continuous dividends. Continuous dividends may seem an\nodd assumption. But a basket of stocks such as the S&P 500 index or the Dow\nJones 30 can best be approximated by the assumption of a continuous dividend\npayout, since there are many stocks and since the index components more or\nless pay out their dividends throughout the year.\nAssuming the continuous dividend yield of k , Merton proved the following\n440 Chapter 17\nC=Se\u2212kTN(d )\u2212Xe\u2212rTN(d ),\n1 2\nwhere\nln(S/X)+(r\u2212k+\u03c32 2)T\nd =\n1 \u03c3 T\nd =d \u2212\u03c3 T\n2 1\nT his model is used below to price the exchange-traded fund which tracks\nthe S&P 500 index:\nA B C\nMERTON'S DIVIDEND-ADJUSTED OPTION PRICING MODEL\n1 used here to price S&P 500 Spiders (symbol: SPY)\n2 S 127.98current stock price\n3 X 127.00exercise price\n4 T 0.6329<-- option expires 16-Mar-07, today's date 28-Jul-06\n5 r 5.00%risk-free rate of interest\n6 k 1.70%dividend yield\n7 Sigma 14%stock volatility\n8\n9 d 0.3122<-- =(LN(B2/B3)+(B5-B6+0.5*B7^2)*B4)/(B7*SQRT(B4))\n1\n10 d 0.2008<-- =B9-B7*SQRT(B4)\n2\n11\n12 N(d) 0.6226<--- Uses formula NormSDist(d)\n1 1\n13 N(d) 0.5796<--- Uses formula NormSDist(d)\n2 2\n14\n15 Call price 7.51<-- S*Exp(-k*T)*N(d)-X*exp(-r*T)*N(d)\n1 2\n16 Put price 3.94<-- call price - S*Exp(-k*T) + X*Exp(-r*T): by Put-Call parity\n17 3.94<-- X*exp(-r*T)*N(-d 2)-S*Exp(-k*T)*N(-d 1): direct formula\nThe Merton model is often used to price currency options. Suppose we take\nan option on the euro. The option specifies a dollar exchange rate for euros\n(in the example below, the call option lets us buy 10,000 euros in 0.0575 years\nfor $1.285 per euro). The asset underlying the option is a euro interest-bearing\nsecurity with interest rate r .\n441 The Black-Scholes Model\nA B C D\n1 PRICING AN OPTION TO BUY EUROS IN DOLLARS\n2 S 1.276Current exchange rate: U.S. dollar price of one euro Intuition: The underlying asset of the\n3 X 1.285Exercise price currency option is a euro. The euro pays\n4 rUS 5.00%U.S. interest rate a\nT\nhd eiv reid fe on red ,\nt\nhw eh Mic eh\nr\ni ts\no\nnth me oe du ero\nl\nain pt pe lr iee ss ,t wra it te h.\n5 r\u20ac 5.50%Euro interest rate the underlying asset price being S*exp(-\n6 T 0.0575Time to maturity of option (in years) r*T), where r is the interest rate on\n7 Sigma 4.70%Euro volatility in dollars e\u20ac uros. Note a\u20ac lso the change in d, where\n8 d1 -0.6095<--(LN(S/X)+(rUS-r\u20ac+0.5*sigma^2)*T)/(sigma*SQRT(T)) r US-r \u20acappears instead of r USas in1 the\n9 d2 -0.6208<-- d1 - sigma*SQRT(T) regular Black-Scholes formula.\n10\n11 Number of euros per call contract 10,000\n12\n13 N(d1) 0.2711<--- Uses formula NormSDist(d1)\n14 N(d2) 0.2674<--- Uses formula NormSDist(d2)\n15\n16 Call price 23.69<-- (S*Exp(-r\u20ac*T)*N(d1)-X*exp(-rUS*T)*N(d2))*B11\n17 Put price 112.23<-- (X*exp(-rUS*T)*N(-d2)-S*Exp(-r\u20ac*T)*N(-d1))*B11: direct formula"
        ],
        "17.7": [
            "- What is a structured security in Wall Street parlance?\n- Can all structured securities be priced using the Black-Scholes model?\n- What is a principal-protected, upside potential security (PPUP)?\n- How is the payoff calculated in a principal-protected, upside potential security (PPUP)?\n- How can a spreadsheet be used to price a structured security?\n- What does it mean for a structured security to be overpriced?\n- What is implied volatility in the context of a structured security?\n- What are some examples of more complicated structured security products?\n- How does a structured product issued by a bank like ABN-AMRO work?\n- How can the Black-Scholes model be used to price structured securities like the ABN-AMRO Airbag?\n- What is a risk-free security in the context of financial modeling?\n- What are the key components of the Swiss bank UBS' '",
            "17.7 Using the Black-Scholes Formula to Price Structured Securities\n\nA \u201cstructured security\u201d is Wall Street parlance for securities which incorporate\ncombinations of stocks, options, and bonds. In this section we give three\nexamples of such securities and show how to price them using the Black-\nScholes model. 5 In the process we also return to the discussion of Chapter 16,\nshowing how the profit diagrams of option strategies can help us understand\nsuch securities.\nA Simple Structured Security: Principal Protection Plus Participation in Market\nUpside Moves\nA simple and popular structured offers guaranteed return of the investor \u2019 s\nprincipal plus some participation in the upside moves of the market. Here\u2019 s an\nexample: Homeside Bank offers its customers the following \u201cPrincipal-\nProtected, Upside Potential\u201d security (PPUP).\n\u2022 Initial investment in the security: $1,000.\n\u2022 No interest paid on the security.\n\u2022 In 5 years the PPUP pays back the $1,000 plus 50% of the increase in the\nS&P 500 index. Writing the index price today as S and the index price in 5\n0\nyears as S , the payoff on the PPUP can be written as:\nT\n5. Not all structureds can be priced using Black-Scholes; more complicated, path-dependent,\nsecurities often need to be priced using the Monte Carlo methods discussed in Chapters 24\n442 Chapter 17\n\u23a1 \u239bS \u239e\u23a4\n$1,000 \u23a3\u23a21+50%\u2217max \u239d\u239c ST \u22121,0 \u23a0\u239f \u23a6\u23a5\n0\nTo analyze the PPUP, we first rewrite the maturity payment as:\n\u23a1 \u239bS \u239e\u23a4\n$1,000 \u23a3\u23a21+50%\u2217max \u239d\u239c ST \u22121,0 \u23a0\u239f \u23a6\u23a5\n0\n50%\n= $(cid:2)1(cid:3),0(cid:4)00 +$1,000\u2217\nS\n\u2217m(cid:2)a(cid:5)x((cid:5)S(cid:3)T \u2212 (cid:5)S(cid:5)0,(cid:4)0)\n\u2191 0 \u2191\nPayoff on Payoff on at-the-mooney\nzero cooupon call option\nbond\nThis shows that the PPUP payoff is composed of two parts:\n\u2022 A $1,000 return of principal. Since no interest is paid on this principal, its\nvalue today is the present value of the payment at the risk-free interest rate,\n$1,000* e \u2212 rT , where r is the interest rate and T = 5 is the maturity of the PPUP.\n50%\n\u2022 $ 1,000\u2217 times the value today of an at-the-money call on the\nS\n0\nS&P 500.\nWe can use the following spreadsheet to price this security:\nA B C\nANALYZING A SIMPLE STRUCTURED PRODUCT\n1 $1,000 Deposit with 50% Participation in S&P Increase over 5 Years\n2 Initial S&P 500 price, S 0 950<-- The price of the S&P 500 at PPUP issuance\n3 Structured exercise price, X 950\n4 Risk-free interest rate for 5 years, r 5.00%\n5 Time to maturity, T 5\n6 Volatility of S&P 500, \u03c3 SP 25%\n7 Participation rate 50%<-- Percentage of increase in the S&P going to PPUP owner\n8\n9 Strutured components, value today\n10 Bond paying $1000 at maturity 778.80<-- =EXP(-B4*B5)*1000\n11 Participation rate /S 0*at-the-money call on S&P 500 162.52<-- =1000*B7/B2*BSCall(B2,B3,B5,B4,B6)\n12 Value of structured security today 941.32<-- =SUM(B10:B11)\nThe value of the structured security (cell B12) is $941.32. This valuation\nhas two parts:\n\u2022 The present value of the bond part of the PPUP is $778.80 (cell B10).\n50%\n\u2022 The value of $1,000\u2217 at-the-money calls on the S&P is $162.52.\n443 The Black-Scholes Model\nG iven the parameters in cells B2:B7, the PPUP is overpriced\u2014 it sells for\n$1,000, whereas its market value ought to be $941.32. Another way to think\nabout the structured is to compute its implied volatility: What \u03c3 (cell B6)\nSP\nwill give the market valuation (cell B12) of the PPUP to equal the $1,000 price\nbeing asked by the Homeside Bank? Either G oal Seek or Solver will solve\nthis problem:\nA B C\nANALYZING A SIMPLE STRUCTURED PRODUCT\n1 $1,000 Deposit with 50% Participation in S&P Increase over 5 Years\n2 Initial S&P 500 price, S 950<-- The price of the S&P 500 at PPUP issuance\n0\n3 Structured exercise price, X 950\n4 Risk-free interest rate for 5 years, r 5.00%\n5 Time to maturity, T 5\n6 Volatility of S&P 500, \u03c3 SP 42.00%\n7 Participation rate 50%<-- Percentage of increase in the S&P going to PPUP owner\n8\n9 Structured components, value today\n10 Bond paying $1000 at maturity 778.80<-- =EXP(-B4*B5)*1000\n11 Participation rate /S*at-the-money call on S&P 500 221.20<-- =1000*B7/B2*BSCall(B2,B3,B5,B4,B6)\n0\n12 Value of structured security today 1000.00<-- =SUM(B10:B11)\nMore Complicated Structured Products\nSuppose you want to create a security with the following payoff pattern:\nStrategy\npayoff\nX\n1\nS\nT\nX X\n444 Chapter 17\nT he payoff pattern increases (dollar for dollar) as the terminal price of\nthe underlying asset increases from 0 \u2264 S \u2264 X . Between X and X , the\nT 1 1 2\npayoff pattern is flat, and for X \u2264 S, the payoff again increases, dollar-for-\n2 T\ndollar with the price of the underlying. The algebraic formula for this payoff\npattern is:\nX \u2212max(X \u2212S ,0)+max(S \u2212X ,0)\n1 1 T T 2\nTo prove that this formula creates the graph:\nX 1\u2212m(cid:2)a(cid:5)x((cid:5)X(cid:3)1\u2212 (cid:5)S(cid:5)T,(cid:4)0)+m(cid:2)a(cid:5)x((cid:5)S T(cid:3)\u2212 (cid:5)X(cid:5)2,(cid:4)0)\n\u2191 \u2191\nPayoff of written Paayoff of bought\nput call\n\u23a7X \u2212X +S =S S <X\n\u23aa 1 1 T T T 1\n=\u23a8X X \u2264S <X\n1 1 T 2\n\u23aa\n\u23a9X +S \u2212X X \u2264S\n1 TT 2 2 T\nA slightly more complicated payoff pattern is the following:\nY\nX X\n445 The Black-Scholes Model\nY\nThe initial part of the payoff has slope , and the second increasing\nX\n1\nY\npart of the payoff pattern has slope . This payoff pattern is created by\nX\n2\nthe following formula:\nY Y\nY\u2212 max(X \u2212S ,0)+ maax(S \u2212X ,0)\n1 T T 2\n(cid:2)X 1(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4) (cid:2)X 2(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4)\n\u2191 \u2191\nY Y\nPayoff of Payoff of\nX1 X2\nwritten puts bought calls\nTo prove that this is indeed the payoff:\nY Y\nY\u2212 max(X \u2212S ,0)+ maax(S \u2212X ,0)\n1 T T 2\n(cid:2)X 1(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4) (cid:2)X 2(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4)\n\u2191 \u2191\nY Y\nPayoff of Payoff of\nX1 X2\nwritten puts bought calls\n\u23a7 Y Y\n\u23aaY\u2212 (X 1\u2212S TT)= S\nT\nS\nT\n<X\n1\nX X\n\u23aa 1 1\n=\u23a8Y X \u2264S <X\n1 T 2\n\u23aa\nY Y\n\u23aaY+ (S \u2212X )= S X \u2264S\n\u23a9 X T 2 X T 2 T\n2 2\nAs an example of this kind of structured payoff security, Figure 17.2 on\np. 447 shows the term sheet for a structured product issued by ABN-AMRO\nbank. The payment on this \u201cAirbag\u201d security depends on the value of the\nStoxx50\u2014an index of European stocks. Here are the details:\n\u2022 Issuance date: 24 March 2003\n\u2022 Terminal date: 24 March 2008\n\u2022 Cost \u20ac 1,020\n446 Chapter 17\nPaymentatmaturity\n\u23a7 \u239b\u239bStoxx50 \u239e\n\u23aa1,000\u22171.33\u2217 \u239d\u239c Maturity \u23a0\u239f IfStoxx50\nMaturity\n<1,618.50\nStoxx50\n\u23aa\u23aa Initial\n=\u23a81,000 1,618.50<Stoxx50 <2,158\nMaturrity\n\u23aa\n\u239bStoxx50 \u239e\n\u23aa 1,000\u2217\u239c Maturity\u239f IfStoxxx50 >2,158\n\u23a9\u23aa \u239d Stoxx50 \u23a0 Maturity\nInitial\nWe recognize this security as one whose payoff has the form discussed\nearlier:\nY Y\nY(cid:6) \u2212 max(X \u2212S ,0)+ max(S \u2212X ,0)\n1 T T 2\n\u2191 (cid:2)X 1(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4) (cid:2)X 2(cid:5)(cid:5)(cid:5)(cid:3)(cid:5)(cid:5)(cid:5)(cid:4)\nBond payoff \u2191 \u2191\nY Y\nwritten puts with purchased call\nX1 X2\nexercisse price X1 witth exercise price X2\nwhere\nX =1,618.50\n1\nX =2,158\n2\nY =1,000\nThe spreadsheet on p. 448 shows the payoff. Cell B7 shows the payoff defi-\nnition given by the Airbag issuer, and cell B8 shows the payoff in the option\nterms defined above. The data table in cells A13:B29 show that these two\n447 The Black-Scholes Model\nFigure 17.2\n448 Chapter 17\nA B C D\n1 ABN-AMRO AIRBAG\n2 Y 1,000.00\n3 X 1,618.50\n1\n4 X 2,158.00\n2\n5 S 2,373.80\nT\n6 Airbag payoff\n7 By Airbag definition 1,100.00<-- =IF(B5<B3,B2*(B4/B3)*B5/B4,IF(B5>B4,B2*B5/B4,1000))\n8 Option formula 1,100.00<-- =B2-B2/B3*MAX(B3-B5,0)+B2/B4*MAX(B5-B4,0)\n9\n10\n11 Data table of payoffs\nAirbag Option\n12 S T definition formula\n13 <-- Data table headers hidden\n14 0 0.00 0.00\n15 100 61.79 61.79 2000\n16 500 308.93 308.93 1800\n17 750 463.39 463.39 1600\n18 1,000 617.86 617.86 1400\n19 1,250 772.32 772.32 1200\n20 1,618.5 1,000.00 1,000.00\n1000\n21 1,750 1,000.00 1,000.00\n22 2,000 1,000.00 1,000.00 800\n23 2,158 1,000.00 1,000.00 600\n24 2,500 1,158.48 1,158.48 400\n25 2,750 1,274.33 1,274.33 200\n26 3,000 1,390.18 1,390.18 0\n27 3,250 1,506.02 1,506.02 0 1000 2000 3000 4000\n28 3,500 1,621.87 1,621.87\n29 3,750 1,737.72 1,737.72\n30\nffoyap\ngabriA\nAirbag definition\nOption formula\nStoxx50 at Airbag expiration\nT o see how the Airbag is priced, we use the Black-Scholes model and find\n449 The Black-Scholes Model\nA B C\nPRICING THE ABN-AIRBAG\n1 Find the Implied Volatility\n2 Stoxx50 price today, S 0 2,158.0\n3 X 1 1,618.50\n4 X 2 2,158.0\n5 Y 1,000.0\n6 Risk-free interest rate for 5 years, r 7.00%\n7 Time to maturity, T 5\n8 Volatility of the Stoxx50, sigma 15.75%\n9\n10 Airbag components, value today\n11 Bond paying X 1 at maturity 704.69<-- =EXP(-B6*B7)*B5\n12 Y/X 1 * written puts with exercise X 1 -4.69<-- =-B5/B3*BSPut(B2,B3,B7,B6,B8)\n13 Purchased call with exercise X 2 320.01<-- =B5/B4*BSCall(B2,B4,B7,B6,B8)\n14 Value of structured security today 1020.00<-- =SUM(B11:B13)\n15\n16\n17 Table: Sensitivity of Airbag to Sigma 1,020.00<-- =B14, data table header\n18 0% 1,000.00\n19 1% 1,000.00\n20 3% 1,000.00 Airbag Pricing: Sensitivity to s\n21 6% 1,000.16 1045\n22 9% 1,002.76 1040\n23 10% 1,004.57 1035\n24 11% 1,006.80\n25 12% 1,009.34 1030\n26 13% 1,012.09 1025\n27 14% 1,014.95 1020\n28 15% 1,017.84 1015\n29 16% 1,020.70\n30 17% 1,023.49 1010\n31 18% 1,026.16 1005\n32 19% 1,028.70 1000\n33 20% 1,031.11 995\n34 21% 1,033.35 0% 5% 10% 15% 20% 25%\n35 22% 1,035.45\n36 23% 1,037.39 Stoxx50 volatility, s\n37 24% 1,039.19\n38 25% 1,040.84\nWhen the Stoxx50 \u03c3 is 15.75% (cell B8), the Airbag\u2019 s price is \u20ac 1 ,020 (cell\nB14). The table shows the sensitivity of this price to the \u03c3 . Notice that Airbag\nvalues are not very sensitive to \u03c3 : Doubling the sigma from 10% to 20%\nincreases the Airbag value by about \u20ac 1 7. This is because of the offsetting\nvalues of the short put and the long call in the Airbag.\nWe can do one more exercise on the Airbag. Using a two-dimensional D ata\nTable, we examine the Airbag\u2019 s price sensitivity to both time to maturity T\nand the Stoxx50 volatility \u03c3 :\necirp\nlaitini\n450 Chapter 17\nA B C D E F G H\nABN-AMRO AIRBAG SENSITIVITY TO TIME TO MATURITY AND SIGMA\n1\n2 Stoxx50 price today, S 0 2,158.0\n3 X 1 1,618.50\n4 X 2 2,158.0\n5 Y 1,000.0\n6 Risk-free interest rate for 5 years, r 7.00%\n7 Time to maturity, T 5\n8 Volatility of the Stoxx50, sigma 15.75%\n9\n10 Airbag components, value today\n11 Bond paying X 1 at maturity 704.69<-- =EXP(-B6*B7)*B5\n12 Y/X 1 * written puts with exercise X 1 -4.69<-- =-B5/B3*BSPut(B2,B3,B7,B6,B8)\n13 Purchased call with exercise X 2 320.01<-- =B5/B4*BSCall(B2,B4,B7,B6,B8)\n14 Value of structured security today 1020.00<-- =SUM(B11:B13)\n15\n16 Time to maturity, T\n17 Data table 1020.00 5 4 3 2 1 0.0001\n18 header: 5% 1000.02 1000.07 1000.20 1000.59 1001.77 1000.20\n19 =B14 10% 1004.57 1006.22 1008.40 1011.13 1013.78 1000.40\n20 15% 1017.84 1021.09 1024.72 1028.28 1029.65 1000.59\n21 20% 1031.11 1035.21 1039.61 1043.69 1044.54 1000.79\n22 Volatility of the Stoxx50, sigma --> 25% 1040.84 1045.48 1050.44 1055.14 1056.54 1000.99\n23 30% 1047.16 1052.22 1057.69 1063.09 1065.58 1001.19\n24 35% 1050.86 1056.29 1062.26 1068.39 1072.19 1001.39\n25 40% 1052.66 1058.44 1064.88 1071.75 1076.95 1001.59\n26 45% 1053.10 1059.19 1066.10 1073.70 1080.28 1001.79\n27 50% 1052.55 1058.94 1066.29 1074.59 1082.53 1001.99\nThe Airbag is a fairly stable security\u2014its price varies no more than 10%\nfor a wide variety of \u03c3 \u2019 s and for nearly all times to maturity.\nA Reverse Convertible: Analyzing the UBS \u201cGoals\u201d\nT he Swiss bank UBS has issued a series of stock-linked securities called\n\u201cGoals.\u201d All of the Goals pay interest on the initial price; the final repayment\ndepends on the market price of the underlying stock: If the stock price is high,\nthe Goals investor gets back her initial investment, and if the stock price is\nlow, the Goals investor is paid out in a package of shares whose value is less\nthan her initial investment.\nA n example of such a security is the Cisco-linked Goals issued by UBS on\n17 January 2001. The main details of this security are:\n\u2022 T he purchaser pays UBS $1,000 on 23 January 2001. In return, she gets 3\n\u239b 19.50% \u239e\npayments of $97.50 = \u2217$1,000 on 23 July 2001, 23 January 2002,\n\u239d \u23a0\n2\n451 The Black-Scholes Model\n\u2022 On 23 July 2002, in addition to the $97.50 payment\n\u00b0 If the price of Cisco stock > $39 per share, the purchaser of the security\ngets $1,000.\n\u00b0 If the price of Cisco stock < $39 per share, the purchaser gets\n1,000\n=25.641 shares of Cisco.\n39\n\u2022 The closing stock price of Cisco on 23 January 2001 was 42.625.\n\u2022 The continuously compounded risk-free interest rate at the time of the Goals\nissuance was 5.2% annually (2.6% semiannually).\nTo analyze the Cisco-linked Goals, we start by noting that the cash flow can\nbe written as:\nTime 0 1 2 3\n-1,000 97.50 97.50 97.50\n1,000-25.641*Max(39-S ,0)\nT\nT o prove this, we write a short spreadsheet which compares the Goals payoff\n452 Chapter 17\nA B C D E F G H I J\n1 EQUIVALENCE OF 2 WAYS OF WRITING THE PAYOFF\n2 Cisco price, 23 July 2002, S T 32\n3 Payoff ratio 25.6410<-- =1000/39\n4 Terminal payoff\n5 As described by UBS 820.51<-- =IF(B2>39,1000,B2*B3)\n6 In option terms 820.51<-- =1000-B3*MAX(39-B2,0)\n7\n8 Data table: Comparing the payoff on Cisco-linked Goals\nAlternative\nCisco stock price UBS option\n9 on 23 July 2002, ST description description\n10 820.51 820.51<-- Data table headers, B5 and B6 respectively\n11 0 0.00 0.00\n12 10 256.41 256.41 UBS Cisco-Linked GOALS Terminal Payoff\n13 15 384.62 384.62 1000\n14 20 512.82 512.82 900\n15 22 564.10 564.10\n16 24 615.38 615.38 800\n17 26 666.67 666.67 700\n18 30 769.23 769.23 600\n19 32 820.51 820.51 500\n20 34 871.79 871.79\n400\n21 38 974.36 974.36 UBS description\n22 39 1,000.00 1,000.00 300\n23 40 1,000.00 1,000.00 200 Alternative\n24 42 1,000.00 1,000.00 100 option description\n25 44 1,000.00 1,000.00\n0\n26 46 1,000.00 1,000.00\n27 47 1,000.00 1,000.00 0 10 20 30 40 50\n28 50 1,000.00 1,000.00\nT he equivalence of these two definitions means that the purchaser of the\nCisco-linked Goals:\n\u2022 Acquires a $1,000 bond paying 9.75% interest semi-annually.\n\u2022 Writes UBS 25.641 puts with exercise X = 39 and with time to maturity\nT = 1.5.\nA t the time the Goals were issued, the semi-annual interest rate was around\n2.6%, far below 9.75%. Thus the bond component of the Goals was worth\nmuch more than $1,000. On the other hand, the purchaser of the Goals was\ngiving UBS 25.641 puts. The value of this \u201cgift\u201d should be accounted for in\nany analysis of the Goals.\nW e illustrate two ways to value the Goals. The first method assumes that\nthe equilibrium NPV of any security should be zero. Doing this for the UBS\n453 The Black-Scholes Model\n97.50 97.50 1,097.50\n\u22121,000+ + +\n(cid:2)(cid:5)(cid:5)(cid:5)((cid:5)1+ (cid:5)r(cid:5))0. (cid:5)5 (cid:3)((cid:5)1+ (cid:5)r)(cid:5)1.0 (cid:5)(cid:5)(1(cid:5)+ (cid:5)r)(cid:4)1.5\n\u2191\nValue=$$205.11\nat r=2.6%\n\u221225.641\u2217PutsonCisco(X =39,,T =1.5)=0\nI n the spreadsheet below, we use this logic to price the puts embedded in the\nUBS security and we compare this price to the Black-Scholes price.\n\u23a1 97.50 \u23a4\n1\n\u23a2\u22121,000+\n(1+2.6%)0.5 \u23a5\nImplicit putvaluation= \u23a2 \u23a5\n25.641\u23a2 97.50 1,097.50 \u23a5\n+ +\n\u23a2 \u23a5\n\u23a3 (11+2.6%)1.0 (1+2.6%)1.5\u23a6\n$205.11\n= =$$8.00\n25.641\nUBS is implicitly paying the Goals purchaser $8.00 per Cisco put. However,\nas shown below, the Black-Scholes price of such a put is $11.71 if \u03c3 = 80%6.\nThis makes the Goals a bad buy.\n6 . T he Cisco-linked Goals was issued during the NASDAQ crash of the early 2000s. The implied\n454 Chapter 17\nA B C\n1 PRICING THE UBS GOALS IMPLICIT PUT\n2 Annual risk-free rate 5.20%\n3 Coupon rate 19.50%\n4 Initial cost 1,000\nConversion ratio: # of shares of Cisco\n5 received if share price is low 25.641 <-- =1000/39\n6\n7 Valuing the fixed payments at 5.20%\n8 Fixed payments\n9 Date Cash flow\n10 23-Jan-01 (1,000.00)\n11 23-Jul-01 97.50 <-- =$B$3*B4/2\n12 23-Jan-02 97.50\n13 23-Jul-02 1,097.50\n14 PV of Goals bond component 205.11 <-- =XNPV(B2,B10:B13,A10:A13)\n15\n16 Value of 25.641 puts embedded in Goals 205.11 <-- =B14\n17 Value per put 8.00 <-- =B16/25.641\n18 This is what UBS is paying the Goals purchaser for the embedded puts.\n19\n20 Valuing the puts with Black-Scholes\n21 S 42.625 Current stock price\n22 X 39 Exercise price\n23 r 5.20% Risk-free interest rate\n24 T 1.5 Time to maturity of option (in years)\n25 Sigma 80% Stock volatility\n26 Put price 11.71 <-- =BSPut(B21,B22,B24,B23,B25)\n27\n28 Is the Goals a good buy? No <-- =IF(B17>B26,\"Yes\",\"No\")\n29\nTechnical note: For didactic clarity, the computations use 5.2% as the interest rate for valuing\nboth the bond component of the Goals (rows 10-14) and for the option valuation. Given a 2.6%\nsemi-annual discrete interest rate, it would be technically more correct to use an equivalent\ncontinuously compounded interest rate of LN((1.026)^2) in the option computations. The reader\n30 can confirm that the effect of this correction is negligible.\nT here is another way to look at the Goals. Consider a Goals purchaser who\nbuys the Goals and also buys 25.641 puts on Cisco with T = 1.5, X = 39. This\n\u201cengineered\u201d combination of a Goals + 25.641 puts creates a risk-free\n455 The Black-Scholes Model\n\u23a7$1,000\u2212 (cid:2)2(cid:5)5.6(cid:5)4(cid:5)1(cid:3)\u2217((cid:5)39(cid:5)\u2212 (cid:5)S(cid:4)T)\n\u23aa\n\u2191\n\u23aa\nPayment on Goaals\n\u23aa \u23aa embedded puts S <39\nPayoff Goals+25.641puts=\u23a8 +2(cid:2)5(cid:5).64(cid:5)1(cid:5)\u2217 (cid:3)(3(cid:5)9(cid:5)\u2212S(cid:5)(cid:4)T)=$1,000 T\n\u23aa\n\u2191\n\u23aa\nPayment on puts\n\u23aa puurchased\n\u23a9\u23aa $1,000 S \u226539\nT\nIn the spreadsheet below, we assume that the bought puts are priced using\nBlack-Scholes and compare the rate of return on this \u201cengineered\u201d security to\nthe risk-free rate.\nA B C\nCREATING A RISKLESS SECURITY WITH THE\n1 UBS GOALS AND 25.641 PUTS\n2 Initial cash flows\n3 Buy UBS security -1,000.00\n4 Buy 25.641 puts -300.21<-- =-25.641*BSPut(B16,B17,B19,B18,B20)\n5\nCash flow of \"engineered\" security:\n6 GOALS + 25.641 bought puts\n7 Date Cash flow\n8 23-Jan-01 (1,300.21)<-- =SUM(B3:B4)\n9 23-Jul-01 9 7.50\n10 23-Jan-02 9 7.50\n11 23-Jul-02 1 ,097.50\n12\n13 IRR of above -0.43%<-- =XIRR(B8:B11,A8:A11)\n14\n15 Inputs for Black-Scholes formula in cell B4\n16 S 42.625Current stock price\n17 X 39Exercise price\n18 r 5.20%Risk-free rate of interest\n19 T 1.5Time to maturity of option (in years)\n20 Sigma 80%Stock volatility\nCell B13 uses the Excel function XIRR (see Chapter 33) to compute the\nannualized internal rate of return on the engineered security. Clearly this return\nis less than the alternative risk-free rate of return (5.2%), which can be earned\nin the market. This is an alternative confirmation of the fact that the Goals are\n456 Chapter 17\nTHE SEC FILING FOR UBS AG $60,000,000 GOALS\nUBS AG\n$60,000,000\n19.5% GOALs DUE JULY 23, 2002\n------------------------------------------------------------------\nEach note being offered has the following terms:\n- - Issuer: UBS AG\n- - Issue: $60,000,000 USD principal amount\nof GOALs due July 23, 2002 linked\nto shares in the common stock of\nCisco Systems, Inc.\n- - Coupon: 19.5% per annum, payable\nsemi-annually in arrears on each\nJanuary 23 and July 23 which shall\nbe composed of (1) an interest\ncoupon representing a rate of 5.2%\nper annum and (2) a coupon\nrepresenting an option premium of\n14.3% per annum\n- - Initial price of $39.00 per share, subject to underlying stock\nantidilution adjustments (strike price):\n- - Key dates: Trade: January 17, 2001\nSettlement: January 23, 2001\nDetermination: July 18, 2002\nMaturity: July 23, 2002\nProceeds at maturity are based on the closing price of Cisco Systems,\nInc. common stock three business days before maturity:\nIf the closing price of Cisco Systems, Inc. common stock is at or\nabove the initial price per share of $39.00, holders will receive a\ncash payment equal to the principal amount of their GOALs.\nIf the closing price of Cisco Systems, Inc. is lower than the initial\nprice per share of $39.00, holders will receive 25.641 shares of Cisco\nSystems, Inc. common stock for each $1,000 principal amount of their\nGOALs (the stock redemption amount). Fractional shares will be paid in\ncash. The number of shares received for each $1,000 invested will be\ncalculated by dividing the initial price per share of $39.00 into\n$1,000. The stock redemption amount and the initial price per share of\n$39.00 (strike price) may change due to stock splits or other\ncorporate actions.\nFigure 17.3\n457 The Black-Scholes Model"
        ],
        "17.8": [
            "What is the Black-Scholes formula?\nWhat does \"bang for the buck\" refer to in financial modeling?\nWhat is a call option and how is it related to stock investment?\nWhat is taken into account under \"bang for the buck\" with options according to the Black-Scholes model?\nWhat does a shorter maturity mean in terms of call options?\nWhat does it mean to buy calls that are 'most highly out of the money'?\nWhat is the relationship between call options and stock volatility?\nHow does the exercise price affect the purchase of call options?\nHow is the price elasticity of options calculated in financial modeling?\nWhat does the notation N(d) represent in this context?\nWhat is the put-call parity in financial modeling?\nHow is the \"call bang\" defined and calculated?\nWhat does the \"put bang\" formula indicate in the context of options?\nHow is the \"bang for the buck\" for both calls and puts represented graphically?\nWhat does a longer time to maturity mean for the \"bang for the buck\"?\nWhy are the most risky options considered the most out-of-the-money and shortest-term options?\nHow does the \"call bang\" vary with the change in the time to exercise and the respective stock price? \nWhat is the meaning of price elasticity of calls and puts?\nHow is stock price change linked to the \"bang for the buck\" of a call option?\nWhat role does the risk-free rate of interest play in financial modeling using the Black-Scholes formula?",
            "17.8 Bang for the Buck with Options\n\nT his section presents another application of the Black-Scholes formula.\nSuppose that you are convinced that a given stock will go up in a very short\nperiod of time. You want to buy calls on the stock that have a maximum \u201cbang\nfor the buck\u201d\u2014that is, you want the percentage profit on your option invest-\nment to be maximal. Using the Black-Scholes formula, it is easy to show that\nyou should:\n\u2022 Buy calls with the shortest possible maturity.\n\u2022 B uy calls that are most highly out of the money (i.e., with the highest exer-\ncise price possible).\nHere \u2019 s a spreadsheet illustration:\nA B C\n1 \"BANG FOR THE BUCK\" WITH OPTIONS\n2 S 25 Current stock price\n3 X 25 Exercise price\n4 r 6.00% Risk-free rate of interest\n5 T 0.5 Time to maturity of option (in years)\n6 Sigma 30% Stock volatility\n7\n8 d 0.2475 <-- (LN(S/X)+(r+0.5*sigma^2)*T)/(sigma*SQRT(T))\n1\n9 d 0.0354 <-- d -sigma*SQRT(T)\n2 1\n10\n11 N(d ) 0.5977 <-- Uses formula NormSDist(d )\n1 1\n12 N(d ) 0.5141 <-- Uses formula NormSDist(d )\n2 2\n13\n14 Call price 2.47 <-- S*N(d )-X*exp(-r*T)*N(d )\n1 2\n15 Put price 1.73 <-- call price - S + X*Exp(-r*T): by put-call parity\n16\n17 Call bang 6.0483 <-- =B11*B2/B14\n458 Chapter 17\nT he \u201ccall bang\u201d defined in cell B17 is simply the percentage change in the\ncall price dividend by the percentage change in the stock price (in economics\nthis is known as the \u201cprice elasticity\u201d):\n\u2202C/C \u2202C S S\nCallbang= = =N(d )\n\u2202S/S \u2202S C 1 C\nSimilarly, for a put, the \u201cbang for the buck\u201d is defined by the formula below\n(of course the story behind the put \u201cbang for the buck\u201d is that you are con-\nvinced that the stock price will go down):\n\u2202P/P \u2202P S S\nPutbang= = =\u2212N(\u2212d )\n\u2202S/S \u2202S P 1 P\nThis is defined in cell B18. To make the numbers easier to understand, we\nS\nhave dropped the minus sign, making the \u201cput bang\u201d = N(\u2212d ) .\n1 P\nThe graph below shows the \u201cbang for the buck\u201d for both calls and puts:\n16\n14\n12\n10\n8\n6\n4\n2\n0\n15 17 19 21 23 25 27 29 31\n\"gnab\"--yticitsale\ntiforP\n\"Bang for the Buck\"\nThe Price Elasticity of Calls and Puts\nas a Function of the Exercise Price X\nCalls\nPuts\n459 The Black-Scholes Model\nI f you play with the spreadsheet, you will see that the longer the time to\nmaturity, the less the bang for the buck. (Another way of saying all of this is\nthat the most risky options are the most out-of-the-money and the shortest-term\noptions.)\nD E F G H I\n23 Data table: Effect of S and T on \"call bang\"\nData table\n24\nheader:\n25 T--option time to exercise\n=B17\n26 6.0483 0.25 0.5 0.75 1\n27 15 25.8856 14.1771 10.1696 8.1112\n28 16 23.3305 12.9884 9.4123 7.5625\n29 17 20.9954 11.9033 8.7218 7.0623\n30 18 18.8590 10.9121 8.0914 6.6057\n31 19 16.9052 10.0067 7.5154 6.1882\n32 20 15.1222 9.1805 6.9891 5.8062\n33 21 13.5007 8.4274 6.5082 5.4565\n34 22 12.0334 7.7424 6.0691 5.1362\n35 23 10.7137 7.1205 5.6682 4.8426\n36 24 9.5347 6.5572 5.3025 4.5737\n37 25 8.4893 6.0483 4.9691 4.3272\n38 26 7.5694 5.5896 4.6655 4.1012\n39 27 6.7664 5.1773 4.3892 3.8941\n40 28 6.0706 4.8074 4.1379 3.7043\n41 29 5.4720 4.4764 3.9094 3.5303\n42 30 4.9598 4.1807 3.7019 3.3708"
        ],
        "17.9": [
            "What is the Black (1976) Model for Bond Option Valuation?\nWhat adaptations did Black (1976) suggest to the Black-Scholes model for bond option valuation?\nWhat does 'F' represent in the context of Black (1976) Model?\nWhat is the Black-Scholes equation's replacement in the Black (1976) Model for Bond Option Valuation?\nHow is the option maturity represented when using the Black (1976) Model?\nWhat is the exercise price in the Black (1976) Model used to value an option on a zero coupon bond?\nIn the use case example in the Black (1976) Model, what does the risk-free interest rate represent?\nWhat does 'sigma' represent in the case of the Black (1976) Model for Bond Option Valuation?\nHow is the pricing of the bond option conducted using the Black (1976) Model?\nWhat is the value of a call and put option as calculated by the Black (1976) Model in the given scenario?\nHow is the forward interest rate defined in this context?\nWhat is a 7-year rate in the context of forward interest rate?\nHow is a forward rate computed when interest rates are discretely compounded?\nWhat does it mean for rates to be continuously compounded?\nCan you define the concept of continuously compounded forward rate?\nWhen applying the forward interest rate to the given example, what assumptions are made about the bond in question?\nHow is the bond's maturity represented in the use case example?\nWhat is the bond's maturity value?\nWhat represents the interest rate to the bond and option maturity in the use case example?\nHow is the forward price of the bond calculated?",
            "17.9 The Black (1976) Model for Bond Option Valuation7\n\nBlack (1976) suggested an adaptation of the Black-Scholes model which is\noften used for simple valuation of options on bonds or forwards. Letting F\nstand for the forward price of an asset, the Black-Scholes equation given in\nsection 17.2 is replaced by\n7. This section is advanced and can be skipped on first reading. A full discussion of the pricing\nof options on bonds is beyond the scope of the current edition of this book. However, this very\n460 Chapter 17\nC=e\u2212rT[FN(d )\u2212XN(d )],\n1 2\nwhere\nln(F /X)+\u03c32T 2\nd =\n1 \u03c3 T\nd =d \u2212\u03c3 T\n2 1\nThe corresponding put price is given by:\nP=e\u2212rT[XN(\u2212d )\u2212FN(\u2212d )]\n2 1\nT o use the Black (1976) model, consider the case of an option on a zero\ncoupon bond, where the option maturity is T = 0.5. The option gives the holder\nthe opportunity to buy the bond at time T for exercise price X = 130. Suppose\nthat the risk-free interest rate is r = 4%. If the forward price of the bond to the\nexercise date is F = 133 and the volatility of the forward price is\u03c3 = 6%, then\nthe pricing of the bond option using the Black (1976) model is given below.\nA B C\nUSING THE BLACK (1976) MODEL\n1 TO PRICE A BOND OPTION\n2 F 133.011 <-- Bond forward price\n3 X 130.000 <-- Exercise price\n4 r 4.00% <--Risk-free rate of interest\n5 T 0.5\n6 Sigma 6% <-- Bond forward price volatility, \u03c3\n7\n8 d 0.5609 <-- =(LN(B2/B3)+B6^2*B5/2)/(B6*SQRT(B5))\n1\n9 d 0.5185 <-- =B8-SQRT(B5)*B6\n2\n10\n11 Call price 4.13 <-- =EXP(--B4*B5)*(B2*NORMSDIST(B8)-B3*NORMSDIST(B9))\n12 Put price 1.02 <-- =EXP(-B4*B5)*(B3*NORMSDIST(-B9)-B2*NORMSDIST(-B8))\nThus a call on the bond is worth 4.13 and a put is worth 1.02.\nDetermining the Bond \u2019 s Forward Price\nThe forward interest rate is the interest rate which can be locked in today for\na loan in the future. In the example below, the current 7-year rate is 6% and\n461 The Black-Scholes Model\nand a loan in the other maturity, we create a security which has zero cash flows\neverywhere except at years 4 and 7:\nA B C D E F G H I J\n1 THE FORWARD INTEREST RATE\n2 Bond maturity, W 7\n3 Option maturity, T 4\n4 Year W pure discount rate 6%\n5 Year T pure discount rate 5%\n6\n7 Discretely-compounded interest rates\n8 0 1 2 3 4 5 6 7 8\n9 7-year deposit at 6.00% 100.00 -150.36\n10 4-year loan at 5.00% -100.00 121.55\n11 Sum of above: A 3-year deposit at year 4 0.00 121.55 -150.36\n12\nDiscretely compounded forward interest rate\n13 from year 4 to year 7 7.35%<-- =(-I11/F11)^(1/(B2-B3))-1\n14\n15 Continuously-compounded interest rates\n16 0 1 2 3 4 5 6 7 8\n17 7-year deposit at 6.00% 100.00 -152.20\n18 4-year loan at 5.00% -100.00 122.14\n19 Sum of above: A 3-year deposit at year 4 0.00 122.14 -152.20\n20\nContinuously compounded forward interest rate\n21 from year 4 to year 7 7.33%<-- =LN(-I19/F19)/(B2-B3)\nThe spreadsheet above shows two forward rate computations. If the interest\nrates are discretely compounded, then the forward rate from year 4 to year 7\nis given by:\nDiscretelycompounded forward \u23a1( 1+r )7\u23a4\u23a4(1/3)\n=\u23a2 7 \u23a5 \u22121\nrate,year4to7 \u23a3( 1+r )4\u23a6\n4\n\u23a1( 1+6%)7\u23a4(1/3)\n=\u23a2 \u23a5 \u22121\n\u23a3( 1+5%)4\u23a6\n\u239b1.5036\u239e(11/3)\n=\u239c \u239f \u22121=7.35%\n\u239d \u23a0\n1.2155\nIf the rates are continuously compounded (as in the Black model and most\noption calculations):\nContinouslycompounded forward \u239b1\u239e \u23a1er7\u22177\u23a4\nrate,year4to7\n= \u239d 3\u23a0ln \u23a3\u23a2 er4\u2217\u22174\u23a6\u23a5\n\u239b1\u239e\u239b1.5220\u239e\n= =7.33%\n\u239d \u23a0\u239d \u23a0\n462 Chapter 17\nT o apply the forward interest rate to the example in the previous subsection,\nassume that the bond in question has a maturity of 2 years and a face value at\nmaturity of 147. Then if the 2-year interest rate is r = 6% and the interest rate\n2\nto the option\u2019 s maturity is r = 4%, the forward price of the bond is F =\n0.5\n133.011, as shown below:\nA B C\nDETERMINING THE FORWARD PRICE\n1 OF THE BOND\n2 Bond's maturity, N 2\n3 Option maturity, T 0.5\n4 Bond maturity value 147\n5\n6 Interest rate to N 6%\n7 Interest rate to T 4%\n8\n9 Bond forward price to T 133.011 <-- =B4*EXP(-B6*B2)*EXP(B7*B3)"
        ],
        "17.10": [
            "What is the Black-Scholes formula used for in finance?\nWhat does the implementation of the Black-Scholes formula entail?\nHow can plain Excel be utilized in the context of the Black-Scholes formula? \nWhat is the role of VBA in defining the Black-Scholes price and the implied volatility for options?\nHow is the Black-Scholes formula applied to price structured products? \nWhat are structured products in the context of the Black-Scholes formula? \nWhat components are considered in the pricing of structured products using the Black-Scholes formula?\nWhat does the concept of 'implied volatility' mean in relation to the Black-Scholes model?\nHow is the Black-Scholes formula considered innovative in the field of finance?\nWhat is the significance of 'plain vanilla' Excel in pricing Black-Scholes options?",
            "17.10 Summary\n\nThe Black-Scholes formula for pricing options is one of the most powerful\ninnovations in finance. The formula is widely used both to price options and\nas a conceptual framework for analyzing complex securities. In this chapter\nwe have explored the implementation of the Black-Scholes formula. Using\n\u201cplain vanilla\u201d Excel allows us to price Black-Scholes options; using VBA we\nare able define both the Black-Scholes price and the implied volatility for\noptions. Finally, we showed how to use Black-Scholes to price structured\nproducts\u2014combinations of options, stocks, and bonds."
        ]
    },
    "18": {
        "18.1": [
            "What is the significance of Greeks in financial modeling?\nCan you explain the concept of Delta in the Black-Scholes formula?\nHow can Delta be interpreted in terms of an option's price variability?\nWhat does Gamma signify in relation to an option's price?\nWhat is the role of Vega in the sensitivity of the option price?\nWhat Greek letter is alternatively used to denote Vega, and why?\nCan you explain the concept of Theta in the Black-Scholes formula?\nWhat is the relationship between Theta and an option's time to maturity?\nWhat do we generally expect in terms of an option's value with the decrease in time to maturity?\nWhat does Rho measure in the context of options?\nHow is Rho related to interest rate sensitivity of an option?\nWhat are the practical uses of the Greeks in hedging?\nWhat model is used for illustrating the use of Greeks?",
            "18.1 Overview\n\nI n this chapter we discuss the sensitivities of the Black-Scholes formula to its\nvarious parameters. The \u201cGreeks,\u201d as they are called (because of the Greek\nletters used to denote most of them), are the partial derivatives of the Black-\nScholes formula with respect to its arguments. They can be thought of as\ngiving a measure of the riskiness of an option:\n\u2022 Delta, denoted by \u0394 , is the partial derivative of the option price with respect\n\u2202Call \u2202Put\nto the price of the underlying stock price: \u0394 = ,\u0394 = . Delta,\nCall \u2202S Put \u2202S\n\u0394, can be thought of as a measure of the variability of the option\u2019 s price when\nthe price of the underlying changes.\n\u2022 Gamma, \u0393 , is the second derivative of the option \u2019 s price with respect to the\nunderlying stock. Gamma gives the convexity of the option price with respect\nto the stock price. For options priced by the Black-Scholes formula, the call\n\u22022Call \u22022Put\nand put have the same gamma: \u0393 = =\u0393 = .\nCall \u2202S2 Put \u2202S2\n\u2022 Vega is the sensitivity of the option price to the standard deviation of the\nunderlying stock \u2019 s return \u03c3 : For no obvious reason, the Greek letter kappa, \u03ba ,\nis sometimes used to denote vega. Given the Black-Scholes formula, calls and\n\u2202Call \u2202Put\nputs have the same vega: \u03ba = = .\n\u2202\u03c3 \u2202\u03c3\n\u2022 Theta, \u03b8 , is change in the option \u2019 s value as the time to maturity decreases.\nWe generally expect that options become less valuable with the passage of\ntime (though this turns out not to be always true). Writing T as the option \u2019 s\nremaining time to maturity, we set theta equal to the negative of the\n\u2202Call \u2202Put\nderivative of the option price with respect to T : \u03b8 =\u2212 ,\u03b8 =\u2212 .\nCall \u2202T Put \u2202T\n\u2022 Rho, \u03c1 , measures the interest rate sensitivity of an option:\n\u2202Call \u2202Put\n\u03c1 =\u2212 ,\u03c1 =\u2212 .\nCall \u2202r Put \u2202r\nIn this chapter we show you how to measure an option \u2019 s Greeks and how\nto use them in hedging. For generality we illustrate using the Merton model\n(Chapter 17, section 6), an extended version of the Black-Scholes formula\n468 Chapter 18"
        ],
        "18.2": [
            "What are \"Option Greeks\" in financial modeling?\nCan you explain the Merton Model used in options pricing?\nWhat is the significance of the Black-Scholes model in financial modeling?\nHow does the Merton model modify the Black-Scholes model for pricing options on an underlying asset that pays a continuous dividend?\nWhat are the key parameters in the Merton model for pricing currency options?\nWhat does 'delta' represent in the context of Option Greeks?\nWhat is the formula for calculating the 'gamma' of an option?\nHow does 'vega' relate to the volatility of the underlying asset in options pricing?\nWhat is the significance of 'theta' in Option Greeks?\nWhy do options generally have a negative theta?\nHow does the time to maturity affect the 'rho' of an option?\nWhat is the impact of a call or a put becoming more in-the-money on its delta?\nHow does the stock price affect the delta of a call or put option?\nHow does the time to maturity of an option impact its delta?\nWhat is the relationship between moneyness of an option and its theta?\nWhat does a positive theta indicate for very in-the-money puts?\nHow does the stock price impact the theta of a call or put option?\nWhat is the relationship between time to maturity and moneyness of an option and its theta? \nWhat adjustments does the Merton model make to the Black-Scholes formula for those options that are defined on an underlying which pays a continuous dividend?",
            "18.2 Defining and Computing the Greeks\n\nThe \u201cGreeks\u201d are the sensitivities of an option price with respect to certain of\nits variables. In the table below we set out the Greeks for options defined on\nan underlying which pays a continuous dividend. As discussed in section 17.6,\nsuch options are priced using the Merton model. Of course, the standard Black-\nScholes model is obtained from the Merton model by setting the dividend yield\nk = 0. Currency options can be priced by the Merton formula by setting S =\ncurrent exchange rate, X = option exercise exchange rate,r = domestic interest\nrate, and k = foreign interest rate.\nThe Merton version of the Black-Scholes formula is given by:\nC=Se\u2212kTN(d )\u2212Xe\u2212rTN(d )\n1 2\nP=\u2212Se\u2212kTN(\u2212d )+Xe\u2212rTN(\u2212d )\n1 2\nwhere\n\u239b S\u239e\nln +(r\u2212k+\u03c32/2)T\n\u239d \u23a0\nd = X\n1 \u03c3 T\nd =d \u2212\u03c3 T\n2 1\nT he table on page 469 gives the Greeks for this formula. The appendix to\n469 Option Greeks\nskeerG\nselohcS-kcalB\ntuP\nllaC\nserusaeM\n)1\n\u2212\n)\n1 d ( N ( T ke \u2212\n=\ntu\nP\n\u0394\n) 1 d (\nN\nT k e \u2212\n=\nlla\nC\n\u0394\nV\u2202\nnoitpo\nfo\nytivitisnes\necirP\nsa\nnettirw\n,atleD\n) d \u2212 ( N\nTek\n\u2212\n=\nS\u2202\n\u03b4\nro\n\u0394 rehtie\n1 Tk\u22122/2)\n1d(\ne\n)\nd(\u2032NTk\u2212e\nytivitisnes\necirp\nredro-dnoceS\n\u0393\nsa\nnettirw\n,ammaG\n=\n1\nV2\u2202\n\u03c0T2\n\u03c3S\nT\n\u03c3S\nytixevnoc\ns \u2019 noitpo\nehT\n.\n2S\u2202\n.ecirp\ngniylrednu\not\ntcepser\nhtiw\nTk\u22122 2) 1d(\u2212e\nT\nS\nV\u2202\nkeerG\non ,ageV\n\u03c02\n=\nT\n)\n1d(\u2032NTk\u2212eS\n\u03c3\u2202\nytilitalov\not\nytivitisneS\nkeerG\ne hh\ntg u seo\nmht i t, ere mtt\noe\nsl\ndesu\nsi\n\u03ba appak\n\u03c3)\nd(\u2032NTk\u2212eS\n\u03c3) d(\u2032NTk\u2212eS\nV\u2202\n\u03b8\nsa\nnettirw\n,atehT\n)\nd\u2212(NTk\u2212eSk\u2212\n1\n\u2212\n)\nd(NTk\u2212eSk+\n1\n\u2212\n\u2212\nytivitisnes\nemiT\n1\nT 2\n1\nT 2\nT\u2202\n)\nd\u2212(NTr\u2212eXr+\n) d(NTr\u2212eXr\u2212\n2\n2\n) d \u2212 ( N T\nr \u2212\nd ( N\nT\nr \u2212 eTX\neTX\n\u2212)ytivitisnes\netar\ntseretnI\n\u03c1 ,ohR\n2\n2\n\u239e2\u03c3\n\u239b\n)\n2x\u2212(\n1\nT\n\u23a0\u239f\n2\n+k\u2212r\n\u239d\u239c+)X/S(nl\n2\ne\n=)x(\u2032N,T\n\u03c3\u2212\nd=\nd,\n=\nd\n:srednimeR\n\u03c02\n1\n2\nT\u03c3\n470 Chapter 18\nThe Greeks are implemented in the spreadsheet below, which shows both\nthe brute-force calculation of each Greek as well as a VBA function\nimplementation.\nA B C\nBLACK-SCHOLES GREEKS\nUses Merton model for a continuously dividend-paying stock\n1\n2 S 100Current stock price\n3 X 90Exercise price\n4 T 0.5Time to maturity of option (in years)\n5 r 6.00%Risk-free rate of interest\n6 k 2.00%Dividend yield\n7 Sigma 35%Stock volatility\n8\n9 d 0.6303<-- =(LN(B2/B3)+(B5-B6+0.5*B7^2)*B4)/(B7*SQRT(B4))\n1\n10 d 0.3828<-- d-sigma*SQRT(T)\n2 1\n11\n12 N(d) 0.7357<-- Uses formula NormSDist(d)\n1 1\n13 N(d) 0.6491<-- Uses formula NormSDist(d)\n2 2\n14\n15 Call price 16.1531<-- =B2*EXP(-B6*B4)*B12-B3*EXP(-B5*B4)*B13\n16 16.1531<-- =bsmertoncall(B2,B3,B4,B5,B6,B7)\n<-- =B3*EXP(-B5*B4)*NORMSDIST(-B10)-B2*EXP(-\n4.4882\n17 Put price B6*B4)*NORMSDIST(-B9)\n18 4.4882<-- =bsmertonput(B2,B3,B4,B5,B6,B7)\n19\n20 Call Greeks, brute force\n21 Delta 0.7284<-- =EXP(-B6*B4)*NORMSDIST(B9)\n22 Gamma 0.0131<-- =EXP(-(B9^2)/2-B6*B4)/(B2*B7*SQRT(2*B4*PI()))\n23 Vega 22.8976<-- =B2*SQRT(B4)*EXP(-(B9^2)/2)*EXP(-B6*B4)/SQRT(2*PI())\nTheta -9.9587<-- =-B2*EXP(-(B9^2)/2-B6*B4)*B7/SQRT(8*B4*PI())+B6*B2*EXP(-\n24 B6*B4)*B12-B5*B3*EXP(-B5*B4)*B13\n25 Rho 28.3446<-- =B3*B4*EXP(-B5*B4)*NORMSDIST(B10)\n26\n27 Call Greeks, VBA formulas\n28 Delta 0.7284<-- =deltacall(B2,B3,B4,B5,B6,B7)\n29 Gamma 0.0131<-- =optiongamma(B2,B3,B4,B5,B6,B7)\n30 Vega 22.8976<-- =vega(B2,B3,B4,B5,B6,B7)\n31 Theta -9.9587<-- =Thetacall(B2,B3,B4,B5,B6,B7)\n471 Option Greeks\nGreek calculations for puts are given below:\nE F G\n20 Put Greeks, brute force\n21 Delta -0.2616<-- =-EXP(-B6*B4)*NORMSDIST(-B9)\n22 Gamma 0.0131<-- =EXP(-(B9^2)/2-B6*B4)/(B2*B7*SQRT(2*B4*PI()))\n23 Vega 22.8976<-- =B2*EXP(-(B9^2)/2-B6*B4)*SQRT(B4)/SQRT(2*PI())\nTheta -6.6984<-- =-B2*EXP(-(B9^2)/2-B6*B4)*B7/SQRT(8*B4*PI())-B6*B2*EXP(-\n24 B6*B4)*(1-B12)+B5*B3*EXP(-B5*B4)*(1-B13)\n25 Rho -15.3255<-- =-B3*B4*EXP(-B5*B4)*NORMSDIST(-B10)\n26\n27 Put Greeks, VBA formulas\n28 Delta -0.2616<-- =deltaput(B2,B3,B4,B5,B6,B7)\n29 Gamma 0.0131<-- =optiongamma(B2,B3,B4,B5,B6,B7)\n30 Vega 22.8976<-- =vega(B2,B3,B4,B5,B6,B7)\n31 Theta -6.6984<-- =Thetaput(B2,B3,B4,B5,B6,B7)\n32 Rho -15.3255<-- =rhoput(B2,B3,B4,B5,B6,B7)\nExcel can be used to examine the sensitivities of the Greeks to various\nparameters. We give some examples below. Figures 18.1 and 18.2 show the\ndeltas as functions of the stock price and as functions of the moneyness of the\ncall option.\n1\n0.8\n0.6\n0.4\n0.2\n0\n0 20 40 60 80 100 120 140\n-0.2\n-0.4\n-0.6\n-0.8\n-1\natleD\nCall and Put Deltas as Functions of Stock Price\nStock price\nCall\ndelta\nPut delta\nFigure 18.1\nA s a call or a put becomes more in-the-money, the delta tends toward +1 for a call and \u20131 for a\nput. Essentially, the call or put price moves in tandem with the underlying stock price. An\n472 Chapter 18\n1.0\n0.9\n0.8\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n0.1\n0.0\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\natled\nllaC\nCall Delta, Time to Maturity, and Moneyness\nOut of the money\nAt the money\nIn the money\nTime to option expiration, T\nFigure 18.2\nAs the option \u2019 s maturity T increases, the delta of an at-the-money and an out-of-the-money call\nincreases, whereas the delta of an in-the-money call decreases.\nFigures 18.3 and 18.4 show the theta of a call as a function of the stock\n473 Option Greeks\n6\n5\n4\n3\n2\n1\n0\n-1 0 20 40 60 80 100 120 140\n-2\n-3\n-4\n-5\n-6\n-7\n-8\n-9\n-10\n-11\n-12\natehT\nCall and Put Thetas as Functions of Stock Price\nOption Exercise Price = 100\nStock price\nCall theta\nPut theta\nFigure 18.3\nVery in-the-money puts can have a positive theta, meaning that as the time to maturity gets shorter,\nthe put gains in value. Other than this case, options generally have a negative theta, meaning that\nthey lose value as the time to maturity decreases.\n0\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n-5\n-10\n-15\n-20\n-25\natehT\nCall Theta, Time to Maturity, and Moneyness\nTime to option maturity\nOut of the money\nAt the money\nIn the money\nFigure 18.4\nC alls always have negative theta (meaning that they lose value as the time to maturity decreases).\n474 Chapter 18"
        ],
        "18.3": [
            "What is Delta hedging in the context of option pricing?\nWhat is represented by a portfolio of stocks and bonds in Delta hedging?\nWhat does Black-Scholes formula determine in the process of Delta hedging?\nWhat are the key parameters considered while replicating an at-the-money European call option?\nWhat is the Black-Scholes price of an option and how is it computed?\nWhat is meant by initial pricing of a call using Black-Scholes formula?\nHow are the stock and bond positions set at the initial date in delta hedging?\nWhat adjustments are made to the stock position and the bond position at each subsequent date?\nWhat happens to the stock and bond portfolios at the final date?\nWhat is the significance of portfolio rebalancing in Delta hedging?\nWhat is a perfect hedge in the context of Delta hedging?\nHow does the actual hedge payoff differ from the desired payoff?\nWhat is the role of delta in delta hedging?\nWhat happens in the process of replicating the BS option pricing formula using delta hedging?\nCan you elaborate on the week-to-week basis of replicating the BS option pricing formula in delta hedging?\nWhat is meant by liquidating the portfolio at the end of the period?\nWhat would be the condition for a delta hedge to be perfect?\nHow is the deviation between the desired payoff and the hedge position checked?\nWhat role does the interest rate play in delta hedging?\nWhat is the importance of the stock's volatility in the context of option pricing and delta hedging?",
            "18.3 Delta Hedging a Call1\n\nD elta hedging is a fundamental technique in option pricing. The idea is to\nreplicate an option by a portfolio of stocks and bonds, with the portfolio pro-\nportions determined by the Black-Scholes formula.\nS uppose we decide to replicate an at-the-money European call option which\nhas 12 weeks to run until expiration. The stock on which the option is written\nhas S = $40 and exercise price X = $35, the interest rate is r = 4%, and the\n0\nstock \u2019 s volatility is \u03c3 = 25%. The Black-Scholes price of this option is 5.44:\nA B C D E F G H\n1 DELTA HEDGING A CALL\n2 S, current stock price 40.00\n3 X, exercise 35.00\n4 r, interest rate 2.00%\nInitial pricing of call using\n5 k, dividend yield 0.00%\nBlack-Scholes formula\n6 T, expiration 0.2308<-- =12/52\n7 Sigma 25%\n8\n9 BS value 5.44<-- =bsmertoncall(B2,B3,B6,B4,B5,B7)\n10\n11 Hedging portfolio\nStock =\nTime until Porfolio Portfolio\nWeeks until expiration Stock price =C13*deltacall(C13,$B$3, Investment in Bond\n12 expiration B13,$B$4,0,$B$7) stock value cash flow\n13 12 0.2308 40.000 35.48 -30.04 5.44 5.44\n14 11 0.2115 38.042 30.19 -3.5498 -26.50 3.69 0.00\n15 10 0.1923 38.884 33.17 2.3135 -28.82 4.35 0.00\n16 9 0.1731 38.568 32.62 -0.2814 -28.55 4.07 0.00\n17 8 0.1538 38.501 32.87 0.3044 -28.87 4.00 0.00\n18 7 0.1346 37.768 30.87 -1.3759 -27.50 3.36 0.00\n19 6 0.1154 39.383 36.54 4.3488 -31.86 4.67 0.00\n20 5 0.0962 40.406 39.29 1.8031 -33.68 5.61 0.00\n21 4 0.0769 39.626 38.34 -0.1859 -33.51 4.84 0.00\n22 3 0.0577 39.216 38.20 0.2496 -33.77 4.43 0.00\n23 2 0.0385 39.745 39.58 0.8646 -34.65 4.93 0.00\n24 1 0.0192 41.522 41.52 0.1756 -34.83 6.69 0.00\n25 0 0.0000 43.199 8.35\n26\n27 Hedged position payoff 8.35<-- =G25\n28 Actual call payoff 8.20<-- =MAX(C25-B3,0) At initial date, the stock and bond positions are set using the Black-\n29 Scholes formula: Stock = SN(d), Bond = -X*exp(-rT)N(d).\n1 2\n30\n31 Formulas At each subsequent date t, the stock position is adjusted to S t*\u0394 call.\n32 Cell D14: =C14*deltacall(C14,$B$3,B14,$B$4,0,$B$7) The bond position is adjusted so that the net cash flow of the\n33 Cell E14: =D14-D13*C14/C13 portfolio is zero.\n34 Cell F14: =F13*EXP($B$4/52)-E14\n35 Cell G14: =D14+F14 At the final date, the stock and bond portfolios are liquidated.\n36 Cell H14: =(D13*C14/C13-D14)+F13*EXP($B$4*(B13-B14))-F14\n475 Option Greeks\nNote that we use the formula BSMertoncall but with the dividend yield\nk = 0%, so that this is, in effect, a regular BS call option.\nIn the spreadsheet above, we create this option by replicating, on a week-\nto-week basis, the BS option pricing formula using delta hedging.\n\u2022 At the beginning, 12 weeks before the option \u2019 s expiration, we determine our\nstock/bond portfolio according to the formula C all=SN(d )\u2212Xe\u2212rTN(d ) ,\n1 2\nso that we have a dollar amount SN(d ) of shares in the portfolio and have\n1\nborrowing of Xe\u2212rTN(d ) . Having determined the portfolio holdings at the\n2\nbeginning of the 12-week period, we now determine our portfolio holdings for\neach of the successive weeks as follows:\n\u2022 In each successive week we set the stock holdings in the portfolio according\nto the formula SN(d ) , but we set the portfolio borrowing so that the n et cash\n1\nflow of the portfolio is zero. Note that SN(d )=S\u0394 , hence the name \u201cdelta\n1 Call\nhedging.\u201d\n\u2022 At the end of the 12-week period, we liquidate the portfolio.\nThe delta hedge would be perfect if we rebalanced our portfolio continu-\nously. However, here we have rebalanced only weekly. Had we a perfect\nhedge, the portfolio would have paid off max[S \u2212X,0] (cell B27); the\nTerminal\nactual hedge payoff (cell B28) is slightly different. Using the technique of\nData Table on a blank cell explained in Chapter 31, we replicate this simula-\ntion to check the deviation between the desired payoff and the hedge position\n476 Chapter 18\nK L M N O P Q R S T U V\nDelta Hedge\u2014\nhedge Max(ST- actual\n12 Simulation payoff X,0) payoff\n13 5.4024 5.3669 0.0355<-- =L13-M13, data table header\n14 1 3.4743 3.5591 -0.0848\n15 2 0.3252 0.0000 0.3252\n16 3 0.0971 0.0000 0.0971 Hedge\u2014Actual Payoff\n17 4 -0.0193 0.0000 -0.0193\n18 5 11.8112 12.2037 -0.3925 0.4\n19 6 3.5610 3.4877 0.0733\n0.2\n20 7 10.6744 10.7604 -0.0860\n21 8 8.6602 8.8020 -0.1417 0.0\n22 9 10.3202 10.2422 0.0780 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21\n23 10 4.3520 4.2742 0.0777 -0.2\n24 11 2.3202 2.1388 0.1814\n25 12 0.0123 0.0000 0.0123 -0.4\n26 13 6.4462 6.2541 0.1920\n27 14 2.7854 3.5831 -0.7978 -0.6\n28 15 10.6339 10.7932 -0.1592\n-0.8\n29 16 3.1851 3.0200 0.1651\n30 17 1.8986 2.0582 -0.1596 -1.0\n31 18 13.6581 13.8167 -0.1586\n32 19 7.9048 7.8179 0.0869\n33 20 7.5720 7.6190 -0.0471"
        ],
        "18.4": [
            "- What is a collar in financial modeling?\n- How is a collar designed to protect a package of shares?\n- What is the usual composition of a collar?\n- How is the net cost of a collar position calculated?\n- What does it mean when we say that the collar provides costless protection to its holder?\n- What is the role of a bank in the context of a collar?\n- What are the parameters a client can define in a collar design?\n- What is the function of the Black-Scholes value in a collar?\n- What does the term 'terminal payoffs' refer to in relation to a collar?\n- How does the addition of shares to a collar affect the value for the holder?\n- What are some reasons why a client might agree to pay more than the Black-Scholes value for a collar? \n- What is the bank's problem in delta hedging a collar?\n- How is the bank's position explained with the Black-Scholes formula?  \n- How is the bank\u2019s net position defined for a collar?\n- What is meant by making a collar gamma neutral?\n- How can we moderate the gamma of the collar?\n- What strategies can be implemented to increase the hedge frequency?\n- What is the concept of making the hedge gamma neutral?\n- How can adding an out-of-the-money put to a position neutralize the large call gamma in hedging? \n- How is the cost of traditional collar delta calculated?",
            "18.4 Hedging a Collar\n\nA collar is an option strategy designed to protect the holder of a package of\nshares against possible price losses. The usual collar is a combination of a\nwritten call plus a purchased put, designed so that the net cost of the position\nis zero. Thus the collar provides costless protection to its holder. Here\u2019 s an\nexample: On 1 January 2008, a bank \u2019 s client holds 5,000,000 shares of XYZ\nCorp. Each share is currently worth $55. Because the stock is currently\nrestricted, the client cannot sell the shares until 1 year from now. However, he\nis worried that the stock price will decline, and hence he desires to purchase\na collar.\nThe client asks an investment bank to design the following package:\n\u2022 He wants to buy a put on the shares with T = 1 year and exercise price\nx = $49.04\nPut\n\u2022 He wants to write a call on the shares with T = 1 year and exercise price\nX = $70.00.\nCall\nT he exercise prices have been set so that the Black-Scholes value of the call\n477 Option Greeks\nA B C D\nCOLLAR: THE PURCHASER OWNS A WRITTEN CALL\nAND A BOUGHT PUT\n1\n2 Call Put\n3 S 55.00 55.00\n4 X 70.00 49.04\n5 T 1 1\n6 r, interest 4.00% 4.00%\n7 k, dividend yield 0.00% 0.00%\n8 Sigma 40% 40%\n9\n10 BS option value 4.74 4.74<-- =bsmertonput(C3,C4,C5,C6,C7,C8)\n11\n12 Call minus put 0.00<-- =B10-C10\n13\n14\n15 =bsmertoncall(B3,B4,B5,B6,B7,B8)\nGiven the X = 70 for the call, the put exercise price was determined using\nCall\n478 Chapter 18\nT he point of the collar is to give the purchaser upside potential with limited\ndownside risk. In the example above, for example, the terminal payoffs of the\nput, the call, and the collar are given by:\nCollar Payoff\n70\n60\n50\n40\n30\n20\n10\n0\n-10 0 10 20 30 40 50 60 70 80 90\n-20 Terminal stock price, S T\nPutpayoff Callpayoff Collarpayoff Collar+Stockposi(cid:415)on\nIn addition to his collar, the client has a portfolio of the shares. The payoffs\nto the holder of the collar plus the shares are never less than $49. This is, of\n479 Option Greeks\nCollar Payoff + Stock Value to Holder\nHolder Never Gets Less Than Collar Xput\n70\n60\n50\n40\n30\nCollar payoff\n20\nCollar + stock\n10\n0\n0 10 20 30 40 50 60 70 80 90\n-10\n-20\nTerminal stock price, S\nT\nA Slightly Longer Story\nEven though the Black-Scholes value of the collar is initially zero, actually\nthe investment bank sold the collar to the client for $5. There are several\nreasons why the client might want to pay this:\n\u2022 P erhaps there is low liquidity in the options (this is often the case in longer-\nterm options), so that the bank is actually supplying a valuable liquidity\nservice.\n\u2022 It might be that the options do not actually exist\u2014either because the particu-\nlar long-term options in question are not marketed or perhaps because there\nare no options on the particular underlying stock (this is often the case for\nspecific portfolios). In this case the bank is actually creating the options under-\nlying the collar by creating an appropriate portfolio of stocks and bonds and\nby changing the portfolio proportions over time (see next subsection).\nThe creation and constant monitoring of this portfolio is a service worth\npaying for.\nDelta Hedging the Collar: The Bank \u2019s Problem\nThe client for the collar is short a call and long a put. The bank wants to make\na similar investment, so that it will parallel the client\u2019 s portfolio and have\n480 Chapter 18\nBlack-Scholes formula this turns out to mean that the net position of the bank\nis a short stock financed by a bond investment:\n\u2212 (cid:2)[S(cid:4)N(cid:4)(d(cid:4)1[(cid:4)X C(cid:4)all(cid:4)])(cid:4)\u2212 (cid:4)(cid:4)X(cid:3)C(cid:4)alle(cid:4)\u2212rT (cid:4)N(cid:4)(d(cid:4)2[(cid:4)X C(cid:4)all(cid:4)(cid:5)])]\n\u2191\nShort call\n\u2212 (cid:2)S(cid:4)N(cid:4)(cid:4)(\u2212 (cid:4)d 1[(cid:4)X(cid:4)Put(cid:4)])(cid:4)+ (cid:4)X(cid:3)P(cid:4)ute(cid:4)\u2212rT (cid:4)N(cid:4)(\u2212 (cid:4)d 2(cid:4)[X(cid:4)Pu(cid:4)(cid:5)t])\n\u2191\nLong put\n=\u2212 (cid:2)S(cid:4)(N(cid:4)(d(cid:4)1[(cid:4)X(cid:4)Ca(cid:4)ll](cid:3))+ (cid:4)N(cid:4)(\u2212 (cid:4)d 1(cid:4)[X(cid:4)Pu(cid:4)t](cid:5)))\n\u2191\nShort stockk position\n+ (cid:2)e(cid:4)\u2212rT (cid:4)[X(cid:4)C(cid:4)allN(cid:4)((cid:4)d 2[(cid:4)X(cid:4)C(cid:4)al(cid:3)l])(cid:4)+ (cid:4)X P(cid:4)utN(cid:4)((cid:4)\u2212d(cid:4)22[(cid:4)X(cid:4)Put(cid:4)(cid:5)])]\n\u2191\nLong bond position\nWe rewrite this in terms of Greeks:\n\u2212 (cid:2)S(cid:4)(N(cid:4)(d(cid:4)1[(cid:4)X(cid:4)Ca(cid:4)ll](cid:3))+ (cid:4)N(cid:4)(\u2212 (cid:4)d 1(cid:4)[X(cid:4)Pu(cid:4)t](cid:5)(cid:5)))\n\u2191\nShort stock position\n\u2212 (cid:2)e(cid:4)\u2212rT (cid:4)[X(cid:4)C(cid:4)allN(cid:4)((cid:4)d 2(cid:4)[X(cid:4)C(cid:4)al(cid:3)l])(cid:4)+ (cid:4)X P(cid:4)utN(cid:4)((cid:4)\u2212d(cid:4)2[(cid:4)X(cid:4)Put(cid:4)(cid:5)])]\n\u2191\nLong bondd position\n\u23a1X N(d [X ]) \u23a4\n=S(\u2212\u0394 (X )\u2212\u0394 (X )))+e\u2212rT \u23a2 Call 2 Call \u23a5\nCall Call Put Put \u23a3 + X N(\u2212d [X ])\u23a6\nPut 2 Put\nH ere\u2019 s a run of a simulated position over the course of a year. In this simula-\ntion the position is updated every \u0394 t = 0.05; assuming 250 trading days in a\n481 Option Greeks\nA B C D E F G\n1 DELTA HEDGING A COLLAR\n2 S 55.00\n3 X 70.00\ncall\n4 X 49.04\nput\n5 r 4.00%\n6 k, dividend yield 0.00\n7 Sigma 40%\n=(C10*B11/B10-\n8 C11)+D10*EXP($B$5*(A10-A11))\nStock =-\nB10*(deltacall(B10,$B$3,A10,$B$5,$B$\n6,$B$7)-\nTime until deltaput(B10,$B$4,A10,$B$5,$B$6,$B$ Portfolio Portfolio\n9 expiration Stock price 7)) Bond value cash flow\n10 1.00 55.00 -36.28 36.28 0.00 0.00\n11 0.95 62.26 -42.31 37.59 -4.72 0.00\n12 0.90 60.06 -39.59 36.44 -3.15 0.00\n13 0.85 70.57 -50.85 40.85 -10.00 0.00\n14 0.80 68.88 -48.21 39.51 -8.70 0.00\n15 0.75 79.24 -61.94 46.06 -15.88 0.00\n16 0.70 79.96 -62.78 46.43 -16.34 0.00\n17 0.65 84.32 -69.21 49.54 -19.67 0.00\n18 0.60 76.84 -57.58 44.15 -13.44 0.00\n19 0.55 73.80 -52.43 41.36 -11.07 0.00\n20 0.50 89.93 -78.52 56.07 -22.45 0.00\n21 0.45 91.19 -81.01 57.57 -23.43 0.00\n22 0.40 84.63 -70.73 53.24 -17.49 0.00\n23 0.35 78.24 -59.24 47.20 -12.05 0.00\n24 0.30 88.04 -78.30 58.93 -19.37 0.00\n25 0.25 99.20 -96.32 67.14 -29.18 0.00\n26 0.20 95.41 -92.46 67.09 -25.37 0.00\n27 0.15 121.46 -121.44 70.98 -50.47 0.00\n28 0.10 136.73 -136.73 71.13 -65.60 0.00\n29 0.05 130.28 -130.28 71.28 -59.00 0.00\n30 0.00 139.32 -67.90\n31 (cid:1651)\n32 Check: Collar payoff to client at time 0 =C29*B30/B29+D29*EXP($B$5\n33 Short call payoff -69.32<-- =-MAX(B30-B3,0) *(A29-A30))\n34 Long put payoff 0.00<-- =MAX(B4-B30,0)\n35 Total -69.32<-- =SUM(B33:B34)\n36\n37 Payoff to bank from delta hedge Formula in cell F11 = =(C10*B11/B10-C11)-\n38 -67.90<-- =E30\n(D11-D10*EXP($B$5*(A10-A11)))\n39\nTerminal cash\n482 Chapter 18\nHere \u2019 s what happens in this spreadsheet:\n\u2022 T he initial (row 10) stock and bond positions are determined by the Black-\nScholes formula. The stock position is \u2212 S ( \u0394 ( X ) \u2212 \u0394 ( x )) and the bond\nCall Call Put Put\nposition is e \u2212 rT [ X N (d [ X ])] + X N (\u2212 d [ X ]). Not surprisingly, the net\nCall 2 Call Put 2 Put\nvalue of this portfolio is zero\u2014this is the way we determined the collar X\nCall\nand X .\nPut\n\u2022 I n each of the subsequent rows, the stock position is determined by the\nBlack-Scholes formula, and the bond position is determined so that the net\ncash flow of the position is zero:\nStock_price\nBonds=Stock_position t\u22121\u2217 t \u2212S(cid:2)to(cid:4)ck(cid:4)(cid:4)_(cid:3)poo(cid:4)si(cid:4)tio(cid:4)(cid:5)n\nt\nStock_price\nt\u22121\n\u2191\nDetermined by\n(cid:2)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:3)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)B(cid:4)lac(cid:4)k-S(cid:4)cho(cid:4)les(cid:4)(cid:5)\n\u2191\nCash flow innto stocks\n+B(cid:2)o(cid:4)nd(cid:4)_(cid:4)p(cid:4)os(cid:4)it(cid:4)io(cid:3)n t(cid:4)\u22121(cid:4)\u2217e(cid:4)xp(cid:4)(rr(cid:4)\u2217\u0394 (cid:4)(cid:5)t)\n\u2191\nValue today of t\u22121 bond position\n\u2022 At the terminal date (row 30), the portfolio is liquidated:\nStockprice\nStock_position =Stock_position \u2217 Terrminal\nTerminal Previous\nStockprice\nPrevious\n+Bond_position \u2217exp(r\u2217\u0394t)\nPrevious\n\u2022 At the terminal date, the purchaser of the collar collects on his short position\nin the call and his long position in the put (cell B35). The bank collects its\nposition value (cells E30 or B38). The bank\u2019 s net cash flow on termination is\nthe difference between these two (cell B40).\nW e can use Data Table on a blank cell to show many simulations. For\ndetails see the spreadsheet for this chapter. Below we show a graph that gives\nthe bank\u2019 s net profit in 21 simulations of the delta hedging strategy for the\n483 Option Greeks\nNet Bank Profit from Delta Hedge of Collar\n5\n21 Simula(cid:415)ons\n4\n3\n2\n1\n0\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21\n-1\n-2\n-3\nMaking the Collar Gamma Neutral\nAs the option gets closer to expiration, the hedge position can become sensitive\nto small changes in the stock price, meaning that the gamma of the collar can\ngrow enormously.\nT here are two solutions to moderate the gamma of the collar:\n\u2022 We can increase our hedge frequency as we get closer to the collar expiration\ndate.\n\u2022 We can change our hedge strategy in order to temper the hedge gamma, as\nwe get closer to the option maturity.\nBelow we explore both solutions.\nIncreasing the Hedge Frequency\nThe main problem of the hedge seems to be for the dates close to the end of\nthe expiration period. Since the initial options have maturity T = 1, this means\nthat we have to be very careful during the last two months of the hedging\nperiod. Delta hedging the position more often may work, though it is easy to\n484 Chapter 18\nA B C D E F\nMODERATING THE COLLAR GAMMA\nThis example starts with T = 0.20 and hedges every Delta_t = 0.01\n1\n2 S 55.00\n3 X 70.00\ncall\n4 X 49.04\nput\n5 r 4.00%\n6 k, dividend yield 2.00%\n7 Sigma 40%\n8\nStock =-\nB10*(deltacall(B10,$B$3,A10,$B$5,$B$\n6,$B$7)-\nTime until deltaput(B10,$B$4,A10,$B$5,$B$6,$B$ Porfolio Portfolio\n9 expiration Stock price 7)) Bond value cash flow\n10 0.20 55.00 -18.29 18.29 0.00 0.00\n11 0.19 53.62 -18.43 18.90 0.47 0.00\n12 0.18 54.12 -17.55 17.85 0.30 0.00\n13 0.17 54.65 -16.60 16.74 0.14 0.00\n14 0.16 50.15 -21.44 22.96 1.51 0.00\n15 0.15 51.18 -19.49 20.58 1.08 0.00\n16 0.14 50.05 -21.20 22.72 1.52 0.00\n17 0.13 51.20 -18.76 19.80 1.04 0.00\n18 0.12 50.71 -19.42 20.65 1.23 0.00\n19 0.11 48.61 -24.11 26.15 2.04 0.00\n20 0.10 50.83 -18.55 19.49 0.95 0.00\n21 0.09 47.75 -26.65 28.73 2.08 0.00\n22 0.08 44.94 -34.04 37.70 3.66 0.00\n23 0.07 45.97 -32.46 35.36 2.90 0.00\n24 0.06 41.06 -39.37 45.75 6.38 0.00\n25 0.05 40.60 -39.75 46.59 6.84 0.00\n26 0.04 38.35 -38.27 47.33 9.06 0.00\n27 0.03 36.60 -36.58 47.40 10.82 0.00\n28 0.02 36.28 -36.27 47.43 11.16 0.00\n29 0.01 35.73 -35.72 47.45 11.73 0.00\n30 0.00 36.36 11.11<-- =C29*B\n31\n32 Check: Collar payoff to client at time 0\n33 Short call payoff 0.00<-- =-MAX(B30-B3,0)\n34 Long put payoff 12.68<-- =MAX(B4-B30,0)\n35 Total 12.68<-- =SUM(B33:B34)\n36\n37 Payoff to bank from delta hedge\n38 11.11<-- =E30\n39\nTerminal cash\n485 Option Greeks\nRepeated simulation of this hedge shows that it works quite well.\nMaking the Hedge Gamma Neutral\nAnother strategy is to add another asset to the hedge position, in an effort to\nneutralize the gamma. In the example below we have added an out-of-the-\nmoney put to the position to neutralize the large call gamma:\nA B C D E\nCOLLAR HEDGE, DELTA & GAMMA\n1 in this example we costlessly neutralize a large call gamma\n2 Call Put Another put\n3 S 48.00 48.00 48.00\n4 X 70.00 49.04 35.00\n5 r 5.00% 5.00% 5.00%\n6 k, dividend yield 0.00% 0.00% 0.00%\n7 T 0.0200 0.0200 0.0200\n8 Sigma 40.00% 40.00% 40.00%\n9\n10 Option prices 0.00 1.66 0.00\n11\n12 Delta 0.0000 -0.6304 0.0000<-- =deltaput(D3,D4,D7,D5,D6,D8)\n13 Gamma 494,472,087 0 1,118,872<-- =gamma(D3,D4,D7,D5,D6,D8)\n14\n15\n16 Bank position: short call with X = 70.00 + long put with X = 49.04 + put with X = 35.00\n17 Call, X = 70.00 -1\n18 Put, X = 49.04 1\n19 Put, X = 35.00 441.938\n20\n21 Position delta -0.6304<-- {=SUMPRODUCT(TRANSPOSE(B17:B19),B12:D12)}\n22 Position gamma 0.1553<-- {=SUMPRODUCT(TRANSPOSE(B17:B19),B13:D13)}\n23\n24 Position cost\n25 Without second put 1.6604<-- =B17*B10+B18*C10\n26 With second put 1.6604<-- =B17*B10+B18*C10+B19*D10\n27\n28 Traditional collar delta -0.6304<-- =-B12+C12\nT his can be done at very little cost, since the put in question is almost cost-\nless (cell D10). Of course, it may not always be possible to costlessly neutral-\nize the gamma. In this case we will have to make some compromises."
        ],
        "18.5": [
            "What are the Greek parameters in option pricing?\nWhat is the significance of the Greeks in the exploration of the sensitivity of option pricing formula?\nCan you explain the relationship between stocks, bonds, and option pricing?\nWhat additional information can be gleaned from books like Hull (2006) and Taleb (1997)?\nWhat is the importance of an extensive collection of option pricing formulas, including Greeks? \nCan you explain what is covered in Haug (2006) relating to option pricing formulas including Greeks?\nWhat is the role of Greeks in financial modeling, particularly with respect to options? \nWhat are some recommended resources for further studying option Greeks and their implications on financial modeling?",
            "18.5 Summary\n\nI n this chapter we have explored the sensitivities of the option pricing formula\nto its various parameters. Using these Greeks, we have delved into the intrica-\n486 Chapter 18\na combination of stocks and bonds. The interested reader should know that\nthere is much more which can be said about this topic. Good starting places\nfor further reading are Hull (2006) and Taleb (1997). An extensive collection\nof option pricing formulas including Greeks can be found in Haug (2006)."
        ]
    },
    "19": {
        "19.1": [
            "What is the standard net present value (NPV) analysis of capital budgeting?\nWhat does a standard NPV analysis value in a project?\nWhat is the most widely used practice for evaluating capital projects?\nWhat disadvantage does the standard NPV analysis have in terms of flexibility?\nHow can a firm adjust its decisions in the capital budgeting process?\nWhat is the 'option to wait' in capital budgeting?\nIn the context of capital budgeting, what does the 'option to expand' refer to?\nWhat is a call option in the context of capital budgeting?\nWhat options are not valued in the standard NPV framework?\nWhat is the abandonment option in a project?\nHow can a put option be implicit in many projects?\nWhat is the option to contract scale in project valuation?\nWhat are some common real options listed by Trigeorgis?\nWhat is the option to defer in the context of real options?\nIn terms of real options, what does the time-to-build option refer to?\nWhat do the options to alter operating scale comprise of?\nWhat are the different scenarios under the option to abandon?\nWhat does the option to switch inputs or outputs mean?\nWhat is the growth option in the context of project investment?\nIn financial modelling, what is the notable extension of the NPV techniques?\nWhy is modeling and valuing real options more difficult than standard cash flows?\nHow can real options be implemented recognizing the inaccuracies of the DCF technique?\nHow do real options impact the value of a project?",
            "19.1 Overview\n\nThe standard net present value (NPV) analysis of capital budgeting values a\nproject by discounting its expected cash flows at a risk-adjusted cost of capital.\nThis discounted cash flow (DCF) technique is by far the most widely used\npractice for evaluating capital projects, be they acquisitions of companies or\nthe purchases of machines. However, standard NPV analysis does not take\naccount of the f lexibility inherent in the capital budgeting process: Part of the\ncomplexity of the capital budgeting process is that the firm can change its\ndecision dynamically, depending on the circumstances.\nHere are two examples:\n1. A firm is considering replacing some of its machines with a new type of\nmachine. Instead of replacing all the machines together, it can first replace one\nmachine. Based on the performance of the first machine replaced, the firm can\nthen decide whether to replace the rest of the machines. This \u201coption to wait\u201d\n(or perhaps the \u201coption to expand\u201d) is not valued in the standard NPV process.\nIt is essentially a call option.\n2 . A firm is considering investing in a project which will produce (uncertain)\ncash flows over time. One option\u2014not valued in the standard NPV frame-\nwork\u2014is to a bandon the project if its performance is not satisfactory. The\nabandonment option is, as we see below, a put option which is implicit in\nmany projects. It is also sometimes called the \u201coption to contract scale.\u201d\nThere are many other real options. In the leading book on the valuation of\nreal options, Trigeorgis (1996) lists the following common real options:\n\u2022 The option to defer or to wait with developing a natural resource or build a\nplant.\n\u2022 T he time-to-build option (staged investment): At each stage the investment\ncan be re-evaluated and (possibly) abandoned or expanded.\n\u2022 The option to alter operating scale (expand, contract, shut down, or restart).\n\u2022 The option to abandon.\n\u2022 The option to switch inputs or outputs.\n\u2022 T he growth option\u2014an early investment in a project constitutes an option\n494 Chapter 19\nT he recognition of real options is an important extension of the NPV tech-\nniques. However, modeling and valuing real options is more difficult than\nmodeling and valuing standard cash flows by the DCF method. Our examples\nbelow illustrate these difficulties. Often it is best to implement real options by\nrecognizing that the DCF technique misjudges the value of a project because\nit ignores the project\u2019 s real options. Our usual conclusion will be that real\noptions add to the value of a project, and that the NPV thus underestimates\nthe true value."
        ],
        "19.2": [
            "What does the term 'Option to Expand' refer to in financial modeling?\nWhat factors should ABC Corp. consider while deciding on replacing their old widget machines with new ones?\nWhat is the significance of the new machine's anticipated cash flows in this context?\nWhat does a negative NPV suggest about a replacement project?\nHow is the cost of capital for the project estimated and what role does it play in this scenario?\nWhat is a real option and how has this concept been applied in this example?\nWhy does the line manager want to try one of the new machines for a year?\nHow might replacing five more machines in one year be seen as an option?\nWhy is the current value 'S' equal to the present value of the machine\u2019s future cash flows?\nWhat is the Black-Scholes option pricing model and how is it used in this context?\nWhen does an entity choose to use the Black-Scholes option pricing model?\nWhat are the limitations of the Black-Scholes option pricing model when applied to real-world scenarios?\nWhat role does the volatility play in evaluating the worth of a project?\nWhy does the value of the project decrease with lower uncertainty in actual cash flows?\nHow does a staged-investment real option contribute to the concept of early exercise?\nWhat is the context of an option to abandon an investment and what does it imply?\nWhat are the assumptions of the Black-Scholes option valuation model? \nHow does the Black-Scholes model affect the valuation of real options? \nWhat is the significance of the risk-free rate in options pricing? \nHow is the present value of the machine's future cash flows calculated?\nWhat is the meaning of 'exercise price' in options trading and how is it relevant in this context?",
            "19.2 A Simple Example of the Option to Expand\n\nI n this section we give a simple example of the option to expand. Consider\nABC Corp., which has six widget machines. ABC is considering replacing\neach of the old machines with a new machine that costs $1,000. The new\nmachines have a 5-year life. The anticipated cash flows for the new machine\nare given below.1\nA B C D E F G\n1 THE OPTION TO EXPAND\n2 Year 0 1 2 3 4 5\n3 CF of single machine -1000 220 300 400 200 150\n4\n5 Discount rate for machine cash flows (risk-adjusted) 12%\n6 Riskless discount rate 6%\n7 Present value of machine's future cash flows 932.52<-- =NPV(B5,C3:G3)\n8 NPV of single machine -67.48<-- =NPV(B5,C3:G3)+B3\nT he financial analyst working on the replacement project has estimated a cost\nof capital for the project of 12%. Using these anticipated cash flows and the\n12% cost of capital, the analyst has concluded that the replacement of a single\nold machine by a new machine is unprofitable, since the NPV is negative:\n220 300 400 200 150\n\u22121000+ + + + + =\u221267.48\n(cid:2)1.1 (cid:4)2 (cid:4)( (cid:4)1.(cid:4)12(cid:4))2 (cid:4)(cid:4)( 1(cid:4).1(cid:3)2) (cid:4)3 (cid:4)( 1(cid:4).1(cid:4)2) (cid:4)4 (cid:4)( 1(cid:4).1(cid:4)2(cid:5))5\n\u2191\nTThe present value of the machine\u2019s future\ncash flow is $9322.52\n1. These cash flows are the incremental cash flow of replacing a single old machine by a new\nmachine. The computations include taxes, incremental depreciation, and the sale of the old\n495 Real Options\nN ow comes the (real options) twist. The line manager in charge of the\nwidget line says, \u201cI want to try one of the new machines for a year. At the end\nof the year, if the experiment is successful, I want to replace five other similar\nmachines on the line with the new machines.\u201d\nD oes this change our previously negative conclusion about replacing a\nsingle machine? The answer is \u201cyes.\u201d To see this, we now realize that what\nwe have is a package:\n\u2022 Replacing a single machine today. This has an NPV of \u2212 67.48.\n\u2022 The option of replacing five more machines in one year. Suppose that the\nrisk-free rate is 6%. Then we view each such option as a call option on an\nasset which has current value S equal to the present value of the machine\u2019 s\nfuture cash flows. As can be seen in cell B7 above, this present value is\nS = 932.52. The exercise price of this option is X = 1,000. Of course these call\noptions can be exercised only if we purchase the first machine now. 2\nS uppose we assume that the Black-Scholes option pricing model can price\nthis option. In this case we have:\nA B C D E F G\n1 THE OPTION TO EXPAND\n2 Year 0 1 2 3 4 5\n3 CF of single machine -1000 220 300 400 200 150\n4\n5 Discount rate for machine cash flows (risk-adjusted) 12%\n6 Riskless discount rate 6%\n7 Present value of machine's future cash flows 932.52<-- =NPV(B5,C3:G3)\n8 NPV of single machine -67.48<-- =NPV(B5,C3:G3)+B3\n9\n10 Number of machines bought next year 5\n11 Option value of single machine purchased in one more year 143.98<-- =B24\n12 NPV of total project 652.39<-- =B8+B10*B11\n13\n14 Black-Scholes Option Pricing Formula\n15 S 932.52PV of machine CFs\n16 X 1000.00Exercise price = Machine cost\n17 r 6.00%Risk-free rate of interest\n18 T 1Time to maturity of option (in years)\n19 Sigma 40%<-- Volatility\n20 d 1 0.1753<-- (LN(S/X)+(r+0.5*sigma^2)*T)/(sigma*SQRT(T))\n21 d 2 -0.2247<-- d 1 - sigma*SQRT(T)\n22 N(d 1) 0.5696<--- Uses formula NormSDist(d 1)\n23 N(d 2) 0.4111<--- Uses formula NormSDist(d 2)\n24 Option value = BS call price 143.98<-- S*N(d 1)-X*exp(-r*T)*N(d 2)\n496 Chapter 19\nAs cell B12 shows, the value of the whole project is 652.39.\nOur conclusion: Buying one machine today, and knowing that we have the\noption to purchase five more machines in one year is a worthwhile project.\nOne critical element here is the volatility. The lower the volatility (i.e., the\nlower the uncertainty), the less worthwhile this project is:\nB C D E F G H I\n27 Data Table\n28 \u03c3 652.39 <-- =B12 , data table header\n29 1% -63.48\n30 10% 97.16 1,400 Project Value as Function of Sigma\n31 20% 283.09 1,200\n32 30% 468.40\n1,000\n33 40% 652.39\n34 50% 834.59 800\n35 60% 1,014.54 600\n36 70% 1,191.81\n400\n37\n200\n38\n39 0\n40 -2000% 10% 20% 30% 40% 50% 60% 70%\n41 Sigma\n42\nT his is not very surprising: The value of the project as a whole comes from\nour uncertainty about the actual cash flows 1 year from now. The less this\nuncertainty is (measured by \u03c3 ), the less valuable the project will be.\nSidebar: Is Black-Scholes the Appropriate Valuation Tool for Real Options?\nT he answer is almost certainly no: Black-Scholes is not the appropriate tool.\nHowever, the Black-Scholes model is by far the most numerically tractable\n(i.e., easiest) model we have for valuing options of any kind. In valuing real\noptions we often use the Black-Scholes model, realizing that at best it can give\nan approximation to the actual option value. Such is life.\nH aving said this, you should realize that the assumptions of the Black-\nScholes option valuation model\u2014continuous trading, constant interest rate, no\nexercise before final option maturity\u2014are not really appropriate to the real\n497 Real Options\na securities option context, would be considered dividend-paying securities\nand/or early exercise. Two examples:\n\u2022 The staged-investment real option, when we have the opportunity to expand\nor contract the investment over time, is intrinsically an option with early\nexercise.\n\u2022 When an option to abandon an investment exists, as long as the investment\nis still in place and not abandoned, it continues to pay \u201cdividends,\u201d in the form\nof cash flows.\nWe can only hope that the Black-Scholes model gives an approximation to\nthe option value intrinsic in the real options."
        ],
        "19.3": [
            "What is the Abandonment Option in the context of a capital budgeting project?\nCan you explain how to value a project using state prices from option pricing?\nWhat is a state price in financial modeling?\nWhat is the significance of \u201cup\u201d and \u201cdown\u201d states in financial modeling?\nHow are the state prices calculated in financial modeling?\nWhat is the Net Present Value (NPV) and how is it calculated in the context of a capital budgeting project?\nCan the option to abandon a project enhance its value?\nWhat might be the implications if project abandonment leads to an all subsequent cash flows being zero?\nWhy might it be worthwhile to pay to abandon a project?\nIn the context of project abandonment, what does the term \"sell the equipment\" mean?\nHow can selling equipment impact the net present value of a project?\nWhat key metrics are considered while determining the state prices?\nWhat is the method used to determine the state prices in financial modeling?\nHow do the mean return (\u03bc) and the standard deviation (\u03c3) of the market portfolio\u2019s returns determine the size of the \"Up\" or \"Down\" moves?\nWhat impact does the use of Excel Solver have on the determination of state prices?\nWhat are the assumptions when matching state prices to the project\u2019s cost of capital?\nWhy is the Excel Solver used to determine state prices?\nCan you explain the significance of consistency with the risk-free interest rate in the context of state prices?\nWhat is the role of the Excel's Goal Seek in financial modeling?",
            "19.3 The Abandonment Option\n\nConsider the following capital budgeting project:\nA B C D E\n7 Project cash flows\n8\n9 150\n10 100\n11 80\n12 -50\n13 80\n14 -50\n15 -60\nA s you can see, the initial cost of this project is 50. In one period the project\nwill produce cash flows of either $100 or \u2212 $50; that is, under certain circum-\nstances, it will lose money. Two periods hence the project again has chances\nof either losing money (in the worst case) or making money.\nValuing the Project\nIn order to value the project, we use the state prices from option pricing. 3 The\nstate price q is the price today of $1 to be paid in the succeeding period in\nu\n498 Chapter 19\nthe \u201cup\u201d state; and the price q is the price today of $1 to be paid in the \u201cdown\u201d\nd\nstate. The spreadsheet fragment below shows all the relevant details, leading\nto a project valuation of \u2212 $29.38 (implying rejection of the project):\nA B C D E F G H I J K L\n1 PRICING AN ABANDONMENT OPTION\n2 Market data State prices\n3 Expected market return 12% qU 0.3087<-- =(1+B5-B9)/((1+B5)*(B8-B9))\n4 Sigma of market return 30% qD 0.6347<-- =(B8-1-B5)/((1+B5)*(B8-B9))\n5 Risk-free rate 6%\n6\n7 One-period \"up\" and \"down\" of market\n8 Up 1.521962<-- =EXP(B3+B4) , note that a valid alternative is 'Up' = EXP(B4)\n9 Down 0.83527<-- =EXP(B3-B4) , note that a valid alternative is 'Down' = EXP(-B4)\n10\n11\n12 Project cash flows State-dependent present value factors\n13\n14 150 0.0953 <-- =E3^2\n15 100 0.3087\n16 80 0.1959 <-- =E3*E4\n17 -50 1\n18 80 0.1959 <-- =E3*E4\n19 -50 0.6347\n20 -60 0.4028 <-- =E4^2\n21 =C15*I15\n22 State-by-state present value\n23 14.2981 <-- =E14*K14\n24 30.8740\n25 15.6755 <-- =E16*K16\n26 -50\n27 15.6755 <-- =E18*K18\n28 -31.7328\n29 -24.1673 <-- =E20*K20\n30\n31 Net present value -29.38<-- =SUM(A23:E29)\nThe methodology is to calculate state-dependent present value factors (how\nthis is done is discussed below) and to multiply these factors times the indi-\nvidual state-dependent cash flows. Each node of the tree is discounted by the\nrelevant state price for the node; for example the cash flow of 80 which occurs\nat date 2 is discounted by q q . The NPV of the project is the sum of all the\nU D\ndiscounted cash flows plus the initial cost (cell B31).\nThe Abandonment Option Can Enhance Value\nN ow suppose that we can abandon the project at date 1 if its cash flow \u201cthreat-\nens\u201d to be \u22125 0; suppose, furthermore, that this abandonment means that all\nsubsequent cash flows will also be zero. As the picture below shows, this\n499 Real Options\nA B C D E F G H I J K L\n34 Cash flows with abandonment Present value with abandonment\n35\n36 150 14.2981 <-- =E36*K14\n37 100 30.8740\n38 80 15.6755 <-- =E38*K16\n39 -50 -50\n40 0 0\n41 0 0\n42 0 0\n43\n44\n45 Present value with abandonment 10.85<-- =SUM(G36:K42)\nT hinking about this further, it is clear that it might even be worthwhile to pay\nto abandon the project . Here \u2019 s what the project looks like when we pay $10\nto abandon it in the troublesome state (this payment can be thought of as\nrepresenting the cost of closing down a facility, etc.):\nA B C D E F G H I J K L\n34 Cash flows with abandonment Present value with abandonment\n35\n36 150 14.2981 <-- =E36*K14\n37 100 30.8740\n38 80 15.6755 <-- =E38*K16\n39 -50 -50\n40 0 0\n41 -10 -6.3466\n42 0 0\n43\n44\n45 Present value with abandonment 4.50<-- =SUM(G36:K42)\nAbandonment When We Sell the Equipment\nAnother possibility is, of course, that \u201cabandonment\u201d means selling the equip-\nment. In this case there might even be a positive cash flow from abandonment.\nAs an example, suppose that we can sell the asset for $15:\nA B C D E F G H I J K L\n34 Cash flows with abandonment Present value with abandonment\n35\n36 150 14.2981 <-- =E36*K14\n37 100 30.8740\n38 80 15.6755 <-- =E38*K16\n39 -50 -50\n40 0 0\n41 15 9.5198\n42 0 0\n43\n44\n500 Chapter 19\nDetermining the State Prices\nThe method we have used above to determine the state prices was explained\nin greater detail in Chapter 16. We assume that in each period the market\nportfolio (by which we mean some large, diversified stock market portfolio\nsuch as the S&P 500) moves either \u201cUp\u201d or \u201cDown\u201d; the size of these moves\nis determined by the mean return \u03bc of the market portfolio and by the standard\ndeviation \u03c3 of the market portfolio\u2019 s returns. Assuming that the returns on\nthe market portfolio have mean \u03bc = 12% and standard deviation of returns\n\u03c3 = 30%, we have\u2014in the above examples\u2014calculated\nUp=exp[\u03bc+\u03c3]=1.53, Down=exp[\u03bc\u2212\u03c3]=0.84\nD enote by q the price today for one dollar in the \u201cUp\u201d state in one period\nU\nand denote by q the price today for one dollar in the \u201cDown\u201d state in one\nD\nperiod. Then\u2014as explained in Chapter 16\u2014the state prices are calculated by\nsolving the system of linear equations:\n1=q \u2217Up+q \u2217Down\nU D\n1\n=q +q\n1+r U D\nThe solution to this system of equations is:\nR\u2212Down Up\u2212R\nq = , q =\nU R\u2217( Up\u2212Down) D R\u2217( Up\u2212Down)\nThis method is illustrated in the above spreadsheet:\nA B C D E F G H I\n2 Market data State prices\n3 Expected market return 12% q 0.3087<-- =(1+B5-B9)/((1+B5)*(B8-B9))\nU\n4 Sigma of market return 30% q 0.6347<-- =(B8-1-B5)/((1+B5)*(B8-B9))\nD\n5 Risk-free rate 6%\n6\n7 One-period \"up\" and \"down\" of market\n8 Up 1.521962<-- =EXP(B3+B4) , note that a valid alternative is 'Up' = EXP(B4)\n501 Real Options\nAlternative State Price Determinations\nAn alternative method of calculating the state prices is to try to match them\nto the project\u2019 s cost of capital. Reconsider the project discussed above, and\nsuppose that the actual probability of each state \u2019 s occurrence is \u00bd. Further-\nmore, suppose that the risk-free rate is 6%. Finally, assume that the project \u2019 s\ndiscount rate\u2014if it has no options whatsoever\u2014is 22%. Then we can calculate\nthe project \u2019 s NPV without real options as 12.48:\nA B C D E F G H\n1 MATCHING THE STATE PRICES TO THE COST OF CAPITAL\n2 Project cost of capital 22%<-- This is the discount rate for the project if it has no options\n3 Risk-free rate 6%\n4\n5 Project cash flows\n6 150\n7 100\n8 80\n9 -50\n10 80\n11 -50\n12 -60\n13\n14 =AVERAGE(C7:C1)\n15 Project expected cash flows: Assumes equal state probabilities\n16 Year 0 1 2\n17 Expected CF -50 25 62.5 =AVERAGE(E6:E12)\n18 Project NPV 12.48 <-- =NPV(B2,C17:D17)+A9\n19\n20\n21 State prices\n22 q 0.4241<-- =1/(1+B3)-B23\nU\n23 q 0.5193<-- Determined by Solver\nD\nI n cells B22 and B23 we look for state prices q and q , which have two\nU D\nproperties:\n1. They are consistent with the risk-free interest rate. This means that\n1 1\nq +q = = .\nU D R 1.06\n2. The state prices give the same NPV for the project as that calculated by the\n502 Chapter 19\nThe second requirement means that we have to use the Excel S olver to\ndetermine the state prices. Here\u2019 s what the solution looks like (the discussion\nof how Solver was used follows the next spreadsheet):\nA B C D E F G\n21 State prices\n22 q U 0.4241<-- =1/(1+B3)-B23\n23 q D 0.5193<-- Determined by Solver\n24\n25 =C7*B22\n26 Project state-by-state discounting\n27 26.9797 <-- =E6*B22^2\n28 42.4105\n29 17.6187 <-- =E8*B22*B23\n30 -50\n31 17.6187 <-- =E10*B22*B23\n32 -25.9646\n33 -16.1798 <-- =E12*B23^2\n34\n35 =C11*B23\n36\n37\n38 State-by-state NPV 12.48<-- =SUM(A27:E33)\n39\n40 Target cell (0.00)<-- =B38-B18\n503 Real Options\nOne more note: You can also use Goal Seek (T ools|Goal Seek ) to get the\nsame result. However, Excel \u2019 s Goal Seek does not remember its previous set-\ntings, meaning that each time you repeat this calculation you will have to reset\nthe cell references. Here\u2019 s what the Goal Seek dialog box looks like:"
        ],
        "19.4": [
            "What is the concept of valuing the Abandonment Option as a series of puts in Financial Modeling?\nWhat is an abandonment option in the context of project valuation?\nWhat are the challenges in valuing an abandonment option?\nHow can a project be valued as a series of cash flows plus a series of Black-Scholes put options?\nWhat is the significance of a risk-adjusted discount rate in the valuation of a project?\nHow does the presence of an abandonment option impact the value of a project?\nWhat is the meaning of state-by-state cash flows in project valuation?\nWhat is the Black-Scholes put option in regards to project valuation?\nHow does volatility influence the value of an abandonment option?\nWhat is the role of the risk-free rate in the valuation of an abandonment option?\nWhat does it mean to have a put option with an exercise price? \nHow does the method of valuing the year-1 abandonment put work?\nWhat is the relationship between the abandonment option and the salvage value of an asset?\nWhat does the term net present value (NPV) refer to in the given context of financial modeling?\nHow does the present value of the future expected cash flows and the present value of a series of Black-Scholes puts determine the total value of the project?\nWhat is meant by the term 'Adjusted Present Value' in the context of project valuation?\nCan the value of the abandonment option influence the total value of a project?",
            "19.4 Valuing the Abandonment Option as a Series of Puts\n\nT he example above shows how and why the abandonment option can have\nvalue. It also illustrates another, more troublesome, feature of the abandonment\noption, namely, that it may be very difficult to value. While it is difficult\nenough to project expected cash flows, it is even more difficult to project\nstate-by-state cash flows and state prices for a complex project.\nA possible compromise in the valuation of an abandonment option is to\nvalue a project as a series of cash flows plus a series of Black-Scholes put\noptions. Consider the following example: You are valuing a 4-year project with\nthe expected cash flows given below and with a risk-adjusted discount rate of\n12%. As you can see, the project has a negative NPV:\nA B C D E F\n1 STANDARD DCF PROJECT VALUATION\n2 Project cash flows\n3 Year 0 1 2 3 4\n4 Cash flow -750 100 200 300 400\n5\n6 Risk-adjusted discount rate 12%The project's cost of capital\n504 Chapter 19\nS uppose that we can abandon the project at the end of any of the next 4\nyears, selling the equipment for 300. Although this abandonment option is an\nAmerican option and not a Black-Scholes option, we value it as a series of\nBlack-Scholes put options. In each case we suppose that we first get the year-\nend cash flow; we then value the abandonment option on the remaining project\nvalue.\n\u2022 End of year 1 : The asset \u2019 s expected value at the end of year 1 will\nbe the discounted value of its future expected cash flows: 702.44=\n200 300 400\n+ + . The abandonment option means that we can get\n1.12\n( 1.12)2 ( 1.12)3\n$300 for the asset during the next 3 years. Suppose that the value has a volatil-\nity of 50%; then valuing this option as a Black-Scholes put with 1 year to\nmaturity gives its value as 19.53. The following spreadsheet uses the VBA\nfunction B SPut defined in Chapter 17:\nA B C D E F\n1 ABANDONMENT VALUE--DETAILS OF YEAR 1 CALCULATION\n2 Project cash flows\n3 Year 0 1 2 3 4\n4 Cash flow -750 100 200 300 400\n5\n6 Risk-adjusted discount rate 12%The project's cost of capital\n7 NPV without options -33.53<-- =B4+NPV(B6,C4:F4)\n8\n9 Valuing the year-1 abandonment put\n10 Value of project, end year 1 702.44<-- =NPV(B6,D4:F4)\n11 Abandonment value 300Like strike price in put formula\n12 Time to option maturity (years) 3\n13 Risk-free rate 6%\n14 Sigma 50%\n15\n16 Put value 19.53<-- =bsput(B10,B11,B12,B13,B14)\n\u2022 End of year 2 : We have a put option with exercise price $300 on an asset\n300 400\nworth 586.73= + . Valuing the abandonment option as a Black-\n1.12\n( 1.12)2\nScholes put with 2 years to exercise gives its value (when \u03c3 = 50%) as 17.74.\n\u2022 End of year 3 : We have a put option with exercise price $300 on an asset\n400\nworth 357.14= . The option has 1 more year remaining to its life and is\n1.12\n505 Real Options\n\u2022 End of year 4 : The asset is worthless in terms of future anticipated cash\nflows, but it can be abandoned for $300 (this is thus its scrap or salvage value).\nThe abandonment option is worth $300.\nIn the spreadsheet below the asset has been valued as the sum of:\n\u2022 The present value of the future expected cash flows. As we showed above,\nthis is \u2212 $33.53.\n\u2022 The present value (at the risk-free rate) of a series of Black-Scholes puts.\nThis value is $299.10.\nThe total value of the project is \u2212 $33.53 + $299.10 = $265.57.\nA B C D E F G\n1 PRICING AN ABANDONMENT OPTION AS A SERIES OF PUTS\n2 Project cash flows\n3 Year 0 1 2 3 4\n4 Cash flow -750 100 200 300 400\n5\n6 Risk-adjusted discount rate 12%The project's cost of capital\n7\n8 NPV without options -33.53<-- =NPV(B6,C4:F4)+B4\n9\n10 Sigma 50%\n11 Risk-free rate 6%\n12 Abandonment value 300Project can be abandoned at end of any year for this amount\n13\n14 NPV of cash flows at RADR -33.53<-- =B8\n15 Value of abandonment option 299.10<-- =NPV(B11,C20:F20)\n16 Adjusted present value 265.57<-- =B15+B14\nFunction in cell D19:\n17 =NPV($B$6,E4:$F$4)\n18\n19 End-year value of remaining cash flows 702.44 586.73 357.14 0.00\n20 Put option value 19.53 17.74 32.47 300.00\n21\nFunction in cell D20:\n=bsput(D19,$B$12,$F$3-\n22 D3,$B$11,$B$10)"
        ],
        "19.5": [
            "What are the unique features of the biotech industry?\nHow is the value of biotech firms typically assessed?\nWhat is the role of future cash-flow opportunities in valuing biotech firms?\nWhat is the real option method in the context of valuing biotechnology projects?\nWhat are the three stages of the drug's development in a biotechnology project?\nWhat outcomes determine the transition from one stage to another in a drug development process?\nCan you explain the concept of discovery phase in drug development?\nWhat are the characteristics of the clinical phase in a drug development process?\nCan you describe the market stage in a drug development process?\nWhat is the expected return on a biotechnology project of this type?\nHow does the cost of capital of the project relate to its expected return?\nWhat is the standard approach to estimate the value of a biotechnology project?\nHow is the net present value of a biotechnology project calculated?\nWhat does a negative net present value indicate about a project?\nWhat is the real options approach to valuation?\nHow does the real options approach relate to R&D in the biotechnology sector?\nCan you explain the concept of a continuation option in project valuation?\nHow does the real options approach adjust for continuation decisions by the manager?\nHow are state prices adjusted when states are eliminated in the real options approach?\nWhy is it important to account for the fact that some states are no longer reachable in the real options approach?",
            "19.5 Valuing a Biotechnology Project4\n\nO ne of the interesting features of the biotech industry is the existence of highly\nvalued firms that have no revenues. It is common understanding that the value\n506 Chapter 19\nof those firms is in their future cash-flow opportunities. Therefore, understand-\ning the translation of qualitative investment opportunities into quantitative\nvaluation is of great importance when valuing those firms. In this section we\nuse the real option method to value a biotechnology project and to illustrate\nthe application of the real option approaches.\nC onsider the following story. 5 A firm is considering the initiation of\nresearch into a new drug. It knows that there are three stages to the drug\u2019 s\ndevelopment:\n\u2022 In the discovery phase, the firm does preliminary research about the viabil-\nity of the idea. This research takes 1 year and costs $1,000 at the beginning\nof the year. With 50% probability the results will be positive enough to proceed\nto the next stage of research.\n\u2022 I f the discovery phase yields success, then the drug goes into the clinical\nphase , in which the drug is tested. This stage lasts 1 year and costs $2,000 at\nthe beginning of the year, and with a probability of 30% yields enough positive\nresults to proceed to the next stage.\n\u2022 I f the drug passes the clinical phase successfully, then it goes into\nthe m arket stage , in which it is sold. This phase costs $15,000 per year\n(at the beginning of each year) and on average lasts 5 years. On average, a\nsuccessful drug can be expected to start the marketing phase with income of\n$20,000. This income grows with annual mean 10% and standard deviation\n\u03c3 = 100%.\nThe expected return on a project of this type is 25%. We assume that this\nis the cost of capital of the project in the case of a discounted cash flow (DCF)\nvaluation.\n5 . W e have made the story simple enough to fit an understandable spreadsheet. For a somewhat\n507 Real Options\nThe Expected Value of the Project Using Traditional DCF Analysis\nIf we estimate the value of this project using traditional discounted cash flow\nanalysis, we get a negative net present value for the project:\nA B C D E F G H\n1 BIOTECH PROJECT EXPECTED CASH FLOWS\n2 Discount rate 25%\n3 Growth 10%\n4\nExpected\n5 Year Stage Cost Income Net Probability cash flow\n6 0 Discovery -1,000 0 -1,000 1 -1,000<-- =F6*E6\n7 1 Clinical -2,000 0 -2,000 0.5 -1,000<-- =F7*E7\n8 2 Clinical -2,000 0 -2,000 0.5 -1,000\n9 3 Marketing -15,000 20,000 5,000 0.15 750\n10 4 Marketing -15,000 22,000 7,000 0.15 1,050\n11 5 Marketing -15,000 24,200 9,200 0.15 1,380\n12 6 Marketing -15,000 26,620 11,620 0.15 1,743\n13 7 Marketing -15,000 29,282 14,282 0.15 2,142\n14\n15 Project NPV -268<-- =G6+NPV(B2,G7:G13)\nSince the project \u2019 s net present value is negative, the DCF approach indicates\nthat it should not be undertaken.\nUsing a Real Options Approach\nA n alternative method for estimating the present value of proceeds is to plot\n508 Chapter 19\nA B C D E F G H I J K\n1 BIOTECH PROJECT, BINOMIAL TREE FOR THE CASH FLOWS\n2 Marketing phase, Initial revenue 20,000 The expected return and variance of return\n3 Marketing, annual cost 15,000 is given by:\n4 Clinical annual cost 2,000 Expected 10%\n5 Initial, annual cost 1,000 \u03c3 100%\n6\n7 Up 300%<-- =EXP(H4+H5)\n8 Down 41%<-- =EXP(H4-H5)\n9\n10 State prices\n11 qu 0.2816\n12 qd 0.6618<-- =1/1.06-B11\n13\n14 Net cash flows 1,614,017<-- =B2*B7^4-B3\n15 527,253\n16 165,500 205,464 <-- =B2*B7^3*B8-B3\n17 45,083 58,386\n18 5,000 9,428 14,836 <-- =B2*B7^2*B8^2-B3\n19 -6,869 -5,068\n20 -11,694 -10,962 <-- =B2*B7*B8^3-B3\n21 -2,000 -13,656\n22 -14,454 <-- =B2*B8^4-B3\n23 -2,000\n24\n25 -1,000\n26\n27 Time line 1 2 3 4 5 6 7\n28\n29\n30 State prices (to start of market phase) 0.0001 <-- =B11^J27\n31 0.0005\n32 0.0018 0.0013 <-- =B11^6*B12*COMBIN(4,3)\n33 0.0063 0.0035\n34 0.0223 0.0083 0.0141 <-- =B11^5*B12*2*COMBIN(4,2)\n35 0.0148 0.0083\n36 0.0098 0.0073 <-- =B11^4*B12^3*COMBIN(4,1)\n37 0.079316 0.0065\n38 0.0043 <-- =B11^3*B12^4*COMBIN(4,0)\n39 0.2816\n40\n41 1\n42\n43\n44 Binomial tree valuation -268<-- =SUMPRODUCT(B14:J25,B30:J41)\n45 Target\n46 DCF valuation -268\nDCF valuation -\n47 binomial tree value 0<-- Should be zero for correct state prices\n509 Real Options\nA Note About the State Prices\nT he net present value of the proceeds from the project is the product of the\nnet cash flows and the appropriate state prices:\nNPV\n=\u22117 \u2211t\nCF\n\u2217(\nq\n)j\u2217(\nq\n)t\u2212j\u2217\u239b\n\u239c\nNumberof \u239e\n\u239f\njt U D \u239dpathstonode\u23a0\nt=0 j=0\nwhere C F denotes the proceeds from the project at date t and state j , where\njt\nj is the number of up moves. As explained in Chapter 16, in the standard\n\u239bt\u239e\nbinomial model, the state price for a node is\n(\nq\nU)j\u2217(\nq\nD)n\u2212j\n\u239d\u239c j\u23a0\u239f , where n is\nthe time at which the node occurs, j is the number of Up steps needed to get\n\u239bt\u239e\nto the node, and \u239c \u239f is the number of paths to reach the node. The latter\n\u239dj\u23a0\nexpression is computed in Excel by using the function Combin(n,j) . However,\nfor the real options model above, the number of paths to each node is slightly\ndifferent, since the beginning of the tree (the initial and clinical states) are\naccessible via only one path.\nIn the spreadsheet above, the prices q and q were computed (using Solver )\nU D\nso that the present value of the project on the binomial tree equals that of the\n1\n510 Chapter 19\nHere \u2019 s the Solver screen:\nThe Real Options Approach\nT he real options approach to R&D recognizes that at each stage in the project,\nthe managers can choose whether to continue the project or not. They do this\nby comparing the value and costs of continuation. In option terminology, at\neach stage, the manager exercises her continuation option if the value from\nexercising the option exceeds the exercise price. In the spreadsheet below, we\n511 Real Options\ncare to also eliminate the subsequent cash flows and to make an adjustment\nto the state prices (more on that below):\nA B C D E F G H I J K\n1 BIOTECH PROJECT, OPTION-ADJUSTED BINOMIAL TREE FOR THE CASH FLOWS\n2 Marketing phase, Initial revenue 20,000 The expected return and variance of return\n3 Marketing, annual cost 15,000 is given by:\n4 Clinical annual cost 2,000 Expected 10%\n5 Initial, annual cost 1,000 \u03c3 100%\n6\n7 Up 300%\n8 Down 41%\n9\n10State prices\n11 qu 0.2816\n12 qd 0.6618\n13\n14 Net cash flows 1,614,017<-- =B2*B7^4-B3\n15 527,253\n16 165,500 205,464 <-- =B2*B7^3*B8-B3\n17 45,083 58,386\n18 5,000 9,428 14,836 <-- =B2*B7^2*B8^2-B3\n19\n20\n21 -2,000\n22\n23 -2,000\n24\n25 -1,000\n26\n27Time line 1 2 3 4 5 6 7\n28\n29\n30 State prices (to start of market phase) 0.0001 <-- =B11^J27\n31 0.0005\n32 0.0018 0.0010 <-- =B11^6*B12*(COMBIN(4,3)-1)\n33 0.0063 0.0059\n34 0.0223 0.0167 0.0047 <-- =B11^5*B12*2*(COMBIN(4,1)-2)\n35\n36\n37 0.079316\n38\n39 0.2816\n40\n41 1\n42\n43\n44 Binomial tree valuation 229<-- =SUMPRODUCT(B14:J25,B30:J41)\nAnother Note About State Prices\nW hen we eliminate states in the real option approach, we must also adjust the\nnumber of paths to each node to account for the fact that some states are no\nlonger reachable. This has been done in the above spreadsheet. For example\nthe state in cell J32 (highlighted) is now reachable by one fewer path."
        ],
        "19.6": [
            "What is meant by capital budgeting in financial modeling?\nWhat aspects should be included in capital budgeting?\nWhat does valuing options mean in capital budgeting?\nWhat are the challenges associated with valuing options in capital budgeting?\nWhat is the importance of intuition in financial modeling?\nWhat is the role of projects in capital budgeting? \nCan you explain the concept of real options in financial modeling? \nHow are real options utilised in financial modelling? \nWhat is the relation between projects and options in capital budgeting? \nWhat are the various methods for valuing options in capital budgeting? \nWhat are the intuitions in financial modelling?",
            "19.6 Summary\n\nRecognizing that capital budgeting should include option aspects of projects\nis clear and obvious. Valuing these options is often difficult. In this chapter\nwe have tried to emphasize the intuitions and\u2014insofar as is possible\u2014to give\n512 Chapter 19"
        ]
    },
    "20": {
        "20.1": [
            "What is duration in the context of finance and bonds?\nHow does the duration of a bond relate to its sensitivity to changes in interest rates? \nWhy is duration considered a risk measure for bonds? \nWhat does a higher bond duration suggest about the risk of the bond?\nWhat is Macaulay duration?\nHow does Macaulay duration vary in comparison to the basic duration measure?\nHow is Macaulay duration calculated?\nWhat is meant by the term structure in the context of bond valuation?\nHow does a flat term structure impact the price calculation of a bond?\nWhat are the constituent parts of bond payments?\nHow is the market price of a bond calculated in the context of a flat term structure and discount rate r?\nHow is the time-weighted average maturity of bond payments represented?\nWhat does the Macaulay duration formula signify?\nWhat is the use of duration in immunization strategies?\nCan you explain the process of calculating duration in Excel?",
            "20.1 Overview\n\nDuration is a measure of the sensitivity of the price of a bond to changes in\nthe interest rate at which the bond is discounted. It is widely used as a risk\nmeasure for bonds\u2014the higher a bond\u2019 s duration, the more risky it is. In this\nchapter we consider a basic duration measure\u2014Macaulay duration\u2014which is\ndefined for the case when the term structure is flat. In Chapter 21 we examine\nthe uses of duration in immunization strategies.\nC onsider a bond with payments C , where t = 1, \u2026 , N. Ordinarily, the first\nt\nN \u2212 1 payments will be interest payments, and C will be the sum of the\nN\nrepayment of principal and the last interest payment. If the term structure is\nflat and the discount rate for all of the payments is r , then the bond \u2019 s market\nprice today will be\nP=\u2211N C\nt\n( 1+r)t\nt=1\nT he Macaulay duration measure (throughout this chapter and the next, when\nwe use the word duration we shall always refer to this measure) is meant to\nrepresent the time-weighted average maturity of the payments received from\nthe bond. It is defined as:\nD=\n1\u2211N tC\nt\nP\n( 1+r)t\nt=1\nI n section 20.3 we go deeper into the meaning of this formula. Before doing\nthis, however, we show how to calculate the duration in Excel."
        ],
        "20.2": [
            "What does face value of a bond represent?\nWhat does maturity of a bond imply?\nWhat is the formula to derive the market price of a bond?\nWhat does the current market interest rate for a bond signify?\nHow is the duration of a bond calculated?\nCan Excel be used to compute the duration of a bond, and if so, how?\nWhat is a basic duration calculation in reference to bond valuation?\nWhat are YTM and Ct in the context of bond valuation?\nHow does coupon rate affect the duration of a bond?\nWhat is the difference between Bond A and Bond B in the given context?\nWhat is the relevance of the net present value of a bond's first-year payoff?\nHow is the net present value of a bond's first-year payoff calculated?\nWhat is the Excel Duration Function and how can it be used?\nWhat is MDuration and how does it differ from Duration in Excel? \nWhat are the parameters required for the Duration and MDuration formulas in Excel?\nHow does the yield to maturity affect the duration of a bond?\nWhat is a \"day count basis\" and how is it used in bond valuation?\nWhat does the Macaulay duration represent?\nWhat is price elasticity of a bond and how can it be calculated?\nWhat are the benefits and limitations of using date serial numbers in the Excel duration formula?\nWhat function does DDuration serve in bond valuation?\nWhat is the significance of unevenly spaced bond payments?",
            "20.2 Two Examples\n\nConsider two bonds. Bond A has just been issued. Its face value is $1,000, it\nbears the current market interest rate of 7%, and it will mature in 10 years.\nBond B was issued 5 years ago, when interest rates were higher. This bond\nhas $1,000 face value and bears a 13% coupon rate. When issued, this bond\nhad a 15-year maturity, so its remaining maturity is 10 years. Since the current\nmarket rate of interest is 7%, bond B\u2019 s market price is given by\n$1,421.41=\u221110 $130\n+\n$1,00\n( 1.07)t ( 1.07)10\n518 Chapter 20\nIt is worthwhile calculating the duration of each of the two bonds (just\nonce!) the long way. We set up a table in Excel. Rows 17 through 24 show\nalternatives to the long computation of the duration.\nA B C D E F G\n1 BASIC DURATION CALCULATION\n2 YTM 7%\n3\nt*Ct,A / t*Ct,B /\n4 Year Ct,A PriceA*(1+YTM)t Ct,B PriceB*(1+YTM)t\n5 1 70 0.0654 130 0.0855 <-- =$A5*E5/(E$16*(1+$B$2)^$A5)\n6 2 70 0.1223 130 0.1598 <-- =$A6*E6/(E$16*(1+$B$2)^$A6)\n7 3 70 0.1714 130 0.2240\n8 4 70 0.2136 130 0.2791\n9 5 70 0.2495 130 0.3260\n10 6 70 0.2799 130 0.3657\n11 7 70 0.3051 130 0.3987\n12 8 70 0.3259 130 0.4258\n13 9 70 0.3427 130 0.4477\n14 10 1,070 5.4393 1,130 4.0413\n15\n16 Bond price 1,000.00<-- =NPV(B2,B5:B14) 1,421.41<-- =NPV(B2,E5:E14)\n17 Duration 7.5152<-- =SUM(C5:C14) 6.7535<-- =SUM(F5:F14)\n18\n19 Using the Excel function Duration and the \"home-made\" function Dduration\n20 Bond A 7.5152<-- =DURATION(DATE(1996,12,3),DATE(2006,12,3),7%,B2,1)\n21 7.5152<-- =dduration(A14,7%,B2,1)\n22\n23 Bond B 6.7535<-- =DURATION(DATE(1996,12,3),DATE(2006,12,3),13%,B2,1)\n24 6.7535<-- =dduration(A14,13%,7%,1)\nAs might be expected, the duration of bond A is longer than that of bond\nB, since the average payoff of bond A takes longer than that of bond B. To\nlook at this another way, the net present value of bond A \u2019 s first-year payoff\n($70) represents 6.54% of the bond \u2019 s price, whereas the net present value of\nbond B\u2019 s first-year payoff ($130) is 8.55% of its price. The figures for the\nsecond-year payoffs are 6.11% and 7.99%, respectively. (For the second-year\nfigures, you have to divide the appropriate line of the above spreadsheet by 2,\nsince in the duration formula each payoff is weighted by the period in which\nit is received.)\nUsing the Excel Duration Formula\nE xcel has two duration formulas, Duration( ) and MDuration( ) . MDuration\n519 Duration\nDuration\nMDuration=\n\u239b YTM \u239e\n\u239c1+ \u239f\n\u239d Numberof coupon payments per year\u23a0\nBoth formulas have the same syntax; for example, for D uration( ) the\nsyntax is:\nDuration(settlement, maturity, coupon, yield, frequency, basis)\nwhere\nsettlement is the settlement date (i.e., the purchase date) of the bond\nmaturity is the bond \u2019 s maturity date\ncoupon is the bond \u2019 s coupon\nyield is the bond \u2019 s yield to maturity\nfrequency is the number of coupon payments per year\nbasis is the \u201cday count basis\u201d (i.e., the number of days in a year). This is a\ncode between 0 and 4:\n0 or omitted US (NASD) 30/360\n1 Actual/actual\n2 Actual/360\n3 Actual/365\n4 European 30/360\nThe Duration formula gives the standard Macaulay duration. The\nMDuration formula can be used in calculating the price elasticity of the\nbond (see section 20.3). These two duration formulas may require a bit of\ntrickery to implement, because they demand a date serial number for both\nthe settlement and the maturity. In the spreadsheet above, the Excel formula\nis implemented in cell C21 by assuming that bond A \u2019 s settlement date (for\nour purposes: the current date) is 3 December 1996 and that the bond \u2019 s\nmaturity date is 3 December 2006. The choice of dates is arbitrary. The last\nparameter of the Excel duration formula, which gives the basis, is optional\nand could be omitted.\nT he insertion of serial date formats in the Excel D uration formula is often\nunhandy. Later in this chapter we use VBA to define a simpler duration\n520 Chapter 20\nof a bond when bond payments are unevenly spaced. This \u201chomemade\u201d dura-\ntion formula is called DDuration . The programming aspects of this function\nare discussed in section 20.6. The previous spreadsheet illustrates this function\nin cells B21 and B24. The dialog box for DDuration \u2019 s computation of the\nduration of bond B is given below:\nThe parameter TimeFirst is the time from the bond purchase date until the\nfirst payment. For the examples of bond A and bond B, this parameter is 1."
        ],
        "20.3": [
            "What does duration mean in the context of financial modeling?\nWhat are the three different meanings of duration presented in this context?\nCan you explain the original definition of Macaulay's duration as the time-weighted average of a bond's payments?\nHow is the duration of a bond related to its discounted payments as a proportion of the bond\u2019s price?\nIn what way can duration be considered as the bond\u2019s price elasticity with respect to its discount rate?\nWhy can the duration measure be used to measure a bond\u2019s price volatility?\nHow does duration serve as a risk measure for bonds?\nWhat are the two interpretations of duration in context of bond prices and interest rates?\nHow can duration be used to measure the price volatility of a bond?\nHow does a change in market interest rate affect bond prices as per the price-volatility formula?\nWhat is Babcock\u2019s formula and how does it interpret duration?\nHow is Babcock\u2019s formula different from the two previous interpretations of duration? \nWhat are the main factors in Babcock's formula and what do they represent?\nWhat are the limitations of Babcock\u2019s formula? \nWhat insights does Babcock's formula provide into the duration measure? \nWhat does it mean to say that duration is a convex combination of current yield and present value factor?\nIn financial modeling, how is duration related to bond maturity, yield to maturity, and current yield?\nWhat does PVIF(r,N) represent in the context of bond duration?\nWhy is duration not very different from (1 + r) PVIF in many cases where the current yield of the bond, y, is not greatly different from its yield to maturity r?\nCan you explain how Babcock's formula for duration is implemented for a specific bond?",
            "20.3 What Does Duration Mean?\n\nIn this section we present three different meanings of duration. Each is inter-\nesting and important in its own right.\nDuration as the Time-Weighted Average of the Bond \u2019 s Payments\nT his was the original definition of Macaulay (1938). Rewrite the duration\nformula as follows:\nD=\n1\u2211N tC\nt\n=\u2211N C\nt\nP\n\u2217t\nP\n( 1+r)t ( 1+r)t\n521 Duration\n\u23a1 C P \u23a4\nThe bracketed terms \u23a2 t \u23a5 sum to 1. This follows from the definition of\n\u23a3( 1+r)t\u23a6\nthe bond price; each of these terms is the proportion of the bond \u2019 s price rep-\nresented by the payment at time t . In the duration formula, each of the terms\n\u23a1 C P \u23a4\n\u23a2 t \u23a5 is multiplied by its time of occurrence: Thus, the duration is the\n\u23a3( 1+r)t\u23a6\ntime-weighted average of the bond \u2019 s discounted payments as a proportion of\nthe bond \u2019 s price.\nDuration as the Bond \u2019 s Price Elasticity with Respect to Its Discount Rate\nThis way of viewing duration explains why the duration measure can be used\nto measure the bond \u2019 s price volatility; it also shows why duration is often used\nas a risk measure for bonds. To derive this interpretation, we take the derivative\nof the bond \u2019 s price with respect to the current interest rate:\ndP =\u2211N \u2212tC\nt\ndr\n( 1+r)t+1\nt=1\nA little algebra shows that:\ndP =\u2211N \u2212tC\nt =\u2212\nDP\ndr ( 1+r)t+1 1+r\nt=1\nwhich transforms into two useful interpretations of duration:\n\u2022 First, duration can be regarded as the e lasticity of the bond price with respect\nto the discount factor , where by \u201cdiscount factor\u201d we mean 1 + r :\ndP/P %changeinbond price\n= =\u2212D\ndr/( 1+r)\n%changeindiscount factor\n\u2022 S econd, we can use duration to measure the price volatility of a bond, by\nrewriting the previous equation as:\ndP dr\n=\u2212D\nP 1+r\nT o show this interpretation of duration in a spreadsheet, we go back to the\nexamples of the previous section. Suppose that the market interest rate rises\nby 10%, from 7% to 7.7%. What will happen to the bond prices? The price of\n522 Chapter 20\n$952.39=\u221110 $70\n+\n$1,000\n( 1.077)t ( 1.077)10\nt=1\nA similar calculation shows the price of bond B to be\n$1,360.50=\u221110 $130\n+\n$1,000\n( 1.077)t ( 1.077)10\nt=1\nAs predicted by the price-volatility formula, the changes in the bond prices\nare approximated by \u0394P\u2245\u2212DP\u0394r/(1+r). To see this, work out the numbers\nfor each bond:\nA B C D E F\nDURATION AS PRICE ELASTICITY\nThe change in the bond price can be approximated by\nDP \u00aa - Duration*Price*Dr/(1+r)\n1\n2 Discountrate 7%\n3\n4 Bond A Bond B\n5 Couponrate 7% Coupon 13%\n6 Facevalue 1,000 Facevalue 1,000\n7 Maturity 10 Maturity 10\n8\n9 Price 1,000.00 Price 1,421.41<-- =PV($B$2,E7,-E5*E6)+E6/(1+$B$2)^E7\n10 Duration 7.5152 Duration 6.7535<-- =DURATION(DATE(1996,1,1),DATE(2006,1,1),E5,B2,1)\n11\n12 Newdiscountrate 7.70%\n13 Newprice 952.39 1,360.50<-- =PV($B$12,E7,-E5*E6)+E6/(1+$B$12)^E7\n14\n15 Change in price\n16 Actual 47.61 60.92<-- =E9-E13\nUsing duration as approximation\n17 DP \u2248 - Duration *Price*\u0394r/(1+r) 49.17 62.80<-- =-E10*E9*($B$2-$B$12)/(1+$B$2)\n18\n<-- =-($B$2-\n$B$12)*E9*MDURATION(DATE(1996,1,1),DATE(2006,1,1),E5,\n19 Using MDuration 49.17 62.80$B$2,1)\nNote row 19 of the above spreadsheet: Instead of using the Excel D uration\n\u0394r\nfunction and multiplying by , we could have used the MDuration\n( 1+r)\n523 Duration\nBabcock \u2019 s Formula: Duration as the Convex Combination of Bond Yields\nA third interpretation of duration is Babcock \u2019 s (1985) formula, which shows\nthat duration is a weighted average of two factors:\n\u239b y\u239e y\nD=N\u239c1\u2212 \u239f+ PVIF(r,N)\u2217(1+r)\n\u239d \u23a0\nr r\nwhere\nBondcoupon\ny= ,tthecurrentyieldofthebond\nBondprice\nPVIF(r,N)=\u2211N 1\n,thepresentvvalueofanN-periodannuity\n( 1+r)i\ni=1\nThis formula gives two useful insights into the duration measure:\n\u2022 D uration is a weighted average of the maturity of the bond and of (1 + r )\ntimes the PVIF associated with the bond. (Note that the PVIF is given by the\nExcel formula PV(r,N,-1) .)\n\u2022 In many cases the current yield of the bond, y , is not greatly different from\nits yield to maturity r . In these cases, duration is not very different from\n(1 + r ) PVIF .\nU nlike the two previous interpretations, Babcock\u2019 s formula holds only for\nthe case of a bond with constant coupon payments and single repayment of\nprincipal at time N ; that is, the formula does not extend to the case where the\npayments C differ over time.\nt\nHere \u2019 s an implementation of Babcock \u2019 s formula for bond B:\nA B C\nBABCOCK'S FORMULA FOR DURATION\nDuration is convex combination of current yield and present value factor:\n1 D = N*y/r + (1 - y/r) * PV(r,N,-1)*(1+r)\n2 N, bond maturity 10\n3 r, 7%\n4 C, bond coupon 13%\n5 Face value 1,000\n6 Price 1,421.41<-- =PV(B3,B2,-B4*B5)+B5/(1+B3)^B2\n7 Current yield 9.15%<-- =B4*B5/B6\n8 PVIF(r,N) 7.0236<-- =PV(B3,B2,-1)\n9\n10 Two duration formulas\n11 Babcock's formula 6.7535<-- =B2*(1-B7/B3)+B7/B3*B8*(1+B3)\n524 Chapter 20"
        ],
        "20.4": [
            "What does duration refer to in the context of financial modeling?\nIs the duration of a bond always a decreasing function of a bond\u2019s coupon?\nCan duration of a bond be considered an increasing function of a bond\u2019s maturity?\nWhat effect does increasing the coupon have on a bond's duration?\nHow does the yield to maturity affect the duration of a bond?\nWhat is the face value of a bond?\nHow do changes in bond maturity affect its duration?\nCan you explain the correlation between a bond's coupon rate and its duration?\nWhat is the relationship between bond maturity and a bond's duration? \nWhat factors are considered to calculate the duration of a bond?\nHow do you determine the effect of coupon on a bond's duration?\nHow do you determine the effect of maturity on a bond's duration?\nWhat does a duration of 9.0110 signify in a financial model?\nCan you explain the term 'Yield to Maturity' in the context of bonds?\nHow does a coupon rate of 4% influence the duration of a bond?\nWhat does a maturity date signify in relation to bonds?\nWhat influences the yield to maturity for bonds?\nHow is the duration affected when the bond's maturity increases but the coupon rate remains the same? \nWhat changes in the bond's duration can we expect if we increase the bond's coupon rate? \nWhy does a bond's duration decline as the coupon increases?",
            "20.4 Duration Patterns\n\nIntuitively we would expect that duration is a decreasing function of a bond \u2019 s\ncoupon and an increasing function of a bond\u2019 s maturity. The first of these\nintuitions is correct, but the second is not.\nThe spreadsheet below shows the effect of increasing the coupon on a\nbond\u2019 s duration, which\u2014as our intuition indicated\u2014indeed declines as the\ncoupon increases:\nA B C D\n1 EFFECT OF COUPON ON DURATION\n2 Current date 5/21/1996<-- =DATE(1996,5,21)\n3 Maturity, in years 21\n4 Maturity date 5/21/2017<-- =DATE(1996+B3,5,21)\n5 YTM 15%Yield to maturity (i.e., discount rate)\n6 Coupon 4%\n7 Face value 1,000\n8\n9 Duration 9.0110<-- =DURATION(B2,B4,B6,B5,1)\n10\n11 Data table: Effect of coupon on duration\n12 9.0110<-- =B9 , data table header\n13 0% 21.0000\n14 1% 13.1204\nEffect of Coupon on Duration\n15 Bond coupon --> 2% 10.7865\nMaturity = 21, YTM = 15.00%\n16 3% 9.6677 23\n17 4% 9.0110 21\n18 5% 8.5792\n19\n19 6% 8.2736\n20 7% 8.0459 17\n21 9% 7.7294 15\n22 13% 7.3707 13\n23 15% 7.2593 11\n24 17% 7.1729\n9\n25\n26 7\n27 5\n28 0% 5% 10% 15%\nCoupon rate\n29\n525 Duration\nIt is not true, however, that the duration is always an increasing function of\nthe bond maturity:\nA B C D\n1 EFFECT OF MATURITY ON DURATION\n2 Current date 5/21/1996<-- =DATE(1996,5,21)\n3 Maturity, in years 21\n4 Maturity date 5/21/2017<-- =DATE(1996+B3,5,21)\n5 YTM 15%Yield to maturity (i.e., discount rate)\n6 Coupon 4%\n7 Face value 1,000\n8\n9 Duration 9.0110<-- =DURATION(B2,B4,B6,B5,1)\n10\n11 Data table: Effect of maturity on duration\n12 9.0110<-- =B9 , data table header\n13 1 1.0000\n14 5 4.5163\n10 Effect of Maturity on Duration\n15 Bond maturity --> 10 7.4827\n16 15 8.8148 9 Coupon rate = 4.0%, YTM = 15.00%\n17 20 9.0398 8\n18 25 8.7881 7\n19 30 8.4461\n6\n20 40 7.9669\n21 50 7.7668 5\n22 60 7.6977 4\n23 70 7.6759 3\n24 80 7.6693\n2\n25\n26 1\n27 0\n28 0 10 20 30 40 50 60 70 80\n29\n30 Maturity\n31\nnoitaruD"
        ],
        "20.5": [
            "What is the duration of a bond with uneven payments?\nHow are bond payments usually spaced?\nWhat is the implication if a bond is purchased 8 months before the first payment?\nHow do you calculate the duration of a bond with uneven payments when the YTM is known?\nWhat differentiates a bond with even payments and a bond with uneven payments?\nHow do you calculate the YTM of a bond with uneven payments?\nWhat is the importance of the term \u03b1 in relation to bond payments?\nWhat factors are considered in the calculation of the price of a bond?\nWhat is the function of the Excel function 'Duration()'?\nHow does the homemade formula DDuration work?\nHow does calculating the YTM for uneven periods differ from even periods?\nWhat are some examples of the calculation of the duration of a bond with uneven periods?\nHow do you use the XIRR function in Excel?\nWhy would one use a VBA program to calculate the YTM for a series of uneven payments?\nWhat is the purpose of the annuityvalue function within the VBA program?\nWhat role does the epsilon play in the calculation of uneven YTM?\nHow do DDuration function and UnevenYTM work together for computation? \nWhat Excel function gives the internal rate of return for a schedule of cash flows that is not necessarily periodic?\nWhat does the function UnevenYTM return?\nWhat is the function of the YTM in relation to bond payments and bond prices?",
            "20.5 The Duration of a Bond with Uneven Payments\n\nThe duration formulas discussed above assume that bond payments are evenly\nspaced. This is almost invariably the case for bonds, except for the first\npayment. For example, consider a bond that pays interest on 1 May of each\nof the years 1997, 1998, \u2026 , 2010, with repayment of its face value on the\nlast date. All the payments are spaced 1 year apart; however, if this bond is\npurchased on 1 September 1996, then the time to the first payment is 8 months\n(September to May), not 1 year. We shall refer to such a bond as a bond with\nuneven payments . In this section we discuss two aspects of this (extremely\ncommon) problem:\n\u2022 The calculation of the duration of such a bond, when the YTM is known.\n526 Chapter 20\nof a bond with even payments (i.e., the standard duration formula). In the\nprocess of the discussion we develop a simpler duration formula in Excel.\n\u2022 The calculation of the YTM of a bond with uneven payments. This requires\na bit of trickery, and ultimately leads us to another VBA function.\nDuration of a Bond with Uneven Payments\nC onsider a bond with N payments, the first of which occurs at time \u03b1 < 1, and\nthe rest of which are evenly spaced. In the derivation which follows, we show\nthat the duration of such a bond is given by the sum of two terms:\n\u2022 First term: The duration of a bond with N payments spaced at even intervals\n(i.e., the standard duration discussed above).\n\u2022 Second term: \u03b1 \u2212 1\nI t is relatively simple to show why this is so. Denote the payments on the\nbond by C \u03b1 , C \u03b1 + 1 , C \u03b1 + 2, \u2026 , C \u03b1 + N \u2212 1 , where 0 < \u03b1 < 1. The price of the bond is\ngiven by:\nP=\u2211N C \u03b1+t\u22121 =( 1+r)1\u2212\u03b1\u2211N C \u03b1+t\u22121\n( 1+r)\u03b1+t\u22121 ( 1+r)t\nt=1 t=1\nThe duration of this bond is given by:\nD=\n1\u2211N (\u03b1+t\u22121) C\n\u03b1+t\u22121\nP\n( 1+r)\u03b1+t\u22121\nt=1\nRewrite this last expression as follows:\nD=\n1( 1+r)1\u2212\u03b1\u23a7 \u23a8\u2211N tC\nt+\u03b1\u22121\n+\u2211N (\u03b1\u22121) C t+\u03b1\u22121\u23ab\n\u23ac\nP \u23a9\n( 1+r)t ( 1+r)t\n\u23ad\u23ad\nt=1 t=1\n= 1 ( 1+r)1\u2212\u03b1\u23a7 \u23a8\u2211N tC t+\u03b1\u22121 +(\u03b1\u221211)\u2211N C t+\u03b1\u22121 \u23ab \u23ac\n( 1+r)1\u2212\u03b1\u2211N C t+\u03b1\u22121 \u23a9 t=1( 1+r)t t=1( 1+r)t\u23ad\n( 1+r)t\nt=1\n=\n1 \u23a7 \u23a8\u2211N tC t+\u03b1\u22121\u23ab\n\u23ac+\u03b1\u22121\n\u2211N C\nt+\u03b1\u22121\n\u23a9 t=1( 1+r)tt\u23ad\n( 1+r)t\n527 Duration\nH ere is an example of the calculation of the duration of a bond with uneven\nperiods. Recall that when there is \u03b1 until the first payment, the duration\nformula is given by:\nD=\u2211N 1 (\u03b1+t\u22121) C\n\u03b1+t\u22121\nP\n( 1+r)\u03b1+t\u22121\nt=1\nHere is an example of the calculation of the duration of a bond with uneven\nperiods. Each of the cells D10:D14 calculates the value of a term of this\nformula:\nA B C D\nDURATION OF BOND WITH UNEVEN PERIODS\n1 Brute Force Calculation and DDuration Function\n2 Alpha 0.3Time until first coupon payment (in years)\n3 N 5Number of payments\n4 YTM 6%\n5 Coupon 100\n6 Face 1,000\n7 Bond price 1,217 <-- =NPV(B4,B10:B14)*(1+B4)^(1-B2)\n8\n9 Period Payment t*C /Price*(1+YTM)t\nt\n10 0.3 100 0.0242 <-- =(B10*A10)/(1+$B$4)^A10/$B$7\n11 1.3 100 0.0990\n12 2.3 100 0.1653\n13 3.3 100 0.2237\n14 4.3 1,100 3.0249\n15 Duration 3.5371 <-- =SUM(C10:C14)\n16\n17 Newly defined VBA function 3.5371 <-- =dduration(B3,B5/B6,B4,B2)\nA s noted in section 20.2, the built-in Excel formula Duration( ) is some-\n528 Chapter 20\nintroduced a simpler duration formula using VBA; the syntax of this formula\nis D Duration(numPayments, couponRate, YTM, timeFirst) :\nFunction DDuration(NumPayments, CouponRate, _\nYTM, TimeFirst)\nprice = 1 / (1 + YTM) \u2227 NumPayments\nDDuration = NumPayments / (1 + YTM) \u2227 _\nNumPayments\nFor Index = 1 To NumPayments\nprice = CouponRate / (1 + YTM) \u2227 _\nIndex + price\nNext Index\nFor Index = 1 To NumPayments\nDDuration = CouponRate * Index / _\n(1 + YTM) \u2227 Index + DDuration\nNext Index\nDDuration = DDuration / price + _\nTimeFirst - 1\nEnd Function\nOur homemade formula DDuration requires only the number of payments\non the bond, the coupon rate, and the time to the first payment \u03b1 . The use of\nthe formula is illustrated in the previous spreadsheet, in cell C17.\nCalculating the YTM for Uneven Periods\nA s the discussion above shows, the calculation of duration requires us to know\nthe bond \u2019 s yield to maturity (YTM); this YTM is just the internal rate of return\nof the bond \u2019 s payments and its initial price. Often the YTM is given, but when\nit is not, we cannot use Excel\u2019 s IRR function but must instead use the XIRR\nfunction.\nC onsider a bond that currently costs $1,123 and which pays a coupon of\n$89 on each of the next 1 January. On 1 January 2001, the bond will pay\n529 Duration\nOctober 1996. The problem in finding the YTM of this bond is that while most\nof the bond payments are spaced 1 year apart, there is only 0.2466 of a year\nuntil the first coupon payment (0.2466 = (Date(1997,1,1)-Date(1996,10,3))/\n365). Thus we wish to use Excel to solve the following equation:\n\u22121,123+\u22113 89\n+\n1089\n=0\n( 1+YTM)t+0.2466 ( 1+YTM)4.2466\nt=0\nTo solve this problem, we can use the Excel function XIRR :\nA B C D\nUSING XIRR TO CALCULATE THE IRR WITH\nUNEVEN PAYMENTS\n1\n2 Current date 3-Oct-96\n3 Annual coupon 89 Paid January 1 for each of next 5 years\n4 Maturity date 1-Jan-01\n5 Face value 1,000\n6 Price of bond 1,123\n7\n8 Time to first payment 0.2466 <-- =(B12-B11)/365\n9\n10 Date Payment\n11 3-Oct-96 -1,123\n12 1-Jan-97 89\n13 1-Jan-98 89\n14 1-Jan-99 89\n15 1-Jan-00 89\n16 1-Jan-01 1,089\n17\n18 YTM 7.300% <-- =XIRR(C11:C16,B11:B16)\nTo use the XIRR function, you first have to make sure that the A nalysis\nToolPak is loaded into Excel. Go to F ile|Options|Add-Ins|Manage . This\nbrings up the following menu, in which you have to make sure that Analysis\n530 Chapter 20\nYou can now use XIRR, which returns the internal rate of return for a\nschedule of cash flows that is not necessarily periodic. To use this function\nyou have to specify the list of cash flows and the list of dates. As in the case\nof the Excel function I RR , You can also provide a guess for the IRR, although\nthis may be left out. 1\nCalculating the YTM for Uneven Payments Using a VBA Program\nI f you do not know the payment dates, you can use VBA to calculate the YTM\nfor a series of uneven payments. The program below is composed of two\n\u2211N 1\nfunctions. The first function, annuityvalue , calculates the value .\nt=1( 1+r)t\nThe second function, unevenYTM , uses the simple bisection technique to\ncalculate the YTM of a series of uneven payments, leaving you to choose the\naccuracy epsilon of the desired result:\n1. There is also a function XNPV for finding the present value of a series of payments paid out\n531 Duration\nFunction Annuityvalue(interest, numPeriods)\nannuityvalue = 0\nFor Index = 1 To numPeriods\nannuityvalue = annuityvalue + 1 / _\n(1 + interest) \u2227 Index\nNext Index\nEnd Function\nFunction UnevenYTM(CouponRate, FaceValue, _\nBondPrice, NumPayments, TimeFirst, epsilon)\nDim YTM As Double\nhigh = 1\nlow = 0\nWhile Abs(annuityvalue(YTM, _\nNumPayments) * CouponRate * _\nFaceValue + FaceValue / _\n(1 + YTM) \u2227 NumPayments - _\nBondPrice / (1 + YTM) \u2227 _\n(1 - TimeFirst)) > = epsilon\nYTM = (high + low) / 2\nIf annuityvalue(YTM, NumPayments) * _\nCouponRate * _\nFaceValue + FaceValue / (1 + YTM) _\n\u2227 NumPayments - BondPrice / _\n(1 + YTM) \u2227 (1 - TimeFirst) > 0 _\nThen\nlow = YTM\nElse\nhigh = YTM\nEnd If\nWend\nUnevenYTM = (high + low) / 2\n532 Chapter 20\nHere \u2019 s an illustration of the use of this function:\nA B C\nILLUSTRATION OF CALCULATION\nOF YTM OF UNEVEN PERIODS\n1\nThis spreadsheet illustrates the unevenYTM VBA function:\nthe syntax of this function is\n2\nunevenYTM(CouponRate,FaceValue,BondPrice,NumPayments,TimeFirst,epsilon)\n3 Coupon rate 7.90%\n4 Face value 1,000.00\n5 Bond price 1,123.00\n6 Number of payments 5\n7 Time to first payment 0.25\n8 Epsilon 0.00001<-- Controls the accuracy of the YTM calculation\n9\n10 YTM 6.138%<-- =unevenYTM(B3,B4,B5,B6,B7,B8)\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n533 Duration\nWe can, of course, use the DDuration function in conjunction with\nUnevenYTM to compute the duration:\nA B C\nUSING DDURATION AND UNEVENYTM TOGETHER\n1\n2 Coupon rate 7.90%\n3 Face value 1,000.00\n4 Bond price 1,123.00\n5 Number of payments 5\n6 Time to first payment 0.25\n7 Epsilon 0.00001<--ControlstheaccuracyoftheYTMcalculation\n8\n9 YTM 6.138%<-- =unevenYTM(B2,B3,B4,B5,B6,B7)\n10\n11 Duration 3.5959<-- =dduration(B5,B2,B9,B6)"
        ],
        "20.6": [
            "What is a general model of the term structure in financial modeling?\nHow is the value of a bond calculated considering the term structure?\nWhat does a flat term structure indicate in context of financial modeling?\nCan the term structure exhibit parallel shifts? If yes, how does it affect the bond price?\nWhat is the measure of duration in financial terms and how is it derived?\nWhat does the Macaulay duration measure signify?\nWhat is a term structure and how can it be complex and not flat?\nWhat kind of information can a file of term structures provide?\nHow would you interpret the term structure of interest rates as described for December 1946?\nWhat do the term structures depicted by the graphs represent?\nWhat does the shortest-term interest rate in the market signify in a term structure?\nWhat kind of term structures were witnessed in 1948 and 1981 respectively?\nWhat does a term structure with \"humps\" signify?\nWould you say that the Macaulay duration provides an adequate approximation to the variety of term structures? Why or why not?",
            "20.6 Non-Flat Term Structures and Duration\n\nI n a general model of the term structure, payments at time t are discounted by\nrate r , so that the value of a bond is given by:\nt\nP=\u2211N C\nt\n( 1+r)t\nt=1 t\nT he duration measure discussed in this chapter assumes either a flat term\nstructure (i.e., r = r for allt ) or a term structure which shifts in a parallel\nt\nfashion. When the term structure exhibits parallel shifts, we can write the bond\nprice as:\nP=\u2211N C\nt\n( 1+r +\u0394t)t\nt=1 t\nand then derive a measure of duration by taking the derivative with respect\nto \u0394 t .\nA general model of the term structure should explain how the discount rate\nr for time- t payments comes about, and how the rates at time t change. This\nt\nis a difficult problem, discussed in Chapters 22 and 23.\nD oes this mean that the simple duration measure we present in this chapter\nis useless? Not necessarily. It may be that the Macaulay duration measure gives\n534 Chapter 20\nterm structure, even for the case when the term structure itself is relatively\ncomplex and not flat.2 In this section, we explore this possibility, using data\nfrom a file of term structures developed by Prof. J. Huston McCullogh, which\nis on the disk that accompanies this book.3 The file contains monthly informa-\ntion on the term structure of interest rates in the United States for the period\n12.1949 to 2.87 (i.e., December 1949\u2013February 1987). A typical row of this\nfile looks like:\n0 mo 1 mo 2 mo 3 mo 4 mo 5 mo 6 mo\n12.1946 0.18 0.32 0.42 0.48 0.52 0.55 0.58\n9 mo 1 yr 2 yr 3 yr 4 yr 5 yr 10 yr 15 yr 20 yr\n0.65 0.72 0.95 1.15 1.3 1.41 1.82 2.16 2.32\nT his particular row gives the term structure of interest rates in December 1946.\nInterest rates are given in annual percentage terms; that is, 0.32 means 0.32%\nper year. Here are some pictures of term structures, taken from the file.4 In the\ngraphs below, each line represents the term structure in a particular month. In\n1948 the term structures were very closely correlated, and all were upward\nsloping:\n2. A paper by Gultekin and Rogalski (1984) seems to confirm this.\n3. The data are from McCullogh (1990). For updated daily term structures on Treasuries, go to\nhttp://www.treasury.gov/resource-center .\n4 . T he interest rates are pure discount rates, calculated so that the value of a bond with price P\nand with N payments, C , C , \u2026 , C is\nP=\u2211N C\nt . The column marked \u201c0mo\u201d gives the\n1 2 N t=1( 1+r t)t\ninstantaneous interest rate \u2014the shortest-term interest rate in the market. You can think of this as\n535 Duration\n2.6\n2.4\n2.2\n2\n1.8\n1.6\n1.4\n1.2\n1\n0.8\nContrast this with the term structures in 1981: Here there were upward- and\ndownward-sloping term structures, as well as term structures with \u201chumps\u201d:\n%\netar\ntnuocsid\neruP\nTerm Structures, 1948\nMaturity\nTerm Structures, 1981\n17\n16\n15\n14\n13\n12\n11\n10\n9\n8\nom0 om1 om2 om3 om4 om5 om6 om9 ry1 ry\n2\nry3 ry4 ry5 ry01 ry51 ry02 ry52\nmaturity\n%\n,etar\ntnuocsid\nerup\nD espite this great variety of term structure shapes, you will see in exercise 7\nto this chapter that the Macaulay duration can give an adequate approximation\n536 Chapter 20"
        ],
        "20.7": [
            "What is the duration in relation to bonds?\nWho originally developed the duration measure for bonds?\nHow does Macaulay describe the duration of a bond in his 1938 study?\nWhat does the duration measure signify in terms of bond's payments?\nHow can duration represent the bond\u2019s price elasticity?\nWhat does a change in the bond's discount rate indicate in terms of duration?\nWhat is the implication of duration in the computation of bond portfolio?\nHow is duration used to describe the immunization of a bond portfolio?\nWhat are the fundamentals of duration computation for bonds?\nWhy is duration considered a commonly used risk measure for bonds?\nHow is the time-weighted average of a bond's payments related to its duration?\nHow is duration dealt with in the next stage of financial modeling regarding bond portfolios?",
            "20.7 Summary\n\nIn this chapter we have summarized the basics of duration, a commonly used\nrisk measure for bonds. The duration measure was originally developed by\nMacaulay (1938) to measure the time-weighted average of a bond \u2019 s payments.\nIt can also represent the bond\u2019 s price elasticity to a change in its discount rate.\nThis chapter has explored duration computation basics; in the next chapter we\nuse duration to describe the immunization of a bond portfolio."
        ]
    },
    "21": {
        "21.1": [
            "What is the value of a bond portfolio dependent on in the future?\nWhat is the meaning of an immunized portfolio?\nWhat is the relation between immunization strategies and the concept of duration?\nWhat concepts of duration have immunization strategies been discussed for?\nWhat is the simplest duration concept discussed in relation to immunization strategies?\nWhat does the concept of Macaulay duration refer to in the context of financial modeling?\nWhat does it mean for a portfolio to have the same payoff at a specific future date irrespective of the prevailing interest-rate structure?\nWhat are some factors influencing the liquidation date of a portfolio? \nCan a portfolio be immunized against all interest-rate structure scenarios? \nWhat makes immunization strategies an important aspect in financial portfolio management? \nWhy are immunization strategies closely related to the conception of duration?",
            "21.1 Overview\n\nA bond portfolio \u2019 s value in the future depends on the interest-rate structure\nprevailing up to and including the date at which the portfolio is liquidated. If\na portfolio has the same payoff at some specific future date, no matter what\ninterest-rate structure prevails, then it is said to be immunized . This chapter\ndiscusses immunization strategies, which are closely related to the conception\nof duration discussed in Chapter 20. Immunization strategies have been dis-\ncussed for many concepts of duration, but this chapter is restricted to the\nsimplest duration concept, that of Macaulay."
        ],
        "21.2": [
            "What is a basic simple model of immunization in finance?\nWhat is the significance of a firm having a known future obligation Q?\nHow can an insurance firm use the concept of a known future obligation?\nHow is the discounted value of an obligation calculated?\nWhat does it mean if the future obligation is hedged by a bond held by the firm?\nWhat is the role of a discount rate in calculating the future obligation?\nHow does a bond's present value relate to its anticipated payments?\nWhat happens to the value of the future obligation if the underlying interest rate changes?\nHow is the new value of a future obligation evaluated using the first-order linear approximation?\nWhat conditions should be met for a change in interest rate not to affect the hedging properties of the company\u2019s portfolio?\nCan the term structure of interest rates always be flat, and what implications does it carry?\nWhat does it mean if the duration of the asset equals the duration of the obligation?\nWhat is the definition of \"immunization\" in financial terms?\nWhat are the limitations of the immunization discussed in first-order approximations?\nWhat differences can be drawn between first-order equality and \u201ctrue\u201d equality?\nHow do parallel movements in the term structure affect the value of a future obligation?\nWhat alternative definitions of duration and immunization could be considered?\nWhat findings were made by Gultekin and Rogalski (1984) regarding the simple Macaulay duration?",
            "21.2 A Basic Simple Model of Immunization\n\nConsider the following situation: A firm has a known future obligation, Q (a\ngood example would be an insurance firm, which knows that it has to make a\npayment in the future). The discounted value of this obligation is\nQ\nV =\n0 ( 1+r)N\nwhere r is the appropriate discount rate.\nS uppose that this future obligation is hedged by a bond held by the firm.\nBy this we mean that the firm currently holds a bond, whose value V is equal\nB\nto the discounted value of the future obligation, V . If P , P , \u2026 P is the\n0 1 2 M\nstream of anticipated payments made by the bond, then the bond\u2019 s present\nvalue is given by\nV\n=\u2211M P\nt\nB ( 1+r)t\nt=1\nNow suppose that the underlying interest rate, r , changes to r + \u0394 r . Using a\nfirst-order linear approximation, we find that the new value of the future obli-\ngation is given by\ndV \u23a1 \u2212NQ \u23a4\nV +\u0394V \u2248V + 0 \u0394r=V +\u0394r\u23a2 \u23a5\n0 0 0 dr 0 \u23a3( 1+r)N+1\u23a6\n540 Chapter 21\nV +\u0394V \u2248V\n+dV\nB\u0394r=V\n+\u0394r\u2211N \u2212tP\nt\nB B B dr B ( 1+r)t+1\nt=1\nI f these two expressions are equal, a change in r will not affect the hedging\nproperties of the company\u2019 s portfolio. Setting the expressions equal gives us\nthe condition\nV\n+\u0394r\u2211N \u2212tP\nt =V\n+\u0394r\u23a1\n\u23a2\n\u2212NQ \u23a4\n\u23a5\nB ( 1+r)t+1 0 \u23a3( 1+r)N+1\u23a6\nt=1\nRecalling that\nQ\nV =V =\nB 0 ( 1+r)N\nwe can simplify this expression to get\n1 \u2211M tP\nt =N\nV\n( 1+r)t\nB t=1\nT he last equation is worth restating as a formal proposition: Suppose that\nthe term structure of interest rates is always flat (that is, the discount rate for\na cash flow occurring at all future times is the same) or that the term structure\nmoves up or down in parallel movements. Then a necessary and sufficient\ncondition that the market value of an asset be equal under all changes of the\ndiscount rate r to the market value of a future obligation Q is that the duration\nof the asset equal the duration of the obligation. Here we understand the word\n\u201cequal\u201d to mean equal in the sense of a first-order approximation.\nA n obligation against which an asset of this type is held is said to be\nimmunized .\nThe above statement has two critical limitations:\n\u2022 The immunization discussed applies only to first-order approximations.\nWhen we get to a numerical example in the succeeding sections, we shall see\nthat there is a big difference between first-order equality and \u201ctrue\u201d equality.\nIn A nimal Farm , George Orwell made the same observation about the barn-\nyard: \u201cAll animals are equal, but some animals are more equal than others.\u201d\n\u2022 W e have assumed either that the term structure is flat or that the term struc-\nture moves up or down in parallel movements. At best, this might be consid-\n541 Immunization Strategies\nsection 20.5). Alternative theories of the term structure lead to alternative\ndefinitions of duration and immunization (for alternatives, see Bierwag et al.,\n1981, 1983a, 1983b; Cox, Ingersoll, and Ross, 1985; Vasicek, 1977). In an\nempirical investigation of these alternatives, Gultekin and Rogalski (1984)\nfound that the simple Macaulay duration we use in this chapter works at least\nas well as any of the alternatives."
        ],
        "21.3": [
            "What is a numerical immunization example in financial modeling?\nWhat does a year-10 obligation with a present value of $1,000 mean?\nHow is the future value of an obligation calculated?\nWhat factors should be considered when trying to immunize an obligation?\nHow is the value of a bond calculated?\nWhat does the yield to maturity of a bond imply?\nWhat does the face value of a bond mean?\nHow does the purchase price of a bond relate to its face value?\nHow does the market value of a bond affect its purchase?\nWhat is the effect of reinvesting each coupon at a fixed yield to maturity?\nHow can a bond finance future obligations?\nWhat happens when the yield to maturity changes after the bond is purchased?\nHow does a change in yield to maturity affect the ability of a bond to fund the obligation?\nWhat is the concept of overfunding in terms of bond financing?\nHow does the bond duration factor into its ability to fund obligations?\nHow does the decreased yield impact a bond's ability to fulfil obligations?\nWhat is the relationship between the face value purchased and product in bond market?\nWhat are the implications of purchasing $1,000 of any bond in relation to financing future obligations?\nWhat does the graphical representation of bond's immunization properties indicate?",
            "21.3 A Numerical Example\n\nI n this section we consider a basic numerical immunization example. Suppose\nyou are trying to immunize a year-10 obligation whose present value is $1,000\n(this means that, at the current interest rate of 6%, its future value is\n$1,000 \u00b7 (1.06) 10 = $1,790.85. You intend to immunize the obligation by pur-\nchasing $1,000 worth of a bond or a combination of bonds.\nYou consider three bonds:\n\u2022 Bond 1 has 10 years remaining until maturity, a coupon rate of 6.7%, and a\nface value of $1,000.\n\u2022 Bond 2 has 15 years until maturity, a coupon rate of 6.988%, and a face\nvalue of $1,000.\n\u2022 Bond 3 has 30 years until maturity, a coupon rate of 5.9%, and a face value\nof $1,000.\nA t the existing yield to maturity of 6%, the prices of the bonds differ.\nBond 1, for example, is worth\n$1,051.52=\u221110 67\n+\n1,000\n; thus, in\n( 1.06)t ( 1.06)10\nt\norder to purchase $1,000 worth of this bond, you have to purchase\n$951 = $1,000/$1,051.52 of face value of the bond.\nB ond 3, however, is currently worth $986.24, so that in order to buy $1,000\nof market value of this bond, you will have to buy $1,013.96 of face value of\nthe bond. If you intend to use this bond to finance a $1,790.85 obligation 10\n542 Chapter 21\nTHE IMMUNIZATION PROBLEM\nIllustrated here for the 30-year bond.\nYear 10:\nFuture obligation of\n$1,790.85 due.\n0 30\nBuy $1,014\nface value\nof 30-year Reinvest Sell bond for PV of\nbond. coupons remaining coupons\nfrom bond and redemption in\nduring year 30.\nyears 1-10.\nWhen the interest rate increases:\nValue of Value of bond in\nreinvested year 10 decreases.\ncoupons\nincreases.\nWhen the interest rate decreases:\nValue of Value of bond in\nreinvested year 10\ncoupons increases.\ndecreases.\nAs we will see below, the 30-year bond will exactly finance the future\nobligation of $1,790.85 only for the case in which the current market interest\nrate of 6% remains unchanged.\nHere is a summary of price and duration information for the three bonds:\nA B C D E\n1 BASIC IMMUNIZATION EXAMPLE WITH 3 BONDS\n2 Yield to maturity 6%\n3\n4 Bond 1 Bond 2 Bond 3\n5 Coupon rate 6.70% 6.988% 5.90%\n6 Maturity 10 15 30\n7 Face value 1,000 1,000 1,000\n8\n9 Bond price $1,051.52 $1,095.96 $986.24 <-- =-PV($B$2,D6,D5*D7)+D7/(1+$B$2)^D6\n10 Face value equal to $1,000 of market value $ 9 51.00 $ 912.44 $ 1,013.96 <-- =D7/D9*D7\n11\n543 Immunization Strategies\nNote that to calculate the duration, we have used the \u201chome-made\u201d D Duration\nfunction defined in Chapter 20.\nIf the yield to maturity doesn\u2019 t change, then you will be able to reinvest\neach coupon at 6%. Thus, bond 2, for example, will give a terminal wealth at\nthe end of 10 years, of\n\u22119 69.88\u22c5( 1.06)t +\u23a1 \u23a2\u22115 69.88 + 1,000 \u23a4 \u23a5=9211.07+1,041.62=1,962.69\n\u23a3\n( 1.06)t ( 1.06)5\u23a6\nt=0 t=1\nThe first term in this expression,\n\u22119\n69.88\u22c5( 1.06)t\n, is the sum of the\nt=0\nreinvested coupons. The second and third terms, \u2211 5 69.88 + 1,000 ,\n( 1.06)t ( 1.06)5\nt=1\nrepresent the market value of the bond in year 10, when the bond has 5 more\nyears until maturity. Since we will be buying only $912.44 of face value of\nthis bond, we have, at the end of 10 years, 0.91244*$1,962.69 = $1,790.85.\nThis is exactly the amount we wanted to have at this date. The results of this\ncalculation for all three bonds, provided there is no change in the yield to\nmaturity, are given in the following table:\nA B C D E\n14 New yield to maturity 6%\n15\n16 Bond 1 Bond 2 Bond 3\n17 Bond price $1,000.00 $1,041.62 $988.53 <-- =-PV($B$14,D6-10,D5*D7)+D7/(1+$B$14)^(D6-10)\n18 Reinvested coupons $883.11 $921.07 $777.67 =-FV($B$14,10,D5*D7)\n19 Total $1,883.11 $1,962.69 $1,766.20 <-- =D17+D18\n20\n21 Multiply by percent of face value bought 95.10% 91.24% 101.40%<-- =D10/1000\n22 Product $ 1 ,790.85 $ 1,790.85 $ 1,790.85 <-- =D21*D19\nThe upshot of this table is that purchasing $1,000 of any of the three bonds\nwill provide\u201410 years from now\u2014funding for your future obligation of\n$1,790.85, p rovided the market interest rate of 6% doesn \u2019 t change .\nNow suppose that immediately after you purchase the bonds the yield to\nmaturity changes to some new value and stays there. This will obviously affect\nthe calculation we did above. For example, if the yield falls to 5%, the table\n544 Chapter 21\nA B C D E\n14 New yield to maturity 5%\n15\n16 Bond 1 Bond 2 Bond 3\n17 Bond price $1,000.00 $1,086.07 $1,112.16 <-- =-PV($B$14,D6-10,D5*D7)+D7/(1+$B$14)^(D6-10)\n18 Reinvested coupons $842.72 $878.94 $742.10 =-FV($B$14,10,D5*D7)\n19 Total $1,842.72 $1,965.01 $1,854.26 <-- =D17+D18\n20\n21 Multiply by percent of face value bought 95.10% 91.24% 101.40%<-- =D10/1000\n22 Product $ 1 ,752.43 $ 1,792.97 $ 1,880.14 <-- =D21*D19\nThus, if the yield falls, bond 1 will no longer fund our obligation, whereas\nbond 3 will overfund it. Bond 2 \u2019 s ability to fund the obligation\u2014not surpris-\ningly, in view of the fact that its duration is exactly 10 years\u2014hardly changes.\nWe can repeat this calculation for any new yield to maturity. The results are\nshown in the figure below, which was produced by running a Data|Table (see\nChapter 31):\nImmuniza(cid:415)onProper(cid:415)esoftheThreeBonds\n2,900\n2,700\n2,500\n2,300\n2,100\n1,900\n1,700\n1,500\n0% 2% 4% 6% 8% 10% 12% 14% 16%\nBond1 Bond2 Bond3\n545 Immunization Strategies"
        ],
        "21.4": [
            "What is the duration of a portfolio?\nHow can a bond investment with a duration of 10 be achieved?\nHow can the weights of a bond investment with a duration of 10 be calculated?\nWhat is the effect of varying the Yield to Maturity (YTM) in a portfolio of bond 1 and bond 3?\nWhat does the future value of a portfolio indicate?\nWhat is bond convexity?\nWhy does Redington (1952) consider convexity as a desirable property?\nWhat characteristics does an immunized portfolio possess according to Redington?\nWhat is the terminal value of a bond portfolio?\nHow does the terminal value of a portfolio change with respect to changes in Yield to Maturity?\nIn a comparison between two immunized portfolios, which portfolio is preferable?\nWhy might a portfolio with more convex terminal value be preferable for immunization strategy?\nCan a bond position be chosen which always benefits from changes in the term structure in regard to convexity?\nWhat role does arbitrage play in the selection of a bond position? \nHow does convexity affect the overfunding of future obligations in a portfolio? \nHow does the performance of a bond portfolio compare to the performance of a single bond?\nWhat is the interpretation of convexity in relation to parallel changes in the term structure?",
            "21.4 Convexity: A Continuation of Our Immunization Experiment\n\nThe duration of a portfolio is the weighted average duration of the assets in\nthe portfolio. This means that there is another way to get a bond investment\nwith a duration of 10: If we invest $665.09 in bond 1 and $344.91 in bond 3,\nthe resulting portfolio also has a duration of 10. These weights are calculated\nas follows:\n\u03bb\u2217Duration +( 1\u2212\u03bb)\u2217Duration =7.6655\u03bb+14.6361( 1\u2212\u03bb)=100\nBond1 Bond3\nSuppose we repeat our experiment with this portfolio of bonds. Starting in row\n15 of the spreadsheet below, we repeat the experiment of the previous section\n(varying the YTM), but add in the portfolio of bond 1 and bond 3. The results\nbelow show that the future value in row 23 does not vary for the portfolio.\nA B C D E F G\n1 EXPERIMENTING WITH BOND PORTFOLIOS AND CONVEXITY\n2 Yield to maturity (YTM) 6%\n3\n4 Bond 1 Bond 2 Bond 3\n5 Coupon rate 6.70% 6.988% 5.90%\n6 Maturity 10 15 30\n7 Face value 1,000 1,000 1,000\n8\n9 Bond price $1,051.52 $1,095.96 $986.24 <-- =-PV($B$2,D6,D5*D7)+D7/(1+$B$2)^D6\n10 Face value equal to $1,000 of market value $ 951.00 $ 912.44 $ 1,013.96 <-- =D7/D9*D7\n11\n12 Duration 7.6655 10.0000 14.6361<-- =dduration(D6,D5,$B$2,1)\n13\n14\n15 New YTM 7%\n16\nBond 1 & 3\nBond 1 Bond 2 Bond 3\n17 portfolio\n18 Bond price $1,000.00 $999.51 $883.47\n19 Reinvested coupons $925.70 $965.49 $815.17\n20 Total $1,925.70 $1,965.00 $1,698.64\n21\n22 Multiply by percent of face value bought 95.10% 91.24% 101.40%\n23 Product $ 1,831.35 $ 1,792.95 $ 1,722.34 $ 1,794.84 <-- =B26*B23+(1-B26)*D23\n24\n25 Portfolio of bonds 1 and 3\n26 Proportion of bond 1 0.6651 <-- =(10-D12)/(B12-D12)\n546 Chapter 21\nBuilding a data table based on this experiment and graphing the results shows\nthat the portfolio \u2019 s performance is better than that of bond 2 by itself:\nPerformanceofBond2versusBondPor(cid:414)olio\n2,100\n2,000\n1,900\n1,800\n1,700\n1,600\n1,500\n0% 2% 4% 6% 8% 10% 12% 14% 16%\nBond2 Bondpor(cid:414)olio\nConvexity\nL ook again at the graph: Notice that, while for both bond 2 and the bond\nportfolio, the terminal value is somewhat convex in the yield to maturity, the\nterminal value of the portfolio is m ore convex than that of the single bond.\nRedington (1952), one of the influential propagators of the concept of duration\nand immunization, thought this convexity very desirable, and we can see why:\nNo matter what the change in the yield to maturity, the portfolio of bonds\nprovides m ore overfunding of the future obligation than the single bond. This\nis obviously a desirable property for an immunized portfolio, and it leads us\nto formulate the following rule:\nIn a comparison between two immunized portfolios, both of which are to fund a known\nfuture obligation, the portfolio whose terminal value is more convex with respect to\nchanges in the yield to maturity is preferable. 1\n1 . T here is another interpretation of the convexity shown in this example: It shows the impossibil-\nity of parallel changes in the term structure! If such changes describe the uncertainty relating to\nthe term structure, a bond position can be chosen which always benefits from changes in the term\nstructure. This is an arbitrage, and therefore impossible. I thank Zvi Wiener for pointing this out\n547 Immunization Strategies"
        ],
        "21.5": [
            "What is a bond portfolio's terminal value? \nHow can the performance of a bond portfolio be improved? \nCan you explain the concept of matching the first and second derivatives in improving a bond portfolio? \nWhat does a direct extension of the analysis of section 20.3 indicate about enhancing the portfolio performance? \nWhat are the determining characteristics of a bond portfolio whose terminal value is insensitive to yield changes? \nWhat is the role of second derivatives in improving the performance of the bond portfolio?\nCan you provide an example of a portfolio with matched second derivatives? \nHow does the matching of second derivatives affect the insensitivity of the terminal value of a portfolio to changes in the yield? \nWhat is the VBA function defined to calculate the second derivative of bond duration?\nWhat is the duration concept in relation to bond portfolio? \nHow does sensitivity of Bond 2 and bond portfolio terminal values respond to interest rate changes? \nWhat do the proportions of a portfolio which sets both the duration and its second derivative indicate? \nHow to calculate a portfolio of bonds with their duration and second duration derivative equal to those of the liability? \nWhat should be the total investment in bonds 1, 3, and 4 to ensure that the portfolio duration is matched to that of bond 2? \nWhat conditions should be met to solve the problem of building a better mousetrap in terms of financial bonds? \nCan you explain how to calculate a bond portfolio using Excel? \nWhat is the weighted average duration derivatives equal to that of bond 2? \nWhat is the sensitivity of Bond 2 and bond portfolio terminal values to interest rate changes?",
            "21.5 Building a Better Mousetrap\n\nD espite what was said in the preceding section, there is some interest in deriv-\ning the characteristics of a bond portfolio whose terminal value is as insensitive\nto changes in the yield as possible. One way of improving the performance\n(when so defined) of the bond portfolio is not only to match the first deriva-\ntives of the change in value (which, as we saw in section 20.3, leads to the\nduration concept), but also to match the second derivatives.\nA direct extension of the analysis of section 20.3 leads us to the conclusion\nthat matching the second derivatives requires:\nN( N+1)= 1 \u2211M t( t+1) P t\nV\n( 1+r)t\nB t=1\nT he following example illustrates the kind of improvement that can be made\nin a portfolio where the second derivatives are also matched. Consider 4 bonds,\none of which, bond 2, is our old friend from the previous example, whose\nduration is exactly 10. The bonds are described in the following table:\nA B C D E F\n1 BOND CONVEXITY\n2 Yield to maturity 6%\n3\n4 Bond 1 Bond 2 Bond 3 Bond 4\n5 Coupon rate 4.50% 6.988% 3.50% 11.00%\n6 Maturity 20 15 14 10\n7 Face value 1,000 1,000 1,000 1,000\n8\n9 Bond price $827.95 $1,095.96 $767.63 $1,368.00 <-- =-PV($B$2,E6,E5*E7)+E7/(1+$B$2)^E6\n10 Face value equal to $1,000 of market value $ 1 ,207.80 $ 912.44 $ 1,302.72 $ 730.99 <-- =E7/E9*E7\n11\n12 Duration 12.8964 10.0000 10.8484 7.0539<-- =dduration(E6,E5,$B$2,1)\n548 Chapter 21\nHere secondDur(numberPayments, couponRate, YTM) is a\nVBA function we have defined to calculate the second derivative of the\nduration:\nFunction secondDur(numberPayments, couponRate,\nYTM)\nFor Index = 1 To numberPayments\nIf Index < numberPayments Then\nsecondDur = couponRate * Index * _\n(Index + 1) / (1 + YTM) \u2227 Index + _\nsecondDur\nElse\nsecondDur = (couponRate + 1) * _\nIndex * (Index + 1) _\n/ (1 + YTM) \u2227 Index + _\nsecondDur\nEnd If\nsecondDur = secondDur\nNext Index\nEnd Function\nWe need three bonds in order to calculate a portfolio of bonds whose dura-\ntion and whose second duration derivative are exactly equal to those of the\nliability. The proportions of a portfolio which sets both the duration and its\nsecond derivative equal to those of the liability are bond 1 = \u2212 0.5619, bond\n3 = 1.6415, bond 4 = \u2212 0.0797.2 As the following figure shows, this portfolio\nprovides a better hedge against the terminal value than even bond 2:\n549 Immunization Strategies\nImmuniza(cid:415)onUsingSecondDeriva(cid:415)ves\n2,000\n1,950\n1,900\n1,850\n1,800\n1,750\n1,700\n1,650\n1,600\n1,550\n1,500\n0% 2% 4% 6% 8% 10% 12% 14% 16%\nBond2 Bondpor(cid:414)olio\nComputing the Bond Portfolio\nWe want to invest proportions x , x , x in bonds 1, 3, and 4 so that:\n1 3 4\n\u2022 The portfolio is totally invested: x + x + x = 1.\n1 3 4\n\u2022 The portfolio duration is matched to that of bond 2: x D + x D + x D =\n1 1 3 3 4 4\nD , where D is the duration of bond i .\n2 i\n\u2022 The second derivative of the portfolio duration is matched to that of bond\n2: x D2+x D2+x D2 =D2 , where D2 is the duration derivative.\n1 1 3 3 4 4 2 i\nWriting this in matrix form, we get:\n\u23a1 1 1 1 \u23a4\u23a1x \u23a4 \u23a1 1 \u23a4\n1\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\u23a5\nD D D x = D\n\u23a2 1 3 4\u23a5\u23a2 3\u23a5 \u23a2 2\u23a5\n\u23a3\u23a2D2 D2 D2\u23a6\u23a5\u23a3\u23a2x \u23a6\u23a5 \u23a3\u23a2D2\u23a6\u23a5\n550 Chapter 21\nwhose solution is given by:\n\u23a1x \u23a4 \u23a1 1 1 1 \u23a4\u22121\u23a1 1 \u23a4\u23a4\n1\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\nx = D D D D\n\u23a2 3\u23a5 \u23a2 1 3 4\u23a5 \u23a2 2\u23a5\n\u23a3\u23a2x \u23a6\u23a5 \u23a3\u23a2D2 D2 D2\u23a6\u23a5 \u23a3\u23a2D2\u23a6\u23a5\n4 1 3 4 2\nThis can easily be set up in Excel:\nI J K L M N\n15 Calculating the bond portfolio:\n16 Vector of\n17 Matrix of coefficients constants\n18 1 1 1 1\n19 12.8964 10.8484 7.0539 10.0000\n20 229.0873 148.7023 67.5980 110.0000\n21\n22 Solution\n23 -0.5619\n24 1.6415 <-- {=MMULT(MINVERSE(I18:K20),M18:M20)}\n25 -0.0797\n26\n27\n28 Explanation of the above: We want to invest proportions\n29 x , x , and x in bonds 1, 3 and 4 respectively, in order\n1 3 4\n30 that: a) The total investment is $1000; this means x+x +x =1\n1 2 4\n31 b) Portfolio duration is matched to that of bond 2; this means\n32 that x *D +x *D +x *D = D , where D is the duration\n1 1 3 3 4 4 2 i\n33 of bond I.\n34 c) The weighted average duration derivatives are equal\n35 to that of bond 2.\n36\n37 These three conditions give us the matrix system in\n38 cells I18:K20 and the corresponding solution in\n551 Immunization Strategies\nGiven this solution, the last chart is produced by the following data table:\nA B C D E F\nData table: Sensitivity of Bond 2 and bond Bond\n26 portfolio terminal values to interest rate Bond 2 portfolio\n27 <-- =I23*B23+I24*D23+I25*E23 , data table header (hidden)\n28 0% $ 1,868.87 $ 1,774.63\n29 1% $ 1,844.71 $ 1,781.79\n30 2% $ 1,825.14 $ 1,786.37\n31 3% $ 1,810.05 $ 1,789.02\n32 4% $ 1,799.35 $ 1,790.32\n33 5% $ 1,792.97 $ 1,790.78\n34 6% $ 1,790.85 $ 1,790.85\n35 7% $ 1,792.95 $ 1,790.91\n36 8% $ 1,799.26 $ 1,791.31\n37 9% $ 1,809.76 $ 1,792.38\n38 10% $ 1,824.46 $ 1,794.38\n39 11% $ 1,843.37 $ 1,797.58\n40 12% $ 1,866.53 $ 1,802.21\n41 13% $ 1,893.98 $ 1,808.46\n42 14% $ 1,925.77 $ 1,816.55\n43 15% $ 1,961.98 $ 1,826.65"
        ],
        "21.6": [
            "What is the value of an immunized portfolio of bonds? \nWhat does an immunized portfolio of bonds remain insensitive to?\nWhat is the process of immunization in relation to bonds portfolio?\nWhat must be the bond portfolio\u2019s duration in relation to the underlying liability for immunization to occur?\nWhat tools are typically used for immunization calculations?\nWhat is the duration of the underlying liability in immunization of bonds portfolio?\nWhat is the importance of setting the bond portfolio's duration equal to the duration of the underlying liability in the context of immunization strategies?\nIn the context of immunization strategies, what is meant by the underlying yield to maturity? \nWhat is meant by the term 'immunization' in financial modeling?",
            "21.6 Summary\n\nThe value of an immunized portfolio of bonds is insensitive to small changes\nin the underlying yield to maturity of the bonds. Immunization involves setting\nthe bond portfolio \u2019 s duration equal to the duration of the underlying liability\nagainst which the portfolio is held. This chapter shows how to effect the\nimmunization of the portfolio. Needless to say, Excel is an excellent tool for\nimmunization calculations."
        ]
    },
    "22": {
        "22.1": [
            "What is the term structure of the interest rate in the context of financial modelling? \nWhat is the main problem associated with fitting an equation to the term structure of interest rate?\nWhat information can we infer from a set of bond prices?\nWhat factors should be considered when discussing the yields on bonds?\nWhy is it significant to take into account the riskiness of the bonds when dealing with term structure problem?\nWhat is the most common interest rate measure for bonds?\nWhat is the yield to maturity (YTM) and how it is associated with bond price and future promised payments on a bond?\nWhat is the meaning of \"discount factor\" in the context of financial modelling and bond pricing?\nHow do discount factors define the pure discount yields on bonds?\nWhat is the simplest term structure problem?\nWhat is the next step after starting with the simplest term structure problem?\nWhat is the Nelson-Siegel model of 1987?\nHow does the Svensson variant differ from the Nelson-Siegel model? \nWhat is the significance of the functional form fitted to the term structure in financial modelling?",
            "22.1 Overview\n\nT his chapter discusses the problem of fitting an equation to the term structure\nof interest rate. The main problem looks like this: We are given a set of bond\nprices. Can we say something intelligent about the yields on these bonds, for\nexample, in terms of time to maturity or in terms of yields versus duration?\nT he problem is surprisingly complicated. It is obvious that we need to take\ninto account the riskiness of the bonds (the set of bonds should be of equal\nrisk) and their time pattern of interest payments. There is an additional com-\nplicating factor: The most common interest rate measure for bonds is the yield\nto maturity (YTM), essentially the internal rate of return of the bond price and\nthe future promised payments on the bond. For analytical purposes, however,\nit is more meaningful to attach a discount factor d to payments made in each\nt\ntime period. These discount factors define the so-called p ure discount yields\non the bonds.1\nT his chapter starts with the simplest term structure problem, where there is\nonly one bond for each time period. We then go on to discuss more compli-\ncated situations. The functional form we fit to the term structure is the Nelson-\nSiegel model (1987). We also show a variation of this model due to Svensson\n(section 22.8)."
        ],
        "22.2": [
            "- What are the two methods of pricing bonds introduced in the sub-section?\n- How is Yield to Maturity (YTM) calculated for a bond?\n- Can you explain the concept of discount factors used for bond pricing?\n- How is a bond's price calculated using discount factors? \n- What is the significance of bond maturity in a pricing model? \n- What role do coupon rates play in bond pricing?\n- What are the implications of having multiple bonds for the same maturity? \n- How does a change in coupon rates affect the yield to maturity?\n- What is the significance of 'time pattern of payments' in bond pricing?\n- How can discount factors benefit the pricing of bonds?\n- How can we interpret the data in the basic example given in the section?\n- Using discount factors, how would you price a 5-period bond with a coupon of 3%?\n- What is the zero-coupon term structure?\n- Could you explain the bond pricing equation in terms of discount rates?\n- What are the factors that can cause a term structure to become intricate?\n- How can we convert discount factors into interest rates?\n- How can different prices or coupons for bonds affect the term structure?",
            "22.2 Basic Example\n\nIn this section we introduce two methods of pricing bonds in the case where\neach bond maturity is associated with a single bond. 2 The two methods are\n\u2022 Computing the yield to maturity of each bond. Each bond \u2019 s yield to maturity\n(YTM) is the internal rate of return of the bond price and the future\npayments.\n* This chapter was co-authored by Dr. Alexander Suhov of Tel Aviv University, a.y.suhov@gmail\n.com.\n1. Those familiar with the Treasury bond strip market will recognize the factors das the discount\nt\nfactors associated with Treasury strips. See www.treasurydirect.gov/instit/marketables/strips/\nstrips.htm.\n2. In the next section we discuss the case where there are multiple bonds for the same maturity\n554 Chapter 22\n\u2022 Computing a set of unique, time-dependent, discount factors for the bonds.\nLabeling the discount factor for time t by d , a bond\u2019 s price is computed by\nt\nPrice=\u2211N\nCd , where C is the promised bond payment at time t .\nt t t\nt=1\nT o illustrate these two methods, consider 15 bonds, each of which pays an\nannual coupon until maturity and each of which has a face value of 100. The\nbonds have a maturity of 1, 2, \u2026, 15. In the spreadsheet clip below we show\nthe table of bonds, their coupon rates, and their YTMs:\nA B C D E F\n1 INITIAL EXAMPLE\nAnnual\ncoupon\n2 Bond Price Maturity rate YTM\n3 1 96.60 1 2.0% 5.59%\n4 2 93.71 2 2.5% 5.93%\n5 3 91.56 3 3.0% 6.17%\n6 4 90.24 4 3.5% 6.34%\n7 5 89.74 5 4.0% 6.47%\n8 6 90.04 6 4.5% 6.56%\n9 7 91.09 7 5.0% 6.63%\n10 8 92.82 8 5.5% 6.69%\n11 9 95.19 9 6.0% 6.73%\n12 10 98.14 10 6.5% 6.76%\n13 11 101.60 11 7.0% 6.79%\n14 12 105.54 12 7.5% 6.81%\n15 13 109.90 13 8.0% 6.83%\n16 14 114.64 14 8.5% 6.84%\n17 15 119.73 15 9.0% 6.85%\nThe YTMs are computed by putting the bond payments into a triangular\n555 Modeling the Term Structure\nF G H I J K L M N\n1 =IF(I$2<$C3,$D3*100,IF(I$2=$C3,(1+$D3)*100,0))\nInterest 0 1 2 3 4 5 6\n2 YTM rate y\nt\n3 5.59% 1 -96.60 102.00 0.00 0.00 0.00 0.00 0.00\n4 5.93% 2 -93.71 2.50 102.50 0.00 0.00 0.00 0.00\n5 6.17% 3 -91.56 3.00 3.00 103.00 0.00 0.00 0.00\n6 6.34% 4 -90.24 3.50 3.50 3.50 103.50 0.00 0.00\n7 6.47% 5 -89.74 4.00 4.00 4.00 4.00 104.00 0.00\n8 6.56% 6 -90.04 4.50 4.50 4.50 4.50 4.50 104.50\n9 6.63% 7 -91.09 5.00 5.00 5.00 5.00 5.00 5.00\n10 6.69% 8 -92.82 5.50 5.50 5.50 5.50 5.50 5.50\n11 6.73% 9 -95.19 6.00 6.00 6.00 6.00 6.00 6.00\n12 6.76% 10 -98.14 6.50 6.50 6.50 6.50 6.50 6.50\n13 6.79% 11 -101.60 7.00 7.00 7.00 7.00 7.00 7.00\n14 6.81% 12 -105.54 7.50 7.50 7.50 7.50 7.50 7.50\n15 6.83% 13 -109.90 8.00 8.00 8.00 8.00 8.00 8.00\n16 6.84% 14 -114.64 8.50 8.50 8.50 8.50 8.50 8.50\n17 6.85% 15 -119.73 9.00 9.00 9.00 9.00 9.00 9.00\n18\n19 <-- =IRR(H17:W17)\nT here is another way to interpret the data in our basic example. Suppose\nthat each time period t has its own discount factor d . Then the prices of the\nt\nbonds could be written as the discounted prices of bond payments:\nBond1:96.6=102d\n1\nBond2:93.71=2.5d +102.5d\n1 2\nBond3:91.56=3d +3dd +103d\n1 2 3\n....\nIngeneral:Price=\u2211N\nCd\nt t\nt=1\nUsing matrices, we can solve for the discount factors d :\nt\n\u23a1C 0 0 0 0 \u2026 0 \u23a4 \u23a1d \u23a4\u23a4 \u23a1Price \u23a4\n11 1 1\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\nC C 0 0 0 \u2026 0 d Price\n\u23a2 21 22 \u23a5\u2217\u23a2 2\u23a5=\u23a2 2\u23a5\n\u23a2 \u2026 \u2026 \u2026 \u23a5 \u23a2 (cid:2) \u23a5 \u23a2 (cid:2) \u23a5\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\n\u23a3C C C \u23a6 \u23a3d \u23a6 \u23a3Price \u23a6\n556 Chapter 22\nSolving this system of equations gives\n\u23a1d \u23a4 \u23a1C 0 0 0 0 \u2026 0 \u23a4\u23a4\u22121 \u23a1Price \u23a4\n1 11 1\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\nd C C 0 0 0 \u2026 0 Price\n\u23a2 2\u23a5=\u23a2 21 22 \u23a5 \u2217\u23a2 2\u23a5\n\u23a2 (cid:2) \u23a5 \u23a2 \u2026 \u2026 \u2026 \u23a5 \u23a2 (cid:2) \u23a5\n\u23a2 \u23a5 \u23a2 \u23a5 \u23a2 \u23a5\n\u23a3d \u23a6 \u23a3C C C \u23a6 \u23a3Price \u23a6\nN N1 N2 NN N\nThis computation is easily done in Excel:\nF G H I J K L M N\n1 =IF(I$2<$C3,$D3*100,IF(I$2=$C3,(1+$D3)*100,0))\nDiscount Interest 0 1 2 3 4 5 6\n2 factors d rate y\nt t\n3 0.9471 1 -96.60 102.00 0.00 0.00 0.00 0.00 0.00\n4 0.8911 2 -93.71 2.50 102.50 0.00 0.00 0.00 0.00\n5 0.8354 3 -91.56 3.00 3.00 103.00 0.00 0.00 0.00\n6 0.7815 4 -90.24 3.50 3.50 3.50 103.50 0.00 0.00\n7 0.7300 5 -89.74 4.00 4.00 4.00 4.00 104.00 0.00\n8 0.6814 6 -90.04 4.50 4.50 4.50 4.50 4.50 104.50\n9 0.6358 7 -91.09 5.00 5.00 5.00 5.00 5.00 5.00\n10 0.5930 8 -92.82 5.50 5.50 5.50 5.50 5.50 5.50\n11 0.5530 9 -95.19 6.00 6.00 6.00 6.00 6.00 6.00\n12 0.5157 10 -98.14 6.50 6.50 6.50 6.50 6.50 6.50\n13 0.4809 11 -101.60 7.00 7.00 7.00 7.00 7.00 7.00\n14 0.4484 12 -105.54 7.50 7.50 7.50 7.50 7.50 7.50\n15 0.4181 13 -109.90 8.00 8.00 8.00 8.00 8.00 8.00\n16 0.3898 14 -114.64 8.50 8.50 8.50 8.50 8.50 8.50\n17 0.3635 15 -119.73 9.00 9.00 9.00 9.00 9.00 9.00\n18\n19 {=MMULT(MINVERSE(I3:W17),-H3:H17)}\nPricing Advantages of the Discount Factors\nT he advantage of the discount factors is that they allow the accurate pricing\nof any other bond with the same time pattern of payments. Consider, for\nexample, a 5-period bond with a coupon of 3%. The price of this bond, using\n557 Modeling the Term Structure\nG H I J K L M\n21 Time --> 0 1 2 3 4 5\n22 New bond 85.5549 3 3 3 3 103\n23 <-- {=MMULT(I22:W22,F3:F17)}\nFrom Discount Factors to a Term Structure\nThe discount factors determine a z ero-coupon term structure : d\n=exp(\u2212y \u2217t)\n,\nt t\nwhere y is the continuously compounded pure-discount rate for time t .\nt\nSolving the discount factors for the zero-coupon interest rate gives\ny\n=ln(\nd\n)\nt\nt t\nThis means that we can write our bond pricing equation in terms of discount\nrates instead of discount factors:\nPrice=\u2211N\nCd\n=\u2211N\nCe\u2212ytt\nt t t\nt=1 t=1\nApplying this to our example:\nF G H I J K L M N O P\nDiscount Interest Time--> 0 1 2 3 4 5\n2 factors d rate y Bond PureDiscountTermStructure\nt t\n3 0.9471 5.44% <-- =-LN(F3)/C3 1 -96.60 102.00 0.00 0.00 0.00 0.00\n7.0%\n4 0.8911 5.76% <-- =-LN(F4)/C4 2 -93.71 2.50 102.50 0.00 0.00 0.00\n5 0.8354 6.00% <-- =-LN(F5)/C5 6.8% 3 -91.56 3.00 3.00 103.00 0.00 0.00\n6 0.7815 6.16% <-- =-LN(F6)/C6 6.6% 4 -90.24 3.50 3.50 3.50 103.50 0.00\n7 0.7300 6.29% 6.4% 5 -89.74 4.00 4.00 4.00 4.00 104.00\n8 0.6814 6.39% 6.2% 6 -90.04 4.50 4.50 4.50 4.50 4.50\n9 0.6358 6.47% 6.0% 7 -91.09 5.00 5.00 5.00 5.00 5.00\n10 0.5930 6.53% 5.8% 8 -92.82 5.50 5.50 5.50 5.50 5.50\n11 0.5530 6.58% 9 -95.19 6.00 6.00 6.00 6.00 6.00\n5.6%\n12 0.5157 6.62% 10 -98.14 6.50 6.50 6.50 6.50 6.50\n5.4%\n13 0.4809 6.66% 11 -101.60 7.00 7.00 7.00 7.00 7.00\n14 0.4484 6.68% 5.2% 12 -105.54 7.50 7.50 7.50 7.50 7.50\n15 0.4181 6.71% 5.0% 13 -109.90 8.00 8.00 8.00 8.00 8.00\n16 0.3898 6.73% 014 1 2-1134.644 5 8.650 7 88.509 10 81.15012 138.5104 15 8.50\n17 0.3635 6.75% 15 -119.73 9.00 9.00 9.00 9.00 9.00\n18\n558 Chapter 22\nDifferent prices or coupons for bonds can produce quite intricate term\nstructures. In the example below we compute the discount factors and interest\nrates for different sets of annual coupon rates:\nA B C D E F G H I J K L M N\nAnnual\ncoupon Discount Interest Time--> 0 1 2 3\n2 Bond Price Maturity rate factors rate Bond \u2193\n3 1 96.60 1 2.0% 0.9471 5.44% <-- =-LN(F3)/C3 1 -96.60 102.00 0.00 0.00\n4 2 93.71 2 2.5% 0.8911 5.76% <--7 . 0=%-LN(F4)/C4 PureD2iscountT-9e3r.m71Struct2u.r5e0 102.50 0.00\n5 3 91.56 3 3.0% 0.8354 6.00% <-- =-LN(F5)/C5 3 -91.56 3.00 3.00 103.00\n6 4 90.24 4 3.5% 0.7815 6.16% <-- =-LN(F6)/C6 4 -90.24 3.50 3.50 3.50\n6.5%\n7 5 89.74 5 4.0% 0.7300 6.29% 5 -89.74 4.00 4.00 4.00\n8 6 90.04 6 4.5% 0.6814 6.39% 6 -90.04 4.50 4.50 4.50\n6.0%\n9 7 91.09 7 4.8% 0.6463 6.24% 7 -91.09 4.80 4.80 4.80\n10 8 92.82 8 4.9% 0.6273 5.83% 8 -92.82 4.90 4.90 4.90\n5.5%\n11 9 95.19 9 5.0% 0.6142 5.42% 9 -95.19 5.00 5.00 5.00\n12 10 98.14 10 5.1% 0.6060 5.01% 10 -98.14 5.10 5.10 5.10\n5.0%\n13 11 101.60 11 5.3% 0.5944 4.73% 11 -101.60 5.30 5.30 5.30\n14 12 105.54 12 5.7% 0.5695 4.69% 12 -105.54 5.70 5.70 5.70\n15 13 109.90 13 6.5% 0.5117 5.15% 4.5% 13 -109.90 6.50 6.50 6.50\n16 14 114.64 14 7.0% 0.4803 5.24% 14 -114.64 7.00 7.00 7.00\n17 15 119.73 15 7.3% 0.4684 5.06% 4.0% 15 -119.73 7.30 7.30 7.30\n0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n18\n19 {=MMULT(MINVERSE(L3:Z17),-K3:K17)}"
        ],
        "22.3": [
            "What does it mean to have several bonds with the same maturity?\nWhat is the common occurrence in bond markets typified by thin trading and often-misreported prices?\nWhat is the discount factor in financial modeling?\nHow to find the discount factors for multiple bonds with the same maturity?\nWhat is the least squares approximation in financial modeling?\nWhy is the matrix of cash flows not invertible when there are several bonds with the same maturity?\nHow is the least squares approximation used to solve for a vector of discount factors?\nWhat is the formula for the least squares approximation in financial modeling?\nWhy will the fit of discount factors to bond prices no longer be precise when several bonds have the same maturity?\nWhat are the potential inconsistencies in pricing when dealing with several bonds with the same maturity?\nWhy might positive pricing errors occur when dealing with multiple bonds of the same maturity?\nWhy is it important to minimize the square of the pricing errors for the set of bonds?\nWhat does it mean when the equations outnumber the unknowns in sets of equations?\nCan you explain how actual bond prices are compared to fitted prices?\nWhat happens when you use a least squares approximation for discount factors in a bond market scenario?\nHow is the pricing of bonds approximated in a financial model incorporating several bonds with the same maturity?\nWhat does \"YTM\" stand for in the context of financial modeling?\nWhat is the impact of varying bond maturity on the least squares approximation in a term structure model?",
            "22.3 Several Bonds with the Same Maturity\n\nI n the previous section there was only one bond for each maturity date. In real\ndata situations, there are often a number of bonds with similar maturities and\npossibly inconsistent pricing. In bond markets, which are typified by thin\ntrading and often-misreported prices, this is a common occurrence. Suppose,\nas in the next example, we have several bonds with similar maturities. In the\nexample below there are two bonds for 3-, 6-, and 9-year maturities, each with\n559 Modeling the Term Structure\nA B C D E F\nMULTIPLE BONDS WITH SAME MATURITY\n1\nAnnual\ncoupon\n2 Bond Price Maturity rate YTM\n3 1 91.8967 1 2.0% 10.99%\n4 2 83.2564 2 2.5% 12.47%\n5 3 76.0000 3 3.0% 13.20%\n6 4 76.2347 3 3.2% 13.32%\n7 5 71.2110 4 3.5% 13.22%\n8 6 67.9672 5 4.0% 13.14%\n9 7 66.0000 6 4.5% 13.01%\n10 8 66.1625 6 4.2% 12.56%\n11 9 65.4881 7 5.0% 12.74%\n12 10 65.7003 8 5.5% 12.53%\n13 11 64.0000 9 5.8% 12.75%\n14 12 66.6158 9 6.0% 12.35%\n15 13 68.0989 10 6.5% 12.19%\n16 14 70.0480 12 7.0% 11.79%\n17 15 72.3857 15 7.5% 11.43%\n18\n19 =IRR(H17:W17)\nThe matrix of cash flows is no longer square, since there are now 15 bonds\nwith 12 maturities. In section 22.2 we found the discount factors d by inverting\nt\nthe matrix of payments, but in this case this matrix is not invertible, since it\nis not square:\nF G H I J K L M N O P Q R S T\nTime--> 0 1 2 3 4 5 6 7 8 9 10 11 12\n2 YTM Bond \u2193\n3 10.99% 1 -91.90 102.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n4 12.47% 2 -83.26 2.50 102.50 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n5 13.20% 3 -76.00 3.00 3.00 103.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n6 13.32% 4 -76.23 3.20 3.20 103.20 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n7 13.22% 5 -71.21 3.50 3.50 3.50 103.50 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n8 13.14% 6 -67.97 4.00 4.00 4.00 4.00 104.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00\n9 13.01% 7 -66.00 4.50 4.50 4.50 4.50 4.50 104.50 0.00 0.00 0.00 0.00 0.00 0.00\n10 12.56% 8 -66.16 4.20 4.20 4.20 4.20 4.20 104.20 0.00 0.00 0.00 0.00 0.00 0.00\n11 12.74% 9 -65.49 5.00 5.00 5.00 5.00 5.00 5.00 105.00 0.00 0.00 0.00 0.00 0.00\n12 12.53% 10 -65.70 5.50 5.50 5.50 5.50 5.50 5.50 5.50 105.50 0.00 0.00 0.00 0.00\n13 12.75% 11 -64.00 5.80 5.80 5.80 5.80 5.80 5.80 5.80 5.80 105.80 0.00 0.00 0.00\n14 12.35% 12 -66.62 6.00 6.00 6.00 6.00 6.00 6.00 6.00 6.00 106.00 0.00 0.00 0.00\n15 12.19% 13 -68.10 6.50 6.50 6.50 6.50 6.50 6.50 6.50 6.50 6.50 106.50 0.00 0.00\n16 12.06% 14 -70.05 7.00 7.00 7.00 7.00 7.00 7.00 7.00 7.00 7.00 7.00 107.00 0.00\n17 11.95% 15 -72.39 7.50 7.50 7.50 7.50 7.50 7.50 7.50 7.50 7.50 7.50 7.50 107.50\nWe can find the discount factors by using a least squares approximation:\nFor each maturity t, we find a factor d so that the square of the pricing errors\nt\nfor the set of bonds is minimized. The least squares approximation is usually\n560 Chapter 22\nthat is, sets of equations in which the equations outnumber the unknowns.\n\u201cLeast squares\u201d means that the overall solution minimizes the sum of the\nsquares of the errors made in the results of every equation.\nWe want to solve for a vector of discount factors d that best approximates\nthe pricing of the bonds.\n\u23a1Discount\u23a4 \u23a1Bond\u23a4\n[ Cashflows]\u2217\n\u23a2\n\u23a5=\n\u23a2 \u23a5\n\u23a3 factors \u23a6 \u23a3Prices\u23a6\n\u23a1102 \u23a4\u23a1d \u23a4 \u23a1\u23a191.8967\u23a4\n1\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n2.5 1022.5 d 83.2564\n\u23a2 \u23a5\u23a2 2 \u23a5 \u23a2 \u23a5\n\u23a2 3 3 103 \u23a5\u23a2 \u23a5 \u23a276.0000\u23a5\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n(cid:2) (cid:2) (cid:2)\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2\n5.8 5.8 5.8 105.8\n\u23a5\u23a2 \u23a5=\u23a2 \u23a5\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 6 6 6 106 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n6.5 6.5 6.5 6.6 106.5\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 7 7 7 7 7 107 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a2 \u23a5\u23a2 \u23a5 \u23a2 \u23a5\n\u23a37.5 77.5 7.5 7.5 7.5 7.5 107.5\u23a6\u23a3\u23a3d \u23a6 \u23a372.3857\u23a6\n12\nThe formula for the least squares approximation is\nd=(\nCashflowsT\n\u2217Cashflows)\u22121\u2217(\nCashflowsT\n\u2217Prices)\nIn Excel this formula becomes\n\u239bMinverse( MMult( Transpose( Cashflows) ,Cashflows)\n,\u239e\nd=MMult\u239c \u239f\n\u239d MMultt( Transpose( Cashflows) ,Prices) \u23a0\n561 Modeling the Term Structure\nA B C D E F G H I\n1 LEAST SQUARES SOLUTION TO TERM STRUCTURE\n2 Least squares and term structure\nAnnual\nMaturity\nBond # Price coupon Maturity d(t) y(t)\n(years)\n3 rate\n4 1 91.8967 1 2.0% 1 0.9009 10.43%<-- =-LN(G4)/F4\n5 2 83.2564 2 2.5% 2 0.7903 11.77%\n6 3 76.0000 3 3.0% 3 0.6874 12.49%\n7 4 76.2347 3 3.2% 4 0.6076 12.46%\n8 5 71.2110 4 3.5% 5 0.5387 12.37%\n9 6 67.9672 5 4.0% 6 0.4863 12.01%\n10 7 66.0000 6 4.5% 7 0.4327 11.97%\n11 8 66.1625 6 4.2% 8 0.3911 11.74%\n12 9 65.4881 7 5.0% 9 0.3473 11.75%\n13 10 65.7003 8 5.5% 10 0.3231 11.30%\n14 11 64.0000 9 5.8% 11 0.2945 11.11%\n15 12 66.6158 9 6.0% 12 0.2687 10.95%\n16 13 68.0989 10 6.5%\n17 14 70.0480 11LeastS7q.0u%aresTermStructure\n18 15 72.3857 12 7.5%\n19 13.0%\n20\n12.5%\n21\n22 12.0%\n23\n24 11.5%\n25 11.0%\n26\n27 10.5%\n28\n10.0%\n29 1 2 3 4 5 6 7 8 9 10 11 12\n30\nMaturity\n562 Chapter 22\nThe fit of discount factors to bond prices will no longer (as in the previous\nsection) be precise. Below we compare the actual bond prices to the fitted\nprices:\nA B C D E F G H I J K\n1 COMPARING FITTED TO ACTUAL PRICES\n2 Least squares and term structure\nAnnual\nActual Maturity Fitted\nBond # coupon Maturity d(t) y(t)\nprice (years) price\n3 rate\n4 1 91.8967 1 2.0% 1 0.9009 10.43%<-- =-LN(G4)/F4 91.8959<-- {=MMULT(O4:Z4,$G$4:$G$15)}\n5 2 83.2564 2 2.5% 2 0.7903 11.77% 83.2556<-- {=MMULT(O5:Z5,$G$4:$G$15)}\n6 3 76.0000 3 3.0% 3 0.6874 12.49% 75.8791<-- {=MMULT(O6:Z6,$G$4:$G$15)}\n7 4 76.2347 3 3.2% 4 0.6076 12.46% 76.3548\n8 5 71.2110 4 3.5% 5 0.5387 12.37% 71.2104\n9 6 67.9672 5 4.0% 6 0.4863 12.01% 67.9665\n10 7 66.0000 6 4.5% 7 0.4327 11.97% 66.6826\n11 8 66.1625 6 4.2% 8 0.3911 11.74% 65.4793\n12 9 65.4881 7 5.0% 9 0.3473 11.75% 65.4895\n13 10 65.7003 8 5.5% 10 0.3231 11.30% 65.7017\n14 11 64.0000 9 5.8% 11 0.2945 11.11% 64.7904\n15 12 66.6158 9 6.0% 12 0.2687 10.95% 65.8269\n16 13 68.0989 10 6.5% 68.0989\n17 14 70.0480 11 7.0% 70.0480\n18 15 72.3857 12 7.5% 72.3857\n19\n20 Actual price minus fi(cid:2)ed price\n21\n1.0\n22\n23 0.8\n24 0.6\n25 0.4\n26 0.2\n27 0.0\n28 -0.2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n29 -0.4\n30 -0.6\n31\n-0.8\n32\n33 -1.0 Bond\n34"
        ],
        "22.4": [
            "What is the advantage of fitting a functional form to the term structure in financial modeling?\nWhat does interpolating interest rates allow in financial modeling?\nWhat is the Nelson-Siegel model in relation to the term structure?\nHow does the Nelson-Siegel model help determine the sensitivity of the term structure to structural factors?\nWhat are the plausible values of parameters in the Nelson-Siegel term structure model?\nHow does one fit the Nelson-Siegel term structure to the discount factors?\nWhat does the term 'NS rate' in a financial model represent?\nWhat processes are involved in computing the NS term structure?\nWhat is the optimization step in modeling the NS term structure?\nWhat is the purpose of minimizing the sum of the squares between the NS and the LS in financial modeling?\nWhat role do discount factors play in financial modeling?\nHow does Excel\u2019s Solver assist in financial modeling?\nWhat does the term 'pure-discount interest rate' mean in financial modeling?\nHow does beta influence the term structure in financial modeling?\nWhat is the significance of least squares fit of discount factors in maturity? \nWhat is the relation between Nelson-Siegel rate and current factors in a term structure model?\nHow is the error calculated in a Nelson-Siegel fitted model? \nWhat does minimizing the squared difference between the LS rate and the NS rate accomplish in financial modeling?",
            "22.4 Fitting a Functional Form to the Term Structure\n\nThe term structure determined in the previous section may suit our purposes.\nWe may, however, want to fit a functional form to the term structure. The\nadvantage of a functional form is that it allows us to interpolate interest rates\nfor time periods and coupons that are not in our data set. It also allows us to\ndetermine the sensitivity of the term structure to structural factors.\nO ne popular fitted form for the term structure is the Nelson-Siegel (NS)\n563 Modeling the Term Structure\ny( t)=\u03b1 +\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u239e\n\u239f+\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u2212e\u2212t\u03b2\u239e\n\u239f\n1 2\u239d \u239d t \u23a0\u23a0 3\u239d \u239d t \u23a0 \u23a0\nThis model can also be written as:\ny( t)=\u03b1 +(\u03b1\n+\u03b1)\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e\n\u239f\u2212\u03b1e\u2212t\u03b2\n1 2 3 \u239d t \u23a0 3\nIn the next section we analyze the NS term structure model and discuss the\nmeaning and the plausible values of its parameters ( \u03b1 , \u03b1 , \u03b1 , \u03b2 ). In this\n1 2 3\nsection we skip these analytics of the model and show how to fit NS term\nstructure to the discount factors of the example of the previous section. 3 Our\nend result is given below (explanations to follow):\nA B C D E F G H I J K L M\n1 FITTING NELSON-SIEGEL\nAnnual\nBond # Price Maturity coupon Maturity dLS(t) yLS(t) NS rate Error\n2 (years) rate\n3 1 91.8967 1 2.0% 1 0.90094 11.00% 10.99% 5.0E-09 \u03b11 0.09622\n4 2 83.2564 2 2.5% 2 0.79028 12.49% 12.56% 4.4E-07 \u03b12 -0.0198\n5 3 76.0000 3 3.0% 3 0.68743 13.31% 13.17% 1.9E-06 \u03b13 0.15235\n6 4 76.2347 3 3.2% 4 0.60759 13.27% 13.29% 7.4E-08 \u03b2 1.84868\n7 5 71.2110 4 3.5% 5 0.53867 13.17% 13.18% 1.6E-09 Error 1.4E-05<-- =SUM(I3:I14)\n8 6 67.9672 5 4.0% 6 0.48632 12.77% 12.95% 3.5E-06 \u03b11+\u03b12 0.0764\n9 7 66.0000 6 4.5% 7 0.4327 12.71% 12.70% 2.5E-08\n10 8 66.1625 6 4.2% 8 0.39109 12.45% 12.44% 7.5E-09\n11 9 65.4881 7 5.0% 9 0.34733 12.47% 12.21% 6.9E-06\n12 10 65.7003 8 5.5% 10 0.32313 11.96% 11.99% 1.1E-07\n13 11 64.0000 9 5.8% 11 0.29448 11.76% 11.80% 2.4E-07\n14 12 66.6158 9 6.0% 12 0.26871 11.57% 11.64% 4.1E-07<-- =(G14-H14)^2\n15 13 68.0989 10 6.5%\n16 14 70.0480 11 7.0% =NSrate($L$3,$L$4,$L$5,$L$6,G14)\n17 15 72.3857 12 7.5% =F14^(-1/G14)-1\n18\n19 {=LS(C21:N35,B3:B17)}\n3. Charles R. Nelson and Andrew F. Siegel, \u201cParsimonious Modeling of Yield Curves,\u201d J ournal\nof Business , 1987. Fitting the NS term structure to a set of bond data is an art! Subsequent sec-\n564 Chapter 22\nThe graph below shows the discount factors and the fitted NS term\nstructure:\n13.5%\n13.0%\n12.5%\n12.0%\n11.5%\nLeast squares rate\n11.0%\nNelson-Siegel rate\n10.5%\n1 2 3 4 5 6 7 8 9 10 11 12\nComputational Procedure\nHere \u2019 s how we computed the NS term structure above:\nS tep 1: We start by computing the discount factors d and the corresponding\nt\nyields y ( t ) for the data in a method similar to that discussed in sections 22.2\nand 22.3. In the example above we label these d L S ( t ) and yL S ( t ).\nS tep 2: We now assume arbitrary but reasonable values for \u03b1 , \u03b1 , \u03b1 , and \u03b2 .\n1 2 3\nIn the next section we discuss what these values might be.\nS tep 3: Given the arbitrary starting values for \u03b1 , \u03b1 , \u03b1 , and \u03b2 , we have the\n1 2 3\nNS discount zero coupon yields\nyNS( t)=\u03b1 +\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u239e\n\u239f+\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u2212e\u2212t\u03b2\u239f\u239e\n1 2\u239d \u239d t \u23a0\u23a0 3\u239d \u239d t \u23a0 \u23a0\u23a0\nStep 4: We now optimize \u03b1 , \u03b1 , \u03b1 , and \u03b2 to minimize the sum of the squares\n1 2 3\nbetween the NS and the LS:\n\u2211N [ yLS( t)\u2212yNS( t)]2\n, where N is the number of\nt=1\n565 Modeling the Term Structure\nHere is an example: Suppose that in our example we initially set (\u03b1 , \u03b1 ,\n1 2\n\u03b1 , \u03b2 ) = (0.1, \u2212 0.05, 0.13, 2). This gives the calculations below:\n3\nA B C D E F G H I J K L M\n1 FITTING NELSON-SIEGEL\nAnnual\nMaturity\nBond # Price coupon Maturity dLS(t) yLS(t) NS rate Error\n2 (years) rate\n3 1 91.8967 1 2.0% 1 0.90094 11.00% 8.41% 6.7E-04 \u03b11 0.1\n4 2 83.2564 2 2.5% 2 0.79028 12.49% 10.27% 4.9E-04 \u03b12 -0.05\n5 3 76.0000 3 3.0% 3 0.68743 13.31% 11.24% 4.3E-04 \u03b13 0.13\n6 4 76.2347 3 3.2% 4 0.60759 13.27% 11.70% 2.5E-04 \u03b2 2\n7 5 71.2110 4 3.5% 5 0.53867 13.17% 11.87% 1.7E-04 Error 0.00232<-- =SUM(I3:I14)\n8 6 67.9672 5 4.0% 6 0.48632 12.77% 11.89% 7.7E-05 \u03b11+\u03b12 0.05<-- =L3+L4\n9 7 66.0000 6 4.5% 7 0.4327 12.71% 11.82% 7.9E-05\n10 8 66.1625 6 4.2% 8 0.39109 12.45% 11.73% 5.3E-05\n11 9 65.4881 7 5.0% 9 0.34733 12.47% 11.61% 7.3E-05\n12 10 65.7003 8 5.5% 10 0.32313 11.96% 11.50% 2.1E-05\n13 11 64.0000 9 5.8% 11 0.29448 11.76% 11.40% 1.3E-05\n14 12 66.6158 9 6.0% 12 0.26871 11.57% 11.30% 7.6E-06<-- =(G14-H14)^2\n15 13 68.0989 10 6.5%\n16 14 70.0480 11 7.0% =F14^(-1/E14)-1\n17 15 72.3857 12 7.5%\n18 {=LS(C37:N51,B3:B17)} =NSrate($L$3,$L$4,$L$5,$L$\n19 6,E14)\n20\n21\n22 13%\n23\n24 12%\n25\n26 11%\n27\n28 10%\n29\n3 30 1 9% Least squares rate\n32 Nelson-Siegel rate\n33 8%\n34 1 2 3 4 5 6 7 8 9 10 11 12\nHere are some explanations:\n\u2022 Columns A\u2013D are the data.\n\u2022 Column F gives the least squares fit of the discount factors for each\nmaturity.\n\u2022 Column G translates this LS fit to a pure-discount interest rate.\n\u2022 C olumn H gives the Nelson-Siegel rate corresponding to our current factors\n( \u03b1 , \u03b1 , \u03b1 , \u03b2 ) = (0.1, \u2212 0.05, 0.13, 2).\n1 2 3\n\u2022 Column I squares the difference between the LS rate and the NS rate. The\n566 Chapter 22\nW e now use Excel\u2019 s Solver to find ( \u03b1 , \u03b1 , \u03b1 , \u03b2 ) that minimizes this\n1 2 3\nsummed squared difference. Here \u2019 s the dialog box:\nT he value in cell L6 is for \u03b2. As we will see in the next section, beta controls\nthe \u201chump\u201d in the term structure and must be positive. Here\u2019 s the solution\nproduced by Solver :\nE F G H I J K L M\nM1a3t.u5r%ity dLS(t) yLS(t) NS rate Error\n2\n3 1 0.90094 11.00% 10.99% 5.0E-09 \u03b11 0.09622\n13.0%\n4 2 0.79028 12.49% 12.56% 4.4E-07 \u03b12 -0.0198\n5 3 0.68743 13.31% 13.17% 1.9E-06 \u03b13 0.15235\n12.5%\n6 4 0.60759 13.27% 13.29% 7.4E-08 \u03b2 1.84868\n7 5 0.53867 13.17% 13.18% 1.6E-09 Error 1.4E-05<-- =SUM(I3:I14)\n12.0%\n8 6 0.48632 12.77% 12.95% 3.5E-06 \u03b11+\u03b12 0.0764<-- =L3+L4\n9 7 0.4327 12.71% 12.70% 2.5E-08\n11.5%\n10 8 0.39109 12.45% 12.44% 7.5E-09\n11 9 0.34733 12.47% 12.21%Leas6t.s9qEua-0re6srate\n11.0%\n12 10 0.32313 11.96% 11.99% 1.1E-07\n13 11 0.29448 11.76% 11.80%Nels2o.n4-SEie-0ge7lrate\n10.5%\n14 12 0.26871 11.57% 11.64% 4.1E-07<-- =(G14-H14)^2\n1 2 3 4 5 6 7 8 9 10 11 12\n15"
        ],
        "22.5": [
            "What is the Nelson-Siegel (NS) term structure?\nWhat are the parameters required for fitting the Nelson-Siegel term structure to data?\nWhat is the NS zero coupon yield?\nWhat are the properties of the Nelson-Siegel term structure?\nWhat does the shortest term rate of NS term structure signify and how is it calculated?\nWhat does the longest term rate of NS term structure signify and how is it calculated?\nHow does beta control the location of the term structure hump?\nHow does the value of beta impact the term structure in the NS model?\nWhat role does alpha play in the NS term structure?\nHow is the Nelson-Siegel term structure affected by very short or very long yields?\nHow does alpha influence the term structure at medium-term yields?\nHow does the value of alpha impact the concavity/convexity of the term structure?\nHow does the term structure vary with different alpha values?\nWhat is the process of fitting a term structure to the NS model?\nHow are plausible initial values set for the NS model parameters?\nWhich parameter approximates the zero-term interest rate in NS model?\nWhich parameter approximates the long-term rate in NS model?\nWhich parameter indicates the location of the hump in the NS term structure?\nWhich parameter affects the concavity/convexity of the term structure in the NS model?",
            "22.5 The Properties of the Nelson-Siegel Term Structure\n\nFitting the Nelson-Siegel (NS) term structure to data requires that we deter-\nmine reasonable initial values for the parameters ( \u03b1 , \u03b1 , \u03b1 , \u03b2 ). In this section\n1 2 3\n567 Modeling the Term Structure\nThe NS zero coupon yield is\ny( t)=\u03b1 +\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u239e\n\u239f+\u03b1\n\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u2212e\u2212t\u03b2\u239e\n\u239f\n1 2\u239d \u239d t \u23a0\u23a0 3\u239d \u239d t \u23a0 \u23a0\n==\u03b1 +(\u03b1\n+\u03b1)\u239b \u239c\u03b2\u239b \u239c1\u2212e\u2212t\u03b2\u239e \u239f\u239e\n\u239f\u2212\u03b1e\u2212t\u03b2\n1 2 3 \u239d \u239d t \u23a0\u23a0 3\nNS Property 1: The Shortest-Term Rate y (0)\nSetting t = 0 gives y (0) = \u03b1 + \u03b1 . This is the NS shortest-term rate. It follows\n1 2\nthat for most term structures \u03b1 + \u03b1 > 0.\n1 2\nNS Property 2: The Longest-Term Rate y ( \u221e )\nSetting t = \u221e givesy ( \u221e ) = \u03b1 . This is the asymptotic long-term interest rate in\n1\nthe NS model.\nNS Property 3: \u03b2 Controls the Location of the Term Structure Hump\nT he NS term structure is defined only if \u03b2 > 0. If the term structure has a\n\u201chump,\u201d this can be controlled by the \u03b2 . In the graph below, we illustrate this.\nLarge betas (e.g., \u03b2 = 12, below) produce upward-sloping term structures,\nwhereas lower \u03b2 \u2019s produce humpy term structures. Increasing the beta pushes\nthe hump out. Roughly speaking, \u03b2 is the location of the hump.\nEffect of bon NS Term Structure\n6.00%\n5.00%\n4.00%\n3.00%\n2.00%\n1.00%\n0.00%\n0 2 4 6 8 10 12 14\n568 Chapter 22\nNS Property 4: \u03b1 Affects the Hump\n3\nT he factor \u03b1 has no influence at either very short or very long yields and\n3\ncontributes to the term structure at medium-term yields only. Very roughly\nspeaking, \u03b1 > 0 produces a concave term structure, \u03b1 < 0 produces a convex\n3 3\nterm structure, and \u03b1 = 0 produces a flat term structure:\n3\nNelson-Siegel Term Structure for Different Alpha3\nBeta = 1.5\n30.00%\n25.00%\n20.00%\n15.00%\n10.00%\n5.00%\n0.00%\n-5.00% 0 2 4 6 8 10 12 14\n-10.00%\n-15.00%\nalpha3=-0.4 alpha3=0.0 alpha3=0.8\nNelson-Siegel: Summing Up\nF itting a term structure to the NS model involves setting initial values for ( \u03b1 ,\n1\n\u03b1 , \u03b1 , \u03b2 ). Plausible initial values can be set by \u201ceyeballing\u201d the empirical\n2 3\nterm structure and setting:\n\u2022 \u03b1 + \u03b1 = approximate zero-term interest rate.\n1 2\n\u2022 \u03b1 = approximate long-term rate.\n1\n\u2022 \u03b2 = approximate location of the hump.\n\u2022 \u03b1 affects the concavity/convexity of the term structure.\n569 Modeling the Term Structure"
        ],
        "22.6": [
            "What is a Nelson-Siegel model?\nWhat is a Treasury note?\nWhat are the parameters of the Nelson-Siegel model used to price bonds?\nWhat is the difference between a clean price and an invoice price in bond markets?\nWhat is an optimizing technique in the context of financial modeling?\nHow is the maturity of treasury notes typically defined and what is its importance?\nWhat is meant by the term 'accrued interest' in reference to Treasury notes?\nHow is accrued interest calculated? \nWhat is a 'coupon payment' in the context of Treasury notes?\nExplain the use of Solver in calculating the Nelson-Siegel term structure.\nWhat does the Nelson-Siegel price of a bond represent?\nDescribe the role of a VBA function in financial modeling of Treasury notes.\nIn the context of this Nelson-Siegel model, what is the significance of the absolute differences between the NSprice and the bond's invoice price?\nHow does the Nelson-Siegel term structure for data optimization work?\nWhat does the term 'bond's invoice price' mean?\nCan you explain why one would need to define a VBA function for the computation of the Nelson-Siegel term structure?\nWhat is the role of Coupdaybs and Coupdays formulas in calculating accrued interest for Treasury notes?\nWhat is the importance of the yield curve or term structure in Finance?\nHow is the term structure or yield curve derived in the context of Treasury notes?",
            "22.6 Term Structure for Treasury Notes\n\nI n this section we fit the Nelson-Siegel (NS) model to the prices of Treasury\nnotes. This is a much larger data set than the one discussed in the previous\nsection, and it allows us to illustrate a different optimizing technique.\nWe start with the data set of prices for Treasury notes (i.e., bonds with\nmaturities of less than 10 years). The date of the data is 31 March 1989.\nA B C D E F G H I J K\n1 127 Treasury Notes on 31 March 1989\n2 Current date 31-Mar-89\n3\nAccrued Invoice\n4 Cusip # Clean price Maturity Coupon rate interest price\n5 912827UU 99.8438 30-Apr-89 7.125 2.972 102.8158 The accrued interest formula in cell E5\n6 912827TP 99.7188 15-May-89 6.875 2.583 102.3016 is\n7 912827JQ 99.9688 15-May-89 9.250 3.475 103.4439 =COUPDAYBS($C$2,C5,2,1)/COUPDA\n8 912827QN 1 00.2500 15-May-89 11.750 4.414 104.6644 YS($C$2,C5,2,1)/2*D5\n9 912827UX 99.7813 31-May-89 8.000 2.659 102.4406\n10 912827UZ 99.5313 30-Jun-89 7.375 1.834 101.3648\n11 912827SK 1 00.0625 30-Jun-89 9.625 2.393 102.4555\n12 912827NK 1 01.3438 15-Jul-89 14.500 3.004 104.3479\n13 912827VC 99.4063 31-Jul-89 7.625 1.243 100.6490\n14 912827TX 98.9688 15-Aug-89 6.625 0.805 99.7740\n15 912827QW 1 01.5313 15-Aug-89 13.875 1.686 103.2177\n16 912827VF 99.3125 31-Aug-89 7.750 0.653 99.9654\n17 912827VH 99.4375 30-Sep-89 8.500 - 99.4375\n18 912827SU 99.8125 30-Sep-89 9.375 - 99.8125\n19 912827NS 1 01.0313 15-Oct-89 11.875 5.448 106.4794\n20 912827VL 98.9688 31-Oct-89 7.875 3.285 102.2536\n21 912827UE 98.0313 15-Nov-89 6.375 2.395 100.4263\nThe \u201cclean price\u201d of column B above is the quoted price of the bond. In\nU.S. markets the actual price paid by the purchaser of the bond, the so-called\ninvoice price, is the sum of the clean price plus the relative portion of\nthe current coupon payment.4 This latter term, the \u201caccrued interest,\u201d is\ncomputed by:\nAccrued Currentdate\u2212Lastinterestdate\n= \u2217Periodicinterest\ninterest Nextinterestdatte\u2212Lastinterestdate\n4. In most European bond markets, the quoted bond price is the actual price paid for the bond\n570 Chapter 22\nT he Excel file computes the accrued interest using the formulas Coupdaybs\nand Coupdays .\nComputing the NS Term Structure\nTo compute the Nelson-Siegel term structure for these data, we define a VBA\nfunction N Sprice that accepts ( \u03b1 , \u03b1 , \u03b1 , \u03b2 ) as input and computes the\n1 2 3\nNelson-Siegel price of a bond. We now optimize using S olver to minimize the\nsum of the absolute differences between the NSprice and the bond \u2019 s invoice\nprice. Here is the relevant optimization:\nA B C D E F G H I J\nCOMPUTING THE NELSON-SIEGEL TERM STRUCTURE FOR TREASURY NOTES\n1 127 Treasury Notes on 31 March 1989\n2 Settlement date 31-Mar-89 Nelson-Siegel parameters\n3 81.0% \u03b11 0.8000\n4 80.9% \u03b12 0.0000\n5 80.8% \u03b13 0.0300\n6 80.7% \u03b2 1.5000\n7 80.6%\n8 80.5% Error 8,479.57<-- {=SUM(ABS(F16:F142-H16:H142))}\n9 80.4%\n10 80.3%\n11 80.2%\n12 80.1%\n13 80.0%\n0 2 4 6 8 10 12\n14\nCoupon Accrued Term to\nNSprice NSrate\n15 Cusip # Clean price Maturity rate interest Invoice price maturity\n16 912827UU 99.8438 30-Apr-89 7.125 2.9720 102.8158 0.0822 96.9656 0.80079<-- =NSrate($H$3,$H$4,$H$5,$H$6,G16)\n17 912827TP 99.7188 15-May-89 6.875 2.5829 102.3016 0.1233 93.7089 0.80117\n18 912827JQ 99.9688 15-May-89 9.250 3.4751 103.4439 0.1233 94.7847 0.80117\n19 912827QN 100.2500 15-May-89 11.750 4.4144 104.6644 0.1233 95.9172 0.80117\n20 912827UX 99.7813 31-May-89 8.000 2.6593 102.4406 0.1671 90.9612 0.80155\n571 Modeling the Term Structure\nA B C D E F G H I J\nCOMPUTING THE NELSON-SIEGEL TERM STRUCTURE FOR TREASURY NOTES\n1 127 Treasury Notes on 31 March 1989\n2 Settlement date 31-Mar-89 Nelson-Siegel parameters\n3 9.7% \u03b11 0.0861\n4\n9.6%\n\u03b12 0.0085\n5\n9.5%\n\u03b13 0.0169\n6 \u03b2 1.6258\n7 9.4%\n8 9.3% Error 56.96<-- {=SUM(ABS(F16:F142-H16:H142))}\n9 9.2%\n10 9.1%\n11 9.0%\n12\n13 8.9%\n0 2 4 6 8 10 12\n14 Maturity\nCoupon Accrued Term to\nNSprice NSrate\n15 Cusip # Clean price Maturity rate interest Invoice price maturity\n16 912827UU 99.8438 30-Apr-89 7.125 2.9720 102.8158 0.0822 102.7587 9.48%<-- =NSrate($H$3,$H$4,$H$5,$H$6,G16)\n17 912827TP 99.7188 15-May-89 6.875 2.5829 102.3016 0.1233 102.2344 9.49%\n18 912827JQ 99.9688 15-May-89 9.250 3.4751 103.4439 0.1233 103.4081 9.49%\n19 912827QN 100.2500 15-May-89 11.750 4.4144 104.6644 0.1233 104.6436 9.49%\n20 912827UX 99.7813 31-May-89 8.000 2.6593 102.4406 0.1671 102.3621 9.50%"
        ],
        "22.7": [
            "What is the Nelson-Siegel term structure?\nCan you explain the method of computing the Nelson-Siegel term structure presented in the section 'An Additional Computational Improvement'?\nWhat are the advantages of the computational method discussed in the context of the Nelson-Siegel term structure?\nWhat parameters does the method optimize in the Nelson-Siegel term structure?\nCan you outline the steps in computing the Nelson-Siegel term structure as presented in the text?\nWhat are discount factors in financial modelling and how are they computed using the Nelson-Siegel method?\nHow does the model use discount factors to calculate a bond's payments?\nWhat is the purpose of computing a rate for each bond's face value in the Nelson-Siegel term structure method?\nHow is the model price of a bond calculated using the Nelson-Siegel method, specifically?\nWhat does optimizing Nelson-Siegel to minimize the differences between the calculated rates mean?\nCan you explain what is represented by the math expressions, specifically how these equations are used to determine the rates in the context of the Nelson-Siegel method?\nWhat is the role of the implied rates in visualizing the term structure?\nCan you elaborate on how the term structure is visualized using the Nelson-Siegel method, taking into consideration the difference between implied rates and NS rates?\nCan you explain meaning of face value, rates, frequency in terms of bond pricing using the Nelson-Siegel method?\nIn the context of financial modelling, what are Treasury Notes and how are they computed using the Nelson-Siegel term structure?\nCan you define and differentiate between the components used in the Nelson-Siegel parameters as mentioned in the text (Implied rates, NS rate, Error, and so on)?",
            "22.7 An Additional Computational Improvement\n\nIn this section we present another method of computing the Nelson-Siegel\nterm structure. The method has the advantages of better convergence for short-\nterm securities. In addition the method in the previous section optimizes four\nnonlinear parameters, whereas the method in this section optimizes three linear\nparameters and one nonlinear parameter; this minimizes the problem of non-\nuniqueness of the parameters.\nHere are the steps in this method:\n\u2022 We compute the discount factors using the NS method as illustrated in\nsection 22.6.\n\u2022 We use these discount factors to discount the bond \u2019 s payments, but not the\nfinal return of face value.\n\u2022 We compute a rate r for each bond\u2019 s face value so that the model price of\nT\nthe bond (using the combination of the NS discount factors and r ) equals the\nT\nbond \u2019 s invoice price.\n\u2022 We now optimize Nelson-Siegel to minimize the differences between the r\nT\nand the corresponding Nelson-Siegel rate.\n572 Chapter 22\nP =\u2211N1 C \u2217d( t1) Frequency+FaceValue \u2217e\u2212r1t N1 1\n1 1 n 1\nn=1\nP =\u2211N2 C \u2217d( t2)) Frequency+FaceValue \u2217e\u2212r2t N2 2\n2 2 n 2\nn=1\n(cid:2)\nP =\u2211NK C \u2217d( tK) Frequencyy+FaceValue \u2217e\u2212rKt NK K\nK K n K\nn=1\nSolving these equations for the rates r :\nT\n( )\n\u239b\nP\n\u2212\u2211N1\nC\nd( t1)\nFrequency\n\u239e\nr =\u2212ln\u239c 1 n=1 1 n \u239f t1\n1 \u239d\u239c FaceValue\n1\n\u23a0\u239f N1\n( )\n\u239b\nP\n\u2212\u2211N2\nC\nd( t2)\nFrequency\n\u239e\nr ==\u2212ln\u239c 2 n=1 2 n \u239f t2\n2 \u239d\u239c FaceValue\n2\n\u23a0\u239f N2\n(cid:2)\n( )\n\u239b\nP\n\u2212\u2211NKC d( tK)\nFrequency\n\u239e\nr ==\u2212ln\u239c K n=1 K n \u239f tK\nK \u239d\u239c FaceValue\nK\n\u23a0\u239f NK\nThe implied rates could be also used for visualization of the term structure. In\nthe following figure we minimize the difference between the implied rates and\nthe corresponding NS rates:\nA B C D E F G H I J K\nCOMPUTING THE NELSON-SIEGEL TERM STRUCTURE FOR TREASURY NOTES\n1 127 Treasury Notes on 31 March 1989\n2 Settlement date 31/Mar/89 Nelson-Siegel parameters\n3 0.098000 \u03b1 1 0.0886\n4 0.096000 \u03b1 2 0.0008\n5 0.094000 Implied rates \u03b1 3 0.0252\n6 NSrate \u03b2 0.8269\n0.092000\n7\n8 0.090000 Error 0.0703<-- {=SUM(ABS(F15:F141-G15:G141))}\n9 0.088000\n10 0.086000\n11 0.0000 2.0000 4.0000 6.0000 8.0000 10.0000\n12\n13 {=NSImpliedRate(B17,$C$2,C17,100,D17,2,$H$3,$H$4,$H$5,$H$6,1)}\nCoupon Term to\nCusip # Maturity Price Implied rate NSrate\n14 rate maturity\n15 912827UU 30/Apr/89 7.125 102.81578 0.0822 0.087203 0.090596<-- =NSrate($H$3,$H$4,$H$5,$H$6,E15)\n16 912827TP 15/May/89 6.875 102.30162 0.1233 0.088748 0.091106\n573 Modeling the Term Structure"
        ],
        "22.8": [
            "What is the Nelson-Siegel-Svensson model in financial modelling?\nCan you explain the parameters utilized in the Nelson-Siegel-Svensson model?\nWho suggested that the NS model can be potentially improved by introducing two additional parameters?\nWhat does the term \"Solver parameters\" refer to in the context of the Nelson-Siegel-Svensson model?\nWhat is an algebraic form in financial modeling?\nCan you briefly explain the concept of term structure in financial modeling?\nWhat does the term \"Settlement date\" signify in the context of Treasury Notes?\nWhat is a Treasury Note?\nWhat does an \"Error\" value represent in the Nelson-Siegel-Svensson model?\nWhat does NSSrate denote in the context of Treasury Notes?\nWhat do the terms 'Cusip #\u2019, 'Coupon rate' and 'Term to maturity' refer to in the context of the Nelson-Siegel-Svensson model? \nWhat is the significance of the implied rate in Treasury Notes?",
            "22.8 Nelson-Siegel-Svensson Model\n\nT he NS model utilizes four parameters to characterize the term structure. It\nwas suggested by Svensson that the NS model can be significantly improved\nby introducing two additional parameters.5 The Nelson-Siegel-Svensson model\nhas the following algebraic form:\ny( t)=\u03b1 +(\u03b1 +\u03b1)\u239b \u239c\u03b2 1\u2212e\u2212t\u03b2 1\u239e \u239f\u2212\u03b1e\u2212t\u03b2 1 +\u03b1 \u239b\u239b \u239c\u03b2 1\u2212e\u2212t\u03b2 2 \u2212e\u2212t\u03b2 2\u239e \u239f\n1 2 3 \u239d 1 t \u23a0 3 4\u239d 2 t \u23a0\nWe use the Solver parameters:\n5. Lars E. O. Svensson, Estimating and Interpreting Forward Interest Rates: Sweden 1992\u20131994.\n574 Chapter 22\nBelow we show the results:\nA B C D E F G H I J K\nCOMPUTING THE NELSON-SIEGEL-SVENSSON TERM STRUCTURE FOR TREASURY NOTES\n1 127 Treasury Notes on 31 March 1989\n2 Settlement date 31/Mar/89 Nelson-Siegel parameters\n3 0.098 \u03b11 0.0817\n4 0.096 \u03b12 0.0033\n5 0.094 \u03b13 0.0307\n6 0.092 \u03b14 0.02897\n7 0.09 \u03b21 0.4397\n8\n0.088\n\u03b22 2.528022\n9\n10 0.086 Error 0.0512<-- {=SUM(ABS(F15:F141-G15:G141))}\n11 0.0000 2.0000 4.0000 6.0000 8.0000 10.0000\n12\n13 {=NSSImpliedRate(B17,$C$2,C17,100,D17,2,$H$3,$H$4,$H$5,$H$6,$H$7,$H$8,1)}\nCoupon Term to\nCusip # Maturity Price Implied rate NSSrate\n14 rate maturity\n15 912827UU 30/Apr/89 7.125 102.81578 0.0822 0.087305812 0.087692799<-- =NSSrate($H$3,$H$4,$H$5,$H$6,$H$7,$H$8,E15)\n16 912827TP 15/May/89 6.875 102.30162 0.1233 0.088826102 0.088826115\n17 912827JQ 15/May/89 9.250 103.44389 0.1233 0.091444851 0.088826115"
        ],
        "22.9": [
            "What is financial modeling?\nWhat is the Nelson-Siegel approximation in financial modeling?\nCan you explain how to calculate the term structure in financial modeling?\nHow are mathematical techniques used to calculate term structure?\nWhat is the role of Nelson-Siegel-Svensson variation in term structure calculation?\nWhat is meant by term structure in financial modeling?\nWhat is meant by maturity in relation to bonds in financial modeling?\nWhat is the concept of multiple bonds with the same maturity in term structure calculation?\nCan you explain a real-life case of Treasury notes and their impact on term structure?\nWhat is the Svensson extension in financial modeling?\nWhat is the function of NSrate in financial modeling?\nHow are NS parameters \u03b11, \u03b12, \u03b13, \u03b2 used in the NSrate function?\nWhat does the NSdiscount function do in financial modeling?\nHow is the price of a standard coupon bond calculated in financial modeling?\nWhat does the NSImpliedRate function do?\nIn financial modeling, what does the function LS(XMatrix, YVector) signify?\nWhat is the role of Excel functions in financial modeling?\nHow does the function MMult operate in financial modeling?\nWhat do we mean by Default-Adjusted Expected Bond Returns in financial modeling?",
            "22.9 Summary\n\nI n this chapter we presented several simple and powerful mathematical tech-\nniques for term structure calculation. The Nelson-Siegel approximation was\nintroduced in detail and its applications were discussed, along with (in section\n22.8) the Nelson-Siegel-Svensson variation. We began with the simplest case,\nin which there is only one bond for each maturity, so that the term structure\ncan be found uniquely. Next, we extended the method to a set in which several\nbonds can have the same maturity. Then, we discussed a real-life case of\nTreasury notes, which can have any maturity date. Finally, the Svensson exten-\n575 Modeling the Term Structure\nAppendix: VBA Functions Used in This Chapter\nThe function NSrate computes the Nelson-Siegel rate for time t based on\nspecific values of the four NS parameters \u03b1 , \u03b1 , \u03b1 , \u03b2 :\n1 2 3\nFunction NSrate(alpha1, alpha2, alpha3, beta, t)\nIf t = 0 Then\nNSrate = alpha1 + alpha2\nElse\nNSrate = alpha1 + (alpha2 + alpha3) * _\n(beta / t) * (1 - Exp(-t / beta)) - _\nalpha3 * Exp(-t / beta)\nEnd If\nEnd Function\nThe function NSdiscount computes the NS discount factors:\nFunction NSdiscount(alpha1, alpha2, alpha3, _\nbeta, t)\nIf t = 0 Then\nNSdiscount = 1\nElse\nNSdiscount = Exp(-t * (alpha1 + _\n(alpha2 + alpha3) * (beta / t) * _\n(1 - Exp(-t / beta)) - alpha3 * _\nExp(-t / beta)))\nEnd If\n576 Chapter 22\nThe function N Sprice computes the price of a standard coupon bond using\nthe Nelson-Siegel term structure:\nFunction NSprice(alpha1, alpha2, alpha3, _\nbeta, j, no_payments, rate, frequency)\ntemp = 0\nrrate = rate / frequency\nFor i = 0 To no_payments - 1\ntemp = temp + rrate * 100 * _\nNSdiscount(alpha1, alpha2, alpha3, beta, _\nj + i / frequency)\nNext i\nNSprice = temp + 100 * NSdiscount(alpha1, _\nalpha2, alpha3, beta, j + (no_payments - 1) _\n/ frequency)\nEnd Function\nT he function NSImpliedRate uses Excel functions to compute the implied\n577 Modeling the Term Structure\nPrivate Function LS(XMatrix, YVector)\nDim X, Y, A, B As Variant\nX = XMatrix\nY = YVector\nn = UBound(X, 1)\nl = UBound(Y)\nIf n < > l Then GoTo FEnd\nWith WorksheetFunction\nA = .MMult(.Transpose(X), X)\nLS = .MMult(.MInverse(A), _\n.MMult(.Transpose(X), Y))\nEnd With\nFEnd:\n23\nCalculating Default-Adjusted Expected Bond Returns"
        ]
    },
    "23": {
        "23.1": [
            "What is the effect of default risk on the returns from holding bonds to maturity?\nWhat is meant by the bond's promised return? \nHow is the yield to maturity of a bond defined?\nWhat factors are needed to calculate the bond's expected return?\nWhat does the recovery rate refer to in context of bond returns?\nCan default happen in stages in the case of bonds?\nWhat is the purpose of using a Markov model in financial modeling for bond returns?\nWhat factors are taken into account in the adjustment procedure while calculating expected return on a bond?\nWhat is the principal or face value of a bond?\nWhat happens when a bond is issued at par?\nWhat is the coupon rate of a bond?\nWhat is the relationship between the coupon rate and the periodic payment promised to the bondholders?\nWhat is the market price of a bond?\nHow does the market price of a bond differ from its coupon rate?\nWhat is the yield to maturity (YTM) of a bond? \nHow are American corporate bonds rated?\nWhat is the classification scheme for rating agencies such as Standard & Poor's and Moody's?\nWhat is the expected payoff for bond holders in case of a bond default?\nHow is the recovery percentage of a bond calculated?\nWhat constitutes Investment-Grade Ratings and Speculative-Grade Ratings?",
            "23.1 Overview\n\nI n this chapter we discuss the effects of default risk on the returns from holding\nbonds to maturity. The e xpected return on a bond that may possibly default is\ndifferent from the bond\u2019 s promised return. The latter is defined as the bond\u2019 s\nyield to maturity , the internal rate of return calculated from the bond \u2019 s current\nmarket price and its promised coupon payments and promised eventual return\nof principal in the future. The bond\u2019 s expected return is less easily calculated:\nWe need to take into account both the bond\u2019 s probability of future default and\nthe recovery rate, the percentage of its principal which holders can expect to\nrecover in the case of default. To complicate matters still further, default can\nhappen in stages, through the gradual degradation of the issuing company\u2019 s\ncreditworthiness.1\nIn this chapter we use a Markov model to solve for the expected return on\na risky bond. Our adjustment procedure takes into account all three of the\nfactors mentioned: the probability of default, the transition of the issuer from\none state of creditworthiness to another, and the percentage recovery of face\nvalue when the bond defaults. In sections 23.2\u201323.4 we first use Excel to solve\na relatively small-scale problem. We then use some publicly available statistics\nto program a fuller spreadsheet model. Finally, we show that this model can\nbe used to derive bond betas, the CAPM \u2019 s risk measure for securities (dis-\ncussed previously in Chapters 8\u201311).\nSome Preliminaries\nBefore proceeding, we define a number of terms:\n\u2022 A bond is issued with a given amount of p rincipal or f ace value . When the\nbond matures, the bondholder is promised the return of this principal. If the\nbond is issued at par , then it is sold for the principal amount.\n\u2022 A bond bears an interest rate called the c oupon rate . The periodic payment\npromised to the bondholders is the product of the coupon rate times the bond\u2019 s\nface value.\n1. Besides default risk, bonds are also subject to term structure risk: The prices of bonds may\nshow significant variations over time as a result of changing term structure. This statement will\nbe especially true for long-term bonds. In this chapter we abstract from term structure risk, confin-\n580 Chapter 23\n\u2022 A t any given moment, a bond will be sold in the market for a market price .\nThis price may differ from the bond\u2019 s coupon rate. 2\n\u2022 The bond \u2019 s yield to maturity (YTM) is the internal rate of return of the bond,\nassuming that it is held to maturity and that it does not default.\nAmerican corporate bonds are rated by various agencies on the basis of the\nbond issuer \u2019 s ability to make repayment on the bonds. The classification\nscheme for two of the major rating agencies, Standard & Poor\u2019 s (S&P) and\nMoody \u2019 s, is given below:\nLong-Term Senior Debt Ratings\nInvestment-Grade Ratings Speculative-Grade Ratings\nS&P Moody \u2019 s Interpretation S&P Moody \u2019 s Interpretation\nAAA Aaa Highest BB + Ba1 Likely to fulfill\nquality BB Ba2 obligations;\nongoing\nBB \u2212 Ba3\nuncertainty\nAA + Aa1 High quality B + B1 High-risk\nAA Aa2 B B2 obligations\nAA \u2212 Aa3 B \u2212 B3\nA + A1 Strong CCC + Caa Current\nA A2 payment CCC vulnerability to\ncapacity default\nA \u2212 A3 CCC \u2212\nBBB + Baa1 Adequate C Ca In bankruptcy or\nBBB Baa2 payment D D default, or other\ncapacity marked\nBBB \u2212 Baa3\nshortcomings\n2. Just to complicate matters, in the United States the convention is to add to a bond \u2019 s listed price\nthe p rorated coupon (the accrued interest) between the time of the last coupon payment and the\npurchase date. The sum of these two is termed the invoice price of the bond; the invoice price is\nthe actual cost at any moment to a purchaser of buying the bond. In our discussion in this chapter\nwe use the term m arket price to denote the invoice price. The computation of the accrued interest\n581 Calculating Default-Adjusted Expected Bond Returns\nWhen a bond defaults, its holders will typically receive some payoff, though\nless than the promised bond coupon rate and return of principal. We refer to\nthe percentage of face value paid off in default as the recovery percentage .3"
        ],
        "23.2": [
            "What does the yield to maturity of a bond relate to?\nWhat factors should affect a bond's expected return?\nHow might a bond's rating influence its expected return?\nHow does the anticipated payoff in the case of bond default affect its expected return?\nWhat should you expect in terms of coupon rate if two newly issued bonds have the same term to maturity but different ratings?\nWhat is the potential impact on a bond's price if its rating is lowered?\nHow does the anticipated payoff in case of default influence a bond's expected return?\nWhat is the expected end-of-year cash flow for a bond that can default at maturity?\nWhat is the formula to calculate the expected return of a one-year bond which can default at maturity?\nWhat does the symbol 'F' represent in the given financial model?\nWhat is the significance of 'P' in the context of bond pricing?\nWhat role does 'Q', the annual coupon rate, play when calculating the expected return of a bond?\nHow is '\u03c0', the probability of bond default at the end of the year, incorporated into bond valuation?\nWhat does the symbol '\u03bb' represent in this financial model?\nHow does one calculate a bond's recovery percentage following default?\nWhat does it mean to make an adjustment for default when calculating a bond's expected return?\nWhat is the meaning of 'recovery percentage' in the context of bond default?\nWhat is the significance of expected period 1 cash flow when calculating a bond's expected return?",
            "23.2 Calculating the Expected Return in a One-Period Framework\n\nThe bond \u2019 s yield to maturity is n ot its expected return: It is clear that both a\nbond\u2019 s rating and the anticipated payoff to bond holders in the case of bond\ndefault should affect its expected return. All other things being equal, we\nwould expect that if two newly issued bonds have the same term to maturity,\nthen the lower-rated bond (having the higher default probability) should have\na higher coupon rate. Similarly, we would expect that an issued and traded\nbond whose rating has been lowered would experience a decrease in price. We\nmight also expect that the lower the anticipated payoff in the case of default,\nthe lower will be the bond \u2019 s expected return.\nAs a simple illustration, we calculate the expected return of a one-year bond\nwhich can default at maturity. We use the following symbols:\nF = face value of the bond\nP = price of bond\nQ = annual coupon rate of the bond\n\u03c0 = probability that the bond willn ot default at end of year\n\u03bb = fraction of bond \u2019 s value bondholders collect upon default\nT he bond\u2019 s expected end-of-year cash flow is \u03c0 \u00b7 (1 + Q ) \u00b7F + (1 \u2212 \u03c0 ) \u00b7 \u03bb \u00b7 F ,\nand its expected return is given by\nExpected year-endcash flow\nOne-yearbondexpectedreturn= \u22121\nInitialbbond price,P\n\u03c0\u22c5( 1+Q)\u22c5F+( 1\u2212\u03c0)\u22c5\u03bb\u22c5F\n= \u22121\nP\n3 . T he bond\u2019 s recovery percentage is not, as you might think, the payoff to the bondholders in\nthe final settlement of a bankruptcy. Instead it is usually computed as the price of the bond in the\n582 Chapter 23\nThis calculation is illustrated in the following spreadsheet:\nA B C\nEXPECTED RETURN ON A ONE-YEAR BOND\nWITH AN ADJUSTMENT FOR DEFAULT\n1 PROBABILITY\n2 Face value, F 100\n3 Price, P 90\n4 Annual coupon rate, Q 8%\n5 Default probability 20%\n6 Recovery percentage 40%\n7\n8 Expected period 1 cash flow 94.4 <-- =B2*(1+B4)*(1-B5)+B2*B6*B5\n9 Expected return 4.89% <-- =B8/B3-1"
        ],
        "23.3": [
            "What is a basic Markov model in the context of financial modeling?\nWhat is the purpose of a ratings transition matrix in financial modeling?\nWhat are the meanings of bond ratings A, B, C, D, and E?\nHow can the transition probabilities of bond ratings be represented in a matrix form?\nWhat is the significance of each row in the transition matrix representing bond ratings?\nWhat does the transition matrix say about the probability of a bond's future ratings?\nHow does one calculate the two-period transition probabilities for bond ratings?\nWhat is the MMULT function used for in terms of financial modeling and its application on bond ratings?\nWhat is the significance of the Matrixpower function in computing the powers of matrices?\nIf a bond is rated A, what are the possibilities for its future rating?\nHow is the year t transition matrix derived in the context of bond ratings?\nWhat are the implications if a bond that started out with an A rating defaults at the end of 10 periods?\nWhat does the bond\u2019s coupon rate Q signify in the financial model?\nWhat is the role of \u03bb, the recovery percentage payoff of face value, if a bond defaults?\nWhat does it indicate when the bond's rating is E?\nWhat does the current state vector represent in bond ratings calculation?\nHow does the initial state of the bond play a role in the expected payoff calculation?",
            "23.3 Calculating the Bond Expected Return in a Multi-Period Framework\n\nWe now introduce multiple periods into the above problem. In this section we\ndefine a basic Markov model which uses a ratings transition matrix to compute\na bond\u2019 s expected return. The model is illustrated using a very simple set of\nratings, much simpler than the complex rating system illustrated in section\n23.1. Section 23.5 uses more realistic data.\nWe suppose that at any date there are four possible bond \u201cratings\u201d:\nA, B, C Bond ratings of solvent bonds in decreasing order of credit\nworthiness.\nD The bond is in default for the first time and pays off recovery\nrate \u03bb of the face value.\nE The bond was in default in the previous period; it therefore\npays off 0 in the current period and in any future periods.\n583 Calculating Default-Adjusted Expected Bond Returns\n\u23a1\u03c0 \u03c0 \u03c0 \u03c0 0\u23a4\nAA AB AC AD\n\u23a2 \u23a5\n\u03c0 \u03c0 \u03c0 \u03c0 0\n\u23a2 BA BB BC BD \u23a5\n\u03a0=\u23a2\u03c0 \u03c0 \u03c0 \u03c0 0\u23a5\n\u23a2 CA CB CC CD \u23a5\n\u23a2 0 0 0 0 1\u23a5\n\u23a2\u23a2\u23a3\n0 0 0 0\n1\u23a6\u23a5\nT he probabilities in each row of the matrix \u03a0 indicate the probability that in\none period the bond will go from a rating of i to a rating of j . In the numerical\nexamples in this and the following two sections, we use the following \u03a0 :\nA B C D E F\n2 A B C D E\n3 A 0.9700 0.0200 0.0100 0.0000 0.0000\n4 B 0.0500 0.8000 0.1500 0.0000 0.0000\n5 C 0.0100 0.0200 0.7500 0.2200 0.0000\n6 D 0.0000 0.0000 0.0000 0.0000 1.0000\n7 E 0.0000 0.0000 0.0000 0.0000 1.0000\nWhat does this matrix \u03a0 mean?\n\u2022 If a bond is rated A in the current period, there is a probability of 0.97 that\nit will still be rated A in the next period. There is a probability 0.02 that it will\nbe rated B in the next period and a probability of 0.01 that it will be rated C.\nIt is impossible for the bond to be rated A today and D or E in the subsequent\nperiod.\n\u2022 A bond that starts off with a rating of B can\u2014in a subsequent period\u2014be\nrated A (with a probability of 0.05), be rated B (with a probability of 0.8), or\nbe rated C (probability 0.15). Bonds rated B in the current period do not default\n(rating D) in the next period. The transition probabilities from state C to states\nA, B, C, and D are 0.01, 0.02, 0.75, and 0.22, respectively.\n\u2022 While it is possible to go from ratings A, B, or C to any of ratings A, B, C,\nor D, it is not possible to go from A, B, or C to E. This is so, since E denotes\nthat default took place in the previous period .\n\u2022 A bond that is currently in state D (i.e., first-time default) will necessarily\nbe in E in the next period. Thus the fourth row of our matrix \u03a0 will always\nbe [0 0 0 0 1].\n\u2022 Once the rating is in E, it remains there permanently. This means that the\n584 Chapter 23\nThe Multi-Period Transition Matrix\nT he matrix \u03a0 defines the transition probabilities over one period. The two-\nperiod transition probabilities are given by the matrix product \u03a0 * \u03a0 . The\nspreadsheet below uses the array function M MULT . 4 It shows that the product\n\u03a0 * \u03a0 is:\nTwo-periodtransition probability=\u03a0*\u03a0\n\u23a10.9420 0.0356 0.0202 0.00222 0.0000\u23a4\n\u23a2 \u23a5\n0.0900 0.6440 0.2330 0.0330 0.0000\n\u23a2 \u23a5\n=\u23a20.0182 0.0312 0.5656 0..1650 0.2200\u23a5\n\u23a2 \u23a5\n\u23a20.0000 0.0000 0.0000 0.0000 1.0000\u23a5\n\u23a3\u23a2\n0.0000 0.0000 0.00000 0.0000\n1.0000\u23a6\u23a5\nThus if a bond is rated \u201cB\u201d today, there is a probability of 9% that in two\nperiods it will be rated \u201cA,\u201d a probability of 64.4% that in two periods it will\nbe rated B, a probability of 23.3% that in two periods it will be rated C,\nand a probability of 3.3% that in two periods it will default (and hence be\nrated D).\nHere is the spreadsheet:\n585 Calculating Default-Adjusted Expected Bond Returns\nA B C D E F\nUSING THE MMULT FUNCTION\nTo compute multi-period transition matrices\n1\n2 One-period transition matrix\n3 A B C D E\n4 A 0.9700 0.0200 0.0100 0.0000 0.0000\n5 B 0.0500 0.8000 0.1500 0.0000 0.0000\n6 C 0.0100 0.0200 0.7500 0.2200 0.0000\n7 D 0.0000 0.0000 0.0000 0.0000 1.0000\n8 E 0.0000 0.0000 0.0000 0.0000 1.0000\n9\n10 Two-period transition matrix\n11 A B C D E\n12 A 0.9420 0.0356 0.0202 0.0022 0.0000\n13 B 0.0900 0.6440 0.2330 0.0330 0.0000\n14 C 0.0182 0.0312 0.5656 0.1650 0.2200\n15 D 0.0000 0.0000 0.0000 0.0000 1.0000\n16 E 0.0000 0.0000 0.0000 0.0000 1.0000\n17 Cells B12:F16 contain the array formula =MMULT(B4:F8,B4:F8)\n18\n19 Three-period transition matrix\n20 A B C D E\n21 A 0.9157 0.0477 0.0299 0.0044 0.0022\n22 B 0.1218 0.5217 0.2723 0.0513 0.0330\n23 C 0.0249 0.0366 0.4291 0.1244 0.3850\n24 D 0.0000 0.0000 0.0000 0.0000 1.0000\n25 E 0.0000 0.0000 0.0000 0.0000 1.0000\n26 Cells B21:F25 contain the array formula =MMULT(B4:F8,B12:F16)\nIn general, the year t transition matrix is given by the matrix power \u03a0 t .\nCalculating these matrix powers by the procedure illustrated above is cumber-\nsome, so we define a VBA function Matrixpower to compute powers of\nmatrices:\nFunction Matrixpower(matrix, n)\nIf n = 1 Then\nMatrixpower = matrix\nElse: Matrixpower = Application.MMult\n(Matrixpower(matrix, n - 1), matrix)\nEnd If\n586 Chapter 23\nT he use of this function is illustrated below. The function Matrixpower allows\na one-step computation of the power of any transition matrix:\nA B C D E F\nUSING THE FUNCTION MATRIXPOWER\n1 To compute multi-period transition matrices\n2 One-period transition matrix\n3 A B C D E\n4 A 0.9700 0.0200 0.0100 0.0000 0.0000\n5 B 0.0500 0.8000 0.1500 0.0000 0.0000\n6 C 0.0100 0.0200 0.7500 0.2200 0.0000\n7 D 0.0000 0.0000 0.0000 0.0000 1.0000\n8 E 0.0000 0.0000 0.0000 0.0000 1.0000\n9\n10 t 10\n11\n12 t-period transition matrix\n13 A B C D E\n14 A 0.7648 0.0799 0.0699 0.0148 0.0706\n15 B 0.2123 0.1429 0.1747 0.0432 0.4269\n16 C 0.0450 0.0250 0.0755 0.0208 0.8338\n17 D 0.0000 0.0000 0.0000 0.0000 1.0000\n18 E 0.0000 0.0000 0.0000 0.0000 1.0000\n19 Cells B14:F18 contain the array formula =matrixpower(B4:F8,B10)\nFrom the above example it follows that if a bond started out with an A rating,\nthere is a probability of 1.48% that the bond will be in default at the end of\n10 periods and a 7.06% probability that it will have defaulted in a previous\nperiod (rating E).\nThe Bond Payoff Vector\nRecall that Q denotes the bond \u2019 s coupon rate and \u03bb denotes the recovery per-\ncentage payoff of face value if the bond defaults. The payoff vector of the\nbond depends on whether the bond is currently in its last period N or whether\nt < N :\n\u23a7Q \u23a71+Q\n\u23aa \u23aa\nQ 1+Q\n\u23aa \u23aa\n\u23aa \u23aa\nPayoff( t,t<N)=\u23a8Q Payoff( t,t=N)=\u23a81+Q\n\u23aa \u23aa\n\u03bb \u03bb\n\u23aa \u23aa\n587 Calculating Default-Adjusted Expected Bond Returns\nThe first three elements of each vector denote the payoff in non-defaulted\nstates, the fourth element \u03bb is the payoff if the rating is D, and the fifth element\n0 is the payoff if the bond rating is E. (Recall that E is the rating for the period\nafter the bond defaults\u2014in our model the payoff in rating E is always zero.)\nThe distinction between the two vectors depends, of course, on the repayment\nof principal in the terminal period.\nBefore we can define the expected payoffs, we need to define one further\nvector, which will denote the i nitial state of the bond. This current state vector\nis a vector with a 1 for the current rating of the bond and zeros elsewhere.\nThus, for example, if the bond has rating A at date 0, then i nitial = [1 0 0 0\n0]; if it has date 0 rating of B, then initial = [0 1 0 0 0].\nWe can now define the expected bond payoff in period t :\nE[ Payoff( t)]=Initial\u22c5\u03a0t\u22c5Payoff(t)"
        ],
        "23.4": [
            "What characteristics denote a bond as a B-rated bond? \nCan you explain the purpose of a coupon rate in relation to a bond? \nWhat is the significance of bond maturity date? \nHow is a bond's current market price determined in relation to its face value? \nWhat does a bond's recovery percentage represent? \nWhat information does the bond payoff vector provide? \nCan you explain what a transition matrix is in the context of financial modeling? \nWhat is the function of the initial vector in calculating bond returns? \nHow is the expected payoff of a bond calculated?\nWhat is the role of the Excel IRR function in calculating the bond\u2019s expected return?\nHow does the financial term 'expected payoffs' relate to bond returns?\nHow is the expected yield calculated for a bond?\nWhat is the purpose of an IF statement used in the calculation of bond ratings?\nHow is a bond's initial rating translated into an initial vector?\nHow is the formula implemented to calculate the period t expected bond payoff?\nHow is a bond's payoff influenced by its term?\nCan you explain the role of the Expected Bond Payoffs in financial modeling?\nWhat does the term 'matrixpower' refer to in the given context of financial modeling?\nWhat is the effect of the current year being less than the bond term on the expected payoff on the bond?\nCan you explain what 'MMULT' refers to in the calculation of bond payoffs?",
            "23.4 A Numerical Example\n\nWe continue using the numerical \u03a0 from the previous section to price a bond\nwith the following characteristics:\n\u2022 The bond is currently rated B.\n\u2022 Its coupon rate Q = 7%.\n\u2022 The bond has 5 more years to maturity.\n\u2022 The bond \u2019 s current market price is 100% of its face value.\n\u2022 The bond \u2019 s recovery percentage \u03bb = 50%.\nThe following spreadsheet shows the facts listed above as well as the payoff\nvectors of the bond at dates before maturity (in cells F3:F7) and on the maturity\ndate (cells I3:I7). The transition matrix is given in cells C10:G14, and the\ninitial vector is given in C16:G16.\nThe expected bond payoffs are given in row 20. Before we explain how they\nwere calculated, we note the important economic fact that\u2014if the expected\npayoffs are as given\u2014then the bond \u2019 s expected return is calculated by the\nExcel IRR function. As cell B21 shows, this expected return is 4.61%. The\nactual formula in cell B21 is I RR(B20:AN20). This allows the calculation of\n588 Chapter 23\nA B C D E F G H I\n1 CALCULATING THE EXPECTED BOND RETURN\n2 Bond price 100.00% Payoff (t<N) Payoff (N)\n3 Coupon rate, Q 7% Cells to right 7% Cells to right 107%\n4 Recovery rate, \u03bb 50% are called 7% are called 107%\n5 Bond term, N 5 \"payoff1\" 7% \"payoff2\" 107%\n6 Initial rating B in row 20 50% in row 20 50%\n7 0% 0%\n8\n9 A B C D E\n10 Transition matrix \u2192 A 0.9700 0.0200 0.0100 0.0000 0.0000\n11 B 0.0500 0.8000 0.1500 0.0000 0.0000\n12 C 0.0100 0.0200 0.7500 0.2200 0.0000\n13 D 0.0000 0.0000 0.0000 0.0000 1.0000\n14 E 0.0000 0.0000 0.0000 0.0000 1.0000\n15\n16 Initial vector 0 1 0 0 0\n17 Formula in cell C16: =IF(UPPER(B6)=\"A\",1,0)\n18\n19 Year 0 1 2 3 4 5 6 7\n20 Expected payoffs -1.0000 0.0700 0.0842 0.0897 0.0899 0.8802 0.0000 0.0000\n21 Expected yield 4.61%<-- =IRR(B20:AN20,0)\n22\n23\n=IF(year>bondterm,0,\n24 IRR of expected IF(year=bondterm,MMULT(initial,MMULT(matrixpower(transition,year),payoff2)),\n25 payoffs MMULT(initial,MMULT(matrixpower(transition,year),payoff1))))\n26\nNote the use of the IF statement in translating the bond\u2019 s initial rating (cell\nB6) to the initial vector given in row 16. To avoid confusion, we write this as\nIF(Upper(B6) = \u201cA\u201d,1,0), etc. This guarantees that even if the bond\u2019 s rating is\nentered as a lowercase letter, the initial vector will come out correctly.\nHow to Calculate the Expected Bond Payoffs\nA s indicated in the previous section, the period t expected bond payoff is given\nby the following formula: E [ payoff ( t )] = initial \u00b7 \u03a0t \u00b7 p ayoff ( t) . The formula in\nrow 21 uses two IF statements to implement this formula:\n=IF(year>bondterm,0,\nIF(year=bondterm,MMULT(initial,MMULT(maatrixpower\n(transition,year),payoff2)),\nMMULT(initial,MMULT\n((matrixpower(transition,year),payoff1))))\n589 Calculating Default-Adjusted Expected Bond Returns\n\u2022 First IF: If the current year is greater than the bond term N (in our example\nN = 5 ), then the payoff on the bond is 0.\n\u2022 Second IF : If the current year is equal to the bond term N , then the expected\npayoff on the bond is M MULT(initial,MMULT(matrixpower(transition,\nyear),payoff2)). Here t ransition is the name for the transition matrix in cells\nC10:G14 and payoff2 is the name for the cells I3:I7.\n\u2022 If the current year n is less than the bond term, then the expected payoff\non the bond is M MULT(initial,MMULT(matrixpower(transition,C18),\npayoff1) , where payoff1 is the name for the cells F3:F7.\nCopying this formula gives the whole vector of expected bond payoffs."
        ],
        "23.5": [
            "What is the relationship between a bond's expected return, its coupon rate, and its yield to maturity (YTM)?\nWhat is the meaning of recovery percentage in the context of bond returns?\nHow do we calculate a bond's expected return as a function of its recovery percentage?\nHow does the recovery percentage impact the bond's expected return?\nWhat happens to a bond's expected return when it is selling at par value?\nHow does the bond's initial rating impact its expected return?\nWhat does it mean when the bond price is below par?\nHow does a lower bond price affect the bond's expected return?\nWhat is the role of the transition matrix in calculating the expected bond return?\nWhat does the bond's initial rating signify in terms of its risk and expected return?\nCan a bond\u2019s expected return be less than its coupon rate? If so, under what circumstances can this happen?\nWhen bond price is less than 100%, how does it affect the bond's expected return?\nDefine the term 'yield to maturity (YTM)' in the context of bonds.\nWhat is the significance of the bond's term in calculating its expected return?\nWhat is the role of the coupon rate in the expected return from a bond?\nWhat is meant by a 'bond selling at par'?\nWhat does it imply when the bond's expected return convergences with the coupon rate?\nWhat is meant by bond recovery rate and how does it affect the expected bond return?\nHow does a change in bond price affect its expected yield?\nWhat is the effect of the bond's initial rating on its recovery percentage?",
            "23.5 Experimenting with the Example\n\nW e can gain some insight into the relation between a bond\u2019 s expected return,\nits coupon rate, and its yield to maturity (YTM) by constructing some data\ntables. In the data table below we compute the bond\u2019 s expected return as a\nfunction of its recovery percentage \u03bb :\nA B C D E F G H I\n28 Data table: Recovery percentage and expected yield\n29 Recovery percentage, l 4.61%<-- =B21 , Tableheader\n30 0% 2.43% 7%\n31 10% 2.87% 7%\n32 20% 3.31% 7% Bond Expected Return and Recovery Rate\nBond price = 100%, Bond Rating = B, Coupon = 7.00%\n33 30% 3.74% 7% 8%\n34 40% 4.18% 7% 7%\n35 50% 4.61% 7%\n6%\n36 60% 5.03% 7%\n37 70% 5.46% 7% 5%\n38 80% 5.88% 7% 4%\n39 90% 6.30% 7% 3%\n40 100% 6.71% 7% 2%\n41\n1%\n42 Note: The data table has a series with the\n43 coupon rate appended so that in the graph we 0%\n0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%\n44 can see the convergence of the bond expected\n590 Chapter 23\nWe conclude that a bond selling at par will, for every recovery percentage\n\u03bb, have expected return less than the coupon rate. If the bond\u2019 s initial rating\nis lower, then the expected return is less for every \u03bb :\nA B C D E F G H I\n28 Data table: Recovery percentage and expected yield\n29 Recovery percentage, l -4.69%<-- =B21 , Tableheader\n30 0% -14.72% 7%\n31 10% -12.73% 7%\n32 20% -10.74% 7% Bond Expected Return and Recovery Rate\nBond price = 100%, Bond Rating = C, Coupon = 7.00%\n33 30% -8.73% 7% 10%\n34 40% -6.71% 7%\n35 50% -4.69% 7% 5%\n36 60% -2.66% 7%\n0%\n37 70% -0.62% 7% 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%\n38 80% 1.43% 7% -5%\n39 90% 3.49% 7%\n-10%\n40 100% 5.55% 7%\n41 -15%\n42 Note: The data table has a series with the\n43 coupon rate appended so that in the graph we -20%\n44 can see the convergence of the bond expected\n45 return to the coupon rate (cells C30:C40)\nA s shown in the example below, when the bond price is below par (meaning\nthat the bond is sold at less than 100% of its face value), the bond \u2019 s expected\n591 Calculating Default-Adjusted Expected Bond Returns\nA B C D E F G H I J\n1 CALCULATING THE EXPECTED BOND RETURN\n2 Bond price 88.00% Payoff (t<N) Payoff (N)\n3 Coupon rate, Q 7% Cells F6:F6 7% Cells I3:I6 107%\n4 Recovery rate, \u03bb 50% are called 7% are called 107%\n5 Bond term, N 8 \"payoff1\" 7% \"payoff2\" 107%\n6 Initial rating B in row 19 50% in row 19 50%\n7 0% 0%\n8\n9 A B C D E\n10 Transition matrix \u2192 A 0.9700 0.0200 0.0100 0.0000 0.0000\n11 B 0.0500 0.8000 0.1500 0.0000 0.0000\n12 C 0.0100 0.0200 0.7500 0.2200 0.0000\n13 D 0.0000 0.0000 0.0000 0.0000 1.0000\n14 E 0.0000 0.0000 0.0000 0.0000 1.0000\n15\n16 Initial vector 0 1 0 0 0.0000\n17 Formula in cell C16: =IF(UPPER(B6)=\"A\",1,0)\n18\n19 Year 0 1 2 3 4 5 6 7 8\n20 Expected payoffs -0.8800 0.0700 0.0842 0.0897 0.0899 0.0867 0.0818 0.0761 0.6914\n21 Expected yield 6.30%\n22\n23\n=IF(year>bondterm,0,\n24 IRR of expected IF(year=bondterm,MMULT(initial,MMULT(matrixpower(transition,year),payoff2)),\n25 payoffs MMULT(initial,MMULT(matrixpower(transition,year),payoff1))))\n26\n27\nData table: Recovery percentage\n28 and expected yield Bond Expected Return and Recovery Rate\n29 Recovery percentage, \u03bb 6.30%<-- Table heade9.r5% Bond price = 88%, Bond Rating = B, Coupon = 7.00% ,\nYTM = 9.183%\n30 0% 3.33% 7%\n31 10% 3.94% 7% 8.5%\n32 20% 4.54% 7%\n33 30% 5.13% 7% 7.5%\n34 40% 5.72% 7%\n6.5%\n35 50% 6.30% 7%\n36 60% 6.87% 7%\n5.5%\n37 70% 7.43% 7%\n38 80% 8.00% 7% 4.5%\n39 90% 8.55% 7%\n40 100% 9.10% 7% 3.5%\n41\n42 Note: The data table has a series with the 2.5%\n43 coupon rate appended so that in the graph we 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%\n44 can see the convergence of the bond expected"
        ],
        "23.6": [
            "What does the term \"bond expected return\" signify in finance and investment?\nWhat is the significance of \"accrued interest\" in computing the bond's actual price?\nHow is \"accrued interest\" calculated?\nHow is \"accrued interest\" treated differently in U.S. and European bond markets?\nWhat is a transition matrix in the context of bond ratings?\nWhen are payment dates and the XIRR function used in financial modeling?\nWhat is a CCC-rated bond and what could be an example of it?\nWhat is a bond's coupon and how is it paid typically?\nIn financial modeling, how is the actual price of a bond determined?\nWhat role does the 'recovery rate' play in computing a bond's expected return?\nWhat data is typically considered when examining recovery rates in bankruptcy across various industries?\nWhat is the significance of a bond\u2019s Yield To Maturity (YTM)?\nHow should the expected return of a bond be compared to the riskless rate of return and its YTM?\nWhat is a plausible range of recovery ratios for a CCC-rated bond?\nWhat factors can affect the expected bond yield?",
            "23.6 Computing the Bond Expected Return for an Actual Bond\n\nIn this section we illustrate the computation of a bond expected return for an\nactual bond. Although the principles used are the same as those discussed\n592 Chapter 23\n\u2022 W e compute the bond\u2019 s actual price using its quoted price and the accrued\ninterest. The accrued interest is jargon for the unpaid part of the bond coupon\nsince the last interest payment. In U.S. bond markets, the accrued interest is\nadded to the quoted bond price to compute the amount actually paid for the\nbond. In most European bond markets, the quoted bond price is the actual\nprice paid for the bond and there is no separate accrued interest calculation.\nThe accrued interest is defined as:\nCurrentdate\u2212Lastinterestdate\nAccruedinterest= \u2217Periodicinterest\nNextinterestdatte\u2212Lastinterestdate\n\u2022 W e use actual payment dates for the bond and use the X IRR function to\ncompute the bond \u2019 s expected yield.\n\u2022 We use an actual transition matrix for bond ratings.\nT he bond we analyze is a CCC-rated bond issued by AMR (the parent\ncompany of American Airlines). Originally issued on 15 May 1991 and matur-\ning on 12 March 2021, the AMR bond has a coupon of 10.55% payable\nsemiannually on 15 May and 15 November.\nWhen we looked up the bond on Yahoo on 20 July 2005, its price was\n593 Calculating Default-Adjusted Expected Bond Returns\nTo the quoted price of 76.75% we must add the bond \u2019 s accrued interest:\nM N\n3 Accrued interest calculation\n4 Last payment date 15-Mar-05\n5 Next payment date 15-Sep-05\n6 Current date 20-Jul-05\n7 Percentage of period 0.69\n8 Accrued interest 0.0364\nIt follows that the actual price paid for the bond is 76.75% + 3.64% = 80.39%.\nIn the spreadsheet below we compute the AMR expected return:\nA B C D E F G H I J K\nCALCULATING THE EXPECTED BOND RETURN\nThis version computes the expected bond return for AMR taking into account actual dates\n1 Uses annual transition matrix\n2 Bond price 76.75% Payoff (t<N) Payoff (N)\n3 Coupon rate, Q 10.55% Vector to AAA 5.28% Vector to 105.28%\n4 Actual price (includes accrued) 80.39%<-- =B2+N8 right AA 5.28% right 105.28%\n5 Recovery rate, \u03bb 50.00% called A 5.28% called 105.28%\n6 Maturity date 12-Mar-21 \"payoff1\" BBB 5.28% \"payoff2\" 105.28%\n7 Current date 20-Jul-05 BB 5.28% 105.28%\n8 Initial rating CCC B 5.28% 105.28%\n9 Bond YTM 14.81% Coupon paid CCC 5.28% 105.28%\n10 semiannually Default 50.00% 50.00%\n11 E 0% 0%\n12\n13 original probability of migrating to rating by year end (%)\n14 Transition matrix \u2192 rating AAA AA A BBB BB B CCC Default E\n15 AAA 0.9366 0.0583 0.0040 0.0008 0.0003 0.0000 0.0000 0.0000 0.0000\n16 AA 0.0066 0.9172 0.0694 0.0049 0.0006 0.0009 0.0002 0.0001 0.0000\n17 A 0.0007 0.0225 0.9176 0.0519 0.0049 0.0020 0.0001 0.0004 0.0000\n18 BBB 0.0003 0.0025 0.0483 0.8926 0.0444 0.0081 0.0016 0.0022 0.0000\n19 BB 0.0003 0.0007 0.0044 0.0667 0.8331 0.0747 0.0105 0.0098 0.0000\n20 B 0.0000 0.0010 0.0033 0.0046 0.0577 0.8419 0.0387 0.0530 0.0000\n21 CCC 0.0016 0.0000 0.0031 0.0093 0.0200 0.1074 0.6396 0.2194 0.0000\n22 Default 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\n23 E 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\n24\n25\n26 AAA AA A BBB BB B CCC Default E\n27 Initial vector 0 0 0 0 0 0 1 0 0\n28\n29 Computing the AMR bond expected return\n30 0 1 2 3 4 5 6 7 8 9\n31 Date 20-Jul-05 15-Sep-05 15-Mar-06 15-Sep-06 15-Mar-07 15-Sep-0715-Mar-08 15-Sep-0815-Mar-0915-Sep-09\n32 Expected payoffs -0.8039 0.1509 0.1066 0.0781 0.0594 0.0471 0.0387 0.0329 0.0287 0.0257\n33 Expected bond return 2.49%<-- =XIRR(B32:AP32,B31:AP31)\n34\n35 Annualized IRR of expected =IF(E31>$B$6,0,\n36 payoffs computed using actual IF(E31=$B$6,MMULT(initial,MMULT(matrixpower(transition,E30),payoff2)),\n37 dates with XIRR. MMULT(initial,MMULT(matrixpower(transition,E30),payoff1))))\n594 Chapter 23\nA ssuming a recovery rate of 50%, the bond has an expected return of 2.49%.\nWhat Are the Recovery Rates?\nThe recovery rate is obviously a critical factor in computing the bond \u2019 s\nexpected return. There are considerable data on the recovery rates in bank-\nruptcy from various industries. A table from an article by Edward Altman and\nVelore M. Kishore is given below; from this table we can see that the average\nrecovery rate from a variety of industries was 41%.\nRecovery Rates by Industry: Defaulted Bonds by Three-Digit SIC Code, 1971\u20131995\nRecovery Rate\nStandard\nNumber of Weighted Median Deviation\nIndustry SIC Code Observations Average Observations Average Weighted\nPublic utilities 490 56 70.47 65.48 79.07 19.46\nChemicals, petroleum,\nrubber and plastic products 280,290,300 35 62.73 80.39 71.88 27.10\nMachinery, instruments,\nand related products 350,360,380 36 48.74 44.75 47.50 20.13\nServices\u2014business and\npersonal 470,632,720,730 14 46.23 50.01 41.50 25.03\nFood and kindred products 200 18 45.28 37.40 41.50 21.67\nWholesale and retail trade 500,510,520 12 44.00 48.90 37.32 22.14\nDiversified manufacturing 390,998 20 42.29 29.49 33.88 24.98\nCasino, hotel, and recreation 770,790 21 40.15 39.74 28.00 25.66\nBuilding materials, metals,\nand fabricated products 320,330,340 68 38.76 29.64 37.75 22.86\nTransportation and\ntransportation equipment 370,410,420,450 52 38.42 41.12 37.13 27.98\nCommunication, broadcasting,\nmovies, printing, publishing 270,480,780 65 37.08 39.34 34.50 20.79\n600,610,620,630,\nFinancial institutions 670 66 35.69 35.44 32.15 25.72\nConstruction and real estate 150,650 35 35.27 28.58 24.00 28.69\n530,540,560,570,\nGeneral merchandise stores 580,000 89 33.16 29.35 30.00 20.47\nMining and petroleum\ndrilling 100,103 45 33.02 31.83 32.00 18.01\nTextile and apparel products 220,230 31 31.66 33.72 31.13 15.24\nWood, paper, and leather\nproducts 240,250,260,310 11 29.77 24.30 18.25 24.38\nLodging, hospitals, and\nnursing facilities 700 through 890 22 26.49 19.61 16.00 22.65\nTotal 696 41.00 39.11 36.25 25.56\nSource: Altman & Kishore, \u201cAlmost Everything You Wanted to Know about Recoveries on Defaulted Bonds,\u201d\n595 Calculating Default-Adjusted Expected Bond Returns\nU sing the Altman and Kishore numbers, the average recovery percentage\nfor transportation companies is 38.42%, with a standard deviation of 27.98%.\nTaking one standard deviation on either side of the average, we can conclude\nthat the recovery percentage for a transportation company is somewhere\nbetween (38.42% \u2013 27.98%, 38.42% + 27.98%) = ( \u223c 10%, \u223c 66%).\nI n the spreadsheet below we have \u201cbackward engineered\u201d a plausible set of\nrecovery ratios, from 55% to 65%, for the AMR bond. These \u201cguesstimates\u201d\nfor the AMR recovery is based on two assumptions:\n\u2022 T he AMR bond should not have an expected return significantly more\nthan the riskless rate of return, which at the time of our calculations was\naround 4%.\n\u2022 The AMR bond expected return should be significantly less than its YTM\nof \u223c1 5%. The YTM is based on promised payments, and we find it implausible\nthat these should correspond to the expected returns.\nT his gives (highlighted area below) an expected bond yield of between 3.85%\nand 6.86% for the AMR bond:\nA B C D E F G H I\nData table: Recovery percentage and expected AMR bond return\n40\n41 Recovery percentage, \u03bb YTM\n42 0.0% -7.93% 14.78% 25%\n43 10.0% -6.22% 14.78%\n44 20.0% -4.36% 14.78% 20%\n45 30.0% -2.32% 14.78% 15%\n46 40.0% -0.05% 14.78%\n47 55.0% 3.85% 14.78% 10%\n48 60.0% 5.31% 14.78% 5%\n49 65.0% 6.86% 14.78%\n0%\n50 80.0% 12.15% 14.78%\n0.0% 20.0% 40.0% 60.0% 80.0% 100.0%\n51 90.0% 16.27% 14.78% -5%\n52 100.0% 20.93% 14.78% Recovery percentage l\n-10%\n53\n596 Chapter 23"
        ],
        "23.7": [
            "What is a semiannual transition matrix in the context of financial modeling?\nWhat is meant by the square root of the transition matrix and why is it relevant in financial modeling?\nWhat analysis does the semiannual transition matrix provide for a bond paying semiannual coupons?\nHow can a semiannual transition matrix calculated using S&P data be used in bond analysis?\nWhat is the application of software like Mathematica in the computation of semiannual transition matrices?\nWhy can it be difficult to calculate a semiannual transition matrix in Excel?\nWhat does the negative entries in the semiannual transition matrix computed by Mathematica signify?\nWhat adjustments are made to eliminate the negative entries in the Mathematica matrix for a semiannual transition matrix?\nHow does the recovery rate affect bond returns?\nWhat is the concept of migrating to ratings in the context of bond returns?\nHow is the expected bond return calculated using a semiannual transition matrix?\nHow are the original probabilities of migrating to ratings determined?\nIn what way does a semiannual transition matrix influence the expected bond yield?\nWhy is the 'current date' considered in the computation of the expected bond return?\nHow does the bond price interacts with the calculations in a semiannual transition matrix?\nHow are semiannual transition matrices compared with annual transition matrices to derive expected bond returns?\nHow does the transition from one rating category to another (e.g., AAA to CCC) impact the bond returns?\nWhat is the significance of the 'recovery percentage' in the calculation of expected bond returns?\nWhat specific factors are considered in the 'maturity date' while calculating the expected bond return with a semiannual transition matrix?\nExplain the impact of the initial vector on the computation of expected payoffs in a semiannual transition matrix-based model.",
            "23.7 Semiannual Transition Matrices\n\nThe analysis of the AMR bond in the previous section assumes that the annual\ntransition probabilities are also valid for bonds paying semiannual coupons.\nWe could refine this assumption by computing a semiannual transition matrix\nfrom the S&P data. Such a matrix would be the square root of the \u03a0 matrix.\nThis is not a calculation which can be easily done in Excel. In the spreadsheet\nbelow we have used a computation from M athematica to find the semiannual\ntransition matrix.5\n597 Calculating Default-Adjusted Expected Bond Returns\nCOMPUTING THE SQUARE ROOT OF THE TRANSITION MATRIX\nThe one-year transition matrix\noriginal probability of migrating to rating by year end (%)\nAAA AA A BBB BB B CCC Default E\nrating\nAAA 0.9366 0.0583 0.0040 0.0008 0.0003 0.0000 0.0000 0.0000 0.0000\nAA 0.0066 0.9172 0.0694 0.0049 0.0006 0.0009 0.0002 0.0001 0.0000\nA 0.0007 0.0225 0.9176 0.0519 0.0049 0.0020 0.0001 0.0004 0.0000\nBBB 0.0003 0.0025 0.0483 0.8926 0.0444 0.0081 0.0016 0.0022 0.0000\nBB 0.0003 0.0007 0.0044 0.0667 0.8331 0.0747 0.0105 0.0098 0.0000\nB 0.0000 0.0010 0.0033 0.0046 0.0577 0.8419 0.0387 0.0530 0.0000\nCCC 0.0016 0.0000 0.0031 0.0093 0.0200 0.1074 0.6396 0.2194 0.0000\nDefault 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\nE 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\nThe square root of the one-year transition matrix as computed by Mathematica\nNote the negative entries\noriginal probability of migrating to rating by year end (%)\nAAA AA A BBB BB B CCC Default E\nrating\nAAA 0.9677 0.0303 0.0015 0.0004 0.0001 0.0000 0.0000 0.0000 0.0000\nAA 0.0034 0.9574 0.0362 0.0021 0.0002 0.0004 0.0001 0.0000 0.0000\nA 0.0003 0.0117 0.9573 0.0272 0.0023 0.0010 0.0000 0.0003 -0.0001\nBBB 0.0001 0.0012 0.0254 0.9439 0.0238 0.0038 0.0008 0.0017 -0.0007\nBB 0.0002 0.0003 0.0018 0.0359 0.9115 0.0406 0.0056 0.0068 -0.0026\nB 0.0000 0.0005 0.0017 0.0018 0.0314 0.9161 0.0225 0.0510 -0.0248\nCCC 0.0009 -0.0001 0.0016 0.0050 0.0105 0.0624 0.7988 0.2706 -0.1495\nDefault 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\nE 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\nThe semi-annual transition matrix. To eliminate the negative entries in the\nMathematica matrix above:\na. We assume that a transition from AAA, ... , CCC --> E is impossible (i.e.: last\ncolumn is zero except for last two entries).\nb. We set all other negative entries to zero.\nc. We set default probability so that each row sums to 1.\noriginal probability of migrating to rating by year end (%)\nAAA AA A BBB BB B CCC Default E\nrating\nAAA 0.9677 0.0303 0.0015 0.0004 0.0001 0.0000 0.0000 0.0000 0.0000\nAA 0.0034 0.9574 0.0362 0.0021 0.0002 0.0004 0.0001 0.0001 0.0000\nA 0.0003 0.0117 0.9573 0.0272 0.0023 0.0010 0.0000 0.0001 0.0000\nBBB 0.0001 0.0012 0.0254 0.9439 0.0238 0.0038 0.0008 0.0010 0.0000\nBB 0.0002 0.0003 0.0018 0.0359 0.9115 0.0406 0.0056 0.0041 0.0000\nB 0.0000 0.0005 0.0017 0.0018 0.0314 0.9161 0.0225 0.0261 0.0000\nCCC 0.0009 0.0000 0.0016 0.0050 0.0105 0.0624 0.7988 0.1208 0.0000\nDefault 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\n598 Chapter 23\nIf we use the semiannual transition matrix to compute the expected bond\nreturns we get:\nA B C D E F G H I J K\nCALCULATING THE EXPECTED BOND RETURN\nThis version computes the expected bond return for AMR taking into account actual dates\n1 Uses semi-annual transition matrix\n2 Bond price 76.75% Payoff (t<N) Payoff (N)\n3 Coupon rate, Q 10.55% Vector to AAA 5.28% Vector to 105.28%\n4 Actual price (includes accrued) 80.39%<-- =B2+N8 right AA 5.28% right 105.28%\n5 Recovery rate, \u03bb 50.00% called A 5.28% called 105.28%\n6 Maturity date 12-Mar-21 \"payoff1\" BBB 5.28% \"payoff2\" 105.28%\n7 Current date 20-Jul-05 BB 5.28% 105.28%\n8 Maturity (years) 15.65 B 5.28% 105.28%\n9 Number of semiannual payments 3 0.00 Coupon paid CCC 5.28% 105.28%\n10 Initial rating CCC semiannually Default 50.00% 50.00%\n11 Bond YTM 14.81% E 0% 0%\n12\n13 original probability of migrating to rating by year end (%)\n14 Transition matrix \u00c6 rating AAA AA A BBB BB B CCC Default E\n15 AAA 0.9677 0.0303 0.0015 0.0004 0.0001 0.0000 0.0000 0.0000 0.0000\n16 AA 0.0034 0.9574 0.0362 0.0021 0.0002 0.0004 0.0001 0.0001 0.0000\n17 A 0.0003 0.0117 0.9573 0.0272 0.0023 0.0010 0.0000 0.0001 0.0000\n18 BBB 0.0001 0.0012 0.0254 0.9439 0.0238 0.0038 0.0008 0.0010 0.0000\n19 BB 0.0002 0.0003 0.0018 0.0359 0.9115 0.0406 0.0056 0.0041 0.0000\n20 B 0.0000 0.0005 0.0017 0.0018 0.0314 0.9161 0.0225 0.0261 0.0000\n21 CCC 0.0009 -0.0001 0.0016 0.0050 0.0105 0.0624 0.7988 0.1208 0.0000\n22 Default 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\n23 E 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000\n24\n25\n26 AAA AA A BBB BB B CCC Default E\n27 Initial vector 0 0 0 0 0 0 1 0 0\n28\n29 Period 0 1 2 3 4 5 6 7 8 9\n30 Date 20-Jul-05 15-Sep-05 15-Mar-06 15-Sep-06 15-Mar-07 15-Sep-0715-Mar-08 15-Sep-0815-Mar-0915-Sep-09\n31 Expected payoffs -0.8039 0.1068 0.0903 0.0771 0.0664 0.0578 0.0508 0.0451 0.0405 0.0367\n32 Expected yield 8.07%<-- =XIRR(B31:AP31,B30:AP30)\nThe semiannual transition matrix gives expected bond returns which are, in\n599 Calculating Default-Adjusted Expected Bond Returns\nCOMPARING THE EXPECTED RETURNS WITH\nSEMIANNUAL VS. ANNUAL TRANSITION MATRICES\nUsing actual dates and XIRR\nExpected bond return\nRecovery Annual Semiannual Expected Bond Returns with Annual and\npercentage, transition transition Semiannual Transition Matrices\nl matrix matrix 25%\n0% -3.05% 0.93%\n20% Annual\n10% -1.75% 2.14%\ntransition matrix\n20% -0.30% 3.45%\n15% Semiannual\n30% 1.32% 4.86% transition matrix\n40% 3.15% 6.40%\n10%\n55% 5.25% 8.07%\n60% 7.68% 9.90%\n5%\n65% 10.51% 11.89%\n80% 13.83% 14.07% 0%\n90% 17.73% 16.45%\n0% 10% 20% 30% 40% 55% 60% 65% 80% 90% 100%\n100% 22.33% 19.04% -5%\nRecovery percentage l"
        ],
        "23.8": [
            "What is a \"bond beta\" in corporate finance?\nHow can the model presented in the chapter be used to compute the bond beta?\nWhat is the formula for the capital asset pricing model\u2019s security market line (SML)?\nHow to calculate the debt beta if we know the expected return on debt, the risk-free rate, and the expected rate of return on the market?\nWhat role does a risk-free rate play in the computation of a bond's beta?\nHow is market risk premium calculated?\nWhat is the tax-adjusted version of the SML and how does it differ from the classical SML?\nWhat is the formula of bond SML in a tax-adjusted environment?\nHow does an increase/decrease in corporate tax rate impact a bond's beta?\nWhat does the term \"recovery percentage\" refer to in the context of bond beta computation?\nWhat comparison can be drawn between AMR bond betas and long-term treasury bonds?\nHow does default risk influence bond beta computation?\nWhat factors should be considered when putting the AMR bond beta into context?",
            "23.8 Computing Bond Beta\n\nA vexatious problem in corporate finance is the computation of bond betas.\nThe model presented in this chapter can be easily used to compute the beta of\na bond. Recall from Chapter 2 that the capital asset pricing model \u2019 s s ecurity\nmarket line (SML) is given by:\nE( r )=r +\u03b2 [ E( r )\u2212r ]\nd f d m f\nwhere\nE(\nr\n)=Expectedreturnondebt\nd\nr =Retuurnonrisklessdebt\nf\nE(\nr\n)=Returnonequitymarket\nportfolio\nm\nI f we know the expected return on debt, we can calculate the debt \u03b2 , pro-\nvided we know the risk-free rate r and the expected rate of return on the market\nf\nE ( r ). Suppose, for example, that the market risk premium E ( r ) \u2013 r = 8.4%,\nm m f\nand that r = 7%. Then a bond having an expected return of 8% will have a \u03b2\nf\n600 Chapter 23\nA B C\n1 CALCULATING A BOND'S BETA\n2 Market risk premium, E(r ) - r 8.40%\nm f\n3 r 7%\nf\n4 Expected bond return 8.00%\n5 Implied bond beta 0.119 <-- =(B4-B3)/B2\nIf we use the tax-adjusted version of the SML (see section 3.10), then the\nbond SML becomes r = Cost of debt = r+ \u03b2 [ E ( r ) \u2212 r (1 \u2212 T )]. This\nD f Debt M f C\ngives the bond beta as:\nA B C\n7 Tax-adjusted SML: r = r + \u03b2 *[E(r ) - r*(1-T )]\nD f Debt M f C\n8 Market risk premium, E(r ) - r 8.40%\nm f\n9 r 7%\nf\n10 Corporate tax rate, T 40%\nC\n11 Expected bond return 8.00%\n12 Implied bond beta 0.089 <-- =(B11-B9)/(B8+B9*B10)\nUsing our data for AMR, we get, for the classical SML model:\nCOMPARING AMR BOND BETAS\nSEMIANNUAL VS. ANNUAL TRANSITION MATRICES\nUsing actual dates and XIRR\nE(r ) 8%\nM\nr 3.90%\nf\nBOND BETA 6.00 AMR BOND BETAS\nRecovery Annual Semiannual 5.00\npercentage, transition transition\nAnnual\nl matrix matrix 4.00 transition matrix\n0% -1.84 -0.79 3.00 Semiannual\n10% -1.49 -0.47 transition matrix\n20% -1.11 -0.12 2.00\n30% -0.68 0.25\n40% -0.20 0.66 1.00\n55% 0.36 1.10\n0.00\n60% 1.00 1.59\n0% 10% 20% 30% 40% 55% 60% 65% 80% 90% 100%\n65% 1.75 2.11 -1.00\n80% 2.63 2.69\n90% 3.66 3.32 -2.00 Recovery percentage l\n601 Calculating Default-Adjusted Expected Bond Returns\nIf we assume that the corporate tax rate is T = 40%, then the tax-adjusted\nC\nCAPM gives the following betas:\nCOMPARING AMR BOND BETAS\nUsing the tax-adjusted CAPM\nE(r ) 8%\nM\nr 3.90%\nf\nCorp. tax rate, T 40.00%\nC\nBOND BETA 3.50 AMR BOND BETAS\nTax-adjusted CAPM\nAnnual Semiannual 3.00\nRecovery transition transition\npercentage, \u03bb matrix matrix 2.50 Annual\n0% -1.30 -0.56 2.00 transition matrix\n10% -1.06 -0.33 1.50 S trae nm si ia tin on nu mal atrix\n20% -0.79 -0.08\n30% -0.48 0.18 1.00\n40% -0.14 0.47\n0.50\n55% 0.25 0.78\n60% 0.71 1.12 0.00\n65% 1.24 1.50 -0.50 0% 20% 40% 60% 80% 100%\n80% 1.86 1.90 Recovery percentage \u03bb\n90% 2.59 2.35 -1.00\n100% 3.45 2.84 -1.50\nIf these bond betas seem large, note that the AMR bond has a maturity\ncomparable to these long-term Treasury bonds and has in addition consider-\nable default risk.\nAnother fact which helps place the AMR bond beta into context is AMR \u2019 s\n602 Chapter 23"
        ],
        "23.9": [
            "What is the technique involved in computing the expected return on a risky bond?\nWhat does computing a bond's expected returns put the bond analysis on par with?\nWhy are expected returns rarely computed for bonds?\nWhat common analysis is typically used for bonds?\nWhat is the yield to maturity of a bond?\nHow is the yield to maturity of a bond related to the bond's IRR?\nWhat does the yield to maturity of a bond include?\nAfter having computed a bond's expected return, what can be then computed?\nWhat does the security market line (SML) help in computing for a bond?\nHow does the effort to compute and calibrate bond betas stand in comparison to stock betas?\nWhat technique illustrates the calculation of bond betas based on rating transitions?\nWhat is the need of the hour regarding the technique for computing expected bond returns?\nWhat role do transition matrices play in computing expected bond returns?\nWhat problem arises with industry-specific data in refining transition matrices?\nWhat assumption does the current technique make about transition matrices?\nWhy might it be beneficial to allow for matrices to change with time?\nIn what economic conditions would the ratings transition matrix be expected to \"shift to the right\"?\nWhat is the need for more data in the context of recovery ratios?",
            "23.9 Summary\n\nI n this chapter we have shown how to compute the expected return on a risky\nbond using a simple technique involving rating transitions. Computing a\nbond \u2019 s expected returns puts the bond analysis on the same footing as the\nanalysis of stocks. Expected returns\u2014common in the analysis of stocks\u2014are\nrarely computed for bonds, where the common analysis is in terms of yields\nto maturity. But the yield to maturity of a bond, essentially the bond \u2019 s IRR\nbased on its promised future payments, includes an ill-defined premium for\nthe bond \u2019 s default.\nH aving computed a bond\u2019 s expected return, we can then compute its beta\nusing the security market line (SML). Compared to the vast efforts to compute\nand calibrate stock betas, relatively little research energy has been expended\non bond betas. The technique illustrated in this chapter, based on the transition\nmatrix of the bond ratings, is relatively new. This technique still has to be\nrefined and thoroughly tested by academic research. Several refinements to\nthe rating-based technique for computing expected bond returns still need to\n603 Calculating Default-Adjusted Expected Bond Returns\n\u2022 Better transition matrices. Transition matrices need to be refined, and\nperhaps made industry specific. (The problem with industry-specific data is\nthat the number of observations drops dramatically. Nevertheless, there are\nexamples of such data [for example, a Standard & Poor\u2019 s 2004 study on real\nestate\u2013backed loans cited in the Selected References).\n\u2022 Time-dependent transition matrices . Our technique assumes that transition\nmatrices are stationary\u2014constant through time. Perhaps better techniques can\nbe developed that allow for matrices to change with time. For example, we\nwould expect that in difficult economic conditions, the ratings transition matrix\nwould \u201cshift to the right\u201d\u2014that the probabilities of a given rating getting worse\nover any period would increase.\n\u2022 More data on recovery ratios ."
        ]
    },
    "24": {
        "24.1": [
            "What techniques can be used for computing random numbers?\nWhat is the role of random numbers in simulating stock prices, investment strategies, and option strategies?\nWhat is a random number generator in the context of computers?\nWhat are the features of a uniformly distributed random number?\nHow do random-number generators in computers imitate the procedure of drawing balls from a mixed urn?\nWhat is the difference between a random-number generator and a pseudo-random-number generator?\nWhat are the cycles in pseudo-random-number generators?\nWhat is the purpose of finding a random-number generator with a long cycle?\nWhat is the nature of the number depicted by the Rand() function in Excel?\nWhat features make a random-number generator respectable?\nHow does the Rand() function in Excel in execution mode?\nWhat makes the sequence of numbers produced by a function unpredictable?\nWhat are uniform random-number generators?\nHow to generate normally distributed random numbers?\nHow are correlated random numbers generated using the Cholesky decomposition?",
            "24.1 Overview\n\nI n this chapter we discuss techniques for computing random numbers. We use\nrandom numbers extensively in Chapters 25\u201330 to simulate stock prices,\ninvestment strategies, and option strategies. In this chapter we show how to\nproduce both uniformly distributed and normally distributed random numbers.\nA random-number generator on a computer is a function that produces a\nseemingly unrelated set of numbers. The question of w hat is a random number\nis a philosophical one.1 In this chapter we will ignore philosophy and con-\ncentrate on some simple random-number generators\u2014primarily the Excel\nrandom-number generator Rand( ) and the VBA random-number generator\nRnd . 2 We will show how to use these generators to produce uniform random\nnumbers and subsequently random numbers that are normally distributed. At\nthe end of the chapter we use the Cholesky decomposition to produce corre-\nlated random numbers.\nTo imagine a set of uniformly distributed random numbers think of an urn\nfilled with 1,000 little balls, numbered 000, 001, 002, \u2026 , 999. Suppose we\nperform the following experiment: Having shaken the urn to mix up the balls,\nwe draw one ball out of the urn and record the ball \u2019 s number. Next we put the\nball back into the urn, shake the urn thoroughly so that the balls are mixed up\nagain, and then draw out a new ball. The series of numbers produced by repeat-\ning this procedure many times should be u niformly distributed between 000\nand 999.\nA random-number generator on a computer is a function that imitates this\nprocedure. The random-number generators considered in this chapter are\nsometimes termed pseudo-random-number generators, since they are actually\ndeterministic functions whose values are indistinguishable from random\nnumbers. All pseudo-random-number generators have cycles (i.e., they eventu-\nally start to repeat themselves). The trick is to find a random-number generator\n1. Philosophical? Perhaps theological. Knuth (1981, p. 142) gives the following quote: \u201cA random\nsequence is a vague notion embodying the idea of a sequence in which each term is unpredictable\nto the uninitiated and whose digits pass a certain number of tests, traditional with statisticians and\ndepending somewhat on the uses to which the sequence is to be put\u201d (attributed to D. H. Lehmer,\n1951).\n2 . I n this book we usually write Excel functions in boldface without the parentheses. In this\nchapter we generally write Rand( ) with the parentheses to emphasize that (1) the parentheses\n608 Chapter 24\nwith a long cycle. The Excel R and( ) function has very long cycles and is a\nrespectable random-number generator.\nI f you\u2019 v e never used a random-number generator, open an Excel spreadsheet\nand type = Rand( ) in any cell. You will see a 15-digit number between\n0.000000000000000 and 0.999999999999999. Every time you recalculate the\nspreadsheet (e.g., by pressing the F 9 key), the number changes. We leave the\ntechnical details of how R and( ) works for the exercises to this chapter, where\nwe show you how to design your own random-number generator. Suffice it\nto say, however, that the series of numbers produced by the function should\nbe (to use Lehmer\u2019 s terminology from footnote 1) \u201cunpredictable to the\nuninitiated.\u201d\nIn this chapter we shall deal with several kinds of random-number genera-\ntors: We first examine the uniform random-number generators which come\nwith Excel and VBA. Subsequently we generate normally distributed random\nnumbers. 3 Finally we generate correlated random numbers using the Cholesky\ndecomposition."
        ],
        "24.2": [
            "What is the function of the Excel function Rand( )?\nHow is the Excel RAND function used to generate a list of random numbers?\nWhat happens when you press F9 while using the RAND function in Excel?\nWhat is the common nomenclature of \u201crandom deviates\u201d associated with in financial engineering?\nWhat is the purpose of the VBA\u2019s Rnd function?\nHow does the VBA's Rnd function compare to the Excel's Rand function?\nCan you describe a setup where a VBA program is linked to a button to generate random numbers?\nIn what way can a VBA program be assigned to a drawing shape in Excel?\nHow does one assign a Macro to a Button or to a Control Sequence in Excel?\nWhat is a basic use case of using the Rnd function in a VBA program?\nHow does the spreadsheet update when the 'RandomList' Macro button in Excel is clicked?",
            "24.2 Rand( ) and Rnd: The Excel and VBA Random-Number Generators\n\nSuppose you simply wanted to generate a list of random numbers. One way\nto do this would be to copy the Excel function R and( ) to a range of cells.\nA B C D E\n1 USING EXCEL'S RAND( ) FUNCTION\n2 0.6230 0.9983 0.2132 0.3381<-- =RAND()\n3 0.3836 0.7527 0.9139 0.3635\n4 0.5948 0.7089 0.9563 0.1333\n5 0.4543 0.7327 0.1095 0.9702\n6 0.0250 0.1392 0.9793 0.5049\n7 0.5001 0.3219 0.1293 0.2255\n8 0.8931 0.4278 0.8038 0.2239\n9 0.5847 0.9270 0.6634 0.5449\n10 0.4985 0.2468 0.8391 0.5452\n11\nEach cell contains the function Rand( ). Each time you\nupdate the spreadsheet or press F9 the block of cells will\n12 produce a new set of random numbers.\n3. A common nomenclature speaks of \u201crandom deviates.\u201d Only in financial engineering can one\n609 Generating and Using Random Numbers\nIn section 24.3 we will develop a crude test of how well Rand( ) works.\nUsing VBA \u2019 s Rnd Function\nV BA contains its own function Rnd, which is equivalent to the Excel Rand\nfunction.4 Here\u2019 s a small VBA program which illustrates a basic use of the\nRnd function:\nSub RandomList()\n\u2018Produces a simple list of random numbers\nFor Index = 1 To 10\nRange(\u201cA4\u201d).Cells(Index, 1) = Rnd\nNext Index\nEnd Sub\nIn the spreadsheet below, the VBA program has been assigned to a button,\nso that each time we click on the button, it runs a VBA program that produces\n10 random numbers:\nA B C D E\nUSING VBA'S RND FUNCTION TO\nPRODUCE A LIST OF RANDOM\n1 NUMBERS\n2 List\n3 0.04535\n4 0.41403 RandomList Macro\n5 0.86262\n6 0.79048\n7 0.37354\n8 0.96195\n9 0.87145\n10 0.05624\n11 0.94956\n12 0.36402\n4 . C onfusing, no? Two different functions in the same computer package which do the same\n610 Chapter 24\nAssigning a Macro to a Button or to a Control Sequence\nI n the spreadsheet pictured on page 609, we have assigned the macro\nRandomList to the button marked \u201cRandomList Macro.\u201d Any drawing\nshape in Excel can be assigned a VBA program. In this case we have\ncreated a rectangle; right-clicking on this rectangle, we have assigned\n611 Generating and Using Random Numbers"
        ],
        "24.3": [
            "What is the purpose of testing Random-Number Generators in Financial Modeling?\nWhat does the half-open interval notation [a,b) imply in terms of number distribution?\nIn the context of Random-Number Generators, can you explain what a uniformly distributed list means?\nWhat is the role of the Excel array function Frequency(data_array,bins_array) when testing the distribution of RAND()?\nHow can you create a list of random numbers on a spreadsheet using RAND() and the Frequency function?\nWhat issues are encountered when using spreadsheet based methods to test random-number generators for large number of random draws?\nHow can VBA be utilized to generate many random numbers in the context of testing random number generators?\nIn a random number generating program, what is the significance of a \"clock\"?\nWhat function does the following formula serve in a random number generator: Int(draw * 10) + 1?\nWhat role does the distribution array play in a random number generator program?\nWhat is the purpose of the \"seed\" in a random number generator?\nHow does the command Randomize in VBA's Rnd function influence the generation of random numbers?\nWhat is the difference between using Randomize without any numeric argument and using Randomize(seed)?\nIn what scenarios would Randomize(seed) be preferred over Randomize without any numeric argument?\nWhat happens with the sequence of random numbers when you use Rnd(negative number) and Randomize(seed) commands in sequence?\nHow does the implementation of random number generation vary between macros that produce a random set of random numbers and those that generate the same set of random numbers each time?",
            "24.3 Testing Random-Number Generators\n\nProducing lists of random numbers is interesting, though a bit uninformative.\nIs the list of numbers thus produced really uniformly distributed? A simple\ntest is to generate each number and determine whether it falls into the interval\n[0,0.1), [0.1,0.2), \u2026 , [0.9,1). The notation [ a,b) denotes the half-open interval\nbetween a and b; a number x is in this interval if a \u2264 x < b. If the list of numbers\nis really uniformly distributed, we would expect roughly an even number of\nthe \u201crandom\u201d numbers to be in each of the 10 intervals.\nO ne way to test this is to generate a list of random numbers on the spread-\nsheet by copying R and( ) to many cells and then using the Excel array function\nFrequency(data_array,bins_array) .5 This is illustrated in the following\nspreadsheet picture:\nA B C D E F\nUSING EXCEL'S FREQUENCY FUNCTION\nTO TEST THE DISTRIBUTION OF RAND()\n1\nRandom\n2 numbers Bin Frequency\n3 0.8978 <-- =RAND() 0.1 0\n4 0.8354 0.2 1\n5 0.5188 0.3 1\n6 0.7317 0.4 0\n7 0.5067 0.5 0 <-- =FREQUENCY(A3:A12,D3:D12)\n8 0.2418 0.6 4\n9 0.6406 0.7 1\n10 0.1228 0.8 1\n11 0.5611 0.9 2\n12 0.5543 1 0\n13\nEach cell in the range A3:A12 contains the formula Rand(). Pressing F9 will produce a new set of\n14 random numbers and frequencies.\n612 Chapter 24\nWriting Frequency(A:A,D3:D12) refers to all non-empty cells in\ncolumn A:\nA B C D E F\nUSING EXCEL'S FREQUENCY FUNCTION\nTO TEST THE DISTRIBUTION OF RAND()\n1\n2 0.724913<-- =RAND() Bin Frequency\n3 0.624834 0.1 155\n4 0.093701 0.2 150\n5 0.019565 0.3 154\n6 0.135518 0.4 148\n7 0.248544 0.5 155 <-- =FREQUENCY(A:A,D3:D12)\n8 0.195843 0.6 142\n9 0.532975 0.7 159\n10 0.231059 0.8 148\n11 0.495747 0.9 139\n12 0.016572 1 145\n13 0.526736\n14 0.211719 Total 1495 <-- =SUM(E3:E12)\n15 0.214072\n16 0.287068\n17 0.877499\n18 0.058629\n19 0.154429\nThis method is obviously not efficient (or even feasible) when we want to\ntest the random-number generator for large numbers of random draws. The\nfollowing program uses VBA to generate many random numbers and puts them\n613 Generating and Using Random Numbers\nSub UniformRandom()\n\u2018Puts random numbers into bins\nRange(\u201cE3\u201d) = Time\n\u2019 the number of random draws\nN = Range(\u201cB2\u201d).Value\nDim distribution(10) As Long \u2018bins\nFor k = 1 To N\ndraw = Rnd\ndistribution(Int(draw * 10) + 1) = _\ndistribution(Int(draw * 10) + 1) + 1\nNext k\nFor Index = 1 To 10\nRange(\u201cB5\u201d).Cells(Index, 1) = distribution(Index)\nNext Index\nRange(\u201cE4\u201d) = Time\n614 Chapter 24\nI n the spreadsheet below we have generated 100 million random numbers\nin 25 seconds:\nA B C D E F G H I J\n1 UNIFORMLY-DISTRIBUTED RANDOM NUMBERS\n2 Runs 100,000,000\n3 Starttime 8:55:57\nUniformRandomMacro\n4 Bin Output Stoptime 8:56:28\n5 1 10,000,082 Elapsed 0:00:31\n6 2 10,000,079\n7 3 9,999,875 Frequency Distribution of 100,000,000 Runs of VBA's\n8 4 9,999,979 Rnd Function\n9 5 10,000,256\n10 6 9,999,942\n10,000,400\n11 7 10,000,105\n12 8 9,999,955 10,000,200\n13 9 10,000,225 10,000,000\n14 10 9,999,502\n15 9,999,800\n16 9,999,600\n17\n9,999,400\n18\n19 9,999,200\n20 9,999,000\n21 1 2 3 4 5 6 7 8 9 10\n22\n23\nHere are some things to note about U niformRandom :\n\u2022 T he program has a \u201cclock\u201d to measure the amount of time it takes to run.\nAt the start of the program, we use Range(\u201cE3\u201d) = Time to put the current time\ninto cell E3. At the end of the program, R ange(\u201cE4\u201d) = Time puts in the ending\ntime. The cell e lapsed contains the formula = stoptime-starttime. Note that\nin order for the cells to read correctly, you have to use the command\nFormat|Cells|Number|Time on the relevant cells.\n\u2022 T he heart of the program uses the function Int(draw * 10) + 1 .\nMultiplying the random draw by 10 produces a number whose first digit is 0,\n1, \u2026 , or 9. The VBA function I nt gives this integer. Distribution is a VBA\narray numbered 1 to 10, with Distribution(1) being the number of random\nnumbers in [0,0.1), Distribution(2) the number of random numbers in\n[0.1,0.2), etc. Thus Int(draw * 10) + 1 is the proper place in\n615 Generating and Using Random Numbers\nUsing Randomize to Produce the Same List (or Not) of Random Numbers\nM ost random-number generators use the last generated \u201crandom\u201d number to\nproduce the next. 6 The first number used in a particular sequence is controlled\nby the \u201cseed,\u201d which is typically taken from the computer\u2019 s clock. VBA\u2019 s Rnd\nis no exception, but it allows you to control the seed by using the command\nRandomize. The two small programs below illustrate two uses of this\ncommand.\n\u2022 Using Randomize without any numeric argument resets the seed (meaning\u2014\nit breaks the connection between the next random number and the current\nrandom number). This is illustrated in the macro Random_EachDifferent ,\nthough it is difficult to see the effect.\nSub Random_EachDifferent()\n\u2018Produces a list of random numbers\nRandomize\n\u2018Initializes the VBA random number generator\nFor Index = 1 To 10\nRange(\u201cA5\u201d).Cells(Index, 1) = Rnd()\nNext Index\nEnd Sub\n\u2022 Using Randomize(seed) uses a particular number as the seed.\n\u2022 Using the sequence of commands Rnd(negative number) and\nRandomize(seed) guarantees the same sequence of random numbers. This is\nillustrated in the macro Random_Same .\n616 Chapter 24\nSub Random_Same()\n\u2018Produces the same list of random numbers\n\u2018which is always the same\nRnd (-4)\n\u2018Initializes the VBA random number generator\nRandomize (Range(\u201cseed\u201d))\nFor Index = 1 To 10\nRange(\u201cB5\u201d).Cells(Index, 1) = Rnd()\nNext Index\nEnd Sub\nI n the spreadsheet below, pushing the top button produces a random set of\nrandom numbers. Pushing the bottom button activates the macro Random_\nSame and produces the same set of random numbers each time\u2014provided the\nSeed (cell B2) isn \u2019 t changed.\nA B C\nPRODUCING LISTS OF RANDOM\n1 NUMBERS\n2 Seed 334\n3\nOutput: Output:\nEach run Each run\n4 different same Run Random_EachDifferent\n5 0.54165 0.29708\n6 0.50241 0.70653\n7 0.99067 0.65463\n8 0.85176 0.96848\n9 0.97838 0.48999\n10 0.40634 0.72373\nRun Random_Same\n11 0.88656 0.06518\n12 0.59110 0.60034\n13 0.72938 0.25382\n14 0.49635 0.70398\n15\nNote: to see the effect of the \"Run Random_Same\" button,\nerase the cells B5:B14. Changing the seed in cell B2\n617 Generating and Using Random Numbers"
        ],
        "24.4": [
            "- What is the basic process of generating normally distributed random numbers using Excel?\n- What are the steps to generate normally distributed numbers using Excel's Data Analysis Random Number Generation feature?\n- How would you test if the generated random numbers are accurately distributed normally?\n- What role does the Excel function Norm.S.Dist serve in generating normally distributed numbers?\n- What does the Excel function Norm.S.Inv signify? \n- How is the Excel function Norm.S.Inv( ) used to inverse the function Norm.S.Dist( )?\n- Can you explain how the Excel program NormStandardRandom uses Norm.S.Inv to produce random deviates?\n- What vital step does NormStandardRandom2 incorporate to improve the speed of generating normally distributed numbers?\n- How does Application.ScreenUpdating = False in VBA enhance the program performance in generating random numbers?\n- Explain the Box-Muller method for generating randomly distributed normal deviates.\n- Explain how the Box-Muller method is incorporated into VBA using the NormStandardRandom3 program.\n- How does the Box-Muller method differ from other methods in generating normally distributed random numbers?\n- What is the importance of using the classification of a particular random number into the bins of an array in Excel? \n- What is the difference between a histogram and a frequency distribution in the context of number generation?\n- How is frequency distribution produced in NormStandardRandom2?",
            "24.4 Generating Normally Distributed Random Numbers\n\nI n the sections above we have generated numbers which are uniformly distrib-\nuted. In this section we explore four ways to produce normally distributed\nrandom numbers using Excel.\nMethod 1: Normally Distributed Numbers Using Data|Data Analysis|Random\nNumber Generation\nO ne way to do this is to use the Excel command D ata|Data Analysis|Random\nNumber Generation. Here\u2019 s how we get Excel to produce 1,000 random\nnumbers which are normally distributed (with \u03bc = 0 and \u03c3 = 1) in column A\n618 Chapter 24\nA B C D E F G H I J K L M\n2 0.064265\n3 0.284026 Bin Frequency 60\n4 0.844066 -3 0\n5 -0.29599 -2.9 1\n6 -0.80368 -2.8 2 50\n7 -0.18515 -2.7 1\n8 1.351168 -2.6 0\n9 1.209719 -2.5 0 40\n10 0.487371 -2.4 3\n11 0.147061 -2.3 4\n12 -0.57748 -2.2 3 30\n13 -1.09433 -2.1 3\n14 1.176213 -2 5\n15 -1.46378 -1.9 4\n20\n16 0.501113 -1.8 6\n17 -0.32546 -1.7 7\n18 0.968419 -1.6 10\n19 -1.53634 -1.5 13 10\n20 0.462621 -1.4 17\n21 -2.32598 -1.3 19\n22 0.580555 -1.2 25 0\n23 -0.68623 -1.1 17 -3 -2 -1 0 1 2 3\n24 1.24697 -1 21\nIf we want to see whether the output is distributed normally we can have\nExcel do a frequency distribution (either by using the array function\nFrequency or by using D ata|Data Analysis|Histogram ). As the graph above\nshows, the output appears to be normally distributed.\nMethod 2: Normally Distributed Numbers Using Norm.S.Inv(Rand( ))\nT he Excel function N orm.S.Inv(Rand( )) can be used to generate normally\ndistributed random numbers. To understand the use of this function, we start\nwith an explanation of the function Norm.S.Dist. The Excel function\n619 Generating and Using Random Numbers\nspreadsheet below, for example, we use Norm.S.Dist(0.5,1) to compute\nN(0.5)\u2014the probability that a random variable that is standard normally dis-\ntributed will be < 0.5. We also use N orm.S.Dist(1,1) \u2013 Norm.S.Dist(1,\u2212 1) to\ncompute the percentage of the standard normal distribution that is between \u2212 1\nand + 1:\nA B C\n1 USING NORM.S.DIST\n2 x 0.500\n3 Norm.S.Dist 0.6915<-- =NORM.S.DIST(B2,1)\n4\n5 x 1\n1\n6 x -1\n2\n7 N(x)-N(x) 0.68269<-- =NORM.S.DIST(B5,1)-NORM.S.DIST(B6,1)\n2 1\nExcel \u2019 s Norm.S.Inv( ) function inverts the function N orm.S.Dist . Given a\nnumber x between 0 and 1, Norm.S.Inv(x) produces number y such that\nNorm.S.Dist(y,1) = x. The function Norm.S.Dist(Rand( )) should produce a\nset of random numbers which is distributed standard normal:\nA B C\nNORMALLY DISTRIBUTED RANDOM\n1 NUMBERS USING NORM.S.INV( )\n2 Any number between 0 and 1 0.6000\n3 Normal number 0.2533 <-- =NORM.S.INV(B2)\n4 Check: 0.6000 <-- =NORM.S.DIST(B3,1)\n5\n620 Chapter 24\nA B C D E F\n1 NORMALLY DISTRIBUTED RANDOM NUMBERS USING NORM.S.INV( )\nRandom numbers\n2 produced with Rand() NormSInv Bin Frequency\n3 0.4308 -0.1744 <-- =NORM.S.INV(A3) -4 0\n4 0.4311 -0.1736 <-- =NORM.S.INV(A4) -3.8 0\n5 0.6535 0.3949 <-- =NORM.S.INV(A5) -3.6 0<-- {=FREQUENCY(B:B,D3:D43)}\n6 0.2190 -0.7755 <-- =NORM.S.INV(A6) -3.4 1\n7 0.3964 -0.2626 -3.2 0\n8 0.7476 0.6668 -3 0\n9 0.8786 1.1678 -2.8 2\n10 0.9265 1.4505 -2.6 3\n11 0.0052 -2.5634 90 -2.4 4\n12 0.2191 -0.7751 80 -2.2 3\n13 0.9435 1.5845 -2 8\n70\n14 0.2059 -0.8206 -1.8 14\n15 0.2036 -0.8288 60 -1.6 18\n16 0.6048 0.2657 50 -1.4 28\n17 0.5326 0.0818 -1.2 38\n40\n18 0.2661 -0.6245 -1 48\n19 0.1243 -1.1537 30 -0.8 50\n20 0.2814 -0.5787 20 -0.6 58\n21 0.8127 0.8878 -0.4 82\n10\n22 0.5243 0.0611 -0.2 74\n23 0.4826 -0.0436 0 0 79\n24 0.5602 -4 -3.5 -30.1-25.516-2 -1.5 -1 -0.5 0 0.5 1 1.5 2 02..52 3 3.5 742\n25 0.9075 1.3256 0.4 70\nMethod 3: Incorporating Norm.S.Inv( ) into VBA\nThe VBA program N ormStandardRandom uses N orm.S.Inv to produce\nrandom deviates. Here is the program and below is the output it produces.\nNote that in VBA we replace the periods in the function with underscores,\nwriting Norm_S_Inv .\nycneuqerF\nI n the spreadsheet below we produce 1,000 iterations of Norm.S.Inv\n(Rand( )) and graph the resulting frequencies. They look normally\ndistributed:\n621 Generating and Using Random Numbers\nSub NormStandardRandom()\n\u2018Produces a list of normally-distributed\n\u2018random numbers\n\u2018Randomize initializes the\n\u2018VBA random number generator\nRandomize\nApplication.ScreenUpdating = False\nRange(\u201cE2\u201d) = Time\nRange(\u201cA8\u201d).Range(Cells(1, 1), _\nCells(64000, 1)).Clear\nN = Range(\u201cB2\u201d).Value\nFor Index = 1 To N\nRange(\u201cA8\u201d).Cells(Index, 1) = _\nApplication.WorksheetFunction.NormSInv(Rnd)\nNext Index\nRange(\u201cE3\u201d) = Time\nEnd Sub\nT he program N ormStandardRandom includes two lines which measure\nthe time taken for the whole simulation to run. The program is very slow,\nlargely because of repeated calls on the spreadsheet function. As you can see\nbelow, 10,000 runs of the program take about 45 seconds on the author\u2019 s\n622 Chapter 24\nA B C D E F G H I J K L\nNormally Distributed Random Numbers\n1 using VBA and Excel's Norm.S.Inv() function\n2 Runs 10,000 Starttime 19:43:33 NormStandardRandom\n3 Stoptime 19:44:17 uses Norm.S.Inv()\n4 Elapsed 0:00:44<-- =E3-E2\n5\n6 Frequency Distribution\n7 Output Bin Frequency\n8 -0.07925 -4 1\n9 0.695962 -3.9 0 Frequency of 10,000 Normally\n10 0.314898 -3.8 0\n11 -0.62788 -3.7 0 Distributed Random Numbers\n12 -0.5172 -3.6 0\n13 -0.69972 -3.5 1 500\n14 -0.11278 -3.4 0\n15 -1.00098 -3.3 0 400\n16 0.549194 -3.2 2\n17 -2.16114 -3.1 11 300\n18 -0.22532 -3 3\n19 0.565778 -2.9 6 200\n20 -2.01698 -2.8 8\n21 -0.2967 -2.7 4 100\n22 0.340505 -2.6 8\n0\n23 -0.4739 -2.5 12\n-5 -4 -3 -2 -1 0 1 2 3 4 5\n24 0.382405 -2.4 27\n25 -0.15375 -2.3 22\n26 1.318265 -2.2 21\nA Faster Version of Method 3\nW e can make method 3 much faster by storing all the data in VBA and only\n623 Generating and Using Random Numbers\nSub NormStandardRandom2()\n\u2018Randomize Initializes the VBA\n\u2018random number generator\nRandomize\nDim distribution(-40 To 40) As Double\nApplication.ScreenUpdating = False\nRange(\u201cE2\u201d) = Time\nN = Range(\u201cB2\u201d).Value\nFor Index = 1 To N\nX = Application.Norm_S_Inv(Rnd())\nIf X < -4 Then\ndistribution(-40) = distribution(-40) + 1\nElseIf X > 4 Then\ndistribution(40) = distribution(40) + 1\nElse: distribution(Int(X / 0.1)) = _\ndistribution(Int(X / 0.1)) + 1\nEnd If\nNext Index\nFor Index = -40 To 40\nRange(\u201cB7\u201d).Cells(Index + 41, 1) = _\ndistribution(Index) / (2 * N)\nNext Index\nRange(\u201cE3\u201d) = Time\n624 Chapter 24\nHere \u2019 s the output for 100,000 iterations. Note the time in cell E4:\nA B C D E F G H I J K\nNormally Distributed Random Numbers\nThis sheet saves time by\nnot recording the random numbers on the screen\n1\n2 Runs 1,000,000 Starttime 19:47:53\n3 Stoptime 19:47:59\n4 Elapsed 0:00:06<-- =E3-E2 NormStandardRandom2\n5\n6 Bin Output\n7 -4 0.0000245\n8 -3.9 0.0000140 Frequency Distribution of 1,000,000 Normally Distributed\n9 -3.8 0.0000165 Random Numbers\n10 -3.7 0.0000250\n11 -3.6 0.0000310 0.0250\n12 -3.5 0.0000460\n13 -3.4 0.0000645 0.0200\n14 -3.3 0.0001030\n15 -3.2 0.0001430 0.0150\n16 -3.1 0.0001755\n17 -3 0.0002550 0.0100\n18 -2.9 0.0003460\n19 -2.8 0.0004600 0.0050\n20 -2.7 0.0006005\n21 -2.6 0.0008165 0.0000\n22 -2.5 0.0009685 -4 -3.5 -3 -2.5 -2 -1.5 -1 -0.5 0 0.5 1 1.5 2 2.5 3 3.5 4\n23 -2.4 0.0012905\n24 -2.3 0.0015430\nThere are a few things to note about this program:\n\u2022 M ost of the results of the normal distribution are between \u22124 and + 4. When,\nin NormStandardRandom2, we classify the output into bins, we want these\nbins to be ( \u2212 \u221e , \u2212 3.9], ( \u2212 2.9, \u22122 .8], \u2026 , (\u2212 3.9, \u221e) . To do this we first define\nan array distribution( \u2212 40 To 40); this array has 81 indices. To clas-\nsify a particular random number (say, X ) into the bins of this array, we use the\n625 Generating and Using Random Numbers\nIf X < -4 Then\ndistribution(-40) = distribution(-40) + 1\nElseIf X > 4 Then\ndistribution(40) = distribution(40) + 1\nElse: distribution(Int(X / 0.1)) = _\ndistribution(Int(X / 0.1)) + 1\nEnd If\n\u2022 NormStandardRandom2 produces not a histogram (which is a c ount of\nhow many times a number falls into a particular bin), but a f requency distribu-\ntion . We do this by dividing by twice the number of runs (remember that each\nsuccessful run produces two random numbers), 2N , before we output the data\nto the spreadsheet:\nFor Index = -40 To 40\nRange(\u201coutput\u201d).Cells(Index + 41, 1) = _\ndistribution(Index) / (2 * N)\nNext Index\n\u2022 Finally, note that the command Application.ScreenUpdating =\nFalse makes a big difference! This command prevents both the updating of\nthe output in the cells and the Excel chart. Try running the program with and\nwithout this command to see the effect.\nMethod 4: The Box-Muller Method\nThe Box-Muller method for creating randomly distributed normal deviates is\nthe fastest method of the four.7 The eight lines which follow S tart in the\n626 Chapter 24\nVBA program below define a routine which in each successful iteration creates\ntwo numbers which are drawn from a standard normal distribution. The routine\ncreates two random numbers, rand and rand , between \u2212 1 and + 1. If the sum\n1 2\nof the squares of these numbers is within the unit circle, then the two normal\ndeviates are defined by\n{ X ,X }=\u23a7 \u23a8rand \u2217 \u22122ln( S 1) ,rand \u2217 \u22122ln( S 1)\u23ab \u23ac\n1 2 1 2\n\u23a9 S S \u23ad\n1 1\nwhere\nS =randd2 +rand2\n1 1 2\nHere \u2019 s the VBA program:\nSub NormStandardRandom3()\n\u2018Box-Muller for producing\n\u2018standard normal deviates\nDim distribution(-40 To 40) As Long\nRange(\u201cE2\u201d) = Time\nN = Range(\u201cB2\u201d).Value\nApplication.ScreenUpdating = False\nFor Index = 1 To N\nstart:\nStatic rand1, rand2, S1, S2, X1, X2\nrand1 = 2 * Rnd - 1\nrand2 = 2 * Rnd - 1\nS1 = rand1 \u2227 2 + rand2 \u2227 2\nIf S1 > 1 Then GoTo start\nS2 = Sqr(-2 * Log(S1) / S1)\nX1 = rand1 * S2\n627 Generating and Using Random Numbers\nIf X1 < -4 Then\ndistribution(-40) = distribution(-40) + 1\nElseIf X1 > 4 Then\ndistribution(40) = distribution(40) + 1\nElse: distribution(Int(X1 / 0.1)) = _\ndistribution(Int(X1 / 0.1)) + 1\nEnd If\nIf X2 < -4 Then\ndistribution(-40) = distribution(-40) + 1\nElseIf X2 > 4 Then\ndistribution(40) = distribution(40) + 1\nElse: distribution(Int(X2 / 0.1)) = _\ndistribution(Int(X2 / 0.1)) + 1\nEnd If\nNext Index\nFor Index = -40 To 40\nRange(\u201cB7\u201d).Cells(Index + 41, 1) = _\ndistribution(Index) / (2 * N)\nNext Index\nRange(\u201cE3\u201d) = Time\n628 Chapter 24\nT his routine is very fast; in the spreadsheet below we produce 10 million\nnormal variates in 18 seconds:\nA B C D E F G H I J K\n1 BOX-MULLER ROUTINE FOR STANDARD NORMAL\n2 Runs 10,000,000 Starttime 10:54:28\n3 Stoptime 10:54:46 NormStandardRandom3\n4 Elapsed 0:00:18<-- =E3-E2 Uses Box-Muller routine\n5\n6 Bin Output\n7 -4 0.0000\n0.0450\n8 -3.9 0.0000\n9 -3.8 0.0000 0.0400\n10 -3.7 0.0001 0.0350\n11 -3.6 0.0001\n12 -3.5 0.0001 0.0300\n13 -3.4 0.0001 0.0250\n14 -3.3 0.0002\n0.0200\n15 -3.2 0.0003\n16 -3.1 0.0004 0.0150\n17 -3 0.0005 0.0100\n18 -2.9 0.0007\n0.0050\n19 -2.8 0.0009\n20 -2.7 0.0012 0.0000\n21 -2.6 0.0015 -4 -2 0 2 4\n22 -2.5 0.0020"
        ],
        "24.5": [
            "What is the Excel function Norm.Inv(rand( ),mean,sigma)?\nWhat is the primary use of the Excel function Norm.Inv(rand( ),mean,sigma)?\nHow does Norm.Inv differ from Norm.S.Inv?\nHow can Norm.Inv be utilized to alter the mean and standard deviation of deviates?\nWhat is the standard normal distribution and how does Norm.S.Inv(Rand( )) invert it?\nGive a brief explanation of the term 'normal deviates'.\nWhat does it mean when stock returns are said to be 'normally distributed'?\nWhat does the mean (\u03bc) and standard deviation (\u03c3) represent in the scenario of simulating stock returns?\nHow does the simulation of periodic stock returns work with Norm.Inv(Rand(),mDt, Dts), with \u2206t = 1/ n?\nWhat is a lognormal price process?\nHow are returns simulated in financial theory using the formula r=\u03bc\u0394t+\u03c3 \u0394t Norm.S.Inv(Rand())?\nHow can normal deviates be created using the Excel function Norm.Inv(Rand( )),mean,sigma)? \nWhat does it imply when much financial theory is phrased in terms of lognormal price processes? \nWhat is the result of an equation where Z is a standard normal deviate according to financial theory?\nWhy might it be more convenient to use Norm.S.Inv(Rand()) in some instances rather than Norm Inv?",
            "24.5 Norm.Inv: Another Way to Generate Normal Deviates\n\nT he Excel function Norm.Inv(rand( ),mean,sigma) can also generate normal\ndeviates. Whereas N orm.S.Inv(rand( )) generates only standard normal devi-\nates, we can use N orm.Inv to change the mean and standard deviation of our\ndeviates. In Chapter 26, we will sometimes use this function to generate nor-\n629 Generating and Using Random Numbers\nA B C D E F G H I J\nNORMALLY DISTRIBUTED RANDOM NUMBERS USING\n1 NORM.INV(rand(),mean,sigma )\n2 Mean 2\n3 Sigma 3\n4\n5 Norm.Inv(rand(),mean,sigma) Bin Frequency\n6 -0.0771 <-- -10.0 0<-- {=FREQUENCY(A:A,D6:D46)}\n7 -3.1876 =NORM.INV(RAND(), -9.4 0\n8 0.7521 $B$2,$B$3) -8.8 0\n9 2.0116 -8.2 0 100\n10 1.8121 -7.6 0 90\n11 2.5113 -7.0 0 80\n12 8.1300 -6.4 1\n70\n13 2.6463 -5.8 1\n14 5.2369 -5.2 4 60\n15 4.8960 -4.6 4 50\n16 2.3377 -4.0 14 40\n17 4.4869 -3.4 9 30\n18 3.3379 -2.8 10\n19 0.4816 -2.2 20 20\n20 2.9400 -1.6 44 10\n21 -2.4114 -1.0 45 0\n22 3.3061 -0.4 42\n23 1.3751 0.2 61\nNorm.Inv as Alternative to Norm.S.Inv\nNorm.S.Inv(Rand( )) inverts the standard normal distribution and can be used\nto create standard normal deviates. The Excel function Norm.Inv(Rand\n( )),mean,sigma) can be used to create normal deviates that are normally\ndistributed with any normal distribution. The example below illustrates this:\n-10.0 -8.8 -7.6 -6.4 -5.2 -4.0 -2.8 -1.6 -0.4 0.8 2.0 3.2 4.4 5.6 6.8 8.0 9.2 10.4 11.6 12.8 14.0\n1,000 normal deviates created with\nnorm.inv(rand(),mean,sigma)\nA B C D E F G H I J K L M\n1 CREATING NORMAL DEVIATES WITH NORM.INV(RAND())\n2 Mean 3.00\n3 Sigma 5.00\n4 Bin Frequency\n5 Norm.Inv -12.00 1<-- =FREQUENCY(A6:A1005,E5:E45)\n6 1.1512<-- =NORM.INV(RAND(),$B$2,$B$3) -11.25 1\n7 -1.7767<-- =NORM.INV(RAND(),$B$2,$B$3) -10.50 3 1,000 Normal Deviates with Mean = 3, Sigma = 5\n8 8.8680<-- =NORM.INV(RAND(),$B$2,$B$3) -9.75 3 Created with Norm.Inv(Rand())\n9 6.9032 -9.00 4\n10 4.4525 -8.25 1 80\n11 5.2241 -7.50 4 70\n12 -1.9517 -6.75 11\n13 -2.7898 -6.00 7 60\n14 1.6515 -5.25 14 50\n15 -0.4800 -4.50 11 40\n16 3.5602 -3.75 19\n17 10.7653 -3.00 21 30\n18 1.6006 -2.25 32 20\n19 2.0960 -1.50 58 10\n20 8.3773 -0.75 43\n21 2.5934 0.00 34 0\n22 5.7685 0.75 51 -15.00 -10.00 -5.00 0.00 5.00 10.00 15.00 20.00\n630 Chapter 24\nGetting Ahead of Ourselves: Do We Prefer Norm.S.Inv or Norm.Inv?\nU ltimately our goal is to simulate stock returns; these (as we discuss in Chapter\n26) are generally assumed to be normally distributed. If we are simulating the\nreturns of a stock based on annual mean \u03bc and standard deviation \u03c3 , then it is\nobviously more convenient to use N orm.S.Inv(rand( ), \u03bc , \u03c3 ) . As we discuss\nin Chapter 26, if ( \u03bc , \u03c3) are the annual statistics of the stock return, and if we\ndivide the year into n subperiods, then the periodic stock returns can be\nsimulated with Norm.Inv(Rand(),mDt, Dts) , where \u0394 t = 1/ n .\nOn the other hand, much financial theory is phrased in terms of lognormal\nprice processes. These are generally written as\nr=\u03bc\u0394t+\u03c3 \u0394tZ\nwhere Z is a standard normal deviate. To conform to this writing, it is often\nmore convenient (and theoretically equivalent) to simulate returns by:\nr=\u03bc\u0394t+\u03c3 \u0394t Norm.S.Inv(Rand())\nIn this book we interchangeably use both writings."
        ],
        "24.6": [
            "What is the method to generate correlated pseudo-random numbers?\nWhat does the term 'standard normal deviates' mean in financial modeling?\nHow do you create a set of simulates that has a desired correlation with Z1?\nWhat is the purpose of the functions AVERAGE, STDEVP, SKEW, KURT in financial modeling?\nWhat does the function CORREL do in financial modeling?\nWhat is the meaning of 'scatter diagrams' in financial modeling?\nHow is the procedure of creating correlated uniform variables different from correlated normal variables?\nWhat is the function of Norm.S.Dist in financial modeling?\nWhat is the meaning of uniformly distributed variables in financial modeling?\nHow can the efficiency of generating correlated uniform simulated random numbers be increased?\nCan functions be combined while generating correlated uniform simulated random numbers?\nWhat is the significance of 'different correlations' in scatter plots of random standard normal simulates? \nHow do you use Norm.S.Inv and Rand functions for generating correlated random numbers?\nWhat procedure would allow you to produce two random numbers that are normally distributed?\nCan you explain 'correlation coefficient' in the context of simulations in financial modeling? \nHow does the correlation of two variables affect the scatter plot representation of the variables?\nWhat does the term 'uniformly distributed' means in context of random number generation?\nWhat is the role of the function NORM.S.DIST in transforming standard normal variables into uniform variables?\nWhat are some key variables used when generating correlated random numbers and what roles do they play in the process?",
            "24.6 Generating Correlated Random Numbers\n\nI n this section we show how to produce correlated pseudo-random numbers.\nWe start by showing how to generate two correlated normal and uniform\n631 Generating and Using Random Numbers\nExample 1: Two Correlated Standard Normal Variables\nSuppose that Z and Z are standard normal deviates (created in the\n1 2\nspreadsheet below with N orm.S.Inv(Rand( )) . Defining z =\u03c1z +z 1\u2212\u03c12 ,\n3 1 2\nwe create a set of simulates that has the desired correlation with Z :\n1\nA B C D E\n1 1,000 CORRELATED STANDARD NORMAL DEVIATES\n2 \u03c1 0.6\n3\n4 Mean 0.0731 -0.0515 0.0026 <-- =AVERAGE(D12:D1011)\n5 Sigma 0.9910 1.0322 1.0026 <-- =STDEV.S(D12:D1011)\n6 Skewness 0.0572 0.1225 0.0376 <-- =SKEW(D12:D1011)\n7 Kurtosis -0.0962 -0.0599 -0.0923 <-- =KURT(D12:D1011)\n8 Count 1000 1000 1000 <-- =COUNT(D12:D1011)\n9 Corr(z,z) 0.5676 <-- =CORREL(B12:B1011,D12:D1011)\n1 3\n10\n11 Z Z Z\n1 2 3\n12 =NORM.S.INV(RAND()) --> -0.9108 -0.2754 -0.7668 <-- =$B$2*B12+SQRT(1-$B$2^2)*C12\n13 =NORM.S.INV(RAND()) --> 0.8994 0.2471 0.7373 <-- =$B$2*B13+SQRT(1-$B$2^2)*C13\n14 =NORM.S.INV(RAND()) --> 0.3730 -0.7499 -0.3762 <-- =$B$2*B14+SQRT(1-$B$2^2)*C14\n15 -0.7975 -0.3404 -0.7508\n16 0.4534 -0.1954 0.1157\n17 -0.5444 -0.4955 -0.7230\n18 1.1833 -1.1735 -0.2288\n19 -1.5330 0.7085 -0.3530\n632 Chapter 24\nThe frequencies and distributions are shown below:\nG H I J K L M N O P Q R\n11\nSca(cid:3)er Plot of Z1 vs Z3, rho = 0.6\n12 Frequency distribution, Z, Z, Z\n1 2 3\n13 Z Z Z 5.0000\n1 2 3\n14 -4 0 0 0 4.0000\n15 -3.8 0 0 0\n3.0000\n16 -3.6 0 0 0\n17 -3.4 0 1 1 2.0000\n18 -3.2 0 1 0 1.0000\n19 -3 0 0 2\n0.0000\n20 -2.8 1 0 1 -4.0000 -3.0000 -2.0000 -1.0000 0.0000 1.0000 2.0000 3.0000 4.0000\n21 -2.6 3 3 3 -1.0000\n22 -2.4 4 1 1 -2.0000\n23 -2.2 3 4 5\n-3.0000\n24 -2 8 7 6\n25 -1.8 12 14 14 -4.0000\n26 -1.6 18 21 16\n27 -1.4 26 16 26\n28 -1.2 46 37 23 Frequencies: Z1, Z2, Z3\n29 -1 39 57 43\n100\n30 -0.8 51 65 51\n90\n31 -0.6 48 62 66\n80\n32 -0.4 65 52 74\n33 -0.2 74 78 97 70 Z1\n34 0 81 81 74 60 Z2\n35 0.2 82 82 80 50 Z3\n36 0.4 80 73 79 40\n37 0.6 71 84 66 30\n38 0.8 76 59 46 20\n39 1 53 52 60 10\n40 1.2 42 36 44 0\n41 1.4 35 34 41 -4 -3 -2 -1 0 1 2 3 4\n42 1.6 27 22 25\n43 1.8 20 24 26\n44 2 8 12 9\nO n the next page we give the scatter plots for a number of simulations with\ndifferent correlation coefficients \u03c1 .\nExample 2: Two Correlated Uniform Variables\nTo create uniform variables that are correlated, we first produce correlated\nstandard normal variables, and then use Norm.S.Dist to produce the uniform\nvariables. Here \u2019 s the procedure:\n\u2022 Use Norm.S.Inv(Rand( )) to produce two random numbers that are nor-\nmally distributed. Call these numbers z and z .\n1 2\n\u2022 Let z =\u03c1z +z 1\u2212\u03c12 . As we showed above z and z are correlated with\n3 1 2 3 1\n633 Generating and Using Random Numbers\n\u2022 Now define u = Norm.S.Dist(z , 1) and u = Norm.S.Dist(z , 1) . Then u\n1 1 2 3 1\nand u are uniformly distributed and correlated with correlation \u03c1 .\n2\nSca(cid:3)erplotofZ1vsZ3,rho=0.00 Sca(cid:3)erplotofZ1vsZ3,rho=1.00\n4.0 4.0\n3.0 3.0\n2.0 2.0\n1.0 1.0\n0.0 0.0\n-4.0 -3.0 -2.0 -1.0 0.0 1.0 2.0 3.0 4.0 -4.0 -3.0 -2.0 -1.0 0.0 1.0 2.0 3.0 4.0\n-1.0 -1.0\n-2.0 -2.0\n-3.0 -3.0\n-4.0 -4.0\nSca(cid:3)erplotofZ1vsZ3,rho= -0.50 Sca(cid:3)erplotofZ1vsZ3,rho=0.30\n4.0 4.0\n3.0 3.0\n2.0 2.0\n1.0 1.0\n0.0 0.0\n-4.0 -3.0 -2.0 -1.0 0.0 1.0 2.0 3.0 -4.0 -3.0 -2.0 -1.0 0.0 1.0 2.0 3.0\n-1.0 -1.0\n-2.0 -2.0\n-3.0 -3.0\n-4.0 -4.0\nFigure 24.1\nScatter plots of random standard normal simulates with different correlations.\nWe show this routine twice. The first time we show it in an extensive spread-\nsheet below. Note the \u201cdiagonal aspect\u201d of the scatter diagram of u versus u\n2 1\n634 Chapter 24\nA B C D E F G H I J\n1,000 CORRELATED UNIFORM SIMULATED RANDOM NUMBERS\n1 Starting with Normal, then going to Uniform\n2 Rho, \u03c1 0\n3 Mean -0.0166 -0.0056 -0.0056<-- =AVERAGE(D11:D10000) Mean 0.4966 0.4975<-- =AVERAGE(I11:I9998)\n4 Sigma 1.0113 0.9758 0.9758<-- =STDEVP(D11:D10000) Sigma 0.2904 0.2839<-- =STDEVP(I11:I9998)\n5 Skewness -0.0556 0.0681 0.0681<-- =SKEW(D11:D10000) Max 0.9999 0.9996<-- =MAX(I11:I9998)\n6 Kurtosis 0.2067 0.1383 0.1383<-- =KURT(D11:D10000) Min 0.0004 0.0005<-- =MIN(I11:I9998)\n7 Count 1,000 1,000 1,000<-- =COUNT(D11:D10000)\n8 Corr(z1,z3) 0.0184<-- =CORREL(B11:B10000,D11:D10000) Corr(u1,u2) 0.0221<-- =CORREL(H11:H1010,I11:I1010)\n9\n10 Z1 Z2 Z3 U1 U2\n11=NORMSINV(RAND())--> -1.1794 0.4929 0.4929<-- =rho*B11+SQRT(1-rho^2)*C11 =NORM.S.DIST(B11,1)--> 0.1191 0.6890<-- =NORM.S.DIST(D11,1)\n12 -0.6960 -0.7892 -0.7892 0.2432 0.2150\n13 0.7384 0.8904 0.8904 1.00 0.7699 0.8134\n14 -0.6938 -1.6462 -1.6462 0.90 0.2439 0.0499\n15 0.1559 -0.1719 -0.1719 0.80 0.5619 0.4318\n16 0.1059 0.9392 0.9392 0.70 0.5422 0.8262\n17 0.4912 -0.7760 -0.7760 0.60 0.6883 0.2189\n18 -0.9220 -0.7613 -0.7613 0.1783 0.2232\n19 -0.7405 0.4353 0.4353 0.50 0.2295 0.6683\n20 -0.2325 -0.9728 -0.9728 0.40 0.4081 0.1653\n21 -0.4111 2.5493 2.5493 0.30 0.3405 0.9946\n22 -0.9892 -1.9558 -1.9558 0.20 0.1613 0.0252\n23 1.0221 -0.0712 -0.0712 0.10 0.8466 0.4716\n24 -1.7364 0.8363 0.8363 0.00 0.0413 0.7985\n25 0.3628 -0.4396 -0.4396 0.00 0.20 0.40 0.60 0.80 1.00 0.6416 0.3301\n26 -0.7760 -0.3599 -0.3599 0.2189 0.3595\n27 0.4689 0.4987 0.4987 0.6804 0.6910\nW e can make this process more efficient (and also more obscure) by com-\nbining functions as in the following spreadsheet. Column A cells are defined\nwith Rand( ). Column B contains the formula = NORM.S.DIST(Rho*\nNORM.S.INV(A7) + SQRT(1-Rho\u2227 2)*NORM.S.INV(RAND( )),1) .\nA B C D E F G H I J\n1,000 CORRELATED UNIFORM SIMULATED RANDOM NUMBERS\nMore Efficient Procedure\n1\n2 Rho -0.9\n3 Corr(u1,u2) -0.89293\n4\n5\n6 U1 U2 Frequency Distribution\n7 0.81343 0.49546<-- =NORM.S.DIST(Rho*NORM.S.INV(A7)+SQRT(1-Rho^2)*NORM.S.INV(RAND()),1) Bins U1 U2\n8 0.38688 0.46179 0.1 55 54\n9 0.53905 0.52559 0.2 40 50\n10 0.21526 0.57302 1.20000 0.3 43 60\n11 0.35648 0.46330 0.4 40 52\n12 0.88493 0.18691 1.00000 0.5 46 51\n13 0.82588 0.33920 0.6 55 40\n14 0.04539 0.84384 0.80000 0.7 53 50\n15 0.13171 0.82252 0.8 55 64\n16 0.19458 0.82780 0.60000 0.9 62 42\n17 0.82913 0.18255 1.0 54 40\n1 18 9 0 0. .6 06 68 44 11 0 0 0. .3 90 15 18 65 4 0.40000 70\n20 0.14516 0.93130\n21 0.28277 0.75389 0.20000 60\n22 0.80075 0.13454\n23 0.78034 0.42222 0.00000 50\n24 0.66430 0.30995 0.00000 0.20000 0.40000 0.60000 0.80000 1.00000 1.20000\n25 0.60427 0.67723 40\n26 0.49552 0.47382\n27 0.43436 0.67985 30\n28 0.49882 0.38023 20\n29 0.38614 0.49012\n30 0.53584 0.68470 10\n31 0.06236 0.96573\n32 0.51508 0.35964 0\n33 0.96866 0.06450 1 2 3 4 5 6 7 8 9 10\n635 Generating and Using Random Numbers"
        ],
        "24.7": [
            "What is correlation in the context of financial modeling?\nWho is Jacob in the context of the financial situation presented?\nAt which age did Jacob retire and how much savings does he have?\nWhat percentage of Jacob's savings does he intend to invest in a market index fund and a risk-free asset?\nWhat is the estimated return on the risk-free asset that Jacob intends to invest in?\nHow are the returns of the market portfolio that Jacob intends to invest in distributed?\nWhat is the mean and standard deviation of the market portfolio's returns?\nWhat amount does Jacob intend to withdraw from his account at the beginning of the year?\nWhat is the estimated standard deviation of Jacob's annual spending growth rate?\nHow is the growth rate of Jacob's annual spending correlated with the stock market?\nAt what age is Jacob's life expectancy?\nHow much will Jacob leave to his son, Simon, according to the simulation?\nExplain the term 'standard normal variables' in the context of financial modeling.\nHow much does Jacob leave for his heirs in this particular simulation?\nWhat is the technique of running a data table on a blank cell and how is it related to financial modeling?\nWhat is the average amount inherited by Jacob's heirs as per the simulation results?\nHow many out of the total simulations resulted in Jacob's heirs being left intestate?\nHow does the correlation between the stock market and Jacob's expenses influence the inheritance value?\nWhy does a negative correlation between the stock market and Jacob's expenses result in a lower inheritance?",
            "24.7 What \u2019 s Our Interest in Correlation? A Small Case8\n\nJacob has just retired at age 65 with savings of $1 million. He intends to invest\n60% of this in a market index fund and the remaining 40% in a risk-free asset.\nHe estimates the return on the risk-free asset as r = 3% annually, and he\nf\nestimates that the market portfolio will have normally distributed returns with\nmean return \u03bc = 11% and\u03c3 = 20%.\nJ acob intends to withdraw $50,000 from his account at the beginning of this\nyear. He thinks that this amount will, on average grow at 3% per year, with a\nstandard deviation of 10%. Furthermore, he thinks that the growth rate of his\nannual spending will be correlated \u03c1 = 0.5 with the stock market9.\nO ur question: If Jacob\u2019 s life expectancy is age 90, how much will he leave\nto his beloved son, Simon? Here \u2019 s a simulation that answers this question\n(some rows are hidden):\n8. This section uses some materials from Chapter 26 and may be skipped on first reading.\n636 Chapter 24\nA B C D E F G H I J\nRETIREMENT PROBLEM\n1 Spending and Market are Correlated\n2 Savings at 65 1,000,000\n3 Annual expenses\n4 Year 65 50,000\n5 Mean growth 3%\n6 Sigma of growth 10%\n7 Correlation with market 0.50\n=$B$7*I17+(1-\n8 Stock market\n$B$7^2)^(0.5)*NORM.S.INV(RAND())\n9 Mean 11%\n10 Sigma 20%\n11 Risk-free 4% =EXP($B$9+$B$10*I17)\n12 Invested in stock market 60%\n13 Left for heirs 906,029<-- =B42\n14\nTwo correlated\n=EXP($B$5+$B$6*J18)\n15 Spending Returns standard normals\nGrowth\nover\nSavings previous Stock Savings at\n16 Age at beg period year Spending market Risk-free end of period Z Z\n1 2\n17 65 1,000,000 50,000 1.0682 1.0408 1,004,359 -0.2203 -0.9133\n18 66 1,004,359 0.9521 47,604 0.8125 1.0408 864,729 -1.5883 -0.7911\n19 67 864,729 0.9953 47,381 1.0835 1.0408 871,664 -0.1488 -0.3470\n20 68 871,664 1.0895 51,621 1.0418 1.0408 853,985 -0.3454 0.5573\n21 69 853,985 1.1228 57,961 1.1690 1.0408 889,751 0.2309 0.8584\n22 70 889,751 0.9806 56,836 0.7173 1.0408 705,228 -2.2114 -0.4961\n23 71 705,228 1.1715 66,581 1.4352 1.0408 815,828 1.2564 1.2825\n24 72 815,828 1.0569 70,371 1.2569 1.0408 872,528 0.5932 0.2537\n25 73 872,528 0.9371 65,947 0.9205 1.0408 781,255 -0.9644 -0.9493\n26 74 781,255 1.0533 69,463 1.1433 1.0408 784,598 0.1195 0.2194\n27 75 784,598 0.9870 68,558 1.1017 1.0408 771,425 -0.0657 -0.4312\n41 89 929,695 0.9389 65,230 1.0529 1.0408 906,029 -0.2921 -0.9299\n42 90 906,029\nSome details of the simulation:\n\u2022 Whatever savings are left at the end of a particular year constitute the initial\nsavings for the next year.\n\u2022 Z and Z are correlated standard normal variables. Note the formulas:\n1 2\nZ =Norm.S.Inv(Rand( )),\n1\nZ =\u03c1\u2217Z +Sqrt(1\u2212r2)\u2217Norm.S.Inv(Rand( ))\n2 1\nI n this particular simulation, Jacob leaves $906,029 for his heirs. Using the\ntechnique of running a data table on a blank cell (see Chapter 31), we can run\n637 Generating and Using Random Numbers\nM N O\n17 Simulation 906,029<-- =B13, data table header\n18 1 -356,743\n19 2 351,558\n20 3 1,886,149\n21 4 387,357\n22 5 1,683,477\n23 6 390,121\n24 7 281,914\n25 8 576,245\n26 9 7,151,210\n27 10 1,251,162\n28 11 845,362\n29 12 3,731,611\n30 13 -461,524\n31 14 4,928,934\n32 15 2,700,700\n33 16 368,321\n34 17 3,127,197\n35 18 3,417,390\n36 19 2,707,635\n37 20 421,627\n38\n39 Average 1,769,485<-- =AVERAGE(N18:N37)\n40 Sigma 1,959,905<-- =STDEV(N18:N37)\n41 Min -461,524<-- =MIN(N18:N37)\n42 Max 7,151,210<-- =MAX(N18:N37)\n43 Negative 2<-- =COUNTIF(N18:N37,\"<0\")\nO n average, Jacob\u2019 s heirs should do pretty well. But in 2 out of the 20 simu-\nlations, his heirs will be left intestate. They might also use Data Table to check\n638 Chapter 24\nM N O P Q R\n=B13\n15 data table header\n16 Correlation \u2193\n17 -0.80 -0.4 0.00 0.4 0.80\n18 1 -9,208,659 3,170,554 3,203,382 3,785,735 2,667,905\n19 2 1,282,980 2,430,952 -353,824 2,204,197 2,726,465\n20 3 7,963,118 -1,818,111 3,361,649 1,680,969 6,282,248\n21 4 276,651 -2,947,014 14,337,774 1,784,993 6,879,205\n22 5 -1,780,692 2,250,315 4,456,252 2,403,919 -913,402\n23 6 3,067,479 -630,263 10,037,217 1,280,899 1,664,357\n24 7 1,435,592 718,311 1,827,268 2,261,576 1,863,233\n25 8 3,627,215 6,871,791 13,387,080 373,271 3,786,064\n26 9 5,751,766 -1,122,584 1,320,789 498,684 619,038\n27 10 4,014,473 8,050,127 2,878,871 1,748,100 5,051,896\n28 11 439,089 4,053,251 2,173,128 7,381,844 13,445,269\n29 12 2,562,847 -1,177,750 -1,562,287 5,884,251 2,545,434\n30 13 5,725,661 -700,188 4,704,009 -1,681,796 3,438,369\n31 14 -1,376,916 2,494,968 -3,210,949 2,090,863 1,769,926\n32 15 2,557,209 802,532 3,262,467 5,176,845 646,516\n33 16 -1,891,881 1,662,779 1,818,090 5,548,178 -260,280\n34 17 3,120,033 5,377,046 2,878,251 4,211,705 9,040,059\n35 18 -1,214,800 7,598,180 8,244,721 2,016,503 1,607,321\n36 19 395,636 6,807,371 -272,614 4,129,666 4,852,653\n37 20 14,077,754 3,165,395 12,316 3,868,468 1,012,387\n38\n39 Average 2,041,228 2,352,883 3,625,180 2,832,444 3,436,233\n40 Sigma 4,615,229 3,304,220 4,631,098 2,157,577 3,434,172\n41 Min -9,208,659 -2,947,014 -3,210,949 -1,681,796 -913,402\n42 Max 14,077,754 8,050,127 14,337,774 7,381,844 13,445,269\n43 Negative 5 6 4 1 2\nAs might be expected, in general the higher the negative correlation between\nthe stock market and Jacob \u2019 s expenses, the lower will be the inheritance. This\nmakes sense: With negative correlation, when the stock market goes down,\nexpenses go up (and vice versa)."
        ],
        "24.8": [
            "What is the concept of Cholesky Decomposition in the context of financial modeling?\nWhat are the properties of a random numbers vector in the simulation scenario?\nWhat is the procedure to use the Cholesky Decomposition for producing correlated Normal Simulates?\nWho was Andr\u00e9-Louis Cholesky and what was his contribution to the field of financial modeling?\nWhat is the Cholesky matrix and how is it implemented in the simulation exercise to pre-multiply a random vector?\nWhat is the purpose of using a variance-covariance matrix in the context of Cholesky Decomposition and the simulation?\nWhat is a lower triangular matrix and how it relates to Cholesky Decomposition?\nHow does pressing F9 in the simulation process contribute to the variance-covariance structure?\nWhat is the significance of verifying the mean, variance, and covariance of each of the variables in a financial simulation?\nWhat are the characteristics of a positive-definite matrix and how it should be used in financial modeling exercises?\nWhat does it mean that a square matrix is called upper triangular in the context of financial modeling?\nWhy is an approximation used when calculating the mean of each of the numbers in simulations?\nHow does the procedure of generating four random normals work in a simulation based on Cholesky Decomposition?\nWhy should financial modeling simulations repeat multiple times to check for consistency?\nHow is the Excel Frequency function used in financial simulations to validate results?\nCan variance and covariance of a series of numbers match the variance-covariance matrix exactly or only approximately in a simulation scenario?\nWhat does it mean to \"pre-multiply each vector of such numbers by the Cholesky decomposition L\" in the context of running simulations?\nWhat relevance does the property of a variance-covariance matrix being positive definite and symmetric have in the context of simulations in financial modelling?\nWhat is the use of the NormSInv function in random normal generation for financial modeling simulations?\nHow is the frequency distribution of variables interpreted in a financial simulation scenario?",
            "24.8 Multiple Random Variables with Correlation: The Cholesky Decomposition\n\nWe can also create multiple correlated random simulates by using the\n639 Generating and Using Random Numbers\npositive definite if, for any row vector x , the product x SxT > 0. The variance-\ncovariance matrix for security returns discussed in Chapters 8\u201312,\n\u23a1\u03c3 \u03c3 \u03c3 \u23a4\n11 12 1N\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c3\nS=\u23a2 21 22 2N\u23a5 , is positive definite and symmetric (since \u03c3 =\u03c3 ).\n\u23a2 (cid:2) \u23a5 ij ji\n\u23a2 \u23a5\n\u23a3\u03c3 \u03c3 \u03c3 \u23a6\nN1 N2 NN\nA square matrix is called u pper triangular if it has non-zero entries only on\nthe diagonal and elements above the diagonal. A square matrix is called lower\ntriangular if (you can fill in the blanks).\nT he French mathematician Andr\u00e9-Louis Cholesky (1875\u20131918) proved that\nany symmetric positive-definite matrix S can be written as the product of\na lower-triangular matrix L and its transpose L T . This is the C holesky\ndecomposition .\nExample\nIn the example below cells B2:B5 contain a 4x4 variance-covariance matrix.\nCells B8:D11 contain the Cholesky decomposition of this matrix\u2014a lower-\ntriangular matrix L . Cells B14:D17 multiply L times its transpose: As you can\nsee, the result is to give back the original variance-covariance matrix.\nA B C D E\n1 Variance-covariance matrix, S\n2 0.400 0.030 0.020 0.000\n3 0.030 0.200 0.000 -0.060\n4 0.020 0.000 0.300 0.030\n5 0.000 -0.060 0.030 0.100\n6\n7 Cholesky decomposi(cid:4)on, L\n8 0.632 0.000 0.000 0.000<-- {=cholesky(A2:D5)}\n9 0.047 0.445 0.000 0.000\n10 0.032 -0.003 0.547 0.000\n11 0.000 -0.135 0.054 0.281\n12\nCheck: Mul(cid:4)ply above matrix by its\n13 transpose\n14 0.400 0.030 0.020 0.000<-- {=MMULT(A8:D11,TRANSPOSE(A8:D11))}\n15 0.030 0.200 0.000 -0.060\n16 0.020 0.000 0.300 0.030\n640 Chapter 24\nThe function Cholesky can be found on the disk that accompanies Financial\nModeling . 10\nUsing the Cholesky Decomposition to Produce Correlated Normal Simulates\n\u23a1\u03c3 \u03c3 \u03c3 \u03c3 \u23a4\n11 12 13 14\n\u23a2 \u23a5\u23a5\n\u03c3 \u03c3 \u03c3 \u03c3\nWe start off with a varcov matrix S=\u23a2 21 22 23 24\u23a5 . We want to run\n\u23a2\u03c3 \u03c3 \u03c3 \u03c3 \u23a5\n\u23a2 31 32 33 34\u23a5\n\u23a3\u03c3 \u03c3 \u03c3 \u03c3 \u23a6\n41 42 43 44\n\u23a7x \u23ab\n1t\n\u23aa \u23aa\n\u23aax \u23aa\na simulation which in each iteration produces a vector \u23a8 2t\u23ac of four random\n\u23aax \u23aa\n3t\n\u23aa \u23aa\n\u23a9x \u23ad\n4t\nnumbers, so that these numbers have the following properties:\n\u2022 The mean of each of the numbers is zero:\n1\u2211n\nx \u22480 . (Because of\nit\nn\nt=1\nrandomness, we can never demand exact equality to zero, only an\napproximation.)\n\u2022 The variance of each series of numbers matches the varcov matrix:\nVar{\nx ,x ,x\n,\u2026}\u2248\u03c3\n11 12 13 11\nVar{\nx ,x ,x\n,\u2026}\u2248\u03c3\n21 22 23 22\n\u2026\n\u2022 The covariance of any two of the series of numbers matches the covariance\nin the varcov matrix:\nCov{( x ,x ,x ,\u2026) ,( x ,x ,x ,\u2026)}\u2248\u03c3 =\u03c3\n11 12 13 21 22 23 21 12\netc.\nThe way to do this is in two steps:\n1. Produce a set of normally distributed numbers between 0 and 1.\n2 . P re-multiply each vector of such numbers by the Cholesky decomposition L .\n1 0. M y thanks to Antoine Jacquier, who posted this on Wilmott.com and has allowed me to use\n641 Generating and Using Random Numbers\nIn the illustration below we show one step of this simulation:\nA B C D E\n1 BASIC MULTIVARIATE NORMAL SIMULATION\n2 Variance-covariance matrix\n3 0.40 0.03 0.02 0.01\n4 0.03 0.30 0.00 -0.06\n5 0.02 0.00 0.20 0.03\n6 0.01 -0.06 0.03 0.10\n7\n8 Cholesky decomposition\n9 0.6325 0.0000 0.0000 0.0000<-- {=cholesky(varcov)}\n10 0.0474 0.5457 0.0000 0.0000\n11 0.0316 -0.0027 0.4461 0.0000\n12 0.0158 -0.1113 0.0654 0.2882\n13\n14 Generating four random normals\n15 -1.3212<-- =NORMSINV(RAND())\n16 -1.1972<-- =NORMSINV(RAND())\n17 0.9280<-- =NORMSINV(RAND())\n18 2.2751<-- =NORMSINV(RAND())\n19\n20 Generating multinomial normal output\n21 -0.83560<-- {=MMULT($A$9:$D$12,A15:A18)}\n22 -0.71594\n23 0.37547\n24 0.82886\nIn cells A15:A18 we use NormSInv and R and to produce four random\nnumbers, each of which is normally distributed with mean zero and standard\ndeviation 1. 11 In cells B21:B24 we pre-multiply this random vector by the\nCholesky matrix in cells A9:D12. The claim is that the numbers in A21:A24\nare normally distributed with mean zero and the variance-covariance structure\ngiven by the varcov matrix. We cannot, of course, prove this claim from a\nsingle simulation. In the following spreadsheet we replicate the above proce-\ndure 220 times:\n642 Chapter 24\nA B C D E F\n1 BASIC MULTIVARIATE NORMAL SIMULATION\n2 Variance-covariance matrix\n3 0.40 0.03 0.02 0.01\n4 0.03 0.30 0.00 -0.06\n5 0.02 0.00 0.30 0.03\n6 0.01 -0.06 0.03 0.10\n7\n8 Cholesky decomposition\n9 0.6325 0.0000 0.0000 0.0000<-- {=cholesky(varcov)}\n10 0.0474 0.5457 0.0000 0.0000\n11 0.0316 -0.0027 0.5468 0.0000\n12 0.0158 -0.1113 0.0534 0.2907\n13\n14 Generating four random normals\n15 -1.1066 0.0427 0.5522 -0.1607 1.1747 -0.6570\n16 1.3488 0.0973 -0.1789 -0.1380 -0.6901 -0.7721\n17 0.6291 -0.6040 -0.1421 -0.7268 -1.6977 0.7685\n18 0.6768 -2.2200 -0.7643 0.4689 -0.7651 -0.5160\n19\n20 Generating multinomial normal output\n21 -0.69990 0.02701 0.34925 -0.10164 0.74294 -0.41553\n22 0.68351 0.05513 -0.07144 -0.08293 -0.32083 -0.45250\n23 0.30529 -0.32919 -0.05973 -0.40212 -0.88924 0.40158\n24 0.06268 -0.68775 -0.20112 0.11033 -0.21766 -0.03338\n25\n26 Checking\nNumber of\n27 simulations 220<-- =COUNT(15:15)\n28\n29 Mean1 0.05502<-- =AVERAGE(21:21)\n30 Mean2 0.02662<-- =AVERAGE(22:22)\n31 Mean3 0.07392<-- =AVERAGE(23:23)\n32 Mean4 -0.02130<-- =AVERAGE(24:24)\n33\nFrom varcov From\n34 matrix simulation\n35 Var1 0.40 0.3658<-- =VAR.P(21:21,21:21)\n36 Var2 0.30 0.2508<-- =VAR.P(22:22,22:22)\n37 Var3 0.30 0.2997<-- =VAR.P(23:23,23:23)\n38 Var4 0.10 0.0824<-- =VAR.P(24:24,24:24)\n39\n40 Covar(1,2) 0.03 0.0318<-- =COVARIANCE.P($21:$21,22:22)\n41 Covar(1,3) 0.02 0.0198<-- =COVARIANCE.P($21:$21,23:23)\n42 Covar(1,4) 0.01 0.0158<-- =COVARIANCE.P($21:$21,24:24)\n43\n44 Covar(2,3) 0.00 0.0095<-- =COVARIANCE.P($22:$22,23:23)\n45 Covar(2,4) -0.06 -0.0419<-- =COVARIANCE.P($22:$22,24:24)\n46\n643 Generating and Using Random Numbers\nI n rows 29\u2013 47 we check the mean, variance, and covariance of each of the\nvariables, comparing them to zero (in the case of the means) and to the data\nin the varcov matrix. By pressing F9 , you can repeat the simulations and\nconvince yourself that we have indeed produced a set of multivariate normal\nsimulations corresponding to the target variance-covariance structure.\nHere, for example, is the result of another press of F9 :\nA B C D E F\n26 Checking\nNumber of\n27 simulations 220 <-- =COUNT(15:15)\n28\n29 Mean1 0.05387 <-- =AVERAGE(21:21)\n30 Mean2 0.02040 <-- =AVERAGE(22:22)\n31 Mean3 -0.05087 <-- =AVERAGE(23:23)\n32 Mean4 -0.03520 <-- =AVERAGE(24:24)\n33\nFrom varcov From\n34 matrix simulation\n35 Variable1 0.40 0.3767 <-- =VAR.P(21:21,21:21)\n36 Variable2 0.30 0.2587 <-- =VAR.P(22:22,22:22)\n37 Variable3 0.30 0.2655 <-- =VAR.P(23:23,23:23)\n38 Variable4 0.10 0.1131 <-- =VAR.P(24:24,24:24)\n39\n40 Covar(1,2) 0.03 0.0107 <-- =COVARIANCE.P($21:$21,22:22)\n41 Covar(1,3) 0.02 0.0016 <-- =COVARIANCE.P($21:$21,23:23)\n42 Covar(1,4) 0.01 -0.0106 <-- =COVARIANCE.P($21:$21,24:24)\n43\n44 Covar(2,3) 0.00 0.0029 <-- =COVARIANCE.P($22:$22,23:23)\n45 Covar(2,4) -0.06 -0.0692 <-- =COVARIANCE.P($22:$22,24:24)\n46\n644 Chapter 24\nDo You Need Further Convincing?\nA nother way to convince yourself that we have done something sensible is to\nplot the frequency distribution of each of the variables, using the Excel F re-\nquency function:\nA B C D E F G H\n50 Frequency distributions\n51 Variable1 Variable2 Variable3 Variable4\n52 -3.0 0 0 0 0<-- {=FREQUENCY(24:24,$A$52:$A$82)}\n53 -2.8 0 0 0 0\n54 -2.6 0 0 0 0\n55 -2.4 0 0 0 0\n56 -2.2 0 0 0 500\n57 -2.0 0 0 0 0\n58 -1.8 0 1 0 400\n59 -1.6 0 0 1 0\n60 -1.4 1 1 1 0\n61 -1.2 3 3 3 300\n62 -1.0 8 8 5 0\n63 -0.8 8 8 6 201\n64 -0.6 16 12 13 4\n65 -0.4 18 20 26 22\n66 -0.2 31 31 14 10 40\n67 0.0 24 31 46 47\n68 0.2 21 28 24 045\n69 0.4 31 -4.0 28-3.0 -2.0 23 -1.0 360.0 1.0 2.0 3.0 4.0\n70 0.6 21 20 27 18\n-10\n71 0.8 19 11 12 5\n72 1.0 7 10 11 1\n73 1.2 6 5 5 1\n74 1.4 3 3 1 0\n75 1.6 3 0 1 0\n76 1.8 0 0 1 0\n77 2.0 0 0 0 0\n78 2.2 0 0 0 0\n79 2.4 0 0 0 0\n80 2.6 0 0 0 0\n81 2.8 0 0 0 0\n82 3.0 0 0 0 0\nNote : Simulations are tricky! Press F 9 multiple times to get different fre-\n645 Generating and Using Random Numbers\nFrequency Frequency\nDistribu(cid:4)on Distribu(cid:4)on\nFrequency Frequency\nDistribu(cid:4)on Distribu(cid:4)on\nFigure 24.2\nF our frequency distributions of random normals using the Cholesky decomposition. They all look\n\u201capproximately\u201d normal, but they don\u2019 t correspond to the \u201ctextbook\u201d shapes that we\u2019 r e used to\n646 Chapter 24"
        ],
        "24.9": [
            "What is the multivariate normal with non-zero means in the context of financial modeling?\nWhat is the significance of asset returns in financial modeling?\nHow does one create multivariate simulations with desired returns?\nWhat is variance-covariance matrix returns?\nWhat does Cholesky decomposition signify in a financial model?\nCan you describe how to generate a multinomial normal output with desired means?\nWhat is the significance of calculating the statistics of a simulation in financial modeling?\nWhat is the procedure to check or verify the accuracy of a financial model's simulation?\nHow do we calculate the target average of simulation in a financial model?\nWhat is the significance of variances computed from a varcov matrix and simulation in financial modeling?\nWhat does Covar signify in a financial model?\nHow are asset means computed from historical returns in finance?\nWhat is the concept of \"hitting\" targets in financial modeling?\nWhy is it difficult to hit the means than the variances in terms of \u201chitting\u201d targets?\nCan you explain the significance of covariances in the context of financial modeling?\nWhat does stationary distribution mean in financial modeling?\nCan you explain why a small sample is unlikely to get close to the actual mean of the distribution?",
            "24.9 Multivariate Normal with Non-Zero Means\n\nBelow we illustrate the case where the asset returns (given in F3:F6) are non-\nzero. To create multivariate simulations with the desired returns, we simply\nadd the target means to the multivariate simulations in rows 21\u201324:\nA B C D E F G H I\n1 MULTIVARIATE SIMULATION WITH NON-ZERO MEANS\nMean\n2 Variance-covariance matrix returns\n3 0.40 0.03 0.02 0.01 5%\n4 0.03 0.30 0.00 -0.06 6%\n5 0.02 0.00 0.20 0.03 7%\n6 0.01 -0.06 0.03 0.10 8%\n7\n8 Cholesky decomposition Cells B21:B25 contain the formula\n9 0.6325 0.0000 0.0000 0.0000<-- {=cholesky(varcov)} =NORMSINV(RAND())\n10 0.0474 0.5457 0.0000 0.0000\n11 0.0316 -0.0027 0.4461 0.0000 Cells B21:B25 contain the formula\n12 0.0158 -0.1113 0.0654 0.2882 {=MMULT($A$9:$D$12,B15:B18)+$F$3:$\n13 F$6}\n14 Generating four standard random normals\n15 0.5556 1.1031 0.3987 -0.3293 1.6139 0.2647 -0.2145 -0.5983 -0.2059\n16 -0.7991 0.3031 0.2735 -1.1220 0.7048 1.2862 0.7759 0.0811 -0.5260\n17 0.1769 0.4273 -1.5465 0.9186 -0.3287 -1.0359 0.0249 1.3598 0.2827\n18 -0.0305 -0.7747 0.5205 -0.8122 -1.1149 -0.9038 -0.7232 -1.7548 -0.1096\n19\n20 Generating multinomial normal output with desired means\n21 0.40140 0.74765 0.30216 -0.15825 1.07073 0.21740 -0.08569 -0.32840 -0.08025\n22 -0.34970 0.27770 0.22813 -0.56783 0.52115 0.77440 0.47319 0.07586 -0.23677\n23 0.16867 0.29466 -0.60802 0.47245 -0.02755 -0.38728 0.07221 0.65745 0.19103\n647 Generating and Using Random Numbers\nTo confirm that this works, we compute the statistics of the simulation:\nA B C D E\n26 Checking\nNumber of\n27 simulations 220<-- =COUNT(15:15)\n28\n29\nTarget Average of\n30 mean simulation\n31 Mean1 0.05 0.0093<-- =AVERAGE(21:21)\n32 Mean2 0.06 0.0512<-- =AVERAGE(22:22)\n33 Mean3 0.07 0.0618<-- =AVERAGE(23:23)\n34 Mean4 0.08 0.0884<-- =AVERAGE(24:24)\n35\nFrom varcov From\n36 matrix simulation\n37 Var1 0.40 0.3502<-- =VARP(21:21,21:21)\n38 Var2 0.30 0.2641<-- =VARP(22:22,22:22)\n39 Var3 0.20 0.2205<-- =VARP(23:23,23:23)\n40 Var4 0.10 0.0897<-- =VARP(24:24,24:24)\n41\n42 Covar(1,2) 0.03 0.0096<-- =COVAR(21:21,22:22)\n43 Covar(1,3) 0.02 0.0076<-- =COVAR(21:21,23:23)\n44 Covar(1,4) 0.01 -0.0002<-- =COVAR(21:21,24:24)\n45\n46 Covar(2,3) 0.00 0.0151<-- =COVAR(22:22,23:23)\n47 Covar(2,4) -0.06 -0.0502<-- =COVAR(22:22,24:24)\n48\n49 Covar(3,4) 0.03 0.0332<-- =COVAR(23:23,24:24)\nT he average (cells C31:C34) can be depressingly far from the desired\ntargets! It takes a lot of simulated data to get close to the targets.1 2\n1 2. I n the sense of \u201chitting\u201d targets\u2014it is much more difficult to hit the means than to hit the\nvariances. This sentence has an almost metaphysical meaning: When we compute asset means\nfrom historical returns\u2014even if all the returns are drawn from a stationary distribution (i.e., with\nunchanging means, variances, and covariances), we are very unlikely in a small sample to get\nclose to the actual mean of the distribution. On the other hand, we are much more likely to be\n648 Chapter 24"
        ],
        "24.10": [
            "What is a multivariate uniform simulation in financial modeling?\nWhat does the function Norm.S.Dist in financial modeling signify?\nHow to simulate uniform distributions using correlated normal distributions?\nWhat is the significance of variance-covariance matrix in generating multivariate uniform simulations?\nWhat does the cholesky decomposition mean in the context of financial modeling?\nHow is the multinomial normal output generated in a multivariate uniform simulation?\nWhat is the significance of generating uniform variates as part of a multivariate uniform simulation?\nHow is the mean and variance calculated in the context of multivariate uniform simulations?\nWhat does the function NORM.S.DIST in financial modeling represent?\nHow are the statistics for simulated uniform variates calculated in financial modeling?\nWhat role does sample covariance matrix play in multivariate uniform simulations?\nWhy is it difficult to match covariances, especially with very large samples in financial modeling?\nWhat is the correlation structure in the context of multivariate uniform simulations and how is it matched?\nWhat is the significance of frequency distribution in multivariate uniform simulations?\nWhat is the role of sample stats in multivariate uniform simulations?",
            "24.10 Multivariate Uniform Simulations\n\nO nce we have simulated correlated normal distributions, we can easily simu-\nlate uniform distributions by using Norm.S.Dist . In the example below, we\nfirst create (in rows 15\u201318) four series of correlated standard normal\ndeviates.\nA B C D E F G H\n1 BASIC MULTIVARIATE UNIFORM SIMULATION\n2 Variance-covariance matrix\n3 1.00 0.03 0.02 0.01\n4 0.03 1.00 0.00 -0.06\n5 0.02 0.00 1.00 0.03\n6 0.01 -0.06 0.03 1.00\n7\n8 Cholesky decomposition\n9 1.0000 0.0000 0.0000 0.0000<-- {=cholesky(varcov)}\n10 0.0300 0.9995 0.0000 0.0000\n11 0.0200 -0.0006 0.9998 0.0000\n12 0.0100 -0.0603 0.0298 0.9977\n13\n14 Generating multinomial normal output\n15 -0.95450 0.52393 -0.01498 0.45889 0.47207 -0.78706 0.81113 1.13469\n16 0.08893 -2.06744 -0.36949 -0.33538 -1.35352 -0.12097 1.10413 1.46068\n17 0.15682 1.89231 -1.66563 0.28293 -0.72093 -0.21203 1.04269 0.00869\n18 -0.06897 1.13988 0.16480 -0.21954 -0.95462 1.18325 0.61655 -1.82526\n19\n20 How many? 390<-- =COUNT(15:15)\n21\n22 Mean Variance Theoretical Skewness Kurtosis\n23 -0.1087 <-- 0.9225 1.0000 0.3156 0.0319<-- =KURT(15:15)\n24 -0.0892 =AVERAGE(15:1 0.9923 1.0000 0.1090 0.2091<-- =KURT(16:16)\n25 -0.0217 5) 1.0732 1.0000 0.0607 0.7864\n649 Generating and Using Random Numbers\nWe now generate uniform variates by applying N orm.S.Dist to the normal\nvariates as shown below:\nA B C D E F G H\n14 Generating multinomial normal output\n15 1.60155 0.35557 1.03640 0.00638 0.26480 -0.87386 0.07279 0.68435\n16 -0.60257 1.26064 0.66585 -0.75586 -1.16279 -0.38719 0.75299 -1.76904\n17 -0.41759 -2.21796 0.16184 0.02274 0.57614 -0.67249 -0.05777 0.35109\n18 0.14609 -0.29084 -1.33622 0.69459 1.61119 0.83252 -0.05966 1.73705\n19\n20 How many? 390<-- =COUNT(15:15)\n21\n22 Mean Variance Theoretical Skew Kurt\n23 0.0239 <-- 1.0822 1.0000 0.1665 -0.0117<-- =KURT(15:15)\n24 -0.0782=AVERAGE(15:1 0.9986 1.0000 -0.0257 -0.1524<-- =KURT(16:16)\n25 -0.0075 5) 0.8513 1.0000 -0.1257 0.0361\n26 0.0195 0.9418 1.0000 -0.0408 0.1898\n27\n28 Generating multinomial uniform output =NORM.S.DIST(D15,1)\n29 0.9454 0.6389 0.8500 0.5025 0.6044 0.1911 0.5290 0.7531\n30 0.2734 0.8963 0.7472 0.2249 0.1225 0.3493 0.7743 0.0384\n31 0.3381 0.0133 0.5643 0.5091 0.7177 0.2506 0.4770 0.6372\n32 0.5581 0.3856 0.0907 0.7563 0.9464 0.7974 0.4762 0.9588\nThe statistics for the simulated uniform variates are given below.1 3\n650 Chapter 24\nA B C D E\n28 Generating multinomial uniform output =NORM.S.DIST(D15,1)\n29 0.0977 0.7258 0.2044 0.2876 0.8485\n30 0.7253 0.5784 0.6019 0.8022 0.3373\n31 0.0684 0.1728 0.1179 0.9484 0.2947\n32 0.7104 0.3940 0.8212 0.8544 0.6659\n33\nSample stats\n34 rows 29-32 Theoretical\n35 Mean 0.4992 0.5000\n36 Variance 0.0830 0.0833\n37 Sigma 0.2880 0.2887\n38 Max 0.9998\n39 Min 0.0000\n40 Corr(1,2) 0.0650 0.0300\n41 Corr(1,3) 0.0908 0.0200\n42 Corr(1,4) -0.0015 0.0100\n43 Corr(2,3) -0.0593 0.0000\n44 Corr(2,4) -0.0656 -0.0600\n45 Corr(3,4) -0.0151 0.0300\n46\n47 Sample covariance matrix\n48 0.0766 0.0053 0.0073 -0.0001\n49 0.0053 0.0857 -0.0051 -0.0056\n50 0.0073 -0.0051 0.0848 -0.0013\n51 -0.0001 -0.0056 -0.0013 0.0842\nNote that without very large samples it is extremely difficult to match\ncovariances. But a number of hits on F9 might convince you that we have\nindeed matched the desired correlation structure.\nFinally, a very simple test: what \u2019 s the frequency distribution of rows\n651 Generating and Using Random Numbers\nF G H I J K L M\n35 Frequency\n36 Bin\n37 0.05 80 100\n38 0.10 79\n39 0.15 79 90\n40 0.20 75 80\n41 0.25 64\n70\n42 0.30 88\n43 0.35 78 60\n44 0.40 78\n50\n45 0.45 85\n46 0.50 80 40\n47 0.55 75 30\n48 0.60 76\n20\n49 0.65 75\n50 0.70 70 10\n51 0.75 89\n0\n52 0.80 84\n0.00 0.10 0.20 0.30 0.40 0.50 0.60 0.70 0.80 0.90 1.00\n53 0.85 68\n54 0.90 81\n55 0.95 90\n56 1.00 66"
        ],
        "24.11": [
            "What is the use of random numbers in financial engineering?\nCan you explain how random numbers are specifically used in option pricing?\nWhat purpose do the Excel and VBA random-number generators serve in financial modeling?\nWhat techniques can be used to produce normally distributed random numbers?\nCan you explain the significance of normally distributed random numbers in financial modeling?\nWhat is the role of VBA in generating random numbers for financial models? \nCan you describe how Excel's capabilities can be used in generating random numbers for financial modelling?\nWhat is a random-number generator and how is it useful in financial engineering?",
            "24.11 Summary\n\nRandom numbers are widely used in financial engineering, especially in option\npricing. This chapter has introduced you to the Excel and VBA random-\nnumber generators and has shown a number of techniques for producing\nnormally distributed random numbers."
        ]
    },
    "25": {
        "25.1": [
            "What are Monte Carlo methods in finance?\nWhat is the primary purpose of using Monte Carlo methods in the context of financial modeling?\nWhat is the historical origin of Monte Carlo methods?\nIn what kind of situations are Monte Carlo methods typically used in finance?\nHow are Monte Carlo methods used to determine the value of \u03c0 (pi)?\nHow can Monte Carlo methods be used in investment and option strategies?\nWhat makes the Monte Carlo method different than other methods used in physics?\nHow are Monte Carlo methods used to price assets where prices are not readily determined by analytical means?\nWhat are some of the applications of Monte Carlo methods in the field of investment and option strategies?\nHow does the uncertainty surrounding various investment and option strategies get revealed through Monte Carlo methods?\nWhat is the aim when using Monte Carlo methods to give a feel for the uncertainty surrounding an investment strategy?\nWhat is the meaning of Monte Carlo pricing?\nWhat is assumed to be known by a person reading about Monte Carlo methods according to the sub-section?",
            "25.1 Overview\n\n\u201cMonte Carlo\u201d (MC) methods refer to a variety of random simulations used\nto determine the values of parameters. In this introductory chapter to MC\nmethods, we use MC to determine the value of \u03c0 . In subsequent chapters we\nuse MC to gain insight into investment and option strategies. The Monte Carlo\nmethod has its source in physics, where it is often used to determine model\nvalues for which there is no analytical solution. 1 One use of Monte Carlo in\nfinance is similar: Monte Carlo methods use simulation to price assets whose\nprices are not readily determined by analytical means. In short: If there isn \u2019 t\na formula for computing the value of an asset, maybe we can determine its\nvalue with a simulation.\nIn Chapters 27\u201330 we also use Monte Carlo methods to give a feel for the\nuncertainty surrounding various investment and option strategies. When we do\nthis, we are not necessarily interested in the pricing implications of uncer-\ntainty\u2014we want to illustrate what kinds of results can occur from a given\ninvestment strategy in assets whose returns are uncertain.\nIn this chapter we give a layperson \u2019 s introduction to Monte Carlo pricing.2\nWe assume that you have read Chapter 24, which gives an introduction to\nrandom numbers."
        ],
        "25.2": [
            "What are Monte Carlo methods in financial modeling?\nWhat is meant by \"random simulation\" in the context of Monte Carlo methods?\nCan you explain how to use Monte Carlo methods to calculate the value of \u03c0?\nWhat is the area of a unit circle and how is it related to \u03c0?\nHow is the Excel function 'Rand' utilized in Monte Carlo methods?\nWhat is the significance of generating random points with an x component and a y component in Monte Carlo methods?\nWhat is the role of a unit square in Monte Carlo simulations?\nHow can we calculate the probability of a random point being inside a unit circle in Monte Carlo methods?\nHow does counting the relative number of points that fall inside a unit circle help approximate \u03c0/4 in Monte Carlo methods?\nWhat does the function (B8 \u2227 2 + C8 \u2227 2 <= 1) signify in a Monte Carlo simulation?\nWhat is the purpose of Excel functions like 'Count' and 'CountIf' in Monte Carlo methods?\nHow do we determine whether a random number falls inside or outside the unit circle in this method?\nIn the context of Monte Carlo simulations, why is it necessary to generate multiple values for the random number?\nWhat does each cell of an Excel spreadsheet contain in a Monte Carlo simulation and why?\nHow does increasing the number of data points affect the accuracy of the simulated \u03c0 value in a Monte Carlo method?",
            "25.2 Computing \u03c0 Using Monte Carlo\n\nA ll Monte Carlo methods involve random simulation. We illustrate how to use\nMonte Carlo to calculate the value of \u03c0 , a number with which you are presum-\nably familiar.\nHere \u2019s our method: We know that the area of the unit circle (circle with\nradius 1) is \u03c0 . It follows that the area of a quarter circle is \u03c0 /4. We inscribe a\nquarter circle into a unit square, as illustrated below. We then proceed to\n\u201cshoot\u201d random points at the unit square. Each random point has an x com-\nponent and a y component. We generate such points by using the Excel func-\ntion Rand .\n1. Two good websites with introductions to Monte Carlo methods are www.ornl.gov/ \u223c pk7/thesis/\npkthnode19.html and www.puc-rio.br/marco.ind/monte-carlo.html .\n656 Chapter 25\nThe picture below shows the quarter circle inscribed in the unit square and\na single random point, which happened to land inside the circle.\nQuarter Unit Circle\nShowing single random point {rand(),rand()}\n1\n0.9\n0.8\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n0.1\n0\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\nBy pressing F9 in the spreadsheet that accompanies this chapter, you can\ngenerate different values of the random point. In some cases, the point will be\n657 An Introduction to Monte Carlo Methods\nQuarter Unit Circle\nShowing single random point {rand(),rand()}\n1\n0.9\n0.8\n0.7\n0.6\n0.5\n0.4\n0.3\n0.2\n0.1\n0\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\nWe can easily do a calculation of the probability that the point will be inside\nthe circle:\n\u2022 The area of the whole unit circle is \u03c0 * r 2 = \u03c0 . Thus the area of the quarter\nunit circle is \u03c0 /4.\n\u2022 The random point\u2014generated by {Rand( ), Rand( )} \u2014is always inside the\nunit square, whose area is 1.\n\u2022 Thus the probability of the random point being inside the unit circle is\nAreaunitcircle \u03c0/4\n= =\u03c0/4\n658 Chapter 25\nMonte Carlo Computation of \u03c0\nIf we count the relative number of points which fall inside the unit circle, we\nshould approximate \u03c0 /4. Thus\nMonteCarloapproximationof \u03c0\n=4\u2217Relativenumber pointsinsideunittcircle\nNumber pointsinsideunitcircle\n=4\u2217\nTotalnumberof points\nIn the spreadsheet below we generate a list of random numbers (columns B\nand C) and then use a Boolean function to test whether the numbers are in or\nout of the unit circle. In row 8 below, for example, the function = (B8 \u2227 2 + C8 \u2227 2 < = 1)\nreturns TRUE if the sum of the squares of B8 and C8 are less than or equal\nto 1 and 0 otherwise. In cell B2 we use C ount to count the number of total\npoints generated, and CountIf to determine the number of data points which\nfall inside the unit circle.3\n3. All of the functions in this paragraph\u2014Boolean functions, Count, and CountIf \u2014are discussed\n659 An Introduction to Monte Carlo Methods\nA B C D E\nCOMPUTING PI USING MONTE CARLO METHODS\n1 INITIAL EXPERIMENT\n2 Number of data points 30 <-- =COUNT(A:A)\n3 Inside circle 22 <-- =COUNTIF(D:D,TRUE)\n4 Pi? 2.933333333 <-- =B3/B2*4\n5\nEach cell in these columns contains the Excel\n6 function =Rand()\nIn unit\n7 Experiment Random1 Random2 circle?\n8 1 0.93377 0.14390 TRUE <-- =(B8^2+C8^2<=1)\n9 2 0.28866 0.68112 TRUE\n10 3 0.53592 0.60165 TRUE\n11 4 0.38665 0.27952 TRUE\n12 5 0.02396 0.62680 TRUE\n13 6 0.98093 0.02753 TRUE\n14 7 0.57770 0.34427 TRUE\n15 8 0.58922 0.26317 TRUE\n16 9 0.34752 0.77355 TRUE\n17 10 0.96858 0.08618 TRUE\n18 11 0.32394 0.66268 TRUE\n19 12 0.04574 0.69957 TRUE\n20 13 0.53216 0.99862 FALSE\n21 14 0.88861 0.60825 FALSE\n22 15 0.65561 0.39199 TRUE\n23 16 0.79978 0.21315 TRUE\n24 17 0.65605 0.99905 FALSE\n25 18 0.23636 0.95164 TRUE\n26 19 0.75541 0.17700 TRUE\n27 20 0.29197 0.01494 TRUE\n28 21 0.56781 0.40796 TRUE\n29 22 0.25891 0.04545 TRUE\n30 23 0.61585 0.88576 FALSE\n31 24 0.32830 0.43645 TRUE\n32 25 0.52969 0.47640 TRUE\n33 26 0.60362 0.85435 FALSE\n34 27 0.97880 0.20737 FALSE\n35 28 0.62883 0.84034 FALSE\n36 29 0.13787 0.66466 TRUE\n37 30 0.98497 0.36433 FALSE\nEach time we press F9 to recalculate the spreadsheet, we get different values\nfor the = Rand , and hence a different Monte Carlo value for \u03c0 . Here are some\n660 Chapter 25\nA B C D E\nCOMPUTING PI USING MONTE CARLO METHODS\n1 INITIAL EXPERIMENT\n2 Number of data points 30 <-- =COUNT(A:A)\n3 Inside circle 24 <-- =COUNTIF(D:D,TRUE)\n4 Pi? 3.2 <-- =B3/B2*4\n5\nEach cell in these columns contains the Excel\n6 function =Rand()\nIn unit\n7 Experiment Random1 Random2 circle?\n8 1 0.19891 0.21584 TRUE <-- =(B8^2+C8^2<=1)\n9 2 0.60485 0.39918 TRUE\n10 3 0.54090 0.50887 TRUE\n11 4 0.01367 0.82935 TRUE\n12 5 0.29872 0.02460 TRUE\n13 6 0.98014 0.75186 FALSE\n14 7 0.01627 0.34278 TRUE\nPressing F9 again:\nA B C D E\nCOMPUTING PI USING MONTE CARLO METHODS\n1 INITIAL EXPERIMENT\n2 Number of data points 30 <-- =COUNT(A:A)\n3 Inside circle 25 <-- =COUNTIF(D:D,TRUE)\n4 Pi? 3.333333333 <-- =B3/B2*4\n5\nEach cell in these columns contains the Excel\n6 function =Rand()\nIn unit\n7 Experiment Random1 Random2 circle?\n8 1 0.95610 0.35792 FALSE <-- =(B8^2+C8^2<=1)\n9 2 0.65874 0.62250 TRUE\n10 3 0.67164 0.23791 TRUE\n11 4 0.81134 0.46254 TRUE\n12 5 0.06633 0.01178 TRUE\n13 6 0.70038 0.91783 FALSE\n661 An Introduction to Monte Carlo Methods\nNow it \u2019 s clear that the values we get for \u03c0 are experimental, but if we did\nthis for a lot of points we would get closer to the actual value of \u03c0 . In the\nexample below we run our experiment 65,000 times:\nA B C D E\nCOMPUTING PI USING MONTE CARLO METHODS\n1 65000 Iterations\n2 Number of data points 65,000 <-- =COUNT(A:A)\n3 Inside circle 51,071 <-- =COUNTIF(D:D,TRUE)\n4 Pi? 3.142830769 <-- =B3/B2*4\n5\nIn unit\n6 Experiment Random1 Random2 circle?\n7 1 0.03174 0.88023 TRUE <-- =(B7^2+C7^2<=1)\n8 2 0.87070 0.97223 FALSE\n9 3 0.14515 0.65038 TRUE\n10 4 0.39535 0.31017 TRUE\nPressing F9 still gives much more accurate values for \u03c0 . A few more presses\nof F9 produced the following Monte Carlo values for \u03c0 :\n3.150544034,3.144256741,3.139556532,\n3.149872576,3.1382136155,3.132780906\nU sing more data points makes our MC value for \u03c0 more accurate, though none\nof these values is that close to the actual value of \u03c0 . 4"
        ],
        "25.3": [
            "What is a Monte Carlo method in financial modeling?\nWhat is the purpose of a VBA Program in financial modeling?\nWhat is the role of computations in financial modeling?\nWhat does the value of \u03c0 (Pi), correct to 50 digits, signify?\nWho is Srinivasa Ramanujan and what is his contribution to mathematical functions?\nCan you explain the use of the VBA program \"MonteCarlo()\"?\nWhat is the functionality of the \"MonteCarloTimer\" program?\nWhy is it important to compute both the StartTime and the StopTime in Monte Carlo methods?\nWhat does the elapsed time for the computations indicate in financial modeling?\nWhat is the purpose of the MonteCarloTimeRecord program?\nHow does one stop a VBA routine in midstream?\nWhat is the significance of the values of \u03c0 in cell B3 in the context of financial modeling?\nWhat does the \"Number\" cell signify in the MonteCarlo VBA program?\nWhat is the role of the \"Hits\" variable in the VBA program mentioned?\nWhy is the macro \"MonteCarloTimeRecord\" time-consuming?\nWhat is the purpose of recording each iteration of the program?\nWhat happens when a large number of points are recorded using the MonteCarloTimeRecord macro?\nHow is the \"Estimate\" computed in the VBA MontaCarlo program?\nWhat is the significant of the \"StartTime\", \"StopTime\", and \"Elapsed\" cells throughout the VBA programs?\nWhat is the role of [Ctrl] + [Break] when running VBA routines?\nWhat does the cell \"Estimate\" represent in financial modeling computations?",
            "25.3 Writing a VBA Program\n\nThis Monte Carlo business requires some VBA. Here \u2019 s a program:\n4. The actual value of \u03c0 , correct to 50 digits, is 3.1415926535897932384626433832795028841\n971693993751. One of the end-of-chapter problems shows you a quick way of computing this\nvalue using several remarkable functions due to the Indian mathematician Srinivasa Ramanujan\n662 Chapter 25\nSub MonteCarlo()\nn = Range(\u201cNumber\u201d)\nHits = 0\nFor Index = 1 To n\nIf Rnd \u2227 2 + Rnd \u2227 2 < 1 _\nThen Hits = Hits + 1\nNext Index\nRange(\u201cEstimate\u201d) = 4 * Hits / n\nEnd Sub\nThe spreadsheet below shows this program and two other VBA programs.\nThe program MonteCarloTimer computes both the S tartTime and the\nStopTime, so that we can compute the elapsed time for the computations.\nBelow, you can see that 10 million iterations of the program took 4 seconds\non the author \u2019 s Lenovo T420s laptop.\nThe program MonteCarloTimeRecord records each iteration of the\nprogram on the screen. This VBA routine allows you to see how the values of\n\u03c0 in cell B3 develop. You can stop this or any VBA routine in midstream by\npressing [Ctrl] + [Break]. This macro is incredibly time wasteful. It took us\n103 seconds to run 5,000 iterations of the routine (compare this to running the\n663 An Introduction to Monte Carlo Methods\nA B C D E\n1 COMPUTING PI USING VBA\n2 Number of data points 10,000,000<-- This cell called \"Number\" Sub MonteCarlo()\n3 Pi? 3.1414508<-- This cell called \"Estimate\" n = Range(\"Number\")\n4 Hits = 0\n5 For Index = 1 To n\n6 StartTime 10:59:49<-- This cell called \"StartTime\" If Rnd ^ 2 + Rnd ^ 2 < 1 Then Hits = Hits + 1\n7 StopTime 10:59:53<-- This cell called \"StopTime\" Next Index\n8 Elapsed 0:00:04<-- =Stoptime-StartTime Range(\"Estimate\") = 4 * Hits / n\n9 End Sub\n10\n11 Note Sub MonteCarloTime()\n12 [Ctrl]+a runs the macro \"MonteCarlo\" 'Includes timer\n13 [Ctrl]+e runs the macro \"MonteCarloTime\" which also records the time n = Range(\"Number\")\n[Ctrl]+f runs the macro \"MonteCarloTimeRecord\" which records the\nresults as they are generated. For large number of points, this takes a\n14 very long time! Press [Ctrl]+[Break] to stop the macro. Range(\"StartTime\") = Time\n15\n16 n = Range(\"Number\")\n17 Hits = 0\n18 For Index = 1 To n\n19 If Rnd ^ 2 + Rnd ^ 2 < 1 Then Hits = Hits + 1\n20 Next Index\n21 Range(\"Estimate\") = 4 * Hits / n\n22 Range(\"StopTime\") = Time\n23 End Sub\n24\n25 Sub MonteCarloTimeRecord()\n26 'Records everything (takes a long time)\n27 n = Range(\"Number\")\n28 Range(\"StartTime\") = Time\n29 n = Range(\"Number\")\n30 Hits = 0\n31 For Index = 1 To n\n32 Range(\"Number\") = Index\n33 If Rnd ^ 2 + Rnd ^ 2 < 1 Then Hits = Hits + 1\n34 Range(\"Estimate\") = 4 * Hits / Index\n35 Range(\"StopTime\") = Time\n36 Next Index\n37 End Sub"
        ],
        "25.4": [
            "What is a Monte Carlo method in financial modeling?\nWhat problem does the scenario present in relation to investment and retirement?\nWhat is a riskless bond and what does an annual return of 6% indicate?\nWhat does it mean by a risky stock portfolio having an expected log return of 12% and a standard deviation of return of 30%?\nWhat is a spreadsheet used for in financial modeling?\nHow are random numbers with normal distribution generated in financial modeling?\nHow can wealth be divided between risky and riskless investments in an investment portfolio?\nWhat is the term 'safety cushion' referring to in the context of financial investment for retirement?\nWhat does the investor's portfolio being worth at least 3*$150,000 signify in the given scenario?\nWhat are the mechanics of drawdown in financial modeling for retirement planning?\nWhat are some ways to determine the investment and drawdown policy of an endowment?\nAre there analytical solutions to determining simultaneously the investment and the drawdown policy of an endowment?\nHow is a risk-free rate distinguished in a retirement investment scenario?\nWhat does the proportion invested in risky indicates about the investment strategy?\nWhat is the significance of standard deviation of return in a risky investment?\nHow does a safety cushion affect the annual drawdown in retirement planning?",
            "25.4 Another Monte Carlo Problem: Investment and Retirement5\n\nT he problem: You are 65 years old and you have $1,000,000. You are trying\nto decide on a mix of investments: There is a riskless bond with an annual\nreturn of 6% and a risky stock portfolio with an expected log return of\n12% and a standard deviation of return of 30%. Your limitations: You want to\ntake $150,000 out of the account every year and have something left over at\nage 75.\nTo get a better handle on this situation, you plot out a spreadsheet:\n5. The material in the remainder of the chapter anticipates some results of the next several chap-\n664 Chapter 25\nA B C D E F G H I\n1 PLANNING YOUR RETIREMENT\n2 Current wealth 1,000,000\n3 Risk-free rate 6%\n4 Parameters of risky investment\n5 Expected annual return 8%\n6 Standard deviation of return 20%\n7 Proportion invested in risky 70%\n8 Annual drawdown 150,000\n9\nRandom\nWealth at 1+return on Wealth at Left at\nInvested in Invested in number,\nYear beginning risky end of Drawdown end of 10\nrisky bonds normally\n10 of year distributed investment year years\n11 1 1,000,000 700,000 300,000 -0.6530 0.9507 984,011 150,000\n12 2 834,011 583,808 250,203 1.9864 1.6117 1,206,595 150,000\n13 3 1,056,595 739,616 316,978 -0.4627 0.9875 1,066,981 150,000\n14 4 916,981 641,887 275,094 0.3292 1.1570 1,034,774 150,000\n15 5 884,774 619,342 265,432 -0.1634 1.0485 931,203 150,000\n16 6 781,203 546,842 234,361 -0.0306 1.0767 837,625 150,000\n17 7 687,625 481,338 206,288 -1.7297 0.7665 587,982 150,000\n18 8 437,982 306,587 131,395 0.8048 1.2725 529,639 150,000\n19 9 379,639 265,748 113,892 0.5611 1.2119 443,005 150,000\n20 10 293,005 205,104 87,902 -0.0473 1.0731 313,431 150,000 163,431\n21\nNormally distributed random numbers\n=C20*F20+D20*EXP($B$3)\n22 generated by =NORM.S.INV(RAND())\n23\n1+return on risky investment\nWealth at beginning of year =G19-H19\n24 =EXP($B$5+$B$6*E20)\n25\n26\n27 Investment in risky asset =B20*$B$7\nIn this spreadsheet column B shows the wealth at the beginning of every\nyear. The wealth is divided between risky and riskless investments according\nto the proportions in cell B7. The riskless investment earns a continuously\ncompounded return of 6% (meaning: $100 invested in the riskless grows\nto 100*e 6% at the end of the year). The risky part of the investment grows\nby a factor of e \u03bc + \u03c3 * Z = 8e% + 20%* Z , where Z is a random number which is\nnormally distributed with mean 0 and standard deviation 1. As explained in\nChapter 24, one way of generating these numbers is to use the Excel function\nNorm.S.Inv(Rand( )) . With each press of F9 , this function recomputes and\nproduces another normally distributed random number.\nIn the above simulation the investor has money left at the end of the 10-year\nperiod. But it is clear that not every simulation will leave the investor with\nspare cash at the end of year 10. A few presses of F 9 to recalculate the spread-\n665 An Introduction to Monte Carlo Methods\nA B C D E F G H I\n1 PLANNING YOUR RETIREMENT\n2 Current wealth 1,000,000\n3 Riskfree rate 6%\n4 Parameters of risky investment\n5 Expected annual return 8%\n6 Standard deviation of return 20%\n7 Proportion invested in risky 70%\n8 Annual drawdown 150,000\n9\nRandom\nWealth at 1+return on Wealth at Left at\nInvested in Invested in number,\nYear beginning risky end of Drawdown end of 10\nrisky bonds normally\n10 of year distributed investment year years\n11 1 1,000,000 700,000 300,000 0.4850 1.1936 1,154,087 150,000\n12 2 1,004,087 702,861 301,226 1.2441 1.3893 1,296,359 150,000\n13 3 1,146,359 802,451 343,908 1.9765 1.6085 1,655,924 150,000\n14 4 1,505,924 1,054,147 451,777 -0.1250 1.0565 1,593,464 150,000\n15 5 1,443,464 1,010,425 433,039 -0.5280 0.9747 1,444,709 150,000\n16 6 1,294,709 906,296 388,413 -0.2036 1.0401 1,355,033 150,000\n17 7 1,205,033 843,523 361,510 -1.6497 0.7788 1,040,840 150,000\n18 8 890,840 623,588 267,252 0.3517 1.1622 1,008,528 150,000\n19 9 858,528 600,970 257,559 -0.7976 0.9236 828,516 150,000\n20 10 678,516 474,961 203,555 -0.7732 0.9281 656,939 150,000 506,939\n21\nNormally-distributed random numbers\n=C20*F20+D20*EXP($B$3)\n22 generated by =NORM.S.INV(RAND())\n23\n1+return on risky investment\nWealth at beginning of year =G19-H19\n24 =EXP($B$5+$B$6*E20)\n25\n26\n27 Investment in risky asset =B20*$B$7\nWhat interests us is what percentage of the investment-consumption paths\nwill end with a positive remainder? We will use Monte Carlo techniques to\nanswer this question. But before we do, we consider an economic question.\nS hould We Apply the 70% Rule Blindly?\nIn the above simulations we have split our investment between the risky and\nthe riskless investments mechanically. We have also continued to draw down\nfunds irrespective of whether there are funds in the account.\nI n the spreadsheet below we correct this. We assume that the investor defines\na \u201csafety cushion.\u201d The cushion in cell B8 below is 3, which is taken to mean\nthat the annual drawdown is $150,000 if the investor \u2019 s portfolio is worth at\nleast 3*$150,000 at the end of the year. If this is not true, then the investor\n666 Chapter 25\nA B C D E F G H I\nPLANNING YOUR RETIREMENT\nUsing a safety cushion of 3\nInvestor takes 150,000 if end-year wealth > 3*150,000, else takes end-year wealth/3\n1\n2 Current wealth 1,000,000\n3 Riskfree rate 6%\n4 Parameters of risky investment\n5 Expected annual return 8%\n6 Standard deviation of return 20%\n7 Proportion invested in risky 70%\n8 Safety cushion 3\n9 Annual drawdown 150,000\n10\nRandom\nWealth at 1+return on\nInvested in Invested in number, Wealth at Left at end\nYear beginning risky Drawdown\nrisky bonds normally end of year of 10 years\n11 of year distributed investment\n12 1 1,000,000 700,000 300,000 -0.5471 0.9710 998,253 150,000\n13 2 848,253 593,777 254,476 0.4716 1.1904 977,072 150,000\n14 3 827,072 578,950 248,121 -0.8906 0.9065 788,306 150,000\n15 4 638,306 446,814 191,492 0.4212 1.1785 729,907 150,000\n16 5 579,907 405,935 173,972 0.9129 1.3003 712,560 150,000\n17 6 562,560 393,792 168,768 0.0895 1.1029 613,500 150,000\n18 7 463,500 324,450 139,050 -0.3590 1.0082 474,770 150,000\n19 8 324,770 227,339 97,431 -0.9809 0.8903 305,860 101,953\n20 9 203,906 142,734 61,172 -1.1469 0.8612 187,882 62,627\n21 10 125,255 87,678 37,576 -0.2989 1.0204 129,369 43,123 86,246\n22\nNormally-distributed random numbers\n=C21*F21+D21*EXP($B$3)\n23 generated by =NORMSINV(RAND())\n24\n1+return on risky investment\nWealth at beginning of year =G20-H20\n25 =EXP($B$5+$B$6*E21)\n26\nDrawdown calculated as\n27 =IF(G21>$B$8*$B$9,$B$9,G21/$B$8)\n28 Investment in risky asset =B21*$B$7\nMany rules like this can be devised. The problem here\u2014phrased as invest-\nment and payouts over retirement\u2014is substantially the same as that faced by\nany endowment manager struggling with the problem of how to determine\nsimultaneously the investment and the drawdown policy of the endowment.\nAs far as we know there is no analytical solution to this problem, though as\n667 An Introduction to Monte Carlo Methods"
        ],
        "25.5": [
            "What is a Monte Carlo simulation in the context of an investment problem?\nWhat is the technique of \"Data table on a blank cell\" in Excel spreadsheets?\nWhat is a Data Table in an investment simulation spreadsheet?\nWhat is the significance of the \"Column input cell\" in the Data Table dialog box in Excel?\nIn the context of a Monte Carlo Simulation, what does it mean to \"run the simulation 20 times\"?\nWhat is the function of VBA in running Monte Carlo simulations?\nHow is the VBA function SuccessfulRuns used to simulate a defined problem?\nWhat do investment/drawdown trajectories indicate in financial modeling?\nWhat is the significance of a function result in cell B13 in financial simulation using VBA?\nWhat is the relationship between risk-free asset and a risky asset in investment decisions?\nWhat does the mean and standard deviation of return signify in risky investments?\nIn a financial simulation, what does a drawdown of $100,000 per year mean?\nWhat does a successful run signify in a Monte Carlo simulation?\nIn the VBA code, what is the significance of the variables 'Initial', 'Drawdown', 'Interest', 'Mean', 'Sigma', 'PercentRisky', 'Years', and 'Runs'?\nHow does the 'Randomize' function work in VBA?\nWhat is the role of portfolio value in investment simulations? \nWhat does it mean for the portfolio value to finish with positive wealth at the end of 10 years?\nWhat does the 'Exp' function represent in the VBA code?\nIn the VBA code segment, what does Success/Runs represent?",
            "25.5 A Monte Carlo Simulation of the Investment Problem\n\nI n this section we run multiple simulations of the investment problem. The\nfirst set of simulations is run in the Excel spreadsheet itself, using the\ntechnique of \u201cData table on a blank cell\u201d explained in section 31.7. The second\nset of simulations is run in VBA.\nData Table on a Blank Cell\nWe set up a Data Table on the investment simulation spreadsheet. Note that\nthe data table header refers to the bequest in cell I20 and that the Column\ninput cell in the Data Table dialog box refers to an empty cell. This is the\ntechnique explained in section 31.7:\nThere are 20 rows in the Data Table , though only 12 are shown. When we\nselect OK, we run the simulation 20 times. Here is one run and some statistics.\n668 Chapter 25\nK L M N O P Q\n5 Average 227,828 <-- =AVERAGE(L12:L30)\n6 Sigma 401,551 <-- =STDEV.S(L12:L31)\nNegative\n7 bequest 30% <-- =COUNTIF(L12:L31,\"<0\")/COUNT(L12:L31)\n8\n9\nBelow: Data table\n10\n11 Simulation 220,554 <-- =I20, data table header\n12 1 -77,438\n13 2 372,005\n14 3 242,134\n15 4 -94,078\n16 5 754,722\n17 6 145,913\n18 7 -447,953\n19 8 211,791\n20 9 808,196\n21 10 724,259\n22 11 -352,192\n23 12 -136,035\n24 13 263,919\n25 14 106,654\n26 15 809,094\n27 16 378,955\n28 17 -193,356\n29 18 699,718\n30 19 112,415\n31 20 753,354\nRunning the Simulation in VBA\nW e write a VBA function SuccessfulRuns, which simulates the above problem.\nGiven an investment policy, the function S uccessfulRuns determines the per-\ncentage of investment/drawdown trajectories which will leave the retiree with\n669 An Introduction to Monte Carlo Methods\nHere is some output from this function:\nA B C D E\nHOW WELL DO WE DO?\nPERCENTAGE OF POSITIVE OUTCOMES\n1\n2 Current wealth 1,000,000\n3 Riskfree rate 8%\n4 Parameters of risky investment\n5 Expected annual return 10%\n6 Standard deviation of return 40%\n7 Proportion invested in risky 40%\n8 Annual drawdown 100,000\n9 Years of investment 10\n10\n11 Runs 1,000\n12\n13 Successful runs 87.60% <-- =successfulruns(B2,B8,B3,B5,B6,B7,B9,B11)\nThe function result in cell B13 considers a retiree starting with $1 million,\nmaking an investment decision between a risk-free asset with return 7% and\na risky asset with stochastic returns \u03bc = 10% and \u03c3 = 40%, and desiring to\ndraw down $100,000 per year. Simulating 1,000 returns, we determine that in\n87.6% of the cases the investor will finish with positive wealth at the end of\n10 years. Running the function again will, of course, produce different results.\nThe VBA Code for SuccessfulRuns\n670 Chapter 25\nFunction SuccessfulRuns(Initial, _\nDrawdown, Interest, Mean, Sigma, _\nPercentRisky, Years, Runs)\nDim PortfolioValue() As Double\nReDim PortfolioValue(Years + 1)\nDim Success As Integer\nUp = Exp(Mean + Sigma)\nDown = Exp(Mean - Sigma)\nPiUp = (Exp(Interest) - Down) / (Up - Down)\nPiDown = 1 - PiUp\nFor Index = 1 To Runs\nFor j = 1 To Years\nRandomize\nPortfolioValue(0) = Initial\nIf Rnd > PiDown Then\nPortfolioValue(j) = _\nPortfolioValue(j - 1) * _\nPercentRisky * Up + PortfolioValue(j - 1) _\n* (1 - PercentRisky) * _\nExp(Interest) - Drawdown\nElse\nPortfolioValue(j) = PortfolioValue(j - 1) * _\nPercentRisky * Down + PortfolioValue(j - 1) _\n* (1 - PercentRisky) * Exp(Interest) _\n- Drawdown\n671 An Introduction to Monte Carlo Methods\nNext j\nIf PortfolioValue(Years) > 0 _\nThen Success = Success + 1\nNext Index\nSuccessfulRuns = Success / Runs\nEnd Function"
        ],
        "25.6": [
            "What are Monte Carlo methods in the context of financial modeling?\nCan you illustrate the use of Monte Carlo methods with an investment example?\nWhen should Monte Carlo methods be avoided in determining the value of a function or procedure?\nIn what scenarios is the usage of Monte Carlo methods to approximate a value to be considered?\nHow can Monte Carlo methods be used to glean insights into the meaning of asset return uncertainty?\nWhy is Monte Carlo not an effective methodology to compute the value of \u03c0?\nWhat are some examples of functions or procedures where Monte Carlo methods can be effectively utilized?\nHow do Monte Carlo methods contribute to handling valuation problems in investment scenarios? \nWhat do Monte Carlo methods offer in terms of accuracy when approximating the value of a function or procedure without a closed-form solution?",
            "25.6 Summary\n\nM onte Carlo methods are experimental techniques for determining the numeri-\ncal value of a function or a procedure. In this chapter we have used the example\nof \u03c0 to illustrate how Monte Carlo might be applied. As a valuation tool, MC\nmethods are to be avoided when there is another, closed-form, way of deter-\nmining the value. As we illustrate in exercises to this chapter, MC is not a\ngood way to compute the value of \u03c0 , given that many excellent formulas exist\nthat approximate \u03c0 with great accuracy. In cases where this is not true, however,\nyou can use Monte Carlo to approximate the value.\nMonte Carlo methods can also be used to simulate investment problems in\norder to gain insight into the meaning of asset return uncertainty. In this\nchapter we illustrated this with some investment examples."
        ]
    },
    "26": {
        "26.1": [
            "What is the Monte Carlo approach to asset pricing?\nWhat are some possible questions one may hope to answer by simulating asset prices?\nWhat does a positive pension bequest imply in the context of a given savings/spending pattern over time?\nWhat can be achieved through a discretely updated portfolio approach to option replication?\nCan you explain how we can price options whose terminal prices depend on the price path of an asset?\nWhat are the distributional properties assumptions for stock prices in standard finance?\nWhat is the meaning of stock prices being lognormally distributed?\nWhat does it mean that stock returns are normally distributed?\nHow can the concept of stock prices being lognormally distributed be simulated in Excel?\nWhat was our previous discussion about option pricing in relation to the Monte Carlo approach?\nWhat is the assumption regarding the development of a stock price over time in a binomial model?\nWhat does the Black-Scholes model assumes about stock prices?\nHow is the binomial model equivalent to the assumption of lognormality?\nWhat does the lognormality of prices signify in financial modeling?\nWhat is the rationale behind considering lognormal distribution as a reasonable distribution for stock prices?\nCan you explain the process of simulating lognormal price paths?\nWhat are the parameters of a lognormal distribution and how are they derived?",
            "26.1 Overview\n\nT he Monte Carlo approach to asset pricing is based on the simulation of asset\nprices. By simulating asset prices, we hope to answer questions relating to the\ninvestment outcomes such as:\n\u2022 W hat is the probability that a given savings/spending pattern over time will\nenable a positive pension bequest?\n\u2022 What is the likelihood that a discretely updated portfolio approach to option\nreplication will successfully duplicate the option outcome?\n\u2022 H ow can we price options whose terminal prices depend on the price path\nof an asset?\nI n order to simulate prices, we must have some assumptions about the dis-\ntributional properties of stock prices. The standard finance assumption is that\nstock prices are lognormally distributed or, equivalently, that stock returns are\nnormally distributed. In this chapter we give meaning to these two statements\nand show how they can be simulated in Excel. Subsequent chapters of Section\nV apply these concepts to the modeling of investments and options.\nWe have touched on this topic in our discussion of option pricing. In Chapter\n16 we discussed the assumption that the development of a stock price over\ntime follows a binomial model. We return to the binomial model in Chapter\n30, where we use it to show Monte Carlo price-path-dependent options. In\nChapter 17, we showed that the Black-Scholes model uses the assumption that\nstock prices are lognormally distributed. On a deeper level, we showed numeri-\ncally in section 16.7 that the binomial model is in the limit equivalent to the\nassumption of lognormality. We did this by showing that the limiting price of\na binomial option pricing model is the Black-Scholes price.\nThis chapter focuses on the lognormality of prices and shows how this\nassumption can be simulated. The structure of the chapter is as follows:\n\u2022 W e start with a discussion of what constitutes \u201creasonable\u201d assumptions\nabout stock prices.\n\u2022 We then discuss why the lognormal distribution is a reasonable distribution\nfor stock prices.\n\u2022 Next, we show how to simulate lognormal price paths.\n\u2022 F inally, we show you how to derive the parameters of the lognormal\ndistribution\u2014the mean and standard deviation of the stock returns\u2014from\n676 Chapter 26"
        ],
        "26.2": [
            "What are reasonable assumptions about the behavior of stock prices over time?\nWhat defines the distribution of a stock price?\nWhat are the five reasonable statistical properties of a stock price?\nHow is the continuity of changes in a stock\u2019s price defined?\nWhy does the price of a 'dead' company stock become zero?\nWhat does it mean that the average return from holding a stock tends to increase over time?\nWhy does the uncertainty associated with the return from holding a stock increase the longer the stock is held?\nHow does variance of the stock price change over time?\nWhat can the five reasonable properties of stock prices tell us about price paths?\nWhat does a stock price path look like?\nWhat are the implications of simulating stock price paths using the lognormal model?\nWhat does it mean to have wiggly lines, continuous lines, lines always above zero in a stock price path simulation?\nHow can daily returns on the Standard & Poor\u2019s 500 index be interpreted?\nWhat statistics can be drawn from the daily returns data?\nWhat does the frequency of the returns indicate about the stock behavior?\nHow can Excel be used to make sense of daily returns data?\nHow is the average annual return computed from daily returns using Excel?\nHow is the standard deviation of annual return computed from daily returns using Excel?\nHow can you compute the date on which the maximum and minimum returns occur using Excel?\nHow are the stock returns over a period computed?\nHow are the mean, variance, and standard deviation of the returns computed?\nHow are the annualized returns computed from the periodic returns?",
            "26.2 What Do Stock Prices Look Like?\n\nW hat are reasonable assumptions about the way stock prices behave over time?\nClearly the price of a stock (or any other risky financial asset) is uncertain.\nWhat is its distribution? This is a perplexing question. One way to answer this\nquestion is to ask what are reasonable statistical properties of a stock price.\nHere are five reasonable properties:\n1 . T he stock price is uncertain. Given the price today, we do not know the\nprice tomorrow.\n2 . C hanges in the stock\u2019 s price are continuous. Over short periods of time,\nchanges in a stock \u2019 s price are very small, and the change goes to zero as the\ntime span goes to zero. 1\n3 . T he stock price is never zero. This property means that we exclude the\nstocks of \u201cdead\u201d companies.\n4 . T he average return from holding a stock tends to increase over time. Notice\nthe word \u201ctends\u201d: We do not know that holding a stock for a longer time will\nlead to a higher return; however, we expect that holding a risky asset over a\nlonger term will lead to a higher average return.\n5. The uncertainty associated with the return from holding a stock also tends\nto increase the longer the stock is held. Thus, given the stock \u2019 s price today,\nthe variance of the stock price tomorrow is small; however, the price variance\nin 1 month is larger, and the variance in 1 year is larger still.\nReasonable Stock Properties and Stock Price Paths\nOne way of viewing these five \u201creasonable properties\u201d of stock prices is to\nthink about price paths. A stock price path is a graph of a stock price over a\nperiod of time. Here, for example, are the price paths of several stocks:\n1. If you have watched stock prices, you know that continuity is usually not a bad assumption.\nSometimes, however, it can be disastrous (look at the way stock market prices behaved in October\n1987, for a dramatic example of price d iscontinuities ). It is possible to build a stock price model\nthat assumes that prices are usually continuous but have occasional (and random) jumps. See Cox\n677 Simulating Stock Prices\n60\n50\n40\n30\n20\n10\n0\nI f we simulated stock price paths (something we will do using the lognormal\nmodel later in this chapter), how would we expect them to look? Our five\nproperties imply that we would expect:\n1. Wiggly lines.\n2. Lines that are continuous (solid), with no jumps.\n3. Lines that are always positive and never cross zero, no matter how low\nthey get.\n4. That at a given point in time, the average over all plausible lines is greater\nthan the initial price of the stock. The farther out we go, the higher this average\nbecomes.\n5 . T hat the standard deviation over all plausible lines is greater the farther out\nwe go.\nH ere\u2019 s another way of thinking about stock prices. Suppose we take the\ndaily returns on the Standard & Poor\u2019 s 500 index (we only show the start of\nthe data):\nJan-02 Jan-03 Jan-04 Jan-05 Jan-06 Jan-07 Jan-08 Jan-09 Jan-10 Jan-11 Jan-12\nDaily Prices for 3 Stocks\nJanuary 2002-December 2011\n678 Chapter 26\nA B C D\nSP500 DAILY PRICES\n1 1950-2011\n2 Date Price Return\n3 03-01-50 16.66\n4 04-01-50 16.85 1.13%<-- =LN(B4/B3)\n5 05-01-50 16.93 0.47%\n6 06-01-50 16.98 0.29%\n7 09-01-50 17.08 0.59%\n8 10-01-50 17.03 -0.29%\n9 11-01-50 17.09 0.35%\n10 12-01-50 16.76 -1.95%\n11 13-01-50 16.67 -0.54%\n12 16-01-50 16.72 0.30%\n13 17-01-50 16.86 0.83%\n14 18-01-50 16.85 -0.06%\n15 19-01-50 16.87 0.12%\nIf we graph these returns over any given period, we get a mess of dots which\nis difficult to interpret:\nStandard & Poors 500 Daily Returns, 1950-2011\n15%\n10%\n5%\n0%\n-5%\n-10%\n-15%\n-20%\n679 Simulating Stock Prices\nW e have marked the largest daily increase and decline with circles: \u201322.9%\non 19 October 1987 and + 10.96% on 13 October 2008.\nT his smear of dots on a graph is difficult to interpret. Excel can help us\nmake some sense of the data:\nA C D E F G H I\nS&P 500 DAILY PRICES\n1 1950-2011\n2 Date Return\n3 3-Jan-50 Number of daily returns 15,601\n4 4-Jan-50 1.13%<-- =LN(B4/B3) Number of days per year 251.629<-- =G3/62\n5 5-Jan-50 0.47%<-- =LN(B5/B4)\n6 6-Jan-50 0.29%<-- =LN(B6/B5) Max 10.96%13-Oct-08\n7 9-Jan-50 0.59% Min -22.90%19-Oct-87\n8 10-Jan-50 -0.29%\n9 11-Jan-50 0.35% Number of returns between -1% and +1% 12,425<-- =COUNTIFS(C:C,\"<=1%\",C:C,\">=-1%\")\n10 12-Jan-50 -1.95% Average daily return 0.0278%<-- =AVERAGE(C:C)\n11 13-Jan-50 -0.54% Standard deviation of daily return 0.9822%<-- =STDEV.S(C:C)\n12 16-Jan-50 0.30%\n13 17-Jan-50 0.83% Average annual return 7.00%<-- =G4*G10\n14 18-Jan-50 -0.06% Standard deviation of annual return 15.58%<-- =SQRT(G4)*G11\nAnother way to look at the data is to plot the frequency of the returns, using\nExcel \u2019 s Frequency function. The details are on the disk with the book. The\nplot looks approximately normally distributed, though perhaps with some left\nskewness:\nFrequencies of S&P 500 Daily Returns\n1950-2011\n2,000\n1,800\n1,600\n1,400\n1,200\n1,000\n800\n600\n400\n200\n0\n680 Chapter 26\nAn Excel Note\nIn the computations above:\n\u2022 We have used CountIfs to count the number of daily returns between\n\u20131% and + 1%.\n\u2022 We have used the shortcut C:C to indicate all the data in column C.\n\u2022 For the 62 years of data there are 251.629 average business days per\nyear. This number is used to convert the average daily return and stan-\ndard deviation of daily return to annual statistics:\n(cid:4284) Average annual return = (days per year) * (average daily return)\n(cid:4284) Standard deviation of annual return = Sqrt(days per year) * stan-\ndard deviation of daily return\n\u2022 To compute the date on which the max and min returns occur, we use\nthe Excel functions M atch and\n(cid:4284) MATCH(G6,$C$3:$C$15604,0) finds the row in the range\nC3:C15604 in which the value in G6 (the max return) occurs.\n(cid:4284) INDEX($A$3:$A$15604,MATCH(G6,$C$3:$C$15604,0)) finds\nthe value in row MATCH(G6,$C$3:$C$15604,0) in A 3:A15604 .\nThis is the date of the occurrence.\nComputing Returns and Their Distribution for a Continuous\nReturn-Generating Process2\nWe can compute the stock return over a period by taking the natural logarithm\n\u239b Price \u239e\nof the price relatives, defined as ln\u239c t \u239f . Furthermore, if { r , r , \u2026 ,\n\u239d \u23a0 1 2\nPrice\nt\u22121\nr } is a series of periodic returns, we can compute the mean, variance, and\nM\nstandard deviation of the returns as:\n681 Simulating Stock Prices\nPeriodicmean=\u03bc =\n1 \u2211M\nr,\nPeriodic (cid:2)M(cid:4)(cid:3)(cid:3)t=(cid:4)1(cid:5)t\n\u2191\nUse Excel\nAverage\nfunction\nPeriodicvariance=\u03c32 = 1 \u2211M ( r \u2212\u03bc )2\nPeriodic (cid:2)M(cid:4)\u2212 (cid:4)1 t(cid:4)=1(cid:4)(cid:3)t (cid:4)(cid:4)Per (cid:4)iodi (cid:4)c (cid:5)\n\u2191\u2191\nUse Excel\nStdev.s function\nAssuming that there are n periods per year, we can compute the annualized\nreturns by\nAnnualizedmean=n\u2217\u03bc\nPeriodic\nAnnualizedvariance=n\u2217\u03c32\nPeriodic\nAnnnualizedstandarddeviation=\u03c3 n"
        ],
        "26.3": [
            "What does a lognormal price distribution signify in stock prices simulation?\nHow is the lognormal price distribution related to geometric diffusion?\nWhat does the variable 'S' represent in the context of stock price simulation?\nHow is the return from holding a share of stock defined in terms of a lognormal distribution?\nHow can we express the stock price at a later time using the lognormal distribution and rate of return?\nWhat is assumed about the rate of return over a short period in a lognormal distribution?\nHow is a standard normal variable incorporated in the calculation of future stock price?\nWhat does it mean if the standard deviation in the lognormal price process is zero?\nWhat does it signify when the stock price grows exponentially in a lognormal distribution?\nHow does introducing a certain level of risk or uncertainty impact the stock price growth model?\nWhat is the role of standard normal variable 'Z' in simulating lognormal price process?\nCan you explain the process of simulating a stock price at a future point of time using a random number from a standard normal distribution?\nWhat does the lognormal price process represent in terms of a diffusion process?\nWhat is the significance of a Wiener process or \"white noise\" in a geometric diffusion model?\nWhat are \"standard-normal deviates\" in the context of lognormal price distribution?\nHow do you construct a simulated stock price path using the lognormal distribution?\nHow are the certain and uncertain portions of the return calculated in a lognormal distribution?\nWhat is the implication of the variance of the stock's return being linear in time in a lognormal distribution model?\nHow is the daily return calculated in a lognormal distribution model?\nHow would the stock price at a future date be calculated using a lognormal distribution?\nHow does the 'elapsed time interval' and 'average rate of growth' factor into the simulation of stock price growth?",
            "26.3 Lognormal Price Distributions and Geometric Diffusions\n\nIn this section we get a bit more formal and describe what we mean by a\nlognormal price distribution. We then relate the lognormal price process to a\ngeometric diffusion.\nSuppose we denote by S the price at time t of a share of stock. The lognor-\nt\nmal distribution assumes that the natural logarithm of one-plus-the-return\nfrom holding a share of stock between time t and time t + \u0394 t is normally\ndistributed with mean \u03bc and standard deviation \u03c3 . Denote the (uncertain) rate\nof return over an interval \u0394 t by r(cid:2) \u0394t. Then we can write S t+\u0394t =S texp[ r(cid:2) \u0394t\u0394t] .\nIn the lognormal distribution, we assume that the rate of return r(cid:2) over a short\n\u0394t\nperiod \u0394 t is normally distributed with mean\u03bc \u0394 t and variance\u03c3 2 \u0394 t .\nA nother way of writing this relation is to write the stock price S at time\nt + \u0394t\n682 Chapter 26\nS\nt+\u0394t =exp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4\n\u23a6\nS\nt\nwhere Z is a standard normal variable (mean = 0, standard deviation = 1). 3\nTo see what this assumption means, suppose first that \u03c3 = 0. In this case\nwe have\nS =S exp[\u03bc\u0394t]\nt+\u0394t t\nw hich simply says that the stock price grows at an exponential rate with cer-\ntainty. In this case the stock is like a riskless bond that bears interest rate \u03bc ,\ncontinuously compounded.\nNow suppose that \u03c3 > 0. In this case, the lognormal assumption says that,\nalthough the tendency is for the stock price to increase, there is an uncertain\nelement (normally distributed) that must be taken into account. The best way\nto think about this is in terms of a simulation. Suppose, for example, that we\u2019 r e\ntrying to simulate a lognormal price process in which \u03bc = 15%,\u03c3 = 30%, and\n\u0394 t = 0.004. Suppose the price at time 0 isS = 35. To simulate the possible\n0\nstock prices at time \u0394 t we first have to pick (at random) a number Z from a\nstandard normal distribution. 4 Suppose that this number is 0.1165. Then the\nstock price S at time \u0394 t will be\n\u0394 t\nS \u0394t =S 0\u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6\n=35\u2217exp\u23a1 \u23a30.15*0.004+0.3\u22170.1165\u2217 0.004\u23a4\u23a4 \u23a6=35.0985\nOf course we could have drawn a different random number. If, for example,\nour random number Z had been \u20130.9102, then we would have\nS \u0394t =S 0\u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6\n=35\u2217exp\u23a1 \u23a30.15\u22170.004\u22120.3\u2217(\u22120.9102)\u2217 0.0044\u23a4 \u23a6=34.4214\n3. If you know about diffusion processes, then the lognormal price process is a geometric\ndiffusion :\ndS \u239b \u03c32\u239e\n=\u239c\u03bc+ \u239fdt+\u03c3dB , where dB is a Wiener process (\u201cwhite noise\u201d): dB=Z dt , where Z\nS \u239d 2\u23a0\nis a standard random variable.\n683 Simulating Stock Prices\nThis process is illustrated in the spreadsheet picture below, where we generated\na list of 250 numbers picked from a standard-normal distribution (the technical\nnomenclature is \u201cstandard-normal deviates\u201d).5 Each is an equally likely poten-\ntial candidate to be Z . Having picked Z for a particular time interval \u0394 t , the\nprice S follows.\nt + \u0394 t\nA B C D E F G H I\n1 CONCEPTUALIZING THE LOGNORMAL DISTRIBUTION\nNormal Stock\n2 Time deviates price\n3 Mean 15% 0 35.0000<-- =B6\n4 Sigma 30% 1 -1.697499 33.9110<-- =F3*EXP(Mean*deltat+Sigma*SQRT(deltat)*E4)\n5 \u0394t 0.004 2 -1.503086 32.9774\n6 Initial stock price 35 3 0.2900038 33.1792 Simulated Stock Price Path\n7 4 0.7383846 33.6675\n8 5 -0.006387 33.6836 38\n9 6 -0.110343 33.6334 36\n10 7 -0.055375 33.6182 34\n11 8 -0.661842 33.2186 32\n12 9 -0.534442 32.9032 30\n13 10 1.1193083 33.6296\n14 11 -1.182809 32.9030 28\n15 12 0.7687686 33.4065 26\n16 13 -1.071367 32.7540 24\n17 14 0.813543 33.2834 22\n18 15 0.8621168 33.8527 20\n19 16 0.9543328 34.4919 0 25 50 75 100 125 150 175 200 225 250\n20 17 -0.872592 33.9459\nThe spreadsheet uses Data|Data Analysis|Random Number Generation\nto generate a list of 250 standard-normal deviates. The command looks\nlike this:\n5. The number of business days in a year is approximately 250. Thus when we define \u0394 t = 1/250 = 0.004, we\n684 Chapter 26\nTo summarize: In order to simulate the growth of the stock price , when the\nprice follows a lognormal price distribution:\n\u2022 Multiply \u0394 t (the elapsed time interval) by \u03bc (the average rate of growth).\nThis gives the certain portion of the return.\n\u2022 Take a draw Z from a random variable which is standard normal, and then\nmultiply this draw by \u03c3 \u0394t . This gives the uncertain portion of the return.\n(The square root implies that the variance of the stock\u2019 s return is linear in time.\nSee below.)\n\u2022 A dd the two results and exponentiate. The daily return is e xp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6 .\nIf the price on date t is S , then the price on date t + 1 is\nt\nS t+1 =S texp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6 ."
        ],
        "26.4": [
            "What is a lognormal distribution? \nWhat does a normal distribution produce? \nWhat is the implication of simulating end-of-year stock prices? \nWhat method is used to produce an end-of-period stock price? \nWhat does putting stock prices into bins and producing a histogram signify?\nWhat is the purpose of the array function Frequency( ) in financial modeling? \nWhat happens when a simulation is done for a large number of points? \nWhat parameters were used in the trial of 1,000,000 for the frequency distribution in the text?  \nWhat programming language is used to simulate the lognormal distribution in the text? \nWhat is the role of variables like mean, sigma and N in the given VBA program? \nWhat is the purpose of the 'starttime' and 'stoptime' in the given VBA program?\nWhat effect does increasing the number of runs have on the results of the VBA program? \nCan you interpret the lognormal frequency distribution table as given in the text?\nWhat is the purpose of the routine that produces randomly distributed standard-normal deviates? \nWhat part does the standard-normal deviates routine play in financial modeling?",
            "26.4 What Does the Lognormal Distribution Look Like?\n\nW e know that the normal distribution produces a \u201cbell curve.\u201d What about the\nlognormal distribution? In the following experiment we simulate 1,000 random\nend-of-year stock prices. The experiment is a continuation of the experiment\nperformed in the previous section; since we are simulating end-of-year prices,\n685 Simulating Stock Prices\n\u2022 We produce a list of 1,000 normal deviates.\n\u2022 We use each normal deviate to produce an end-of-period stock price\nS =S \u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6=S \u2217exp[\u03bc+\u03c3Z] ,since\u0394t=1\n1 0 0\n\u2022 We put the stock prices into bins and produce a histogram.\nHere \u2019 s what the spreadsheet for this experiment looks like:\nA B C D E F G H I\n1 THE LOGNORMAL HISTOGRAM\n1000 normally\ndistributed Lognormal\n2 Mean 22% numbers =exp(mu+sigma*Z) Bins Frequency\n3 Sigma 30%\n4 \u0394t 1 -0.723596258 1.0029 0.00 0\n5 -0.447857929 1.0894 0.15 0\n6 -0.695454219 1.0114 0.30 0\n7 1.558892109 1.9891 0.45 0\nLognormal Frequency Distribu(cid:415)on\n8 1.484181666 1.9450 0.60 4\n9 180 1.698790584 2.0743 0.75 40\n10 0.438406005 1.4212 0.90 89\n160\n11 -0.406621439 1.1030 1.05 155\n12 140 1.048028935 1.7064 1.20 164\n13 120 -0.487628995 1.0765 1.35 155\n14 0.594645826 1.4894 1.50 133\n100\n15 -0.483584017 1.0778 1.65 89\n16 80 1.984662958 2.2601 1.80 51\n17 60 -0.052540372 1.2266 1.95 40\n18 0.355370275 1.3863 2.10 29\n40\n19 -0.6636526 1.0211 2.25 21\n20 20 -0.422878657 1.0976 2.40 10\n21 0 -0.905299657 0.9497 Table above created with the array\n22 0.0 0.2 0.3 0.5 0.6 0.8 0.9-01..712013.21981.044 1.5 1.71.010.8392.0 2.1 2.3 2.4 formula\n23 -0.954453299 0.9358 {=FREQUENCY(E:E,G4:G20)}\n24 1.969010555 2.2495\nHaving produced 1,000 lognormal price relatives e xp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6 , we can\nuse the array function Frequency( ) (this function is discussed in Chapter 33)\n686 Chapter 26\nW hen we do this simulation for a large number of points, the resulting\ndensity curve becomes smooth. Here, for example, is the frequency distribu-\ntion of 1,000,000 trials with \u03bc = 12%,\u03c3 = 30%, and\u0394 t = 1:\nA B C D E F\n1 SIMULATION OF LOGNORMAL RETURNS\n2 Runs 1,000,000 Output\n3 Mean 12% 0Simula(cid:415)on of Lognormal Frequency\n4 Sigma 30% 0\n5 0.03 0\n6 Starttime 10:04:31 PM 0\n0.03\n7 Stoptime 10:04:35 PM 0\n8 Elapsed 00:00:04 0.02 0\n9 0\n10 0.02 0\n11 0\n12 0.01 0\n13 0\n14 0.01 0\n15 0\n16 0.00 0\n0 50 100 150 200 250 300 350 400 450\n17 0\nThe VBA program that produced this output is shown below:\n\u2018Simulating the lognormal distribution\n\u2018Note that I take delta = 1!\nSub RandomNumberSimulation()\nApplication.ScreenUpdating = False\nRange(\u201cstarttime\u201d) = Time\nN = Range(\u201cruns\u201d).Value\nmean = Range(\u201cmean\u201d)\nsigma = Range(\u201csigma\u201d)\n687 Simulating Stock Prices\nFor Index = 1 To N\nstart:\nStatic rand1, rand2, S1, S2, X1, X2\nrand1 = 2 * Rnd - 1\nrand2 = 2 * Rnd - 1\nS1 = rand1 \u2227 2 + rand2 \u2227 2\nIf S1 > 1 Then GoTo start\nS2 = Sqr(-2 * Log(S1) / S1)\nX1 = rand1 * S2\nX2 = rand2 * S2\nReturn1 = Exp(mean + sigma * X1)\nReturn2 = Exp(mean + sigma * X2)\nFrequency(Int(Return1 / 0.01)) = _\nFrequency(Int(Return1 / 0.01)) + 1\nFrequency(Int(Return2 / 0.01)) = _\nFrequency(Int(Return2 / 0.01)) + 1\nNext Index\nFor Index = 0 To 400\nRange(\u201csimuloutput\u201d).Cells(Index + 1, 1) = _\nFrequency(Index) / N\nNext Index\nRange(\u201cstoptime\u201d) = Time\nRange(\u201celapsed\u201d) = Range(\u201cstoptime\u201d) -\nRange(\u201cstarttime\u201d)\nRange(\u201celapsed\u201d).NumberFormat = \u201chh:mm:ss\u201d\n688 Chapter 26\nT he routine which produces randomly distributed standard-normal deviates\nis contained in the eight lines following the word s tart ; this routine is further\nexplained in Chapter 31."
        ],
        "26.5": [
            "What is simulating lognormal price paths?\nWhat is the initial price of the stock in the given simulation?\nWhat are the statistical parameters associated with the stock price, as mentioned in the simulation?\nWhat does an annual log mean return of 10% signify in the context of stock prices?\nWhat does an annual log standard deviation of 20% indicate in relation to stock prices?\nHow many business days are typically considered in a year for stock price simulation?\nWhat might the daily price movement of a stock indicate?\nIn the context of stock price simulation, what is the interpretation of \u0394 t = 1/250 = 0.004, \u03bc = 10%, and \u03c3 = 20%?\nWhat is the role of the random normal deviate Z in stock price simulation?\nHow is the PricePathSimulation program used in simulating a typical price path?\nWhat is the purpose of rerunning the simulation?\nWhat does the output from the PricePathSimulation program represent?\nWhat does it mean if the price of a stock is distributed lognormally?\nCan you explain what Norm.Inv Rand( ) ,mDt,s Dt signifies in stock price simulation?\nWhat does Exp(Norm.Inv Rand( ) ,mDt,s Dt) illustrate in the context of lognormal price paths?\nHow is Norm.Inv used to simulate returns?\nWhat does the variance of the returns indicate over time in stock price simulation? \nWhat are properties 4 and 5 of stock prices as mentioned in the context?\nWhat are the components of a typical price path simulation in VBA? \nCan you explain how to simulate 10 lognormal price paths with the same statistical parameters?\nWhat does it mean when it is said that \"the return on an asset and the uncertainty associated with this return increase over time\"?",
            "26.5 Simulating Lognormal Price Paths\n\nW e now return to the problem of simulating lognormal price paths that we\nstarted to discuss in section 26.3. We shall try to understand, through a simula-\ntion written in VBA, the meaning of the following sentences: \u201cThe price of a\nstock today is $25. The price of the stock is distributed lognormally, with an\nannual log mean return of 10% and an annual log standard deviation of 20%.\u201d\nWe want to know how the price of the stock might behave on a daily basis\nthroughout the next year. There are an infinite number of price paths for the\nstock. What we will do is simulate (randomly) one of these paths. If we want\nanother price path, we can merely rerun the simulation.\nThere are about 250 business days in a year. Therefore the daily price move-\nment of the stock between day t and day t + 1 can be simulation by setting\n\u0394 t = 1/250 = 0.004, \u03bc = 10%, and \u03c3 = 20%. If the initial price of the stock\nS = $25, then the price after one day will be\n0\nS \u0394t =S 0\u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6=25\u2217exp\u23a1 \u23a30.15\u22c50.004+0.20\u22c5Z 0.004\u23a4 \u23a6\nand the price after 2 days will be\nS =S \u2217exp\u23a1 \u23a30.15\u22c50.004+0.20\u22c5Z 0.004\u23a4 \u23a6\n0.008 0.004\nand so on. At each step the random normal deviate Z is the uncertain factor in\nthe price return. Because of this uncertainty, all paths produced will be\ndifferent.\nH ere is a VBA program P ricePathSimulation that reproduces a\ntypical price path:\nSub PricePathSimulation()\nRange(\u201cstarttime\u201d) = Time\nN = Range(\u201cruns\u201d).Value\nmean = Range(\u201cmean\u201d)\nsigma = Range(\u201csigma\u201d)\n689 Simulating Stock Prices\nReDim price(0 To 2 * N) As Double\nprice(0) = Range(\u201cinitial_price\u201d)\nFor Index = 1 To N\nstart:\nStatic rand1, rand2, S1, S2, X1, X2\nrand1 = 2 * Rnd - 1\nrand2 = 2 * Rnd - 1\nS1 = rand1 \u2227 2 + rand2 \u2227 2\nIf S1 > 1 Then GoTo start\nS2 = Sqr(-2 * Log(S1) / S1)\nX1 = rand1 * S2\nX2 = rand2 * S2\nprice(2 * Index - 1) = price(2 * Index - 2)\n* Exp(mean * delta_t + _\nsigma * Sqr(delta_t) * X1)\nprice(2 * Index) = price(2 * Index - 1) *\nExp(mean * delta_t + _\nsigma * Sqr(delta_t) * X2)\nNext Index\nFor Index = 0 To 2 * N\nRange(\u201coutput\u201d).Cells(Index + 1, 1) = Index\nRange(\u201coutput\u201d).Cells(Index + 1, 2) =\nprice(Index)\nNext Index\nRange(\u201cstoptime\u201d) = Time\nRange(\u201celapsed\u201d) = Range(\u201cstoptime\u201d) -\nRange(\u201cstarttime\u201d)\nRange(\u201celapsed\u201d).NumberFormat = \u201chh:mm:ss\u201d\n690 Chapter 26\nThe output from this program looks like this on the spreadsheet:\nA B C D E F G H I J\nSIMULATING LOGNORMAL PRICE PATHS WITH VBA\n1 Press [Ctrl]+R to operate macro\nStock\n2 Day price\n3 0 30.00 Runs 125\n4 1 30.33 Initial price 30\n5 2 31.49 Mean 20%\n6 3 31.32 Sigma 30%\n7 4 31.41\n8 5 31.87\nLognormal Price Simula(cid:415)on\n9 6 31.72\n10 7 31.16 Parameters: Mean = 20%, Sigma = 30%\n11 8 31.07 50\n12 9 31.84\n45\n13 10 31.47\n14 11 31.18 40\n15 12 32.11\n16 13 31.84 35\n17 14 32.91\n18 15 32.95 30\n19 16 32.17\n25\n20 17 32.05\n21 18 31.81 20\n22 19 32.40 0 25 50 75 100 125 150 175 200 225 250\n23 20 31.50\nSimulating Price Paths with Norm.Inv\nI n the spreadsheet below we do a similar simulation, using Norm.Inv\nto simulate the returns (see Chapter 31 for more details).\n( )\nNorm.Inv Rand( ) ,mDt,s Dt produces normally distributed returns\nwith annual mean \u03bc and annual standard deviation \u03c3 .\n( ( ))\nExp Norm.Inv Rand( ) ,mDt,s Dt is the lognormally distributed price\n691 Simulating Stock Prices\nA B C D E F G\nSIMULATING LOGNORMAL PRICE PATHS WITH NORM.INV\nUses Exp(Norm.Inv(rand(),Mean*\u0394t,Sqrt(\u0394t)*Sigma) to simulate returns\n1 Press F9 to produce new simulation\nStock\n2 Day price\n3 0 30.00 Initial price 30\n4 1 31.18<-- =B3*EXP(NORM.INV(RAND(),Mean*$F$6,SQRT($F$6)*Sigma)) Mean 15%\n5 2 31.27<-- =B4*EXP(NORM.INV(RAND(),Mean*$F$6,SQRT($F$6)*Sigma)) Sigma 40%\n6 3 31.09 Delta_t 0.004<-- =1/250\n7 4 31.29\n8 5 31.98\n9 6 31.25 Lognormal Price Simula(cid:415)on\n10 7 29.86\n11 8 29.65 Parameters: Mean = 15%, Sigma = 40%\n80\n12 9 30.22\n13 10 30.05 70\n14 11 30.87\n15 12 30.34 60\n16 13 31.07\n17 14 31.14 50\n18 15 32.33\n40\n19 16 32.97\n20 17 32.65 30\n21 18 34.34\n22 19 35.05 20\n23 20 34.53 0 25 50 75 100 125 150 175 200 225 250\n24 21 33.83\nTen Lognormal Price Paths\nI n the spreadsheet below we use a slightly different technique to simulate 10\nlognormal price paths with the same statistical parameters. In each cell we use\n692 Chapter 26\nThis normal deviate is then used to simulate the stock price, as illustrated\nbelow:\nA B C D E F G H I J K\n1 SIMULATING 10 LOGNORMAL PRICE PATHS\n2 Initial price 30\n3 Mu 11%\n4 Sigma 30%\n=J9*EXP(Mu*Delta_t+Sigma*SQRT(Delta_\n5 Delta_t 0.004<-- =1/250\nt)*NORM.S.INV(RAND()))\n6\n7 10 price paths\n8 Day Path1 Path2 Path3 Path4 Path5 Path6 Path7 Path8 Path9 Path10\n9 0 30.00 30.00 30.00 30.00 30.00 30.00 30.00 30.00 30.00 30.00\n10 1 29.57 30.08 29.53 30.44 31.15 30.02 29.15 30.62 30.45 29.87\nSimula(cid:415)ng 10 Lognormal Price Paths\n11 2 28.75 30.73 29.68 30.56 32.71 30.44 28.36 31.25 30.39 29.73\n12 3 28.48 80 30.83 29.25 32.02 33.54 30.97 28.69 30.47 30.83 29.11\n13 4 27.67 31.86 28.67 32.88 33.92 31.23 28.33 30.12 30.31 30.05\n14 5 27.62 70 31.27 28.02 31.97 33.35 31.15 29.03 29.65 29.92 29.69\n15 6 27.80 31.81 27.90 32.10 34.63 31.69 28.61 30.14 29.55 29.32\n60\n16 7 27.84 31.45 28.40 31.37 34.50 32.29 29.10 31.26 29.81 30.53\n17 8 28.60 50 31.93 28.50 31.82 34.35 31.60 29.11 30.68 30.44 31.13\n18 9 29.54 32.18 28.89 31.61 34.70 30.89 28.80 30.79 29.82 30.89\n40\n19 10 29.54 32.31 28.99 32.59 35.41 30.33 28.81 30.72 29.20 31.91\n20 11 29.34 30 33.47 29.18 32.49 36.12 30.41 29.29 31.12 28.83 31.37\n21 12 28.72 32.26 28.35 32.31 36.99 30.26 29.16 30.18 29.40 30.37\n22 13 28.17 20 32.57 28.25 31.60 37.23 29.40 28.81 29.66 28.91 30.02\n23 14 28.36 31.59 29.61 31.49 38.44 29.33 28.19 29.12 28.62 30.44\n10\n24 15 28.08 031.6925 2950.74 75 32.51080 12358.04150 2197.575 20027.52225 22508.43 29.17 29.24\n25 16 27.94 31.73 30.60 32.29 38.22 29.55 27.90 28.29 29.30 30.45\nA s you can see, on average the price of the asset increases over time, as\ndoes the variance of the returns. This accords with properties 4 and 5 of stock\nprices in section 26.3\u2014we expect both the return on an asset and the uncer-\ntainty associated with this return to increase over time."
        ],
        "26.6": [
            "What do security analysts refer to as \u201cfundamentalists\u201d and \u201ctechnicians\u201d?\nHow do fundamentalists approach the analysis of a stock's value?\nWhat do technicians believe that the stock prices are determined by?\nCan past patterns of stock prices help predict future prices according to technicians?\nWhat is meant by a head-and-shoulders pattern in technical analysis?\nWhat are \u201cfloors\u201d, \u201crebound levels\u201d, and \u201cpennants\" according to technicians?\nHow is technical analysis viewed by academics?\nWhat is the weak efficient markets hypothesis?\nAccording to weak efficient markets hypothesis, can technical analysis predict futures prices effectively?\nWhy does belief in technical analysis possibly give it validity?\nHow can patterns in simulations generate predictions for future prices?\nWhat factors might a technician consider when predicting whether a stock price will rise or fall?\nHow might a technician interpret the significance of a stock price floor that never goes below a certain level?\nWhat does a head-and-shoulders pattern suggest about a stock's price?",
            "26.6 Technical Analysis\n\nS ecurity analysts are divided into \u201cfundamentalists\u201d and \u201ctechnicians.\u201d This\ndivision has nothing to do with their outlook on the Creator of the Universe,\nbut rather with the way they regard stock prices. Fundamentalists believe that\nthe value of a stock is ultimately determined by underlying economic vari-\nables. Thus, when a fundamentalist analyzes a company, she will look at its\n693 Simulating Stock Prices\nTechnicians, in contrast, think that stock prices are determined by patterns.\nThey believe that, by examining the pattern of past prices of a stock, they can\npredict (or at least make sensible statements about) the stock \u2019 s future prices.\nA technician may tell you that \u201cwe \u2019 re currently in a head-and-shoulders\npattern,\u201d by which he means that a graph of the stock price looks like the figure\nbelow:\n36\nLognormal Price Simulation\n34\nTechnical Analysis\n32\n30\n28\n26\n24\n22\n20\n0 50 100 150 200 250 300\nDay\n)$(\necirp\nkcotS\nHead\nShoulders\nFloor\nO ther terms used by technicians include \u201cfloors\u201d (there\u2019 s one in the graph),\n\u201crebound levels,\u201d and \u201cpennants.\u201d\nThe academic (some would say ivory tower) view of technical analysis is\nthat it is worthless. A basic theory of financial theory says that markets effi-\nciently incorporate the information known about the securities traded on them.\nThere are several versions of this theory; one of them, the weak efficient\nmarkets hypothesis , says that at the very least all information about past prices\n694 Chapter 26\nmeans that technical analysis cannot make predictions about futures prices,\nsince technical analysis is based solely on past price information. 6\nN evertheless, a lot of people believe in technical analysis (this in itself may\ngive technical analysis some validity). The simulations we are running in this\nchapter will allow us to generate a myriad of patterns which, when analyzed,\nwill yield \u201cgood\u201d predictions of future prices. For example, in the figure above\nit appears that $24 is a floor for the stock price, since it never goes any lower.\nA perspicacious analyst can detect a clear head-and-shoulders pattern between\ndays 40 and 100. There appears to be a ceiling of $35. Thus a technician might\npredict that the stock price will stay below $37 unless it rises above that level.\n(If you are going to be a technician, you have to learn to say these things with\na straight face.)"
        ],
        "26.7": [
            "What is the main purpose of calculating the parameters of the Lognormal Distribution from Stock Prices in financial modeling?\nCan you explain how stock price data can be used to compute the annual mean return and the standard deviation of the annual return?\nIn the context of financial modeling, what is the role of the Black-Scholes formula?\nHow does the mean and the variance of the logarithm of the stock return over a certain interval contributes to calculating the parameters of the lognormal distribution?\nWhat does it mean to say that the expected log return and the variance of the log return are linear in time?\nHow can we estimate lognormal \u03bc and \u03c3 from data on historical prices?\nWhy would one need to carry out lognormal simulations?\nHow do we calculate the log returns using historical prices in a particular stock and why is it important?\nWhat is the significance of the functions Stdevp in the calculation of \u03c3, according to financial modeling principles?\nWhat is the relation between the annual average log return and the monthly average log return?\nHow is the annual standard deviation related to the monthly standard deviation in financial modeling?\nWhat are some alternate ways to calculate the parameters of the lognormal distribution?\nCan you propose an alternate procedure to extrapolate the mean and standard deviation of future returns from the past history of returns?\nWhat is the meaning of 'implied volatility' in the context of the Black-Scholes formula?\nHow does the implied volatility of the stock\u2019s log returns fit the price of an option on the stock?",
            "26.7 Calculating the Parameters of the Lognormal Distribution from Stock Prices\n\nThe main purpose of this section is to show you how stock price data can be\nused to compute the annual mean return \u03bc and the standard deviation of the\nannual return \u03c3 needed in the lognormal simulations (and\u2014in Chapter 17\u2014the\n\u03c3 needed as an input to the Black-Scholes formula). Before doing this, note\nthat the mean and variance of the logarithm of the stock return over an interval\n\u0394 t are\n\u23a1 \u239bS \u239e\u23a4\nE \u23a3\u23a2ln \u239d\u239c St+\u0394t \u23a0\u239f \u23a6\u23a5=E\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6=\u03bc\u0394t\nt\n\u23a1\u23a1 \u239bS \u239e\u23a4\nvar \u23a3\u23a2ln \u239d\u239c St+\u0394t \u23a0\u239f \u23a6\u23a5=var\u23a1 \u23a3\u03bc\u0394t+\u03c3Z \u0394t\u23a4 \u23a6=\u03c32\u0394t\nt\nThis means that both the expected log return and the variance of the log return\nare linear in time.\nNow suppose we want to estimate the lognormal \u03bc and \u03c3 from data on\nhistorical prices. It follows that\n( ) ( )\n\u23a1 S \u23a4 \u23a1 S \u23a4\nmean ln t+\u0394t var ln t+\u0394t\n\u03bc=\n\u23a3 S\nt\n\u23a6\n,\u03c32 =\n\u23a3 S\nt\n\u23a6\n\u0394t \u0394t\n6 . F or a discussion of this point, see Chapter 13 of Brealey, Myers, and Allen (2005); for a more\n695 Simulating Stock Prices\nTo make things specific, the following spreadsheet gives monthly prices for\na particular stock. From these prices we calculate the log returns and the\nannualized mean and standard deviation. Note that we have used the function\nStdevp to calculate \u03c3 ; this assumes that the data represent the actual\ndistribution.\nA B C D\nCALCULATING THE ANNUAL MEAN AND SIGMA OF\nRETURNS FROM MONTHLY PRICE DATA FOR\nHALLIBURTON CORPORATION\n1 Oct. 2011\u2014Oct. 2013\n2 Monthly average 1.23% <-- =AVERAGE(C10:C33)\n3 Monthly standard deviation 6.74% <-- =STDEV.S(C10:C33)\n4\n5 Annual average, \u03bc 14.76% <-- =12*C2\n6 Annual standard deviation, \u03c3 23.36% <-- =SQRT(12)*C3\n7\nClosing Monthly\n8 Date price return\n9 3-Oct-11 36.54\n10 1-Nov-11 36.08 -1.27%<-- =LN(B10/B9)\n11 1-Dec-11 33.84 -6.41%<-- =LN(B11/B10)\n12 3-Jan-12 36.07 6.38%<-- =LN(B12/B11)\n13 1-Feb-12 35.88 -0.53%<-- =LN(B13/B12)\n14 1-Mar-12 32.63 -9.49%<-- =LN(B14/B13)\n15 2-Apr-12 33.64 3.05%<-- =LN(B15/B14)\n16 1-May-12 29.55 -12.96%\n17 1-Jun-12 27.99 -5.42%\n18 2-Jul-12 32.67 15.46%\n19 1-Aug-12 32.39 -0.86%\nN ote that the annual average log return is 12 times the monthly average log\nreturn, whereas the annual standard deviation is 12 the monthly standard\ndeviation. In general if the return data are generated for n periods per\nyear, then\nmean =n\u22c5mean ,\u03c3 = n\u22c5\u03c3\nannualreturn periodicreturn annualreturn periiodicreturn\nOf course, this is not the only way to calculate the parameters of the log-\nnormal distribution. We should mention at least two other methods:\n\u2022 We can use some other procedure to extrapolate the mean and standard\ndeviation of future returns from the past history of returns. One example of\n696 Chapter 26\n\u2022 We can use the Black-Scholes formula to find the i mplied volatility : The \u03c3\nof the stock \u2019 s log returns which fits the price of an option on the stock. This\nis illustrated in section 17.4."
        ],
        "26.8": [
            "What is the lognormal distribution in financial modeling?\nWhat is the relationship between the lognormal distribution and the Black-Scholes formula?\nHow is lognormality relevant to stock prices?\nWhy might one assume that the returns on an asset are normally distributed?\nWhat visual evidence might support the assumption of lognormality for the S&P 500 portfolio?\nHow can you simulate price paths that are lognormally distributed?\nWhat are the methods to compute the mean and standard deviation of a lognormal distribution?\nHow can historical returns of an asset contribute to the computation of the mean and standard deviation of a lognormal distribution?\nHow might lognormal distribution contribute to option pricing?\nHow is the concept of lognormality justified in the case of the S&P 500 portfolio?\nWhat insights can be garnered from the lognormal pricing paths?\nWhat is the significance of the mean and standard deviation in a lognormal distribution?",
            "26.8 Summary\n\nThe lognormal distribution is one of the foundations of the Black-Scholes\nformula for option pricing discussed in the next chapter. In this chapter we\nhave explored the meaning of lognormality for stock prices. We have shown\nhow lognormality\u2014the assumption that the returns on an asset are normally\ndistributed\u2014can be justified visually for the S&P 500 portfolio. We have also\nshown how to simulate price paths which are lognormally distributed. Finally,\nwe have shown how to compute the mean and the standard deviation of a\nlognormal distribution from the historic returns of an asset."
        ]
    },
    "27": {
        "27.1": [
            "What is the main topic of discussion in relation to portfolio investments?\nWhat is the importance of simulation in the performance of portfolio investments?\nHow does the correlation of stock returns relate to financial modeling?\nWhat is the Cholesky decomposition and how is it used in relation to multiple stocks' portfolios?\nWhat are pension problems in the context of financial simulations?\nHow does portfolio investment relate to financing future withdrawals?\nWhat does the simulation of \u03b2 signify in financial modeling?\nWhy do low \u03b2 stocks have higher \u03b1 in financial modeling simulations?\nWhat is the technique of running a Data Table on a blank cell used for in financial modeling?\nWhat is sensitivity analysis in financial modeling?\nWhy might the spreadsheets for financial modeling be computationally intensive?\nWhat are some ways to mitigate computation intensity in financial modeling spreadsheets?\nWhat is the role of D ata Tables in financial modeling computations? \nWhy might you want to turn off automatic computation of Data Tables in financial modeling?",
            "27.1 Overview\n\nI n this chapter we simulate the performance of portfolio investments of one\nor more stocks. We start with simulations of a single stock (a slight repetition\nof materials covered in the previous chapter). We then deal with correlation,\nfirst discussing the case of two correlated stock returns, and then generalizing\nto portfolios of multiple stocks, using the Cholesky decomposition (Chapter\n24). We go on to discuss simulations of pension problems, where portfolio\ninvestment is used to finance future withdrawals. Finally we discuss the simu-\nlation of \u03b2 , showing that low \u03b2 stocks have higher \u03b1 .\nT hroughout this chapter we use the technique of running a Data Table on\na blank cell to do sensitivity analysis. This technique, which enables us to run\nmultiple random simulations, is described in Chapter 31.\nA Computational Note\nThe spreadsheets for this chapter are very computationally intensive. We have\ndealt with this problem by splitting them up into separate Excel notebooks\ndealing with the various issues. We also advise turning off the automatic com-\nputation of D ata Tables ( File|Options|Calculation options|Automatic except\nfor data tables) ."
        ],
        "27.2": [
            "What is the objective of simulating portfolio investments?\nHow are stock returns over time simulated?\nWhat does the equation r =\u03bc\u0394t+\u03c3 \u0394tZ represent in the context of financial modelling?\nWhat is represented by Z in the return equation?\nWhat signifies the stock price at time t in financial modelling?\nWhat does a simulation example for monthly stock prices entail?\nWhat does it mean to work with returns instead of prices in simulation modelling?\nWhat does total return represent in stock return simulation?\nWhat does the equation n(\u03bc\u0394t)+\u03c3 \u0394t( Z +Z +\u2026+Z ) represent in financial modelling?\nIn the context of financial modelling, what would the expected price at the end of n months signify?\nWhat is the significance of running a simulation many times?\nWhat happens if you run a simulation multiple times in terms of the average ending price?\nWhat is shown in the Data Table in financial modelling?\nWhat does the average ending price for 25 simulations indicate?\nWhat does the ending price (cell B20) in the Data Table represent in a simulation modelling?\nHow is the expected price at the end of 12 months calculated based on mean return and volatility?\nHow does simulating price and returns for a single stock help in financial analysis?\nWhat role does a standard normal deviate play in generating a stock's random return?\nWhy is the use of the Norm.S.Inv(rand( )) function crucial in generating a stock's random return?\nWhat is the significance of simulating monthly stock returns instead of prices?\nWhat is the purpose of calculating a total return in a stock return simulator?\nWhat can variance in simulations teach us about potential real-world outcomes?",
            "27.2 Simulating Price and Returns for a Single Stock\n\nI n this section we simulate portfolio investments. We start with an exercise we\nhave already done in Chapter 26, namely, simulating stock returns over time.\n700 Chapter 27\nthis stock. In the spreadsheet below we simulate such a price path: At each\npoint t , we generate a random return for the stock:\nr =\u03bc\u0394t+\u03c3 \u0394tZ\nt\nwhere Z is a standard normal deviate generated by Norm.S.Inv(rand( )) .1 The\nstock price at time t is given by\nS\nt\n=S t\u22121exp\u23a1 \u23a3\u03bc\u0394t+\u03c3 \u0394tZ\u23a4 \u23a6\nBelow is a simulation example for monthly stock prices:\nA B C D E F G H I\n1 SIMULATING MONTHLY STOCK PRICE\n2 Mean 12%\n3 Sigma 30%\n4 Delta_t 0.0833 <-- =1/12\n5 Initial price 12.00\n6\n7 Month Price\n8 0 12.00\n9 1 11.69 <-- =B8*EXP(Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND()))\n10 2 10.51 <-- =B9*EXP(Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND()))\n11 3 9.97\n12 4 11.82 Simula(cid:415)ng One Year of Stock Prices\n13 5 14.05\n(Mean,Sigma) = (12.00%,30.00%)\n14 6 14.42\n15 7 13.40 16\n16 8 11.50 15\n17 9 10.27 14\n18 10 11.52 13\n19 11 12.59 12\n20 12 15.46 11\n21 10\n22 9\n23 8\n24 7\n25 6\n26 0 1 2 3 4 5 6 7 8 9 10 11 12\n701 Monte Carlo Simulations for Investments\nWorking with Returns Instead of Prices\nIf we do this simulation with stock returns, we get the following:\nA B C D E F G H I J K\n1 SIMULATING MONTHLY STOCK RETURN\n2 Mean 12%\n3 Sigma 30%\n4 Delta_t 0.0833<-- =1/12\n5 Initial price 12.00\n6\n7 Month Price\n8 1 -18.47%<-- =Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND())\n9 2 -4.28%<-- =Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND())\n10 3 -0.97%<-- =Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND())\n11 4 10.12% Simula(cid:415)ng One Year of Stock Returns\n12 5 4.70% (Mean,Sigma) = (12.00%,30.00%)\n13 6 10.59%\n20%\n14 7 12.59%\n15 8 5.97% 16%\n16 9 -3.98% 12%\n17 10 4.77% 8%\n18 11 -3.81% 4%\n19 12 -13.55% 0%\n20 -4% 1 2 3 4 5 6 7 8 9 10 11 12\n21 Total return 3.69%<-- =SUM(B8:B19) -8%\n22\n-12%\n23\n-16%\n24\n-20%\n25\nSome Return/Price Mathematics\nThe cumulative return for n months is n(\u03bc\u0394t)+\u03c3 \u0394t( Z +Z +\u2026+Z ) .\n1 2 n\nThis means that the expected price at the end of n months is P = P e xp[\u03bc ( n \u0394 t )\nn n\n+ \u03c3 2 ( n \u0394 t )/2]. For 12 months (1 year), the expected price isP = P e xp[\u03bc +\u03c3 2 /2].\nn n\nOf course you will never see exactly this expected price, but if you run the\nsimulation many times, the average ending price will be approximately\nP = P e xp[\u03bc +\u03c3 2 /2]. We show this in the Data Table below:\n702 Chapter 27\nA B C D E F G H I J K L M\n1 SIMULATING A SINGLE STOCK: PRICES\n2 Mean 12% Mean price 13.7851<-- =AVERAGE(L10:L209)\n3 Sigma 30% Max 26.3859<-- =MAX(L10:L34)\n4 Delta_t 0.0833<-- =1/12 Min 5.5119<-- =MIN(L10:L34)\n5 Initial price 12.00 Expected ending 14.1527<-- =B5*EXP(Mean+Sigma^2/2)\n6\n7 Month Price\n8 0 12.00 200 simulations of ending price\n9 1 12.11<-- =B8*EXP(Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND())) 10.4890<-- =B20, data table header\n10 2 11.92<-- =B9*EXP(Mean*Delta_t+Sigma*SQRT(Delta_t)*NORM.S.INV(RAND())) 1 15.8501\n11 3 10.79 2 9.6356\n12 4 10.37 Simula(cid:415)ng One Year of Stock Prices 3 14.8198\n13 5 11.20 (Mean,Sigma) = (12.00%,30.00%) 4 9.1409\n14 6 11.45 5 11.1895\n15 7 9.75 13 6 11.5435\n16 8 9.71 12 7 14.1382\n17 9 10.65 8 14.5613\n18 10 9.82 11 9 13.7257\n19 11 9.38 10 10 16.7483\n20 12 10.49 11 26.3859\n21 9 12 16.8141\n22 8 13 18.5837\n23 7 14 8.6738\n24 15 5.5119\n25 6 16 16.5237\n26 0 1 2 3 4 5 6 7 8 9 10 11 12 17 8.9945\nIn the above example the Data Table simulates the ending price (cell B20).\nThe average ending price for 25 simulations is close to the expected ending\nprice (cell L5). 2"
        ],
        "27.3": [
            "What is the correlation in the context of two stocks?\nCan you define standard normal deviates in the context of financial modeling?\nWhat does it mean to work only in returns, not in prices, when managing a portfolio of two stocks?\nWhat is the significance of the correlation amounting to '-0.4' in a two-stock portfolio?\nHow do you calculate the correlation between two standard normal deviates Z1 and Z2?\nWhy would a statistician refer to an increase in number of simulations as a \u201csmall sample problem\u201d?\nWhat is the meaning of the formula Z2 =\u03c1Z1 + 1\u2212\u03c1^2Z3, and how is it used in financial modeling?\nWhat do the Excel function Norm.S.Inv(Rand()) represent in financial modeling context, particularly in simulating two correlated normal deviates?\nWhat is the significance of simulating 25 years of annual returns in a Monte Carlo simulation for investments?\nWhy is Finance considered full of small sample problems?\nHow does the correlation between two stocks affect the outcome of their investment portfolio?\nWhat does it imply when a correlation is negative in a two stock portfolio?\nWhat could be the reason for performing simulations only on returns, not on prices, in a two-stock portfolio?\nWhat are the potential implications of having a large amount of data still facing small sample problems in finance as per section 27.7?",
            "27.3 Portfolio of Two Stocks\n\nWe extend the exercise of the previous section to two stocks with correlation\n\u03c1 . To simplify matters we will work only in returns, not in prices.\nTheory\nWe recall from Chapter 24 that two standard normal deviates Z and Z are\n1 2\ncorrelated with correlation \u03c1 if\nZ =\u03c1Z + 1\u2212\u03c12Z\n2 1 3\n2. Were we to increase the number of simulations to 200, the average (cell L2) would be closer\nto the expected (cell L5). A statistician would refer to this as a \u201csmall sample problem.\u201d We prefer\nto note that 25 simulations of a series of annual returns is\u2014in plain English\u2014the simulation of\n25 years of annual returns. This is a lot! Our interpretation: Finance is full of small sample prob-\nlems, despite the large amount of data available. We return to this topic in section 27.7, where we\n703 Monte Carlo Simulations for Investments\nwhere Z and Z are both standard normal deviates (produced with the Excel\n1 3\nfunction N orm.S.Inv(Rand( )) . We simulate this below:\nA B C D E F G H I\n1 SIMULATING TWO CORRELATED NORMAL DEVIATES\n2 Correlation -0.4\n3\n4 Z Z\n1 2\n5 -0.4937 -2.0283 <-- =$B$2*A5+SQRT(1-$B$2)*NORM.S.INV(RAND())\n6 -0.8308 2.3217\n7 -0.6305 1.3517 Correlated Standard Normal Deviates\n8 -0.6152 0.7190 Correla(cid:415)on = -0.40\n9 -0.0759 0.6951\n10 0.4551 1.3796 3.00\ny = -0.7141x + 0.1631\n11 0.1376 0.1976"
        ],
        "27.4": [
            "What is meant by adding a risk-free asset in the context of financial modeling?\nWhat is the significance of expected annual return in evaluating a financial portfolio? \nCan you define the term 'Sigma annual return' in the context of portfolio evaluation? \nIn financial modeling, what do 'Mean', 'Sigma', and 'Correlation' represent for a stock investment?\nHow is the risk-free rate denoted in financial models?\nWhat factors contribute to the determination of a risky portfolio?\nHow can the composition of a portfolio with a risk-free asset and risky assets be represented in financial terms?\nWhat is the formula to calculate the expected return of a portfolio that includes both risky and risk-free assets?\nWhat role does the proportion of investments in risky and risk-free assets play in determining the overall return and risk of a portfolio?\nCan you explain the 'Sigma of annualized return' in the context of a portfolio's performance?\nWhy do financial models use simulation for determining annual returns?\nWhat is the relationship between a portfolio's expected and simulated annual returns and its expected and simulated Sigma of annualized returns?\nWhat does 'Delta_t' stand for in financial modeling and how is it calculated?\nWhy do we perform Monte Carlo Simulations for Investments? \nWhat does Stock1 and Stock2 denote in the text?",
            "27.4 Adding a Risk-Free Asset\n\nW e add a risk-free asset to the exercise of the previous section, simulating the\nperformance of an investment in a portfolio of the two risky stocks and the\nrisk free. Cells B13 and B14 below give the risky portfolio expected annual\nreturn and annual sigma. Cells B19 and B20 show the expected return\nand sigma for a portfolio invested 40% in the risky and 60% in the risk-free\n707 Monte Carlo Simulations for Investments\nA B C D E F G\n1 PORTFOLIO OF 2 STOCKS AND RISK-FREE\n2 Stock1 Stock2\n3 Mean 12% 22%<-- cell names: mean1, mean2\n4 Sigma 10% 15%<-- cell names: sigma1, sigma1\n5 Correlation 0.2<-- cell name: corr\n6 Delta_t 0.0833<-- =1/12, cell name: delta_t\n7\n8 Risk free rate, r 3%<-- cell name: rf\nf\n9\n10 Risky portfolio\n11 Stock1 30%<-- cell name: prop1\n12 Stock2 70%<-- =1-prop1\n13 Expected annual return 19.00%<-- =prop1*mean1+(1-prop1)*mean2\n14 Sigma annual return 11.48%<-- =SQRT(prop1^2*sigma1^2+(1-\n15 prop1)^2*sigma2^2+2*prop1*(1-prop1)*corr*sigma1*sigma2)\n16 Investment\n17 In risky portfolio 40%<-- cell name: prop\n18 In risk free 60%<-- =1-prop\n19 Expected return 9.40%<-- =prop*B13+(1-prop)*rf\n20 Sigma return 4.59%<-- =prop*B14\n21\nPortfolio\n22 Month return Z Z\n1 2\n23 1 1.72% -0.403 0.884169\n24 2 1.35% 0.335756 0.367992\n25 3 1.73% -0.733 0.991814\n26 4 -1.41% 1.297981 -2.18324\n27 5 -0.12% -0.51652 -0.59738\n28 6 0.30% -1.49158 0.031419\n29 7 2.69% 0.787621 1.349174\n30 8 0.00% -1.33656 -0.26242\n31 9 2.72% 0.954727 1.325199\n32 10 0.43% -0.04545 -0.27502\n33 11 -0.37% -0.14668 -0.9101\n34 12 1.96% 1.653972 0.501086\n35\n36 Annual return\n37 Simulated 11.01%<-- =SUM(B23:B34)\n38 Expected 9.40%<-- =prop*(prop1*mean1+(1-prop1)*mean2)+(1-prop)*rf\n39\n40 Sigma of annualized return\n41 Simulated 4.50%<-- =SQRT(12)*STDEV.S(B23:B34)\n42 Expected 4.59%<-- =B20\n43\n44 Formulas\n45 Cell B23 =prop*(prop1*(mean1*delta_t+sigma1*SQRT(delta_t)*D23)+(1-\n708 Chapter 27"
        ],
        "27.5": [
            "What is the process of simulating the performance of a multiple stock portfolio?\nWhat is the Cholesky decomposition as used in financial modeling?\nCan you explain the steps involved in creating normal deviates that has a variance-covariance structure?\nWhat is the role of the Cholesky matrix in financial modeling?\nWhat is the use of Excel function Norm.S.Inv(Rand( )) in financial modeling?\nHow can Excel be used to simulate returns in a multiple stock portfolio?\nCan you explain the use of a Variance-Covariance matrix in financial modeling?\nWhat does the term \"correlated standard normal variates\" mean in financial modeling?\nHow is the VBA function CorrNormal used to create correlated normal deviates?\nWhat is the purpose of the VBA function UrandoList and how does it function in financial modeling simulations?\nWhat is the relationship between Cholesky decomposition and variance-covariance matrix in financial modeling?\nWhat is the significance of simulating multiple years of monthly returns with specified means in stock market simulations?\nCan you explain how Theorectical mean and variance are used in financial modelling?\nWhat is the purpose of stats in financial modelling?\nHow the results of a financial simulation can more closely correspond to the priors?\nWhat is the significance of Data variance vs Theoretical variance in finance modelling? \nHow Methods of Cholesky decomposition applied in the simulation of stock returns? \nWhat's the role of Standard Normal Deviates in financial modeling?\nHow does the function U Randomlist create a column vector of standard normal deviates?\nWhat is the implication of multiplying the deviates times the Cholesky matrix in financial modeling?",
            "27.5 Multiple Stock Portfolios\n\nSo far we \u2019 ve simulated the performance of a two-stock portfolio. When we\nturn to multiple stocks, we need to make use of the Cholesky decomposition\n(see section 24.7). We remind you how the Cholesky decomposition works:\nWe want to create a set of normal deviates that has variance-covariance struc-\nture S :\n\u23a1\u03c3 \u03c3 \u03c3 \u23a4\n11 12 1N\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c3\nS=\u23a2\n\u23a2\n21 22 2N\u23a5\n\u23a5\n\u23a2 \u23a5\n\u23a3\u03c3 \u03c3 \u03c3 \u23a6\nN1 N2 NN\nAs explained in Chapter 24, the steps in doing this are as follows:\n1. Create a lower-triangular Cholesky decomposition of S. We denote this\nmatrix by L and use the VBA function Cholesky on the disk with this book\nto compute the matrix.\n2. Create a column vector of N standard normal deviates. We use the Excel\nfunction N orm.S.Inv(Rand( )) .\n3. Multiply L times the column vector of standard normal deviates.\n4. The result is a set of correlated standard normal variates.\nExample: Standard Normal Deviates with Given Correlation Structure\nH ere\u2019 s an example. We define a VBA function CorrNormal that takes as its\nargument the desired variance-covariance matrix. Below we use this function\nto simulate 3 years of monthly returns with means specified in cells B3:D3\n709 Monte Carlo Simulations for Investments\nA B C D E F G H I J K\nNORMAL DEVIATES WITH DESIRED MEANS USING THE CHOLESKY DECOMPOSITION\n1 3 years of simulated monthly data\n2 Monthly means Month 3 years of simulated monthly returns\n3 4.00% 3.00% 2.00% 1.00% 1 39.65% -14.76% 7.37% -31.14%<--\n4 2 35.08% 24.91% 48.30% 5.50%{=corrnormal($A$6:$D$9)+\n5 Variance-covariance matrix 3 59.32% -21.07% 55.70% 49.49%$A$3:$D$3}\n6 0.400 0.030 0.020 0.000 4 32.98% 21.50% 22.42% 18.62%\n7 0.030 0.300 0.000 -0.060 5 108.48% 21.66% 61.81% -18.11%\n8 0.200 0.000 0.200 0.030 6 9.51% -61.34% -30.38% -8.12%\n9 0.000 -0.060 0.030 0.100 7 27.94% 18.99% -14.77% -7.86%\n10 8 -111.90% 4.41% -45.30% 28.64%\n11 Sta(cid:2)s(cid:2)cs 9 23.50% -23.32% 30.42% 16.33%\n12 Count 36<-- =COUNT(G:G) 10 -34.89% -19.63% 10.32% 33.48%\n13 11 -6.82% 64.53% -103.76% -23.03%\n14 Data average vs theore(cid:2)cal mean 12 -85.11% -19.16% -84.99% -3.20%\n15 0.0683 0.0089 0.0092 -0.0410<-- =AVERAGE(J:J) 13 15.16% -4.81% -1.82% -9.40%\n16 0.0400 0.0300 0.0200 0.0100<-- Theore(cid:2)cal mean 14 -106.19% 14.36% -84.03% -65.22%\n17 15 82.83% 37.21% 31.91% -14.62%\n18 Data variance vs theore(cid:2)cal variance 16 26.93% -108.92% 18.73% 37.40%\n19 0.3293 0.2128 0.1769 0.0643<-- =VAR.S(J:J) 17 45.52% -22.53% 14.80% -8.79%\n20 0.4000 0.3000 0.2000 0.1000<-- Theore(cid:2)cal variance 18 -35.01% 78.25% -51.82% -42.48%\n21 19 45.79% -34.86% 29.89% 22.20%\n22 Sample variance-covariance 20 56.55% -6.03% -35.33% -29.66%\n23 minus the variance-covariance matrix 21 57.91% -40.91% 11.52% 26.60%\n24 0.0799 0.0861 -0.1291 -0.0332<-- {=A6:D9-varcovar(G:J)} 22 -9.86% 33.99% 0.02% -43.59%\n25 0.0861 0.0931 0.0605 0.0045 23 -20.68% -13.32% 0.28% -10.90%\n26 0.0509 0.0605 0.0280 -0.0154 24 -54.97% 58.29% 5.19% -42.82%\n27 -0.0332 0.0045 -0.0154 0.0375 25 66.82% -5.66% 75.10% -2.78%\n28 26 -107.69% 21.00% -11.28% -23.31%\nI f we rerun this simulation for 500 months, the simulation more closely\ncorresponds to the priors:\nA B C D E F G H I J K\nNORMAL DEVIATES WITH DESIRED MEANS USING THE CHOLESKY DECOMPOSITION\n1 500 months of simulated monthly data\n2 Monthly means Month 500 months of simulated monthly returns\n3 4.00% 3.00% 2.00% 1.00% 1 30.37% 54.92% 34.46% -31.99%<--\n4 2 -39.31% -55.10% -19.66% 42.11%{=corrnormal($A$6:$D$9)+\n5 Variance-covariance matrix 3 -12.04% -106.92% 38.44% 33.99%$A$3:$D$3}\n6 0.400 0.030 0.020 0.000 4 -26.48% -45.08% -23.79% 56.90%\n7 0.030 0.300 0.000 -0.060 5 -4.61% 14.74% 3.30% 23.00%\n8 0.200 0.000 0.200 0.030 6 73.97% -30.09% 50.34% -3.26%\n9 0.000 -0.060 0.030 0.100 7 -118.50% -97.71% -20.31% 7.28%\n10 8 -18.96% -4.75% -39.35% -9.65%\n11 Sta(cid:2)s(cid:2)cs 9 -44.79% 195.97% 7.85% 13.42%\n12 Count 500<-- =COUNT(G:G) 10 53.93% -37.18% 12.84% -4.62%\n13 11 -73.29% -7.69% -28.67% -40.54%\n14 Data average vs theore(cid:2)cal mean 12 159.96% -23.86% 103.38% 50.33%\n15 0.0261 -0.0077 0.0318 0.0138<-- =AVERAGE(J:J) 13 111.39% -27.33% 64.59% 1.55%\n16 0.0400 0.0300 0.0200 0.0100<-- Theore(cid:2)cal mean 14 21.98% 29.09% 38.99% 28.19%\n17 15 -31.05% 14.37% 27.04% 22.06%\n18 Data variance vs theore(cid:2)cal variance 16 -30.86% 28.08% -8.95% 54.89%\n19 0.3189 0.3375 0.1912 0.1034<-- =VAR.S(J:J) 17 -43.76% 68.92% -7.72% -31.58%\n20 0.4000 0.3000 0.2000 0.1000<-- Theore(cid:2)cal variance 18 -130.46% 60.87% -79.26% -58.12%\n21 19 -46.48% 75.66% 25.41% 26.95%\n22 Sample variance-covariance 20 59.00% 42.60% -3.99% -0.27%\n23 minus the variance-covariance matrix 21 -6.62% 101.89% -36.76% -25.29%\n24 0.0817 0.0379 -0.1485 -0.0129<-- {=A6:D9-varcovar(G:J)} 22 23.67% 26.17% -1.09% -21.08%\n25 0.0379 -0.0368 0.0260 0.0169 23 -23.83% -30.14% 42.18% 44.61%\n26 0.0315 0.0260 0.0092 -0.0057 24 -53.00% 24.61% 9.55% 15.60%\n710 Chapter 27\nThe VBA Function CorrNormal\nT he VBA function that creates the correlated normal deviates is a combination\nof two functions. The second of these functions U Randomlist creates a column\nvector of standard normal deviates. These deviates are then multiplied times\nthe Cholesky matrix.\nFunction CorrNormal(mat As Range) As Variant\nCorrNormal = Application.Transpose(Application.\nMMult(Cholesky(mat), _\nurandomlist(mat)))\nEnd Function\nFunction urandomlist(mat As Range) As Variant\nApplication.Volatile\nDim vector() As Double\nnumCols = mat.Columns.Count\nReDim vector(numCols - 1, 1)\nFor i = 1 To numCols\nvector(i - 1, 0) = Application.Norm_S_\nInv(Rnd)\nNext i\nurandomlist = vector\nEnd Function"
        ],
        "27.6": [
            "What is Monte Carlo Simulation in the context of investments?\nHow is pension savings simulated in financial modeling?\nWhat is the role of annual deposit in pension fund calculations?\nWhat does it mean for a pension fund to be \"completely depleted\"?\nWhy is the annual interest rate important for pension savings calculations?\nWhat does the term \"bequest\" mean in relation to a pension plan?\nHow does a potential pensioner save for a specific number of years and subsequent withdrawals?\nWhat is the impact of investing pension savings in a risky portfolio?\nHow is the mean return and return sigma of a portfolio related to retirement investment?\nHow does the risk-free asset impact pension savings and the bequest?\nWhat is the significance of the risk-free rate in a retirement problem?\nWhat happens when a larger proportion is invested in a risky asset?\nHow are retirement withdrawal quantities calculated in financial modeling?\nWhat happens when the savings for pensions are invested in a risky portfolio?\nWhat does it mean for a pension to be \"fully funded\"?\nHow does the portfolio risk impact the average bequest size in a pension plan?\nCan investing in a risk-free asset guarantee positive bequests in a pension plan?\nHow does the percentage of investment in a risk-free asset affect the bequest amount?\nWhat role does uncertainty play in financial modeling for pension savings?\nWhat kind of statistics are evaluated in financial modeling for pension savings?",
            "27.6 Simulating Savings for Pensions\n\nW e return to a problem that we discussed in Chapter 1. There we discussed\nthe case of a potential pensioner who wants to save for 5 years in order to\nenable eight subsequent withdrawals of 30,000. The question we discussed in\nsection 1.6 is the calibration of the annual deposit so that the pension fund\n(with accumulated 8% annual interest) would be completely depleted after 8\n711 Monte Carlo Simulations for Investments\nHere \u2019 s the answer to this problem:\nA B C D E F\n1 A RETIREMENT PROBLEM, Section 1.6\n2 Interest 8%\n3 Annual deposit 29,386.55\n4 Annual retirement withdrawal 30,000.00\n5 =$B$2*(C7+B7)\nAccount\nDeposit at Interest Total in\nbalance,\nYear beginning earned account,\nbeginning\n6 of year of year during year end year\n7 1 0.00 29,386.55 2,350.92 31,737.48<-- =D7+C7+B7\n8 2 31,737.48 29,386.55 4,889.92 66,013.95\n9 3 66,013.95 29,386.55 7,632.04 103,032.54\n10 4 103,032.54 29,386.55 10,593.53 143,012.62\n11 5 143,012.62 29,386.55 13,791.93 186,191.10\n12 6 186,191.10 -30,000.00 12,495.29 168,686.39\n13 7 168,686.39 -30,000.00 11,094.91 149,781.30\n14 8 149,781.30 -30,000.00 9,582.50 129,363.81\n15 9 129,363.81 -30,000.00 7,949.10 107,312.91\n16 10 107,312.91 -30,000.00 6,185.03 83,497.94\n17 11 83,497.94 -30,000.00 4,279.84 57,777.78\n18 12 57,777.78 -30,000.00 2,222.22 30,000.00\n19 13 30,000.00 -30,000.00 0.00 0.00\n20\nNote: This problem has 5 deposits and 8 annual withdrawals, all made at the beginning of the year. The\nbeginning of year 13 is the last year of the retirement plan; if the annual deposit is correctly computed, the\n21 balance at the beginning of year 13 after the withdrawal should be zero.\nI n this section we discuss a Monte Carlo variation of this problem. As in\nChapter 1, the future pensioner discovers that she has no pension savings and\ndesires to make deposits to fund eight subsequent withdrawals. In this version,\nhowever, the savings are invested in a risky portfolio having mean return of\n12% and return sigma of 18%. We are curious to see whether a specific level\nof annual deposits can fund the future planned withdrawals of 30,000 per year.\nTo do this, we examine the bequest\u2014the amount left in the pension plan at\nthe end of year 13. Several things are clear:\n\u2022 E xcept for the case where 100% of the savings are invested in the risk-free\nasset, there is no longer any certainty about the savings or the bequest.\n\u2022 On average, the larger the proportion in the risky asset, the greater will be\n712 Chapter 27\nHere \u2019 s one simulation:\nA B C D E\n1 A RETIREMENT PROBLEM\n2 Risk-free rate 8%<-- Cell name: rf\n3 Risky asset\n4 Mean 12%<-- Cell name: mean\n5 Sigma 18%<-- Cell name: sigma\n6 Annual deposit 30,000<-- Years 1-5\n7 Investment policy\n8 Risk-free 30%<-- Cell name: prop\n9 Risky asset 70%<-- =1-prop\n10 Annual retirement withdrawal 30,000<-- Years 6-13\n11\nAccount\nDeposit at\nbalance, In account at\nYear beginning\nbeginning end of year\n12 of year of year\n13 1 0 30,000 31,649<-- =(B13+C13)*(prop*EXP(rf)+(1-\n14 2 31,649 30,000 69,767prop)*EXP((mean+sigma*NORM.S.INV(RAND())\n15 3 69,767 30,000 97,717)))\n16 4 97,717 30,000 139,754\n17 5 139,754 30,000 158,609\n18 6 158,609 -30,000 149,860\n19 7 149,860 -30,000 131,279\n20 8 131,279 -30,000 109,145\n21 9 109,145 -30,000 94,169\n22 10 94,169 -30,000 74,561\n23 11 74,561 -30,000 57,691\n24 12 57,691 -30,000 30,722\n713 Monte Carlo Simulations for Investments\nT o get a feel for the uncertainty, we run our standard Data Table on a\nblank cell:\nG H I\n3 Statistics for data table\n4 Average 130,469<-- =AVERAGE(H15:H24)\n5 Max 613,335<-- =MAX(H15:H24)\n6 Min -36,264<-- =MIN(H15:H24)\n7 Sigma 193,818<-- =STDEV.S(H15:H24)\n8 % positive bequests 90%<-- =COUNTIF(H15:H24,\">0\")/10\n9\n10\n11\nData table:\nSimulating the bequest\n12\n13 Simulation Bequest\n14 387,776<-- =D25, data table header\n15 1 613,335\n16 2 79,823\n17 3 41,689\n18 4 3,386\n19 5 67,000\n20 6 319,044\n21 7 94,766\n22 8 59,295\n23 9 -36,264\n24 10 62,616\nT he average bequest for this specific series of 10 simulations is 130,469 but\nwith considerable variation. Since the simulation is stochastic, each time you\nopen the spreadsheet, you will see different numbers. In 90% of the cases we\ncan count on full funding of the pension (in the sense that the bequest is posi-\ntive). If we simulate the results varying the percentage invested in the risk-free\n714 Chapter 27\nG H I J K L M\n2 Data table statistics\n3 Percentage in risk-free\n4 100% 80% 60% 40% 20% 0%\n5 Average 14,147 31,980 82,341 93,310 126,400 160,835\n6 Max 14,147 67,016 269,055 165,297 334,284 890,635\n7 Min 14,147 -12,565 -64,989 -37,721 -48,516 -189,115\n8 Sigma 0 25,632 94,586 72,617 121,558 308,885\n9 % positive bequests 100% 90% 70% 90% 90% 70%\n10\n11\nData table:\nBequest as function of % in risk-free (columns)\n12\n13 Simulation Percentage in risk-free\n14 -88,472 100% 80% 60% 40% 20% 0%\n15 1 14,147 47,839 53,527 165,297 249,223 -56,263\n16 2 14,147 17,554 130,848 132,197 15,894 216,808\n17 3 14,147 -12,565 141,673 160,402 138,809 -189,115\n18 4 14,147 51,438 -64,989 154,817 71,843 23,543\n19 5 14,147 12,938 93,901 10,521 248,790 196,818\n20 6 14,147 67,016 -8,049 14,001 334,284 403,491\n21 7 14,147 47,580 92,645 98,430 -48,516 890,635\n22 8 14,147 8,801 119,013 -37,721 116,709 172,262\n23 9 14,147 56,973 -4,217 95,632 9,463 26,016\n24 10 14,147 22,223 269,055 139,523 127,503 -75,851\nThe chart below summarizes these simulations:\nBequest Sta(cid:2)s(cid:2)cs\nVarying the Percentage in Risk-Free (x-axis)\n700,000\n600,000\n500,000\n400,000\n300,000\n200,000\n100,000\n0\n-100,0000% 20% 40% 60% 80% 100%\n-200,000\n715 Monte Carlo Simulations for Investments"
        ],
        "27.7": [
            "What is a typical beta calculation in financial modelling?\nWhat does 'actual beta' mean in financial modelling?\nHow is 'actual beta' simulated?\nWhat is the correlation between stock i and the market?\nHow far can the actual beta derived from data be from the theoretical beta?\nHow is beta defined in terms of asset i?\nHow can beta be represented using the correlation between i and M?\nHow can beta be estimated using time-series data?\nWhat is the typical calculation period for beta in capital market calculations?\nWhat are the standard first-pass regressions?\nHow are the market and stock returns correlated?\nWhat is the relationship between Beta and Alpha in financial modelling?\nWhy do low beta stocks have high alphas and vice versa?\nWhat does it mean when a Monte Carlo beta is distant from the anticipated beta?\nWhat kind of variations can be expected in the simulation process?\nDoes the computed beta exhibit considerable variability?\nWhat is a Data Table showing beta and alpha as functions of sigma?\nHow is the column for the stock returns created?\nWhat does the column for the market returns indicate?\nHow are the market and stock returns correlated with correlation?\nWhat is the interpretation when the Monte Carlo simulation results are not far from the theoretical results?\nWhat does it indicate when the Monte Carlo beta is quite distant from the anticipated beta?\nWhat is the relationship between beta and alpha in terms of sigma?\nWhat are the results when the simulation is repeated several times?\nHow does the correlation between the market portfolio and stock impact the simulation results?",
            "27.7 Beta and Return\n\nIn this section we simulate a typical beta calculation. We assume that we know\nthe \u201cactual\u201d beta, in the sense that we know the \u03c3 , \u03c3 , and the correlation \u03c1\nM i\nbetween stock i and the market. We then simulate this beta by creating returns\ndrawn from an appropriate distribution. We use this example to illustrate how\nfar the actual beta, derived from data, can be from the theoretical beta.\nRecall from Chapter 11 that for an asset i , \u03b2 is defined as follows:\n\u03b9\n( )\nCov r,r\n\u03b2 = i M\ni ( )\nVar r\nM\nIn the simulations below, we use two equivalent expressions for \u03b2 \u03b9 . First, using\nthe correlation \u03c1 between i and M , we can write \u03b2 \u03b9 as:\nCov( r,r ) \u03c1\u03c3\u03c3 \u03c1\u03c3\n\u03b2 = i M = i M = i\ni Var( r ) \u03c32 \u03c3\nM M M\nSecond, if we have time-series data {r , r } for the returns on the stock and\nit Mt\nthe market, then we can estimate \u03b2 \u03b9 by running the regression:\nr =\u03b1 +\u03b2r\nit i i Mt\nIf the data is correlated with correlation \u03c1 , then we expect\n\u03c1\u03c3\n\u03b1 =E( r )\u2212\u03b2E( r) ,\u03b2 = i ,R2 =\u03c12\ni M i i i \u03c3\nM\nIn capital market calculations \u03b2 \u03b9 is typically calculated for monthly returns\nover a period of 3 to 5 years. Below replicate this procedure by simulating the\n60 correlated returns of two assets. We will call the first asset \u201c i\u201d and the\nsecond asset \u201c M .\u201d We start with some basic data for i and M :\nA B C D E\n2 Mean Sigma\n3 Stock i 6% 22%\n4 Market 10% 15%\n5 Correlation(i,M) 0.3000\n716 Chapter 27\nWe now simulate our data:\nA B C D E F\n1 SIMULATING BETA AND ALPHA\n2 Mean Sigma\n3 Stock i 6% 22%\n4 Market 10% 15%\n5 Correlation(i,M) 0.3000\n6\n7 Anticipated \u03b1 0.0160<-- =mu_i-B8*mu_m\ni\n8 Anticipated \u03b2 0.4400<-- =rho*sigma_i/sigma_m\ni\n9 Anticipated R2 0.0900<-- =rho^2\n10\n11\n12 Regress r on r\ni M\n13 Alpha 0.0086<-- =INTERCEPT(E20:E79,F20:F79)\n14 Slope 0.4390<-- =SLOPE(E20:E79,F20:F79)\n15 R-squared 0.0827<-- =RSQ(E20:E79,F20:F79)\n16\n17 Simulation\n18 Month Normal Returns\n19 Z Z Stock Market\n1 2\n20 1 0.6168 -1.4645 9.92% 3.66%\n21 2 0.9019 1.1497 11.73% 14.98%\n72 53 1.1386 -2.1888 13.23% 0.52%\n73 54 -0.4403 1.0415 3.20% 14.51%\n74 55 -1.5644 -1.4113 -3.94% 3.89%\n75 56 1.2524 0.6107 13.95% 12.64%\n76 57 1.3170 0.7016 14.36% 13.04%\n77 58 -1.3743 -1.3212 -2.73% 4.28%\n78 59 -2.2023 0.2114 -7.99% 10.92%\n79 60 -0.1458 -1.1017 5.07% 5.23%\n80\n81 Formulas\n82 Cell B20:=NORM.S.INV(RAND())\n83 Cell C20:=rho*B20+SQRT(1-rho^2)*NORM.S.INV(RAND())\n84 Cell E20:=mu_i+sigma_i*SQRT(1/12)*B20\n85 Cell F20:=mu_m+sigma_m*SQRT(1/12)*C20\nThe formulas used in the spreadsheet:\n\u2022 Z = Norm.S.Inv(Rand( )) . As discussed in Chapter 24 this creates a stan-\n1\ndard normal deviate.\n\u2022 Z =\u03c1\u2217Z +norm.s.inv( rand( ))\u2217 1\u2212\u03c12 . As discussed in Chapter 24\n2 1\nthe standard normal deviate Z has correlation \u03c1 with Z .\n2 1\n\u2022 The column for the stock returns is created by r =\nstock\n\u03bc +\u03c3 1/12\u2217Z .\n717 Monte Carlo Simulations for Investments\n\u2022 T he column for the market returns is created by r =\nmarket\n\u03bc +\u03c3 1/12\u2217Z .\nmarket market 2\nThe result is that the market and stock returns are correlated with correlation\n\u03c1 . We now run a standard first-pass regress of r on r . For the simulations\ni M\ndiscussed above, the results of the Monte Carlo simulation are not far from\nthe theoretical results:\nA B C D E F\n7 Anticipated \u03b1 0.0160<-- =mu_i-B8*mu_m\ni\n8 Anticipated \u03b2 0.4400<-- =rho*sigma_i/sigma_m\ni\n9 Anticipated R2 0.0900<-- =rho^2\n10\n11\n12 Regress r on r\ni M\n13 Alpha 0.0086<-- =INTERCEPT(E20:E79,F20:F79)\n14 Slope 0.4390<-- =SLOPE(E20:E79,F20:F79)\n15 R-squared 0.0827<-- =RSQ(E20:E79,F20:F79)\nRerunning the simulation shows that not all results will be close to the\ndesired. Below, for example, is another set of simulations in which the Monte\nCarlo \u03b2 \u03b9 is quite distant from the anticipated \u03b2 \u03b9 :\nA B C D E F\n7 Anticipated \u03b1 0.0160<-- =mu_i-B8*mu_m\ni\n8 Anticipated \u03b2 0.4400<-- =rho*sigma_i/sigma_m\ni\n9 Anticipated R2 0.0900<-- =rho^2\n10\n11\n12 Regress r on r\ni M\n13 Alpha -0.0037<-- =INTERCEPT(E20:E79,F20:F79)\n14 Slope 0.5942<-- =SLOPE(E20:E79,F20:F79)\n718 Chapter 27\nIf we repeat our experiment 50 times, we see that the computed \u03b2 \u03b9 exhibits\nconsiderable variability:\n50 Simulated Betas\n1.00\n0.90\n0.80\n0.70\n0.60\n0.50\n0.40\n0.30\n0.20\n0.10\n0.00\n1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 41 43 45 47 49\nSimulated beta Theore(cid:2)cal beta\nAre Beta and Alpha Related?\nT here is a growing literature showing that low beta stocks have high alphas\nand vice versa. 3 We show that this is true in our Monte Carlo simulation. In\nthe spreadsheet below we run a Data Table showing beta and alpha as func-\ntions of \u03c3 . 4\ni\n3. For references, see Frazzini-Pedersen (2011), Cremers-Petajisto-Zitzewitz (2010), Hong-Sraer\n(2012), and Nardin-Haugen (2012).\n719 Monte Carlo Simulations for Investments\nHere are two more variations. In the first variation we have assumed a much\nhigher \u03c3 for the market portfolio:\n0.08\n0.06\n0.04\n0.02\n0.00\n-0.020.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4\n-0.04\n-0.06\ny = -0.0997x + 0.0638\n-0.08\nR\u00b2 = 0.5348\n-0.10\n-0.12\n-0.14\nahplA\nH I J K L M N O\n4 Intercept 0.0647<-- =INTERCEPT(J10:J20,I10:I20)\n5 Slope -0.0978<-- =SLOPE(J10:J20,I10:I20)\n6 Rsq 0.9826<-- =RSQ(J10:J20,I10:I20)\n7\n8 Sigma_i Beta_i Alpha_i\n9 0.5706 0.0106<-- =B13, data table header\n10 0% 0.000 0.060\n11 20% 0.584 -0.004\n12 30% 1.068 -0.033\n13 40% 0.944 -0.029 0.10\n14 50% 1.354 -0.070 0.05\n15 60% 1.841 -0.086 0.00\n16 70% 2.487 -0.200 -0.050.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5\n17 80% 2.813 -0.230\n-0.10\n18 90% 2.359 -0.168\n-0.15\n19 100% 1.722 -0.083\n-0.20\n20 110% 4.252 -0.345\n21 -0.25 y = -0.0978x + 0.0647\n22 -0.30 R\u00b2 = 0.9826\n-0.35\n23\n24 -0.40\n25\nAlpha versus Beta:\nParameters: (sigma_M,rho): (40%, 0.4)\nBeta\nahplA\nAlpha versus Beta:\nParameters: (sigma_M,rho): (15%, 0.4)\n720 Chapter 27\nI n the second variation, we change the correlation between the market\nportfolio and stock i :\n0.10\n0.08\n0.06\n0.04\n0.02\n0.00\n-0.020.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n-0.04\ny = -0.101x + 0.0673\n-0.06\nR\u00b2 = 0.9349\n-0.08\n-0.10\nahplA\nAlpha versus Beta:\nParameters: (sigma_M,rho): (15%, 0.2)\nBeta"
        ],
        "27.8": [
            "What are Monte Carlo techniques in the context of investment problems?\nWhat do Monte Carlo techniques reveal about investment problems beyond mean and standard deviation of returns?\nWhat are some common cases of asset management?\nHow can we calculate the return on a single stock using Monte Carlo techniques?\nIn what way can we determine the return on a portfolio of risky assets with a given correlation structure using Monte Carlo simulations?\nWhat is a standard savings/pension problem with an uncertain investment component in financial modeling?\nHow is the computation of asset betas achieved in financial modeling?\nWhat is the role of Monte Carlo simulations in analyzing a standard savings/pension problem with an uncertain investment component?\nHow are asset betas computed using Monte Carlo techniques?\nWhat are asset betas in financial modeling?\nWhat does the correlation structure of a portfolio of risky assets mean in financial modeling?",
            "27.8 Summary\n\nM onte Carlo techniques give insight into investment problems that goes\nbeyond the standard calculations of mean and standard deviation of returns.\nIn this chapter we examine some common cases of asset management: the\nreturn on a single stock, on a portfolio of risky assets with a given correlations\nstructure, a standard savings/pension problem with an uncertain investment\ncomponent, and the computation of asset betas."
        ]
    },
    "28": {
        "28.1": [
            "What is Value at Risk (VaR)?\nHow can one define the term \"RiskMetrics\" as stated by J.P. Morgan?\nHow is VaR used in financial modeling?\nWhat is the significance of the time period T in risk measurement?\nCan you explain the role of the confidence level in risk assessment?\nWhat is meant by the lowest quantile in the context of VaR?\nHow can the time horizon of the VaR model vary?\nWhy might external regulatory requirements such as bank capital requirements enforce a very small quantile in risk measurement?\nHow does a company's internal risk management model typically utilize VaR?\nWhere can a general introduction to VaR be found?\nWhat does a daily VaR of $1 million at 1% mean for a portfolio manager? \nCan you explain the meaning of a daily loss more significant than $1 million under normal market conditions? \nHow do the overall goals of risk measurement influence the choice of the two major parameters- time period T and the confidence level?",
            "28.1 Overview\n\nV alue at risk (VaR) measures the worst expected loss under normal market\nconditions over a specific time interval at a given confidence level. As one of\nour references states: \u201cVaR answers the question: how much can I lose with\nx % probability over a pre-set horizon?\u201d (J. P. Morgan, R iskMetrics\u2014Technical\nDocument1 ). Another way of expressing this is that VaR is the lowest quantile\nof the potential losses that can occur within a given portfolio during a specified\ntime period. The basic time period T and the confidence level (the quantile) q\nare the two major parameters that should be chosen in a way appropriate to\nthe overall goal of risk measurement. The time horizon can differ from a few\nhours for an active trading desk to a year for a pension fund. When the primary\ngoal is to satisfy external regulatory requirements, such as bank capital require-\nments, the quantile is typically very small (e.g., 1% of worst outcomes).\nHowever, for an internal risk management model used by a company to control\nthe risk exposure, the typical number is around 5% (visit the Internet sites in\nSelected References for more details). A general introduction to VaR can be\nfound in Linsmeier and Pearson (1996) and in Jorion (1997).\nI n the jargon of VaR, suppose that a portfolio manager has a daily VaR equal\nto $1 million at 1%. This statement means that there is only one chance in\n100 that a daily loss bigger than $1 million occurs under normal market\nconditions."
        ],
        "28.2": [
            "What is a portfolio in financial terms?\nWhat does it mean when an asset's return is normally distributed?\nHow is the mean return of an asset calculated?\nWhat does the standard deviation in an asset's return signify?\nWhat does the end-of-year distribution of a portfolio value refer to?\nWhat does it mean when the end-of-year portfolio value is less than $80 million?\nWhat is the significance of the probability of a loss of more than $20 million by year-end?\nWhat is Value at Risk (VaR) in financial terms?\nHow is the maximum loss at the end of the year calculated with 1% probability? \nWhat is the significance of VaR at 1%?\nWhat does the Norm.Dist function in Excel indicate?\nHow is the Norm.Dist function used to determine the probability of the year-end value of a portfolio?\nWhat is the difference between using the TRUE and FALSE value in the last entry in Norm.Dist function?\nWhat does the cumulative normal distribution indicate in financial terms?\nWhy is the probability mass function of the portfolio value's year-end important in financial modeling?",
            "28.2 A Really Simple Example\n\nS uppose a manager has a portfolio that consists of a single asset. The return\nof the asset is normally distributed with mean return 20% and standard devia-\ntion 30%. The value of the portfolio today is $100 million. We want to answer\nvarious simple questions about the end-of-year distribution of portfolio value:\n1. What is the distribution of the end-of-year portfolio value?\n2 . W hat is the probability of a loss of more than $20 million by year-end (i.e.,\nwhat is the probability that the end-of-year value is less than $80 million)?\n* T his chapter is based on an article written with Zvi Wiener, \u201cValue-at-Risk (VaR),\u201d which first\nappeared in Mathematica in Education and Research 7 (1998).\n1 . T his and other valuable documents produced by J. P. Morgan can be found on the disk that\n724 Chapter 28\n3. With 1% probability, what is the maximum loss at the end of the year? This\nis the VaR at 1%.\nT he probability that the end-of-year portfolio value is less than $80 million is\nabout 9%:\nA B C D\n1 PROBABILITY OF YEAR-END PORTFOLIO VALUE\n2 Mean 20%\n3 Sigma 30%\n4 Initial investment 100\n5 Cutoff 80\nProbability that\nportfolio worth less\n6 than cutoff 9.12%<-- =NORMDIST(B5,(1+B2)*B4,B4*B3,TRUE)\n7\nData table header: =NORMDIST(B5,(1+B2)*B4,B4*B3,FALSE)\n8\n9\n10 Portfolio value 0.0055\nEnd-of-Year Portfolio Value\n11 0 0.0000\n12 10 0.0000 0.014\n13 20 0.0001 0.012\n14 30 0.0001\n15 40 0.0004 0.010\n16 50 0.0009 0.008\n17 60 0.0018\n18 70 0.0033 0.006\n19 80 0.0055\n0.004\n20 90 0.0081\n21 100 0.0106 0.002\n22 110 0.0126\n0.000\n23 120 0.0133\n24 130 0.0126 0 25 50 75 100 125 150 175 200 225 250\n25 140 0.0106\n26 150 0.0081\n27 160 0.0055\nExcel \u2019 s Norm.Dist function can return both the cumulative distribution and\nthe probability mass function.2 Here\u2019 s the way the screen looks when we apply\nthe Norm.Dist function in cell B6:\n725 Value at Risk (VaR)\nThe spreadsheet uses two versions of Norm.Dist: First we use the function\nin cell B6 to determine the probability that the year-end value of the portfolio\nis less than 80. In this version of the function, we use the value TRUE for the\nlast entry in Norm.Dist; when we write = NORMDIST(B5,(1 + B2)*B4,B4*B\n3,TRUE), N orm.Dist returns values of the cumulative normal distribution. In\nthe data table we set this value to FALSE to plot the probability mass function\nof the year-end portfolio value."
        ],
        "28.3": [
            "What does the term \"quantile\" refer to in the context of finance?\nHow do you define Quantiles in Excel, in the context of financial modelling?\nCan you explain the use of the Solver function in Excel for determining portfolio values?\nWhat is the Value at Risk (VaR) per the definition stated in financial modelling?\nHow does a cutoff point of a normal distribution get calculated in Excel?\nWhat is the significance of the end-of-year portfolio value in financial modelling?\nHow can Excel be used to find the quintile of a normal and lognormal distribution?\nWhat built-in functions defined in Excel help in determining the quintile for normal and lognormal distributions?\nWhat is the lognormal distribution and how is it relevant to financial modelling?\nHow is the lognormal distribution useful in evaluating asset prices?\nWhat does it mean for the return on a portfolio to be normally distributed?\nHow is the time period \"T\" in the lognormal distribution expression used in financial calculations?\nWhat is the process of calculating the annual value at risk (VaR) with a lognormal distribution?\nWhat parameters are taken into account for a portfolio whose annual returns are lognormally distributed?\nHow is value at risk (VaR) calculated for non-annual periods such as several days or weeks?\nWhat is the typical time period for value at risk (VaR) calculations in regulatory and management concern?\nHow can the distribution formula be adapted to calculate the VaR over any specific horizon?",
            "28.3 Defining Quantiles in Excel\n\nBy using Excel \u2019 s Solver , we can determine that with a probability of 1%, the\nend-of-year portfolio value will be less than 50.209. Recall that the value at\nrisk is the worst expected loss under normal market conditions over a specific\ntime interval at a given confidence level. Therefore, the value 50.210 means\n726 Chapter 28\nA B C D E F G\n1 PROBABILITY OF END-YEAR PORTFOLIO VALUE\n2 Mean 20%\n3 Sigma 30%\n4 Initial investment 100\n5 Cutoff 50.210\nProbability that portfolio\n6 worth less than cutoff 1.00%<-- =NORMDIST(B5,(1+B2)*B4,B4*B3,TRUE)\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\nThe cutoff is known as the quantile of the distribution. In Excel it can be\ndetermined by using S olver , as illustrated above. For two distributions we\nuse\u2014the normal and the lognormal distributions\u2014Excel has built-in functions\nwhich find the quintile. These functions\u2014N orm.Inv , Norm.S.Inv , and\nLoginv \u2014find the inverse for the normal, standard normal, and lognormal\ndistributions.\nH ere\u2019 s an example for the numbers given above; this time we have written\nthe function = NORM.INV(0.01,(1 + B3)*B5,B5*B4) in cell B6. This function\nfinds the cutoff point for which the normal distribution with mean = 120 and\nstandard deviation = 30 has probability of 1%. You can see this point on the\n727 Value at Risk (VaR)\nA B C\n1 CALCULATING THE QUANTILES\n2 Mean 20%\n3 Sigma 30%\n4 Initial investment 100\n5 Cutoff 50.210<-- =NORMINV(0.01,(1+B2)*B4,B4*B3)\n6 1.00%<-- =NORMDIST(B5,(1+B2)*B4,B4*B3,TRUE)\n7\n8 VaR at 1.00% level 49.790<-- =B5-B6\n9\n10\n11\n12\n13 3.0%\n14\n15 2.5%\n16 2.0%\n17\n18 1.5%\n19 1.0%\n20\n21 0.5%\n22 0.0%\n23 -20 -15 -10 -5 0 5 10 15 20 25 30 35 40 45 50 55 60 65\n24\n25\nThe Lognormal Distribution\nThe lognormal distribution is a more reasonable distribution for many asset\nprices (which cannot become negative) than the normal distribution. Suppose\nthat the return [return = Log(price relative)] on the portfolio is normally dis-\ntributed with annual mean \u03bc and annual standard deviation \u03c3 . Furthermore,\nsuppose that the current value of the portfolio is given by V . Then it follows\n0\n(see Hull, 2011) that the logarithm of the portfolio value at time T , V , is\nT\nnormally distributed. 3 This means:\n\u23a1 \u239b \u03c32\u239e \u23a4\nln( V T) ~Normal \u23a3\u23a2ln( V 0)+ \u239d\u239c\u03bc\u2212\n2\n\u23a0\u239fT,\u03c3 T \u23a6\u23a5\nytilibaborP\nCumulative Normal Distribution\n(only part--so we can see the 1% quantile)\n1% quantile point\nPortfolio value (million $)\n728 Chapter 28\nSuppose, for example, that V = 100,\u03bc = 10%,\u03c3 = 30%. Thus the end-of-year\n0\nlog of the portfolio value is distributed normally:\nln(\nV\n1) ~Normal\u23a1 \u23a3\u23a2ln( 100)+\u239b \u239d\u239c0.10\u22120. 232\u239e \u23a0\u239f,0.3\u23a4 \u23a6\u23a5=Normal[ 4.6666017,0.3]\nThus a portfolio whose initial value is $100 million and whose annual returns\nare lognormally distributed with parameters \u03bc = 10% and \u03c3 = 30%, has an\nannual VaR equal to $47.42 million at 1%:\nA B C\nQUANTILES FOR LOGNORMAL\nDISTRIBUTION\n1\n2 Initial value, V 100\n0\n3 Mean, m 10%\n4 Sigma, s 30%\n5 Time period, T 1 <-- in years\n6\n7 Parameters of normal distribution of ln(V )\nT\n8 Mean 4.6602 <-- =LN(B2)+(B3-B4^2/2)*B5\n9 Sigma 0.3000 <-- =B4*B5\n10\n11 Cutoff 52.576 <-- =LOGINV(0.01,B8,B9)\n12 VaR at 1% level 47.424 <-- =B2-B11\nMost VaR calculations are not concerned with annual value at risk. The main\nregulatory and management concern is with loss of portfolio value over a much\nshorter time period (typically several days or perhaps weeks). It is clear that\n\u23a1 \u239b \u03c32\u239e \u23a4\nthe distribution formula ln( V T) ~Normal \u23a3\u23a2ln( V 0)+ \u239d\u239c\u03bc\u2212\n2\n\u23a0\u239fT,\u03c3 T \u23a6\u23a5 can\nbe used to calculate the VaR over any horizon. Recall that T is measured in\nannual terms; if there are 250 business days in a year, then the daily VaR cor-\nresponds to T = 1/250 (for many fixed income instruments, one should use\n1/360, 1/365, or 1/365.25, depending on the market convention):"
        ],
        "28.4": [
            "What is the value at risk (VaR)?\nHow is VaR implemented in real-world applications?\nWhat parameters are estimated in the application of VaR?\nWhy is the estimation of asset return distributions a challenging problem in implementing VaR?\nIn the context of financial modeling, what is the importance of correlations between asset returns?\nWhat issue arises with the calculation of position sizes in the implementation of VaR?\nWhat are the factors contributing to a bank's risk when it has offsetting positions in foreign currencies at different branches in different locations?\nWhat does the variance-covariance matrix signify in financial modelling?\nWhat do the terms mean return and variance of return signify in a financial model of a portfolio?\nIn terms of financial portfolios, what is meant by 'risky assets'?\nHow is the Return distribution of a portfolio calculated?\nIn a three-asset financial model, how are the proportions invested in each asset represented?\nWhat assumption is made about the returns when calculating the VaR in a three-asset model?\nHow is VaR calculated in a spreadsheet model for a three-asset problem?\nIn the context of implementing VaR, what is the correlation between asset returns and why is it important?\nWhat are the typical challenges faced by a large financial institution in calculating position sizes?\nIn a variance-covariance matrix, what does \u03c3 represent?\nWhat is the significance of the total portfolio value in a financial model?",
            "28.4 A Three-Asset Problem: The Importance of the Variance-Covariance Matrix\n\nAs can be seen from the preceding examples, VaR is not\u2014in principle, at\nleast\u2014a very complicated concept. In the implementation of VaR, however,\n729 Value at Risk (VaR)\ngreater detail in the material available on the RiskMetrics website, w ww.msci.\ncom/resources/ ):\n1. The first problem is the estimation of the parameters of asset return distri-\nbutions. In \u201creal world\u201d applications of VaR, it is necessary to estimate means,\nvariances, and correlations of returns. This is a not-inconsiderable problem!\nIn this section we illustrate the importance of the correlations between asset\nreturns. In the following section we give a highly simplified example of the\nestimation of return distributions from market data. For example, you can\nimagine that a long position in euros and a short position in U.S. dollars are\nless risky than a position in only one of the currencies, because of a high\nprobability that profits of one position will be mainly offset by losses of\nanother.\n2 . T he second problem is the actual calculation of position sizes. A large\nfinancial institution may have thousands of loans outstanding. The database\nof these loans may not classify them by their riskiness, nor even by their term\nto maturity. Or\u2014to give a second example\u2014a bank may have offsetting posi-\ntions in foreign currencies at different branches in different locations. A long\nposition in euros in New York may be offset by a short position in euros in\nGeneva; the bank\u2019 s risk\u2014which we intend to measure by VaR\u2014is based on\nthe net position.\nWe start with the problem of correlations between asset returns. We continue\nthe previous example, but assume that there are three risky assets. As before,\nthe parameters of the distributions of the asset returns are known: all the\nmeans, \u03bc , \u03bc , \u03bc , as well as the variance-covariance matrix of the returns:\n1 2 3\n\u239b\u03c3 \u03c3 \u03c3 \u239e\n11 12 13\nS=\u239c\u03c3 \u03c3 \u03c3 \u239f\n\u239c 21 22 23\u239f\n\u239d\u03c3 \u03c3 \u03c3 \u23a0\n31 32 33\nThe matrix S is of course symmetric; \u03c3 is the variance of the i th asset \u2019 s return,\nii\nand \u03c3 is the covariance of the returns of assets i and j (if i = j\u03c3 , is the vari-\nij ij\nance of asset i \u2019 s return).\nSuppose that the total portfolio value today is $100 million, with $30 million\ninvested in asset 1, $25 million in asset 2, and $45 million in asset 3. Then\nthe return distribution of the portfolio is given by:\nMeanreturn=x \u03bc +x \u03bc +x \u03bc\n1 1 2 2 3 3\nVarianceof\nreturn={\nx,x ,x\n} .S.{\nx,xx ,x\n}T\n730 Chapter 28\nwhere x = { x , x , x } = {0.3, 0.25, 0.45} is the vector of proportions invested\n1 2 3\nin each of the three assets. Assuming that the returns are normally distributed\n(meaning that prices are lognormally distributed), we may calculate the VaR\nas in the following spreadsheet:\nA B C D E F G H\n1 VaR FOR 3 ASSET PROBLEM\nMean Portfolio\nVariance-covariance matrix\n2 returns proportions\n3 Asset 1 10% 0.10 0.04 0.03 0.30\n4 Asset 2 12% 0.04 0.20 -0.04 0.25\n5 Asset 3 13% 0.03 -0.04 0.60 0.45\n6\n7 Initial investment 100\n8 Mean return 0.1185<-- {=MMULT(TRANSPOSE(B3:B5),H3:H5)}\n9 Portfolio sigma 0.3848<-- {=SQRT(MMULT(MMULT(TRANSPOSE(H3:H5),D3:F5),H3:H5))}\n10\n11 Mean investment value 111.8500\n12 Sigma of investment value 38.4838\n13\n14 Cutoff 22.3234<-- =NORMINV(0.01,(1+B8)*B7,B9*B7)\n15 Cumulative PDF 0.01<-- =NORMDIST(B14,B11,B12,TRUE)\n16 VaR at 1.00% level 77.6766<-- =B7-B14\n17\nNote that the functions in cells B8 and B9 are array\nfunctions: You must press [Ctrl]+[Shift]+[Enter] after\nyou write the function in the cell. The curly brackets {}\nare not written--they appear automatically.\n18"
        ]
    },
    "29": {
        "29.1": [
            "What is the concept of simulating options and option strategies in financial modeling?\nWhat does a dynamic portfolio consist of when replicating an option on a stock?\nWhat is the Black-Scholes formula and how can it be interpreted?\nWhat do you mean by the dynamic strategy being 'self-financing' as per the Black-Scholes formula?\nWhat are the challenges faced in replicating the option strategy portfolio continuously?\nWhat is the method to simulate a stock price?\nHow does the Black-Scholes formula determine the prices of a European call and put?\nIn the context of the Black-Scholes formula, what do stock and bond positions represent in an option?\nWhat are the implications of rebalancing a portfolio that replicates an option with stocks and bonds?\nWhat is the 'self-financing' property in the Black-Scholes replicating portfolio?\nWhat occurs when the replicating portfolio is not frequently rebalanced?\nHow do the changes in stock and bond positions offset each other in a continuously rebalanced portfolio?\nWhy is the concept of a 'zero-investment property' significant in financial modeling?\nHow does the change in a stock's price affect the investment required to reach the replicating portfolio?\nWhat is the process to adjust the stock and bond positions in a replicating portfolio? \nWhat is the effect of stock price on the net cash flow in a replicating portfolio?\nWhat do the position changes in a replicating portfolio signify?\nWhat happens when the time period \u0394 t diminishes in the Black-Scholes model?\nHow does the Black-Scholes model prove the strategy is completely self-financing?",
            "29.1 Overview\n\nI n this chapter we simulate options and option strategies. We start by showing\nhow an option on a stock can be replicated by a dynamic portfolio of the stock\nand a bond. We go on to apply this approach to portfolio insurance (a combi-\nnation of a put and stock) and to a butterfly. Our approach has its roots in the\nBlack-Scholes formula. This formula can be interpreted as showing that an\noption is a portfolio of a position in the underlying asset and a position in the\nrisk-free asset, where both positions are adjusted dynamically over time.\nRemarkably, the Black-Scholes formula shows that if the adjustment process\nis continuous, then the dynamic strategy is self-financing: It requires no addi-\ntional cash flows after the establishment of the initial portfolio.\nI n a more realistic situation it is of course impossible to replicate the option\nstrategy portfolio continuously. We have to compromise by making only peri-\nodic adjustments, and this forces us to consider first how to define the strategy\nover time, and second how well the compromise strategy performs in replicat-\ning the option strategy. We will show several approaches to this problem.\nBackground: Price Simulations and the Black-Scholes Formula\nR ecall from Chapter 26 that the way to simulate a stock price is to simulate\nS\nt\n=S t\u22121\u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3 \u0394tZ\u23a4 \u23a6 , where Z is a draw from a standard normal\ndistribution. In Excel this formula becomes: 1\nS\nt\n=S t\u22121\u2217exp\u23a1 \u23a3\u03bc\u0394t+\u03c3 \u0394t\u2217Norm.S.Inv( Rand( ))\u23a4 \u23a6\nWe will use this formula throughout the chapter to simulate stock prices.\nRecall also that the Black-Scholes formula, explained in Chapter 17, states\nthat the prices of a European call and put are given by:\nCall=SN(\nd\n)\u2212Xe\u2212rTN(\nd\n)\n1 2\nPut=\u2212SN(\u2212d )+Xe\u2212rTN(\u2212d )\n1 2\n( ) ( )\nln S + r+\u03c3\u03c32 T\nd = X 2 ,d =d \u2212\u03c3 T\n1 \u03c3 T 2 1\n1. The Excel function Norm.S.Inv is equivalent to the older version, N ormsinv. Both functions\n746 Chapter 29\nIn this chapter our interpretation of this formula is that an option can be\nreplicated by a long or short position in the underlying stock and a long or\nshort position in the risk-free asset (jargon: \u201cthe bond\u201d):\nStock position Bond position\nCall=SN( d) SN( d) \u2212Xe\u2212t*(T\u2212t)N(\nd\n)\n1 t 1 2\n\u2212Xe\u2212rTN( d 2) Long position in stock Short position in bond\nPut=\u2212SN(\u2212d 1) \u2212S tN(\u2212d 1) Xe\u2212t*(T\u2212t)N(\u2212d 2)\n+Xe\u2212rTN(\u2212d 2) Short position in stock Long position in bond\nI t follows that if we replicate an option with a portfolio of stocks and bonds,\nthis portfolio needs to be rebalanced often. A remarkable fact, proved by Black\nand Scholes in their pathbreaking 1973 paper, is that if the rebalancing is\ncontinuous, then the changes in the stock and bond positions exactly offset\neach other. This zero-investment property is also termed \u201cself-financing\u201d and\nis a hallmark of the Black-Scholes replicating portfolio.\nW hile we cannot prove this fact, we can give some intuition. In the spread-\nsheet below, we look at two very close times. At time t = 0, we price a call\noption on a stock whose current price is S = 50. The option has exercise price\n0\nX = 50, and expires at T = 0.5. The replicating portfolio for the option is\n28.9698 in the stock and \u201324.2745 in the bond, giving a call option value of\n4.6952 (cell B19).\nAt time \u0394 t = 1/250 (roughly 1 day later), a randomly generated stock price\nis 49.8708. The replicating portfolio is now 28.6400 in the stock and \u201324.0399\nin the bond. To compute the investment required to reach this portfolio, we\nhave to revalue the previous investments in the stock and the bond. The\n49.8708\nprevious stock position has grown in value to 28.9698\u2217 =28.8949\n50\nand the previous bond position now has value of \u221224.2745\u2217er*\u0394t =\u221224.2784\n(1 day \u2019 s interest has been added). This means that we must sell off some of\nthe stock: (28.6400 \u2212 28.8949) = 0.2548. Thus the cash flow from the change\nin the stock position is positive. In the bond position we want to change the\ndebt from \u2212 24.2784 to \u2212 24.0399; this means that we require cash of 0.2385\nto pay off some of the debt. The net cash flow from these changes is + 0.2549\n747 Simulating Options and Option Strategies\nA B C D E F G\n1 BLACK-SCHOLES AS A PORTFOLIO\n2 \u0394t 0.0040<-- =1/250\n3\n4 Time = 0 Time = \u0394t\n5 S 50.0000 49.8708\n6 X 50.0000 50.0000\n7 r 4.00% 4.00%\n8 T, time to option maturity 0.5000 0.4960<-- =B8-B2\n9 Sigma 30% 30%\n10\n11 d 1 0.2003 0.1873 =E18-C18\n12 d 2 -0.0118 -0.0240\n13\nCash flow\n14 N(d 1) 0.5794 0.5743 =B17*C5/B5 Value of from =E17-C17\n15 N(d 2) 0.4953 0.4904 previous position\n16 position change\n17 Stock position, S*N(d 1) 28.9698 28.6401<-- =C5*C14 28.8949 0.2548<-- \u0394stock\n18 Bond position, -X*N(d 2) -24.2745 -24.0399<-- =-C6*EXP(-C8*C7)*C15 -24.2784 -0.2385<-- \u0394bond\n19 Value of call option 4.6952 4.6002<-- =SUM(C17:C18) 0.0163\n20\n21 =B18*EXP(B7*B2)\n=SUM(F17:F18) net\n22\ncash flow from\n23\nposition change\n24\nThe Excel notebook with this chapter gives a dynamic spreadsheet for the\nabove example that changes values with each press of F 9. Using this spread-\nsheet you can confirm:\n\u2022 The position changes rarely completely net out.\n\u2022 The smaller the \u0394 t, the smaller the net cash flow will be from the position\nchange. Black-Scholes proved that in the limit, this net cash flow is always\nzero, and that the strategy is thus completely self-financing."
        ],
        "29.2": [
            "What does imperfect but cashless replication of a call option imply?\nWhat does the Black-Scholes formula require in order to perfectly replicate a call option?\nHow is the initial portfolio set while implementing a self-financing strategy using Black-Scholes formula?\nHow is the change in stock position taken into account under this strategy?\nWhat is the significance of time in strategizing the stock and bond position?\nHow the put and call options differ when imperfectly replicated?\nWhat is the role of continuous trading in replicating a call option?\nCould you describe a scenario when a Black-Scholes value differs from the portfolio value?\nWhat does it mean to have a self-financing replication strategy in financial modeling?\nHow are stock positions determined throughout the duration of an imperfect cashless replication?\nHow would the investment portfolio payoff calculated in an imperfect cashless replication?\nHow are the stock and bond positions set at different times during imperfect cashless replication?\nWhat is the process of replicating a put option?\nWhat does running a simulation multiple times accomplish in financial modeling?\nWhat are the concluding measures to determine if the imperfect replication strategy works effectively?\nWhat are the primary components of a replicating portfolio in financial modeling?\nWhat happens during the final payoff stage in an imperfect cashless replication?\nHow does the imperfect but cashless strategy differ from perfect cashless strategy during replication of a call option?\nIn which scenario are continuous trades necessary in financial modeling?\nWhat are some common statistical measures used in evaluating the results of simulations in financial modeling?",
            "29.2 Imperfect but Cashless Replication of a Call Option\n\nTo perfectly replicate a call option using the Black-Scholes formula will\nrequire continuous trading. Suppose we compromise a bit on strictly following\nthe BS formula. In what follows we use the strategy of replication, but force\nit to be self-financing. We do this as follows:\n\u2022 At time 0, we set the initial portfolio equal to that prescribed by the BS\nformula: S tock = S N ( d ), Bond = \u2212 X \u2212e rT N ( d )\n748 Chapter 29\n\u2022 At times t > 0, we set the stock position = S N ( d ) , but we set the bond posi-\nt 1\ntion equal to the cash flow from the change in the stock position:\nBond\nt+\u0394t\n= (cid:2)Bo(cid:4)nd(cid:3)t\u2217 (cid:4)e(cid:5)r\u0394t +SS tN( d 1,t)\u2217S t+\u0394t \u2212S (cid:2)t+(cid:4)\u0394t(cid:4)N (cid:3)( d (cid:4)1,t(cid:4)+(cid:5)\u0394t)\n\u2191\n(cid:2)(cid:4)(cid:4)(cid:3)(cid:4)(cid:4)(cid:4)S(cid:5)t\n\u2191\nt+\u0394t value \u2191 t+\u0394t desired\nof time t bond t+\u0394t value stock position\nposition of time t\nstock position\n=Bond \u2217\u2217er\u0394t +S { N( d )\u2212N( d )}\nt t+\u0394t 1,t 1,t+\u0394t\nH ere\u2019 s the way this looks. At t = 0 the replicating portfolio is exactly equiva-\nlent to the Black-Scholes (cells H13:I13), but at t > 0, the Black-Scholes value\nis different from the portfolio value (though quite close).\nA B C D E F G H I\nIMPERFECT BUT CASHLESS REPLICATION OF CALL OPTION WITH PORTFOLIO\nRequires no investment over time but doesn't perfectly match Black-Scholes\n1\n2 S, stock price 50\n0\n3 X, exercise price 50\n4 T, strike date 0.5\n5 Mean stock return (mu) 12%\n6 Sigma of stock return 30% =E13*EXP(interest*Delta_t)+B14*(NO\n7 r, interest rate 4% RM.S.DIST(done(B13,exercise,C13,int\n8 Delta_t 0.0192<-- =1/52 erest,Sigma),1)-\nNORM.S.DIST(done(B14,exercise,C14\n9 ,interest,Sigma),1))\n=B14*NORM.S.DIST(done(B14,exe\n10 rcise,C14,interest,Sigma),1)\nReplicating\n11 portfolio Comparing BS to portfolio value\nStock Time Portfolio -\n12 Week price remaining Stock Bond Portfolio BS BS\n13 0 50.0000 0.5000 28.9698 -24.2745 4.6952 4.6952 0.0000\n14 1 51.0829 0.4808 31.5541 -26.2502 5.3039 5.2435 0.0605\n15 2 47.5675 0.4615 22.7932 -19.6809 3.1123 3.2099 -0.0977\n749 Simulating Options and Option Strategies\nHere \u2019 s the result in terms of final payoffs:\nA B C D E F G H I\n34 21 44.5525 0.0962 5.5524 -5.4820 0.0705 0.2463 -0.1759\n35 22 45.1987 0.0769 5.7963 -5.6495 0.1468 0.2324 -0.0856\n36 23 48.2980 0.0577 16.4192 -15.8793 0.5399 0.7571 -0.2172\n37 24 45.4011 0.0385 2.5675 -3.0246 -0.4571 0.0630 -0.5201\n38 25 48.4558 0.0192 11.5024 -11.7891 -0.2867 0.2752 -0.5619\n39 26 50.0476 0.0000\n40\n41 Final payoff\nPerfectly replicated\n42 option 0.0476<-- =MAX(B39-exercise,0)\nInvestment portfolio\n43 payoff 0.0821<-- =D38*B39/B38+EXP(interest*Delta_t)*E38\nW e run this simulation 50 times and compare the payoffs on the perfect\nreplication with those of the investment portfolio. We use the technique from\nChapter 31, \u201c Data Table on a blank cell,\u201d to run the simulation. Our conclu-\nsion: By and large, the imperfect replication strategy works ok.\nA B C D E F G H I J K\n46 Data table: running 50 replications\nDifference:\nPerfect Perfect -\n47 Simulation replication Portfolio portfolio\n48\n49 1 12.8857 13.6891 -0.8034 Statistics for 50 simulations\n50 2 20.2031 20.8742 -0.6711 Mean difference -0.0024<-- =AVERAGE(D49:D98)\n51 3 4.9478 3.9451 1.0026 Sigma 0.5662<-- =STDEV.S(D49:D98)\n52 4 20.0870 19.3043 0.7827 Max difference 1.0026<-- =MAX(D49:D98)\n53 5 5.8534 5.8424 0.0109 Min difference -1.3473<-- =MIN(D49:D98)\n54 6 6.3475 6.5438 -0.1962\n55 7 0.0000 0.8066 -0.8066 Difference between Formula Payoff Max(S -X,0)\nT\n56 8 0.0000 -0.1808 0.1808 and Replica(cid:415)ng Por(cid:414)olio Payoff\n57 9 42.8039 42.4171 0.3868\n58 10 8.5893 8.7009 -0.1116 1.5\n59 11 0.0000 0.3803 -0.3803\n1.0\n60 12 14.9803 15.0901 -0.1098\n61 13 0.0000 -0.0419 0.0419 0.5\n62 14 0.0000 0.3429 -0.3429\n63 15 0.0000 0.2457 -0.2457 0.0\n64 16 15.3211 15.2346 0.0865 0 5 10 15 20 25 30 35 40 45 50\n65 17 5.0699 5.2351 -0.1652 -0.5\n66 18 0.0000 0.2243 -0.2243\n67 19 40.9947 40.4187 0.5760 -1.0\n68 20 0.0000 0.3497 -0.3497\n-1.5\n69 21 7.7107 7.1019 0.6088\n70 22 0.0000 -0.7894 0.7894\n750 Chapter 29\nWithout too much explanation, we can do the same for a put. Redoing the\nmathematics for a put:\nBond\nt+\u0394t\n=B(cid:2)o(cid:4)nd(cid:3) \u2191t\u2217 (cid:4)e(cid:5)r\u0394t \u2212SS (cid:2)tN (cid:4)( (cid:4)\u2212 (cid:4)d\n(cid:3)1,t\n(cid:4))\u2217 (cid:4)S St (cid:4)+ (cid:5)(cid:5)t\u0394t +S (cid:2)t+(cid:4)\u0394tN (cid:4)(cid:3)( \u2191\u2212 (cid:4)d 1,(cid:4)t+(cid:5)\u0394t)\nt+\u0394t value \u2191 t+\u0394t desired\nof time t bond t+\u0394t value stock position\nposition of time t\nstock position\n=Boond \u2217er\u0394t +S {\u2212N(\u2212d )+N(\u2212d )}\nt t+\u0394t 1,t 1,t+\u0394t\nPutting this in a simulation and running the simulation 50 times:\nA B C D E F G H I J K\n46 Data table: running 50 replications\nDifference:\nPerfect Perfect -\n47 Simulation replication Portfolio portfolio\n48\n49 1 0.0000 10.5672 -10.5672 Statistics for 50 simulations\n50 2 11.3925 0.6324 10.7602 Mean difference 4.0640<-- =AVERAGE(D49:D98)\n51 3 0.0000 10.6771 -10.6771 Sigma 11.7531<-- =STDEV.S(D49:D98)\n52 4 0.0000 1.9068 -1.9068 Max difference 38.8730<-- =MAX(D49:D98)\n53 5 7.4425 -0.9831 8.4256 Min difference -13.0531<-- =MIN(D49:D98)\n54 6 15.3637 0.2359 15.1278\n55 7 0.0000 1.6436 -1.6436 Difference between Put Formula Payoff Max(X-S ,0)\nT\n56 8 3.7379 0.2299 3.5080 and Replica(cid:415)ng Por(cid:414)olio Payoff\n57 9 28.2190 0.0705 28.1484\n58 10 27.3503 -0.8341 28.184450.0\n59 11 5.1821 0.0421 5.140040.0\n60 12 0.0000 9.1971 -9.1971\n61 13 1.1650 -0.0918 1.256830.0\n62 14 21.2614 -0.2358 21.4972\n63 15 26.5251 -0.1598 26.684920.0\n64 16 0.0000 2.6018 -2.6018\n10.0\n65 17 2.8785 0.2471 2.6314\n66 18 9.2148 -0.4114 9.62620.0\n67 19 0.0000 6.4053 -6.4053 0 5 10 15 20 25 30 35 40 45 50\n68 20 1.4479 0.9499 0.4980-10.0\n69 21 0.9231 -0.4849 1.4080\n70 22 2.6633 1.2584 1.4049-20.0"
        ],
        "29.3": [
            "What is portfolio insurance in the context of options?\nWhat is the significance of a put in portfolio insurance?\nHow can the Black-Scholes option pricing formula be utilized to replicate a put in portfolio insurance?\nWhat part does a dynamic strategy play in replicating a put using the Black-Scholes formula?\nWhat is the function of sensitivity analysis in stock portfolios?\nWhat happens to your investment if the stock\u2019s price at the end of the year is more than the exercise price of the put option?\nWhat does it mean to exercise a put option?\nHow does the total investment differ, when we consider portfolio insurance?\nIn the context of portfolio insurance, what does it mean to say \"a put is equivalent to a short position in the stock and a long position in the risk-free asset\"?\nWhat are the risks associated with replicating portfolio insurance strategies?\nWhen implementing a portfolio insurance strategy, how much proportion of your wealth should you ideally invest in risk-free, pure discount bonds?\nHow does the standard deviation of a stock's log return impact portfolio insurance strategy?\nWhat happens to the portfolio proportion of stock when its price increases and decreases, respectively?\nWhy is it important to adjust portfolio proportions over time for the success of a portfolio insurance strategy? \nWhat is the effect on the final proportions of a portfolio insurance strategy when the stock price decreases during the year?\nWhat happens to the portfolio proportions when the stock price increases over a year?",
            "29.3 Simulating Portfolio Insurance\n\nO ptions can be used to guarantee minimum returns from stock investments.\nAs we showed in our discussion of option strategies in Chapter 15, when you\npurchase a stock (or a portfolio of stocks) and simultaneously purchase a put\non the stock (on the portfolio), you are assured that the strategy payoff will\n751 Simulating Options and Option Strategies\nStock+Put=S +max( X\u2212S ,0)\nT T\n\u23a7S ifS >X\n=\u23a8 T T\n\u23a9X ifS \u2264X\nT\nI t is not always possible to find marketed puts in all portfolios; in this case\nthe Black-Scholes option pricing formula can show us how to replicate a put\nby a dynamic strategy in which the investment in a risky asset (be it a single\nstock or a portfolio) and the investment in riskless bonds changes over time\nto mimic the returns of a put option. Such replication strategies are at the heart\nof the portfolio insurance strategies discussed here.\nW e start by considering the following simple example: You decide to invest\nin one share of General Pills stock, which currently costs $56. The stock pays\nno dividends. You hope for a large capital gain at the end of the year, but you\nworry that the stock\u2019 s price may decline. To guard against a decline in the\nstock\u2019 s price, you decide to purchase a European put on the stock. The put\nyou purchase allows you to sell the stock at the end of 1 year for $50. The\ncost of the put, $2.38, is derived from the Black-Scholes model (see Chapter\n17) using the following data: S = $56, X = $50, \u03c3 = 30%, and r = 8%:\n0\nA B C D E\n2 S 56.00\n0\n3 X 50.00\n4 T 1\n5 r 8.00%\n6 Sigma 30%\n7 Put price 2.38 <-- =bsput(B2,B3,B4,B5,B6)\nThis protective put or portfolio insurance strategy guarantees that you will\nlose no more than $6 on your share of General Pills stock. If the stock \u2019 s price\nat the end of the year is more than $50, you will simply let the put expire\nwithout exercising it. However, if the stock\u2019 s price at the end of the year is\nless than $50, you will exercise the put and collect $50. It is as if you had\npurchased an insurance policy on the stock with a $6 deductible.\nO f course this protection doesn\u2019 t come for free: Instead of investing $56 in\nyour single share of stock, you have invested $58.38. You could have deposited\nthe additional $2.38 in the bank and earned interest of 8%*$2.38 = $0.19 in\nthe course of the year; alternatively, you could have used the $2.38 to buy\n752 Chapter 29\nTo see how this strategy works, we perform sensitivity analysis of the strat-\negy profit as a function of the terminal price of the stock S :\nT\nA B C D E F G H I J\n9 PORTFOLIO INSURANCE STRATEGY\n10 Buy stock 56.00<-- =B2\n11 Buy put 2.38<-- =B7\n12 Total cost 58.38<-- =B10+B11\n13\n14 Payoff at date T\n15 S 35.00\nT\n16 Put payoff 15.00<-- =MAX(B3-B15,0)\n17 Total payoff 50.00<-- =SUM(B15:B16)\n18 Profit -8.38<-- =B17-B12\n19\n20 Data table: Total strategy profit as function of ST\n21\n22 S Stock Put Profit\nT\n23 <-- =B23+C23-B12, data table headers (hidden)\n24 0 0 50 -8.37698\n25 10 10 40 -8.37698\n26 20 20 30 -8.37698 50\n27 30 30 20 -8.37698\n28 40 40 10 -8.37698 40\n29 50 50 0 -8.37698 30\n30 60 60 0 1.623024\n31 70 70 0 11.62302 20\n32 80 80 0 21.62302 10\n33 90 90 0 31.62302\n34 100 100 0 41.62302 0\n0 20 40 60 80 100 120\n35 -10\n36\n37\n38\n39\nlatoT\n,tuP\n,kcotS\n:sffoyaP\nProtec(cid:415)ve Put on GP, Terminal Payoff\nS T\nStock Put Profit\nPortfolio Insurance When There Are No Traded Puts\nIn the example above, we have implemented a portfolio insurance strategy by\npurchasing a put whose underlying asset exactly corresponds to our share\nportfolio. But this technique may not always be possible:\n\u2022 It could be that there is no traded put option on the shares we wish to insure.\n\u2022 I t could also be that we want to purchase portfolio insurance on a more\ncomplicated basket of assets, such as a portfolio of shares. Puts on portfolios\ndo exist (for example, there are traded puts on the S&P 100 and S&P 500\n753 Simulating Options and Option Strategies\nI t is here that the Black-Scholes option pricing model comes to our aid.\nFrom this formula it follows that a put option on a stock (from here on, \u201cstock\u201d\nwill be used to refer to a portfolio of stocks as well as a single stock) is simply\na portfolio consisting of a short position in the stock and a long position in\nthe risk-free asset, with both positions being adjusted continuously. For\nexample, consider the Black-Scholes formula for a put with expiration date\nT = 1 and exercise price X . At time t , 0 \u2264 t < 1, the put has value\nP\n=\u2212SN(\u2212d )+Xe\u2212r(1\u2212t) N(\u2212d )\nt t 1 2\n( )\nln S t +( r+\u03c32 /2)( 1\u2212t)\nX\nd = ,d =d \u2212\u03c3 1\u2212t\n1 \u03c3 1\u2212t 22 1\nwhere\n1\u2212t is time remaining to maturity\nS is the priice of the stock at timet\nt\nThus, buying a put is equivalent to investing X e \u2212 r ( 1 \u2212 t ) N ( \u2212 d ) in a risk-free bond\n2\nwhich matures at time 1 and investing \u2212 S N ( \u2212 d ) in the stock. Since the invest-\nt 1\nment in the stock is negative, this means that a put is equivalent to a short\nposition in the stock and a long position in the risk-free asset.\nThe total investment required to buy one share of the stock plus a put on\nthe stock is S + P. Writing this out and substituting in the Black-Scholes put\nt t\nformula gives\nTotalinvestment,protective put=S +P\nt t\n=S \u2212SN(\u2212d )+Xe\u2212r(1\u2212t) N(\u2212\u2212d )\nt t 1 2\n=S( 1\u2212N(\u2212d ))+Xe\u2212r(1\u2212t) N(\u2212d )\nt 1 2\n=SN(\nd\n)+Xe\u2212r(1\u2212t) N(\u2212d ))\nt 1 2\nw here the last equality uses the fact that for the standard normal distribution\nN ( x ) + N ( \u2212 x ) = 1. Another way of looking at this problem is to regard the total\ninvestment S + P a t time t as a portfolio of a stock and a bond; we can then\nt t\nask, What is the proportion \u03c9 of this portfolio invested in the stock at time t ?\nt\n754 Chapter 29\nProportioninvestedinstock=\u03c9\nt\n( )\nSN d\n= t 1\nSN(\nd\n)+Xe\u2212r(1\u2212t) N(\u2212d ))\nt 1 2\nProportioninvestedinrisk freeasset=1\u2212\u03c9\nt\nXe\u2212r(1\u2212t) N(\u2212d )\n= 2\nSNN(\nd\n)+Xe\u2212r(1\u2212t) N(\u2212d )\nt 1 2\nTo sum up: If you want to buy a specific portfolio of assets and an insurance\npolicy guaranteeing that at t = 1 your total investment will not be worth less\nthan X, then at each point in time, t, you should invest a proportion \u03c9 of your\nt\nwealth in the specific portfolio you have chosen, and a proportion 1 \u2212 \u03c9 in\nt\nriskless, pure discount bonds that mature at t = 1. The Black-Scholes put\npricing formula can be used to determine these proportions.\nAn Example\nS uppose you decide to invest $1,000 in General Pills stock (currently selling\nat $56) and in protective puts on the shares with an exercise price of $50 and\nan expiration date 1 year from now. This ensures that your dollar value per\nshare at the end of 1 year will be no less than $50. Suppose that there is no\ntraded put on General Pills, so that you will have to create your own put by\ninvesting in the share and in riskless discount bonds. The riskless rate of inter-\nest is 8%, and the standard deviation of General Pills\u2019 log return is 30%.\nWe will construct a series of portfolios which implements this strategy on\na week-by-week basis. Based on our discussion from the previous section, we\nknow that this replication strategy will not be perfect. We simulate it to see\nhow it works.\nWeek 0 : At the beginning of this week, the initial investment in shares of\nGeneral Pills should be:\nS N( d ) 56\u22170.7865\n\u03c9 = 0 1 = =75.45%\n0 S +P 56+2.38\n755 Simulating Options and Option Strategies\nwith the remaining proportion, 1 \u2212 \u03c9 = 24.55%, invested in riskless discount\n0\nbonds maturing in 1 year. If traded European puts on GP existed and if these\nputs had an exercise price of 50 with an exercise date 1 year from now, these\nwould be trading at $2.38. Your strategy would consist of buying 17.13 shares\nof GP (cost = $959.23) and 17.13 puts (cost = $40.77). Buying $754.40 worth\nof shares and $245.60 worth of bonds exactly duplicates the initial investment\nin 17.13 shares and 17.13 puts. This equivalence is guaranteed by Black and\nScholes. The calculations of the option price and the appropriate portfolio\nproportions are shown in the spreadsheet picture below:\nA B C\nBlack-Scholes Option Pricing Formula\n1 Applied to General Pills Put\n2 S 56Stock price\n3 X 50Exercise price\n4 T 1Time remaining\n5 r 8.00%Risk-free rate of interest\n6 Sigma 30%Stock volatility\n7 Put price 2.38<-- call price - S + X*Exp(-r*T): by Put-Call parity\n8\n9 Calculating the portfolio insurance proportions\n10 Omega 75.45%<-- =B2*NORM.S.DIST(done(B2,B3,B4,B5,B6),1)/(B2+B7), proportion in shares\n11 1-omega 24.55%<-- =1-B10, proportion in bonds\nYou started at t = 0 with an initial investment of $1,000; now suppose that\nby the beginning of the next week (t = 1/52 = 0.0192) the price of GP shares\n756 Chapter 29\nYou can see that when the stock price increases, the portfolio proportion of\nthe stock increases:\nA B C\nUpdating the Portfolio Insurance Proportions\n1\n2 Previous stock price S 56.00\nt\n3 Previous time to maturity 1.00\n4 Time interval, \u0394t 0.0192<-- =1/52\n5 New time to maturity 0.9808<-- =B3-B4\n6\n7 Previous portfolio\n8 Stock 754.50\n9 Bonds 245.50\n10 Current stock price S t+\u0394t 60.00Stock price\n11\n12 Current portfolio before readjustment\n13 Stock 808.39<-- =B8*B10/B2\n14 Bonds 245.88<-- =B9*EXP(B22*B4)\n15 Total 1,054.27<-- =SUM(B13:B14)\n16\n17 Calculating the portfolio insurance proportions\n<--\nProportion of stock\nOmega, \u03c9 82.53%=B10*NORM.S.DIST(done(B10,B21,B5,B22,B23),\n18 1)/(B10+bsput(B10,B21,B5,B22,B23))\n19 1-omega 17.47%<-- =1-B18\nI f, conversely the stock price at time \u0394 t is 52, the proportion of the stock\n757 Simulating Options and Option Strategies\nA B C\nUpdating the Portfolio Insurance Proportions\n1\n2 Previous stock price S 56.00\nt\n3 Previous time to maturity 1.00\n4 Time interval, \u0394t 0.0192<-- =1/52\n5 New time to maturity 0.9808<-- =B3-B4\n6\n7 Previous portfolio\n8 Stock 754.50\n9 Bonds 245.50\n10 Current stock price S t+\u0394t 52.00Stock price\n11\n12 Current portfolio before readjustment\n13 Stock 700.61<-- =B8*B10/B2\n14 Bonds 245.88<-- =B9*EXP(B22*B4)\n15 Total 946.49<-- =SUM(B13:B14)\n16\n17 Calculating the portfolio insurance proportions\n<--\nProportion of stock\nOmega, \u03c9 66.41%=B10*NORM.S.DIST(done(B10,B21,B5,B22,B23),\n18 1)/(B10+bsput(B10,B21,B5,B22,B23))\n19 1-omega 33.59%<-- =1-B18\nWe now simulate this strategy over time:\nA B C D E F G H I J K L M N\n1 PORTFOLIO INSURANCE STRATEGY\n2 S0 56.00\n3 X 50.00\n4 T 1\nFormulas--in cell F12: =D12*E12\n5 r 8.00%\nin cell G12: =E12*(1-D12)\n6 Sigma 30%\n7 Mean 12%\n8 Delta_t 0.0192<-- =1/52\n9\n10 Beginning of week Wealth\n11 Week Stock Put Omega Total wealth Stocks Bonds\n12 0 56.00 2.38 0.7545 1,000.00 754.50 245.50 1,050 60\n13 1 54.92 2.59 0.7324 985.87 722.01 263.86\n14 2 54.87 2.58 0.7313 985.63 720.82 264.80 1,000 50\n15 3 54.25 2.70 0.7175 977.88 701.66 276.22\n16 4 52.34 3.19 0.6711 953.57 639.93 313.65 950 40\n17 5 52.21 3.20 0.6671 952.40 635.33 317.07 900 30 18 6 52.76 3.02 0.6808 959.60 653.32 306.27\n19 7 52.93 2.94 0.6850 962.26 659.15 303.10 850 20\n20 8 52.73 2.97 0.6794 960.16 652.30 307.86\n21 9 52.33 3.05 0.6684 955.70 638.76 316.94 800 10\n22 10 52.34 3.02 0.6684 956.39 639.22 317.17 750 0\n23 11 50.36 3.62 0.6104 932.64 569.25 363.39 1 6 11 16 21 26 31 36 41 46 51\n24 12 50.26 3.63 0.6060 932.01 564.80 367.21\n25 13 49.05 4.05 0.5661 919.00 520.28 398.73\n26 14 46.24 5.24 0.4675 889.84 416.01 473.83\nhtlaew\nlatoT\necirp\nkcotS\nPortfolio Insured Wealth\nTotal Wealth and Stock Price over 52Weeks\nTotal wealth Stock\n758 Chapter 29\nI n the above simulation, the stock price decreased during the year, and the\nfinal proportions of the portfolio insurance strategy will be wholly in the risk-\nfree asset. Below we present another possibility: The stock price increases over\nthe year, and the portfolio proportions are increasingly in the stock, with the\nbond going to zero.\n1,200 70\n1,000 60\n50\n800\n40\n600 30\n400\n20\n200 10\n0 0\n1 6 11 16 21 26 31 36 41 46 51\nhtlaew\nlatoT\necirp\nkcotS\nPortfolio Insured Wealth Portfolio Insured Wealth\nTotal Wealth and Stock Price over 52Weeks Stock and Bond Portfolio over 52Weeks\n1,200\n1,000\n800\n600\n400\n200\nTotal wealth Stock\n0\n0 5 10 15 20 25 30 35 40 45 50\nWeek Stocks Bonds"
        ],
        "29.4": [
            "What is the concept of Portfolio Insurance in financial modeling? \nCan you explain the importance of exercise price in the properties of portfolio insurance? \nCan you delineate how the exercise price affects the proportion invested in the risky asset in portfolio insurance? \nWhat does the formula for the proportion (\u03c9) invested in a risky asset imply? \nCan you illustrate the significance of stock price in determining the proportion of investment in portfolio insurance? \nWhat is the relation between the decrease in value of put and the stock price increase with respect to proportion invested? \nWhat happens to the proportion invested when the stock price increases according to Property 2 of portfolio insurance?\nWhat are the possible outcomes as t approaches 1 in the context of portfolio insurance properties? \nWhat implies by the phrase \"the denominator of \u03c9 is < 2\" in the context of portfolio insurance? \nCan you throw light on how we validate the properties of Portfolio Insurance?\nWhat does it mean by \"probability limits\" in the context of portfolio insurance?\nHow does the proportion invested change based on the stock price and exercise price as per the properties of portfolio insurance? \nIf S tends to X and t tends to 1, what happens to the invested proportion \u03c9 according to Property 3 of portfolio insurance?\nWhat is the role of N(d) and N(-d) in determining the outcome of Property 3 of portfolio insurance?",
            "29.4 Some Properties of Portfolio Insurance\n\nThe preceding example illustrates some of the typical properties of portfolio\ninsurance. Three important properties are the following:\nPROPERTY 1 When the stock price is above the exercise price X , then the\nproportion \u03c9 invested in the risky asset is greater than 50%.\nProof The proof of this property requires a little manipulation of our formula\nfor \u03c9 . Rewrite \u03c9 as:\n( )\nSN d 1\n\u03c9= 1 =\nSN(\nd\n1)+Xe\u2212r(1\u2212t) N(\u2212d 2) 1+Xe\u2212r(1\u2212t) N(\u2212d 2)\n( )\nSN d\n1\nWe will show that when S \u2265 X , the denominator of \u03c9 is < 2, which will prove\nthe proposition: First note that when S \u2265 X , X/S \u2264 1. Next note thaet \u2212 r ( 1- t ) < 1\n759 Simulating Options and Option Strategies\n( )\nN(\u2212d 2)\n=\nN \u03c3 1\u2212t\u2212d\n1\n( ) ( )\nN d N d\n1 1\n( )\nN 0.5\u03c3 1\u2212t\u2212[ ln( S X)+r(1\u2212t)] /\u03c3( 1\u2212t))\n=\n(\n)<1\nN 0.5\u03c3 1\u2212t+[ ln( S X)+r(1\u2212t)] /\u03c3( 1\u2212t)\nThis proves the property.\nPROPERTY 2 W hen the stock\u2019 s price increases the proportion \u03c9 invested in the\nstock increases and vice versa.\nProof T o see this property, it is enough to see that whenS increases, the value\nof the put decreases and N (- d ) decreases. Rewrite the original definition of\n1\n\u03c9 as:\nS[ 1\u2212N(\u2212d )] [ 1\u2212N(\u2212d )]\n\u03c9= 1 = 1\nS+P 1+P/S\nT hus, when S increases, the denominator of \u03c9 decreases and the numerator\nincreases, which proves Property 2.\nPROPERTY 3 As t \u2192 1, one of two things happens: If S t > X , then \u03c9 t \u2192 1. If\nS < X , then \u03c9 \u2192 0.\nt t\nProof To see this, note that when S > X andt \u2192 1, N (d ) \u2192 1 andN (-d ) \u2192\nt 1 1\n0; thus for this case \u03c9 \u2192 1. Conversely, when S < X andt \u2192 1, N (d ) \u2192 0\nt t 1\nand N (-d ) \u2192 1 and thus \u03c9 \u2192 0. (Strictly speaking these statements are only\n1 t\ntrue as \u201cprobability limits\u201d\u2014see Billingsley 1968. What about the case when,\nas t \u2192 1, S / X \u2192 1? In this case \u03c9 \u2192 \u00bd. However, the probability of this\nt t\noccurring is zero.)"
        ],
        "29.5": [
            "What does the term \"portfolio insurance\" imply in financial modelling?\nWhat method is one using from the book when constructing a portfolio of puts and shares that guarantees total dollar returns on the initial investment?\nWhat does the variable z represent in the context of guaranteeing a certain final wealth from an initial investment?\nWhat is the significance of the stock price S and put exercise price X in determining a return guarantee on investment?\nHow is the variable \u03b1 calculated in reference to a portfolio of shares and puts?\nIn the equation S + P ( S , X ) = X / z, what do S, P, and X represent?\nWhat are the parameters required for a spreadsheet implementation of a return guarantee equation?\nAs the insurance level is raised in a portfolio, how does it affect the relative expenditures on puts and stocks?\nCan we set an insurance level that guarantees more than the initial investment and if so, under what condition?\nWhat does a value of z > 1 signify?\nWhy can't we guarantee a return greater than the riskless interest rate in portfolio insurance?\nWhat is the significance of the equation S + Put ( S , X ) - X / z = 0 in guaranteeing a return on investment?\nHow does one check whether the financial modeling solution is correct or not?\nWhat is the significance of Alpha in financial modelling?\nWhat is the possible implication when there is no solution to insuring for a value of z > the interest rate?",
            "29.5 Digression: Insuring Total Portfolio Returns\n\nW e digress slightly to consider an interesting portfolio insurance problem. So\n760 Chapter 29\nper share. A slightly different version of this problem involves constructing a\nportfolio of puts and shares that guarantees the t otal dollar returns on the t otal\ninitial investment. A typical story goes like this:\nY ou have $1,000 to invest, and you want to guarantee that a year from now\nyou will have at least $1,000 z. Here z is some number, generally between 0\nand 1; for example, if z = 0.93, this means that you want your final wealth to\nbe at least $930. 2 You want to invest in a stock whose current price is S and\n0\nin a put on the stock with an exercise price X. You want the number of puts\nto be equal to the number of shares, so that each \u201cpackage\u201d of share + put\ncosts you S + P ( S , X ). To implement the strategy, you must therefore buy \u03b1\n0 0\nshares, where:\n1,000\n\u03b1=\nS\n+P(\nS\n,X)\n0 0\nS ince you have bought \u03b1 shares and \u03b1 puts with an exercise price of X , the\nminimum dollar return from your portfolio is \u03b1 X. You want this to be equal\nto 1,000z , and therefore you solve to get \u03b1 = 1,000 z/X . Thus you can guarantee\nyour minimum return if\nS\n+P(\nS\n,X)=X/z\n0 0\nH ere\u2019 s a spreadsheet implementation of this equation. The data table shows\nthe graph of S + P ( S , X ) \u2212 X / z ; where this graph crosses the x-axis is the\n0 0\nsolution for the put exercise price X when S = 56, \u03c3 = 30%, r = 6%, T = 1,\n0\nand z = 93%.\n761 Simulating Options and Option Strategies\nA B C D\n1 INSURING TOTAL PORTFOLIO RETURNS\n2 z 0.9300 Insurance level\n3\n4 S 56.0000 Current stock price\n0\n5 X 56.4261 Exercise price\n6 T 1 Time to maturity of option (in years)\n7 r 8.00% Risk-free rate of interest\n8 Sigma 30% Stock volatility\n9\n10 Alpha 16.4817 <-- =1000/(B4+bsput(B4,B5,B6,B7,B8))\n11\nEquation to be\n12 solved 0.00 <-- =B4+bsput(B4,B5,B6,B7,B8)-B5/B2\n13\n14 Data table: Sensitivity of B12 on X\n15 Exercise price \u2193 0.00 <-- =B12, data table header\n16 50 4.6135\n17 51 3.8358 At Which X to Create a Synthe(cid:415)c Put?\n18 52 3.0800\n5.0\n19 53 2.3463\n20 54 1.6348 4.0\n21 55 0.9453 3.0\n22 56 0.2778\n2.0\n23 57 -0.3679\n1.0\n24 58 -0.9922\n25 59 -1.5953 0.0\n26 60 -2.1776 -1.050 51 52 53 54 55 56 57 58 59 60\n27\n-2.0\n28\n29 -3.0\n30 Exercise X\n31\nAs you can see, the X for which the equation in cell B12 equals zero is\n762 Chapter 29\nSolver gives the solution to the equation S + Put ( S , X ) \u2212 X / z = 0. The solu-\n0 0\ntion is indicated in the next picture:\nA B C\n1 INSURING TOTAL PORTFOLIO RETURNS\n2 z 0.9300 Insurance level\n3\n4 S 56.0000 Current stock price\n0\n5 X 56.4261 Exercise price\n6 T 1 Time to maturity of option (in years)\n7 r 8.00% Risk-free rate of interest\n8 Sigma 30% Stock volatility\n9\n10 Alpha 16.4817 <-- =1000/(B4+bsput(B4,B5,B6,B7,B8))\n11\n12 Equation to be solved 0.00 <-- =B4+bsput(B4,B5,B6,B7,B8)-B5/B2\n13\n14 Check\n15 Cost of shares 922.98 <-- =B10*B4\n16 Cost of puts 77.02 <-- =B10*bsput(B4,B5,B6,B7,B8)\n17 Total cost 1,000.00 <-- =B15+B16\n18\n763 Simulating Options and Option Strategies\nThe solution is to buy \u03b1 = 16.4817 puts and shares (the cost of which is\n$1,000, as you can see in cell B19). The minimum return of this portfolio is\n16.4817* X = $930 (cell B19).\nCan You Insure for More Than Your Initial Investment?\nWhen we raise the insurance level, the implied exercise price of the put must\ngo up. This means that as we buy more insurance, we spend relatively more\nof our $1,000 on puts (insurance) and relatively less on the stocks (which have\nthe upside potential).\nC an we insure for more than our current level of investment? To put it\nanother way, can we set z > 1? This means that we are picking an insurance\nlevel which guarantees that we end up with more than our initial investment.\nA little thought and some calculations reveal that we can indeed choose z > 1\nas long as z \u2264 1 + r . That is: We cannot guarantee ourselves a return greater\nthan the riskless interest rate! To see this, we offer two examples. In the first\nexample below, we solve for z = 1.08 = 1 + r. This has a solution (note that\nthe value of cell B12 is zero):\nA B C\n1 INSURING TOTAL PORTFOLIO RETURNS\n2 z 1.0800 Insurance level\n3\n4 S 56.0000 Current stock price\n0\n5 X 104.8368 Exercise price\n6 T 1 Time to maturity of option (in years)\n7 r 8.00% Risk-free rate of interest\n8 Sigma 30% Stock volatility\n9\n10 Alpha 10.3017 <-- =1000/(B4+bsput(B4,B5,B6,B7,B8))\n11\n12 Equation to be solved 0.00 <-- =B4+bsput(B4,B5,B6,B7,B8)-B5/B2\n13\n14 Check\n15 Cost of shares 576.90\n16 Cost of puts 423.10\n17 Total cost 1,000.00\n18\n764 Chapter 29\nWhen z > 1.08, however, there is no solution. Returning to the first chart of\nthis section, we can see that there is no solution that insures for 9% ( z = 1.09)\nthat is > the interest rate of 8%:\nA B C D\n1 INSURING TOTAL PORTFOLIO RETURNS\n2 z 1.0900 Insurance level\n3\n4 S 56.0000 Current stock price\n0\n5 X 56.4261 Exercise price\n6 T 1 Time to maturity of option (in years)\n7 r 8.00% Risk-free rate of interest\n8 Sigma 30% Stock volatility\n9\n10 Alpha 16.4817 <-- =1000/(B4+bsput(B4,B5,B6,B7,B8))\n11\nEquation to be\n12 solved 8.91 <-- =B4+bsput(B4,B5,B6,B7,B8)-B5/B2\n13\n14 Data table: Sensitivity of B12 on X\n15 Exercise price \u2193 8.91 <-- =B12, data table header\n16 50 12.5054\n17 55 9.6264 Looking for put X that gives Insurance level of\n18 60 7.2927 z =1.09\n19 65 5.4649\n20 70 4.0756 14.0\n21 75 3.0466 12.0\n22 80 2.3018 10.0\n23 85 1.7738 8.0\n24 90 1.4072 6.0\n25 95 1.1581 4.0\n26 100 0.9932\n2.0\n27\n0.0\n28\n50 60 70 80 90 100\n29\n765 Simulating Options and Option Strategies"
        ],
        "29.6": [
            "What is a butterfly strategy in financial modeling?\nWhat does it mean to simulate a butterfly over 1 month?\nHow is the stock return assumed to be lognormal?\nHow is a call used in a butterfly strategy?\nWhat is the purpose of rebalancing the position daily in a butterfly strategy?\nWhat does the term 'self-financing requirement' mean in the context of a butterfly strategy?\nWhat is the Black-Scholes formula?\nHow is a stock investment defined in financial modeling?\nHow is the bond investment adjusted in the context of a butterfly strategy?\nIn financial modeling, what does a self-financing strategy entail?\nWhat is the cash flow from the stock position and how is it calculated?\nWhat is the zero-investment cash flow from the bond position?\nWhat does running the simulation mean in the context of a butterfly strategy?\nHow is a formula payoff compared to a simulation payoff in financial modeling?\nWhat is the significance of repeating a simulation multiple times in financial modeling?\nWhat is the butterflyNd1 function in financial modeling and what is its purpose?\nWhat does the term \"terminal stock price\" mean in the context of a butterfly strategy?\nWhat is the significance of VBA functions in financial modeling?\nWhat is a self-financing butterfly portfolio and what is its purpose in a butterfly strategy?\nHow is the initial cost calculated in a butterfly strategy simulation?",
            "29.6 Simulating a Butterfly\n\nFor our last exercise in this chapter, we simulate a butterfly strategy. Recall\nfrom Chapter 15 that a butterfly consists of three options. In this section we\nsimulate a butterfly over 1 month (22 days), rebalancing the position daily.\nOur butterfly consists of three calls written on a stock with current price\nS = 35. We assume that the stock return is lognormal with \u03c3 = 35% and that\n0\nr = 2%. The calls:\n\u2022 Call 1: X = 20, position: 1 call purchased\n\u2022 Call 2: X = 35, position: 2 calls written\n\u2022 Call 3: X = 50, position: 1 call purchased\n766 Chapter 29\nA B C D E F G H\n1 BUTTERFLY\n2 S 35\n0\n3 T 0.087302 <-- =22/252\n4 Sigma 80%\n5 r 2%\n6\n7 X Position Cost\n8 Call1 20 1 15.05 <-- =bscall($B$2,B8,$B$3,$B$5,$B$4)\n9 Call2 35 -2 3.32 <-- =bscall($B$2,B9,$B$3,$B$5,$B$4)\n10 Call3 50 1 0.29 <-- =bscall($B$2,B10,$B$3,$B$5,$B$4)\n11 Initial cost 8.70 <-- =SUMPRODUCT(C8:C10,D8:D10)\n12\n13 One profit example (used in data table)\n14 S 47\nT\n15 Profit1 11.95 <-- =C8*(MAX($B$14-B8,0)-D8)\n16 Profit2 -17.36 <-- =C9*(MAX($B$14-B9,0)-D9)\n17 Profit3 -0.29 <-- =C10*(MAX($B$14-B10,0)-D10)\n18 Total -5.70 <-- =SUM(B15:B17)\n19\n20 Data table: profit as function of S\nT\n21 S Payoff\nT\n22 -5.70 <-- =B18\n23 0 -8.70\n24 5 -8.70\n25 10 -8.70 8\n26 15 -8.70 6\n27 20 -8.70\n4\n28 25 -3.70\n2\n29 30 1.30\n0\n30 35 6.30 -2 0 10 20 30 40 50 60 70 80 90\n31 40 1.30\n-4\n32 45 -3.70\n-6\n33 50 -8.70\n-8\n34 55 -8.70\n-10\n35 60 -8.70\n36 65 -8.70\n37 70 -8.70\n38 75 -8.70\nW e recall the Black-Scholes formula and denoting the time remaining to\noption maturity by t :\ntfiorp\nyflre(cid:425)uB\nBu(cid:425)erfly Profit\nTerminal stock price, S\n767 Simulating Options and Option Strategies\nCall( X)=SN( d,t)\u2212Xe\u2212rTN( d,t)\n1 2\n( ) ( )\nln S + r+\u03c32 t\nd = X 2 ,d =d \u2212\u03c3 t\n1 \u03c3 t 2 1\nIn a table for the butterfly:\nN calls Call( X ,t)=N [ SN( d ( X ,t))\u2212X e\u2212rTN( d ( X ,t))]\nLow Low Low 1 Low Low 2 Low\n( ) ( )\nln S + r+\u03c32 t\nd ( X ,t)= X Low 2 ,d ( X ,t)=d ( X ,t)\u2212\u03c3 t\n1 LLow \u03c3 t 2 Low 1 Low\nN Mid calls Call( X Mid,t)=N Mid[ SN( d 1( X Mid,t))\u2212X Mide\u2212rTN( d 2( X Mid,t))]\n( ) ( )\nln S + r+\u03c32 t\nd ( X ,t)= X Mid 2 ,d ( X ,t)=d ( X ,t)\u2212\u03c3 t\n1 MMid \u03c3 t 2 Mid 1 Mid\nN High calls Call( X High,t)=N\n(\nHigh[[ SN )( d (1( X High, )t))\u2212X Highe\u2212rTN( d 2( X High,t))]\nln S + r+\u03c32 t\nd( X ,t)= X High 2 ,d ( X ,t)=d(( X ,t)\u2212\u03c3 t\n1 High \u03c3 t 2 High 1 High\nAdding these together we get\nButterfly( t)=S {\nN\n\u2217N(\nd\n(\nX\n,t))+N \u2217N(\nd\n(\nX\n,t))\nt Low 1 Low Mid 1 Mid\n+N \u2217N( d ( X ,t))}+\u2212e\u2212rT{ N \u2217X N( d ( X ,t))\nHighh 1 High Low Low 2 Low\n+N \u2217X N( dd ( X ,t))+N \u2217X N( d ( X ,t))}\nMid Mid 2 Mid High High 2 High\nNewly defined VBA functions:\nButterfly( t)=S \u2217butterflyNd1(\nX ,X ,X ,N ,N ,N\n,S,X,t,\u03c3,r)\nt Low Mid High Low Mid Highh t\n\u2212e\u2212rTbutterflyNd2(\nX ,X ,X ,N ,N ,NN\n,S,X,t,\u03c3,r)\nLow Mid High Low Mid High t\nThe VBA function B utterflyNd1 is defined below (the function B utterflyNd2\n768 Chapter 29\nFunction butterfl yNd1(XLow, XMid, XHigh, _\nNumberLow, NumberMid, NumberHigh, Stock, _\nTime, Interest, sigma)\nbutterfl yNd1 = Stock * _\n(NumberLow * Application.Norm_S_Dist _\n(dOne(Stock, XLow, Time, Interest, sigma), 1) _\n+ NumberMid * Application.Norm_S_Dist _\n(dOne(Stock, XMid, Time, Interest, sigma), 1) _\n+ NumberHigh * Application.Norm_S_Dist _\n(dOne(Stock, XHigh, Time, Interest, sigma), 1))\nEnd Function\nSelf-Financing Butterfly Portfolio\nWe attempt to replicate this position dynamically, maintaining the self-\nfinancing requirement (i.e., no cash flows after time t = 0).\nA t time t = 0, we define the investment in the stock and the bond as above.\n\u23a7N \u2217N( d ( X ,t=0))+N \u2217N( d ( X ,t=0)) \u23ab\nStock( 0)=S 0\u23a8 \u23a9+NLow \u2217\u2217N(1\nd\n(\nXLow\n,t=0))\nMid 1 Mid \u23ac\n\u23ad\nHigh 1 High\nA fterward, at time t + \u0394 t, we define the stock investment as above and adjust\nthe bond investment to net out the stock:\n\u23a7N \u2217N( d ( X ,t+\u0394t))+N \u2217( d ( X ,t+\u0394t))) \u23ab\nStock( t+\u0394t)=S t+\u0394t\u23a8 \u23a9+NLow \u2217N(1\nd\n(\nXLow\n,t+\u0394t))\nMid 1 Mid \u23ac\n\u23ad\nHigh 1 High\nCash Flow from the Stock Position\nThe cash flow from the stock position is the value of the time t position minus\n769 Simulating Options and Option Strategies\nStockcash\nflow( t+\u0394t)=Stock( t)\u2217S t+\u0394t \u2212Stock( t+\u0394t)=\nS\nt\nS t+\u0394t {\nN\n\u2217N(\nd\n(\nX\n,S,t))+N \u2217N(\nd\n(\nX\n,S,t))\nLoow 1 Low t Mid 1 Mid t\nS\nt\n+N \u2217N( d ( X ,,S,t))}\u2212\nHigh 1 High t\n\u23a7N \u2217N( d ( X ,S ,t+\u0394t))+N \u2217( d ( X ,S ,t+\u0394t)) \u23ab\nS t+\u0394t\u23a8 \u23a9+NLow \u2217( d1 (\nX\nLow ,St+\u0394t ,t+\u0394t)) Mid 1 Mid tt+\u0394t \u23ac\n\u23ad\nHigh 1 High t+\u0394t\nIn Excel:\nS t+\u0394t \u2217butterflyNd1(\nX ,X ,X ,N ,N ,N\n,S,X,t,,r,\u03c3)\nLow Mid High Low Mid High t\nS\nt\n\u2212butterflyNd1(\nX ,X ,X ,N ,N ,N ,S\n,XX,t+\u0394t,r,\u03c3)\nLow Mid High Low Mid High t+\u0394t\nZero-Investment Cash Flow from the Bond Position\nI n order to define a self-financing strategy, we let the bond position at each\ntime t \u201cabsorb\u201d the change in the stock position. At time t = 0, the bond posi-\ntion is\n\u23a7N \u2217X N( d ( X ))+N \u2217X N( d ( X )) \u23ab\nBond( 0)=\u2212e\u2212rT\u23a8 \u23a9+NLow \u2217XLow N(2\nd\n(\nXLow\n))\nMid Mid 2 Mid \u23ac\n\u23ad\nHiggh High 2 High\nA t time t + \u0394 t, the bond position is the previous position minus the cash flow\non the stock position:\nBond(t+\u0394)=Bond( t)\u2217er\u0394t\n\u23a7 \u23aaS t+\u0394t *butterflyNd1(\nX ,X ,X ,,N ,N ,N\n,S,X,t,r\u03c3) \u23ab\n\u23aa\n\u2212\u23a8 S Low Mid High Low Mid High t \u23ac\nt\n\u23a9\u23aa \u2212butterflyNd1(\nX ,X ,X ,NN ,N ,N ,S\n,X,t+\u0394t,r,\u03c3) \u23ad\u23aa\nLow Mid High Low Mid High t+\u0394t\nThe cash flow on the bond position is\nBond cash\nflow( t+\u0394t)=Bond( t)\u2217er\u0394t \u2212Bond( t+\u0394t)\n=Bond( t)\u2217er\u0394t \u2212BBond( t)\u2217er\u0394t\n\u23a7 \u23aaS t+\u0394t \u2217butterflyNd1(\nX ,X ,X ,N ,N ,N\n,S,X,t,r\u03c3) \u23ab\n\u23aa\n+\u23a8 S Low Mid High Low Midd High t \u23ac\nt\n\u23a9\u23aa \u2212butterflyNd1(\nX ,X ,X ,N ,N ,,N ,S\n,X,t+\u0394t,r,\u03c3) \u23ad\u23aa\n770 Chapter 29\nRunning the Simulation\nWe run the simulation:\nA B C D E F G H\n1 SIMULATING A BUTTERFLY\n2 S 35 Butterfly X Number\n0\n3 T 0.0873<-- =22/252 Xlow 20 -1\n4 Sigma 80% Xmid 35 2\n5 r 2% Xhigh 50 -1\n6 Delta_t 0.0040<-- =1/252\n7\n8 Butterfly simulation\nTime Stock Bond\n9 to maturity Stock position position\n10 0.0873 35.0000 0.8045 -9.5036\n11 0.0833 34.9221 0.6791 -9.3806\n12 0.0794 34.6785 0.0585 -8.7656<--\n13 0.0754 39.2902 12.4606 -21.1606=D10*EXP($B$5*Delta_t)+B11/B10*butterflyN\n14 0.0714 35.4297 2.5165 -12.4425d1($F$3,$F$4,$F$5,$G$3,$G$4,$G$5,B10,A1\n15 0.0675 35.7399 3.6778 -13.58270,$B$5,$B$4)-\n16 0.0635 37.6961 10.1079 -19.8126butterflyNd1($F$3,$F$4,$F$5,$G$3,$G$4,$G$\n17 0.0595 39.5127 15.6702 -24.88945,B11,A11,$B$5,$B$4)\n18 0.0556 39.3373 16.0412 -25.3320\n19 0.0516 40.0574 18.7535 -27.7526\n20 0.0476 37.8111 12.9252 -22.9781\n21 0.0437 39.6546 19.8128 -29.2374\n22 0.0397 38.0253 15.3452 -25.5861\n23 0.0357 39.1652 20.6678 -30.4508\n24 0.0317 37.0963 12.9733 -23.8505\n25 0.0278 37.8587 17.7407 -28.3531\n26 0.0238 37.6234 17.7742 -28.4991\n27 0.0198 36.2854 10.6435 -22.0028\n28 0.0159 39.9963 32.6490 -42.9215\n29 0.0119 38.3893 28.0061 -39.5939\n30 0.0079 39.5149 36.2603 -47.0300\n31 0.0040 38.1897 35.1787 -47.1683\n32 0.0000 37.5170 34.5591 -47.1720\n33\n34 Comparison of formula payoff to simulation payoff\n35 Formula -12.4830<-- =G3*MAX(B32-F3,0)+G4*MAX(B32-F4,0)+G5*MAX(B32-F5,0)\n771 Simulating Options and Option Strategies\nRepeating this simulation 50 times and comparing the formula payoff (B35)\nto the simulation payoff (B36):\nA B C D E F G H I\n34 Comparison of formula payoff to simulation payoff\n35 Formula -3.0153<-- =G3*MAX(B32-F3,0)+G4*MAX(B32-F4,0)+G5*MAX(B32-F5,0)\n36 Simulation -2.2116<-- =SUM(C32:D32)\n37\n38 Data table: 50 runs of the simulation\n39\n40 Run -0.8037<-- =B35-B36, data table header\n41 1 0.4614\n42 2 -0.8721 Statistics for 50 runs: Formula payoff-simulation\n43 3 -0.2146 Average 0.0329<-- =AVERAGE(B41:B90)\n44 4 0.3714 Sigma 1.3119<-- =STDEV.S(B41:B90)\n45 5 -2.3605 Max 4.2486<-- =MAX(B41:B90)\n46 6 -1.1354 Min -4.0611<-- =MIN(B41:B90)\n47 7 1.1293\n48 8 -2.0989 Formula payoff minus Simula(cid:415)on payoff\n49 9 -0.4745\n50 10 0.1328 5\n51 11 -0.0947 4\n52 12 1.7906\n3\n53 13 1.5235\n2\n54 14 4.2486\n55 15 -0.6404 1\n56 16 0.6187 0\n57 17 -0.1200 -1 0 5 10 15 20 25 30 35 40 45 50\n58 18 -0.4576\n-2\n59 19 -0.8565\n-3\n60 20 0.9230\n61 21 -0.0117 -4\n62 22 0.3053 -5\n63 23 0.0551\n64 24 1.0346"
        ],
        "29.7": [
            "What is the principle behind simulating option replication strategies?\nWhat does the Black-Scholes formula represent in terms of investment over time?\nWhat is the concept of a self-financing or zero-investment strategy?\nHow is the dynamic investment formula adjusted for implementing the idea of self-financing strategies?\nWhat could be the potential effect of implementing more complicated replication strategies, for example, a butterfly strategy?\nWhat are the limitations of the replication strategies in accurately reflecting the strategy payoff?\nWhat is meant by net investment over time in financial modeling?\nWhy is there a mismatch between the formula and the strategy payoff when simulating complicated strategies?\nWhat is meant by a butterfly strategy in terms of option replication strategies?\nWhen simulating options and option strategies, what do we mean by a dynamic investment?\nHow do the risky and riskless assets affect the dynamic investment over time?\nCan you explain what a replication strategy is in the context of financial modeling?\nWhat are the implications of a significant mismatch between the formula and the strategy payoff?",
            "29.7 Summary\n\nT his chapter concentrated on simulating option replication strategies. All of\nthe replication strategies are based on the idea that the Black-Scholes formula\ngives the dynamic investment over time in the risky and riskless asset. When\nimplementing this idea, we had to adjust this dynamic formula so that the\nnet investment over time is zero (the so-called self-financing or zero-\ninvestment strategies). The replication strategies then become somewhat less\n772 Chapter 29\npayoff only approximately. For more complicated strategies (we illustrated for\na butterfly), the mismatch between the formula and the strategy payoff can be\nsignificant."
        ]
    },
    "30": {
        "30.1": [
            "What are Monte Carlo methods in financial modeling?\nWhat are the objectives of using Monte Carlo methods for pricing options?\nWhat are Asian options in financial modeling?\nWhat are the characteristics of barrier options in finance?\nHow is the payoff of an Asian option determined?\nHow does the payoff of the barrier option depend on the underlying price?\nWhat is the meaning of risk neutrality in financial modeling?\nHow does the riskless bond and stock play a role in risk neutrality?\nWhat is risk-free rate and how is it represented in risk neutrality?\nWhat are the two meanings of risk neutrality and how do they differ?\nWhat does it mean to transform the stock's returns in financial modeling?\nHow is the binomial model used in the context of risk neutrality?\nWhat is the relevance of risk-neutral probabilities in pricing derivative securities?\nWhat are path-independent options in financial modeling?\nWhat are path-dependent options and how are they different from path-independent options?\nWhy doesn't a path-dependent option have an analytic price solution?\nHow does the Monte Carlo provide a numerical tool for pricing path-dependent options?\nWhat role does the simulation of the price path of the underlying asset play in Monte Carlo pricing of path-dependent options?\nWhat are plain-vanilla options in financial modeling and how are they priced?\nHow does the Black-Scholes formula come into play in pricing plain-vanilla options?\nHow is the Monte Carlo pricing mechanism used for more complicated options?",
            "30.1 Overview\n\nThis chapter continues the discussion of the previous chapter and shows how\nto implement Monte Carlo methods for pricing options. The main objective is\nto show how to price Asian options and barrier options. Both of these options\nare p ath dependent : Their payoffs depend not just on the terminal price of an\nunderlying asset but also on the intermediate asset prices before the terminal\nprice. An Asian option has a payoff which depends on the average price of the\nunderlying asset for some period before option maturity, and a barrier option \u2019 s\npayoff depends on the underlying price reaching a particular level at some\npoint before maturity. In sections 30.6\u201330.9 we will make these general state-\nments more explicit.\nWhat Does Risk Neutrality Mean?\nC onsider a situation in which there are two basic securities, a riskless bond\nand a stock. The interest rate on the bond is called the risk-free rate and is\nusually denoted by r . In the context of this situation of two basic assets, \u201crisk-\nneutral pricing\u201d can have two meanings. In both meanings of risk-neutrality\nderivative (i.e., non-basic) securities are priced as the discounted value (at the\nrisk-free rate) of their expected payoffs. The two meanings of risk neutrality\ndiffer in the procedure used to arrive at the payoffs of the risky basic security\n(the stock).\n\u2022 In the first meaning of risk neutrality, we change the underlying distribution\nof the stock\u2019 s returns so that the expected stock price is one plus the risk-free\nrate. To price an option we apply the basic risk-neutral pricing principle of\ndiscounting the expected option payoffs by the risk-free rate. In this use of\nrisk neutrality, we transform the stock\u2019 s returns but compute the expected\npayoffs using the actual return probabilities. We illustrate this procedure in\nsection 30.2.\n\u2022 The second meaning of risk neutrality uses the binomial model (see Chapter\n16). We transform the state prices into risk-neutral probabilities. In this use\nof risk neutrality, we do not transform the stock \u2019 s payoffs but instead replace\nthe actual state probabilities by the equivalent risk-neutral probabilities. We\nthen price derivative securities by discounting their expected payoffs at the\n776 Chapter 30\nThe first method of pricing is ideal for pricing options whose payoffs depend\nonly on the terminal price of the stock. We call such options p ath independent .\nThe second method is more general and can in principle be used to price any\noption, even if the payoffs are path dependent. Examples of such options\nexplored in this chapter are Asian and barrier options. Both these options are\npath-dependent options\u2014options whose price depends not only on the termi-\nnal price of the asset, but also on the path of the prices by which the terminal\nprice was reached. In general a path-dependent option does not have an ana-\nlytic price solution. Monte Carlo provides us with a handy numerical tool for\npricing such options. Monte Carlo pricing of path-dependent options depends\non a simulation of the price path of the underlying asset.\nThe Structure of This Chapter\nIn section 30.2 we show how the first risk-neutrality pricing principle (trans-\nforming the stock\u2019 s returns) can be used to Monte Carlo price a standard call\nand a put. We then continue with the second meaning of risk neutrality and\nshow how it can be used to price barriers and Asian options.\nT o make this chapter more self-contained we include a brief review of state\nprices and risk neutrality (section 30.3). We then show, in section 30.4, how\nto price a plain-vanilla option with a Monte Carlo algorithm. Since plain-\nvanilla options\u2014jargon by which we simply mean European calls and puts on\na stock whose price process is lognormal\u2014are accurately priced using the\nBlack-Scholes formula, this exercise allows us to check our pricing method\nagainst a known result and also allows us to develop the proper intuitions about\nthe Monte Carlo pricing of more complicated options."
        ],
        "30.2": [
            "What is the method of pricing standard European calls and puts using Monte Carlo?\nCan you explain the first meaning of risk neutrality in financial modelling? \nWhy might using Monte Carlo methods to price European calls and puts be viewed as a waste of time?\nWhat is the Black-Scholes formula and how is it applicable in pricing options?\nWhy is the Black-Scholes formula deemed a superior pricing solution?\nWhat are the benefits of pricing a plain-vanilla call using Monte Carlo methods?\nCan you describe the procedure of pricing a call on a stock using Monte Carlo?\nHow do we generate a set of stock prices to simulate the option price?\nWhy is it assumed that the stock prices are lognormally distributed with mean r and standard deviation \u03c3?\nHow are the terminal payoffs of the option computed?\nWhat is the significance of average discounted payoff in financial modelling and how is it calculated?\nWhat is the rationale for assuming the stock\u2019s mean return to be r \u2212\u03c3 2 /2 in financial modelling?\nIn the context of risk neutrality, how would one go about transforming expected stock prices?\nHow are future stock prices generated in financial modelling using Monte Carlo?\nWhat is the significance of theoretical statistics in financial modelling?\nHow does one compute the call payoff for each simulated stock price?\nWhat is the method for calculating discounted value in option pricing?\nHow do Monte Carlo simulations work for put options?\nWhat is a digital option and how can its pricing be carried out using Monte Carlo?\nWhat is the use of Excel function Int(Mod(S ,10) in determining the second digit of the terminal stock price?",
            "30.2 Pricing a Plain-Vanilla Call Using Monte Carlo Methods\n\nIn this section we explore the pricing of standard European calls and puts using\nMonte Carlo. We employ the first meaning of risk neutrality discussed in\nsection 30.1, transforming the returns on the stock so that the stock \u2019 s expected\nreturn is the risk-free rate and then discounting the expected option payoffs at\nthe risk-free rate.\nT o use this complicated model to price European calls and puts with\nMonte Carlo methods might be viewed as an immense waste of time\u2014the\nBlack-Scholes formula (Chapter 17) gives a wonderful pricing solution for\n777 Using Monte Carlo Methods for Option Pricing\n\u03c0 discussed in Chapter 25, the exercise of pricing a plain-vanilla call using\nMonte Carlo methods gives us considerable insight into the application of\nMonte Carlo methods.\nThe Procedure\nConsider a call on a stock with the parameters given below. This call can be\npriced using the Black-Scholes formula. We will show how our first risk-\nneutral procedure of transforming the returns can be used to price this call\nusing Monte Carlo.\nA B C\n1 BLACK-SCHOLES CALL PRICE\n2 S0 50\n3 X 44\n4 T 1\n5 r 5%\n6 Sigma 15%\n7\n8 Black-Scholes call price 8.5417<-- =BSCall(B2,B3,B4,B5,B6)\nWe now simulate the option price as follows:\n\u2022 Step 1: We simulate a set of stock prices at time T . The stock prices have\nthe property that they are lognormally distributed with mean r and standard\ndeviation \u03c3 . To do this we assume that the stock prices have mean r \u2212 \u03c3 2 /2\nand standard deviation \u03c3 .\n\u2022 Step 2: We compute the terminal payoffs of our option for these stock prices:\nmax( S \u2212 X ,0).\nT\n\u2022 S tep 3: We compute the average discounted payoff: exp[ \u2212 r * T ]* Average\n[max( S \u2212 X ,0)]. This should be the same as the Black-Scholes price (and\nT\napproximately it is).\nWhy Do We Assume That the Stock \u2019 s Mean Return Is r \u2212\u03c3 2 /2?\nSuppose that the stock returns are normal with mean \u03bc and standard deviation\n\u03c3 . As discussed in Chapter 26, this means that the expected stock price is\nS exp[(\u03bc +\u03c3 2 /2) t ]. In our first meaning of risk neutrality, we want to transform\n0\n778 Chapter 30\nreplacing \u03bc by r \u2212\u03c3 2/ 2. This guarantees that the expected future price of the\nstock grows at rate r, which is the basic condition for the risk-neutral pricing:\nS exp[( \u03bc+\u03c32 2) t] =S exp[(( r\u2212\u03c32 2) +\u03c32 2) t] =S exp[ rt]\n0 0 0\nStep 1: Generating the Price Data\nH aving cleared up this theoretical issue, we now return to our computations.\nWe first generate 1,000 future stock prices. Each price is generated using:\n\u23a1\u239b \u03c32\u239e \u23a4\nS =S \u2217exp\u23a2\u239cr\u2212 \u239f\u2217T+\u03c3\u2217 T \u2217Z\u23a5\nT 0 \u23a3\u239d 2 \u23a0 \u23a6\nHere Z is the standard normal deviate produced, as illustrated in Chapter 26,\nby the Excel function N orm.S.Inv(Rand( )) . Here \u2019 s some sample data:\nA B C D E F G H I\nSIMULATING RISK-NEUTRAL STOCK PRICES\n1 The terminal stock prices S T in column D have standard deviation \u03c3 and expected return r\nSimulated\ntime T stock Stock\n2 prices prices\n3 S0 50 50.4594<-- =$B$3*EXP(($B$6- Count 1,000<-- =COUNT(D:D)\n4 X 44 57.3000$B$7^2/2)*$B$5+$B$7*SQRT( Max 80.5565<-- =MAX(D:D)\n5 T 1 43.1088$B$5)*NORM.S.INV(RAND())) Min 32.7373<-- =MIN(D:D)\n6 r 5% 62.2230 Average 52.6528<-- =AVERAGE(D:D)\n7 Sigma 15% 70.9889 Sigma 7.9982<-- =STDEV.S(D:D)\n8 54.0741\n9 Black-Scholes call price 8.5417<-- 55.4966 Data statistics\n10 =BSCall(B3,B4, 56.7003 Return 5.17%<-- =LN(H6/B3)\n11 B5,B6,B7) 60.0961 Sigma of return 15.19%<-- =H7/H6\n12 41.8308\n13 45.5635 Theoretical statistics\n14 44.9597 Return 5.13%<-- =EXP(B6*B5)-1\n15 59.0905 Sigma of return 15.00%<-- =B7\n16 50.5293\nSteps 2 and 3\nW e now use the sample data to compute the payoffs of our option. Below we\ncompute the call payoff for each simulated stock price (column E), and in cell\nB10 we compute the discounted value (at the risk-free rate) of the average of\nthese payoffs exp[ \u2212 r * T ]* Average [max( S \u2212 X ,0)]. As predicted, this discounted\nT\n779 Using Monte Carlo Methods for Option Pricing\nA B C D E F\nPRICING A CALL WITH SIMULATED RISK-NEUTRAL PRICES\n1000 simulations (columns D, E)\n1\nSimulated\ntime T stock Simulated\n2 prices call payoff\n3 S0 50 47.3920 3.3920<-- =MAX(D3-$B$4,0)\n4 X 44 57.7402 13.7402<-- =MAX(D4-$B$4,0)\n5 T 1 46.5386 2.5386<-- =MAX(D5-$B$4,0)\n6 r 5% 62.5030 18.5030\n7 Sigma 15% 60.6115 16.6115\n8 59.3324 15.3324\n9 Call option valuation 63.4439 19.4439\n10 Discounted average payoff 8.6400<-- =EXP(-B6*B5)*AVERAGE(E:E) 58.7748 14.7748\n11 Black-Scholes call price 8.5417<-- =BSCall(B3,B4,B5,B6,B7) 71.8958 27.8958\n12 47.4755 3.4755\nThe same procedure works for puts:\nA B C D E F\nPRICING A PUT WITH SIMULATED RISK-NEUTRAL PRICES\n1000 simulations (columns D, E)\n1\nSimulated\ntime T stock Simulated\n2 prices call payoff\n3 S0 50 59.8926 0.0000<-- =MAX($B$4-D3,0)\n4 X 44 52.6776 0.0000<-- =MAX($B$4-D4,0)\n5 T 1 62.4782 0.0000<-- =MAX($B$4-D5,0)\n6 r 5% 67.1018 0.0000\n7 Sigma 15% 62.4515 0.0000\n8 53.0296 0.0000\n9 Put option valuation 46.7010 0.0000\n10 Discounted average payoff 0.3801<-- =EXP(-B6*B5)*AVERAGE(E:E) 43.4355 0.5645\n11 Black-Scholes call price 0.3958<-- =bsput(B3,B4,B5,B6,B7) 73.7133 0.0000\n12 53.5770 0.0000\nDigital Option\nTo show the power of this method, suppose we wish to price a security that\npays off the second digit of the terminal stock price. As an example: If the\nS = 43.5323, our \u201cdigital security\u201d pays off 3; if S = 50.5323, the payoff is\nT T\n0. (Why anyone would want to buy such a security is a separate question.)\nThe spreadsheet below shows that this security can easily be priced using\n780 Chapter 30\nprices and use the Excel function Int(Mod(S ,10) to determine the second\nT\ndigit of the terminal stock price:\nA B C D E F\nDERIVATIVE PAYS OFF SECOND DIGIT OF TERMINAL STOCK PRICE\n1\nSimulated\ntime T stock Simulated\n2 prices call payoff\n3 S0 50 53.6894 3.0000<-- =INT(MOD(D3,10))\n4 X 44 49.2395 9.0000<-- =INT(MOD(D4,10))\n5 T 1 44.3635 4.0000<-- =INT(MOD(D5,10))\n6 r 5% 45.7508 5.0000\n7 Sigma 15% 44.5083 4.0000\n8 57.4873 7.0000\n9 Digital option valuation 48.8942 8.0000\n10 Discounted average payoff 4.2606<-- =EXP(-B6*B5)*AVERAGE(E:E) 46.8333 6.0000\n11 46.5321 6.0000"
        ],
        "30.3": [
            "What does risk neutrality mean in the context of a binomial model in financial modeling?\nHow are risk-neutral state probabilities used in the calculation of expected payoffs of derivative securities?\nWhat are the focus areas of pricing in the context of barrier and Asian options?\nWhat basic facts about state prices and risk-neutral pricing are discussed in financial modeling?\nHow does a binomial framework operate with respect to the growth of a stock price?\nWhat is the property of risk neutrality in relation to state prices?\nWhat is the role of risk-neutral probabilities in asset pricing?\nHow are the risk-neutral expected payoffs computed and what are they discounted at?\nHow are the payoffs of a call usually expressed in the context of underlying asset price?\nHow is the risk-neutral pricing scheme extended to multi-period frameworks?\nWhat does the recombining tree notation in financial modelling suggest?\nWhat does path-independent in the context of date-n payoffs mean?\nWhat is the difference between path-independent and path-dependent payoffs in financial modeling?\nHow does the option payoff depend on terminal stock price and how is it unaffected by the path by which this price is reached?\nIn a multi-period binomial framework, how are the payoffs denoted and how is the value of an asset calculated?\nWhat is the significance of the U and D parameters in a binomial framework?\nHow are state prices represented in a binomial framework and what are their implications for risk neutrality?\nWhat do stock prices and bond values signify in a recombining versus non-recombining binomial models?\nHow are payoffs represented in path-independent and path-dependent assets in financial modelling?",
            "30.3 State Prices, Probabilities, and Risk Neutrality\n\nIn the remainder of this chapter we use the second meaning of risk neutrality\ndiscussed in section 30.1: In the framework of a binomial model, we compute\nrisk-neutral state probabilities which are then used to compute the expected\npayoffs of derivative securities. Our main focus will be on the pricing of barrier\nand Asian options, but the principles are general and can be applied to most\nderivatives.\nIn this section we start with a brief recapitulation of the basic facts about\nstate prices and risk-neutral pricing discussed in Chapter 16. Suppose we have\nbinomial framework with stock price S which grows at U or D in every period.\nSuppose the interest rate is R . 1 Risk neutrality is a property of every set\n\u23a7 R\u2212D U\u2212R \u23ab\nof state prices: Given state prices \u23a8q = ,q = \u23ac , the\n\u23a9 U R( U\u2212D) D R( U\u2212D) \u23ad\nrisk-neutral probabilities are defined by {\u03c0 = Rq , \u03c0 = Rq } . The risk-neutral\nU U D D\nprobabilities can be used to price assets by taking the discounted expected\n1. Properly speaking, U , D, and R are one plus the growth and interest rates. For the sake of\nlinguistic parsimony, we well use \u201cup growth,\u201d \u201cdown growth,\u201d and \u201cinterest rate\u201d even though\n781 Using Monte Carlo Methods for Option Pricing\nvalue of the asset payoffs.2 An asset with payoffs one period hence of {P ayoff ,\nU\nPayoff } in states U and D respectively has value today of:\nD\n\u03c0 Payoff +\u03c0 Payoff\nAssetvaluetoday=q Payoff +q Payoff = U U D D\nU U D D (cid:2)(cid:4)(cid:4)(cid:4)(cid:4)(cid:3)R(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)\n\u2191\nThhe risk-neutral expected payoff\n(expectation computed\nwith tthe risk-neutral probabilities)\ndiscounted at the risk-freee interest\nrate.\nThe { Payoff , Payoff } are usually functions of the underlying asset price. For\nU D\nan ordinary call, for example, {P ayoff = max( S * U \u2212 X ,0), Payof f = max( S * D\nU D\n\u2212 X ,0)}.\nW e can extend the risk-neutral pricing scheme to multi-period frameworks.\nConsider a multi-period binomial setting where U and D do not change over\ntime, and indicate the date n state payoffs by Payoff , j = 0, \u2026 , n . This\nn,j\nnotation P ayoff indicates the date-n payoff of the asset in a state where there\nn,j\nare j up moves on the binomial tree; for a call in a binomial framework P ayoff\nn,j\n= Max ( S * Uj D n \u2212 j \u2212 X ,0). Then the value of this asset is given by\nAssetvaluetoday=\u2211n \u239b \u239cn\u239e\n\u239fqjqn\u2212jPayoff =\n1 \u2211n \u239b \u239cn\u239e\n\u239f\u03c0\u03c0j\u03c0n\u2212jPayoff\n\u239d j\u23a0 U D n,j Rn \u239d j\u23a0 U D n,j\nj=0 (cid:2)(cid:4)j=(cid:4)0 (cid:4)(cid:4)(cid:4)(cid:3)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)\n\u2191\nThe risk-neutral expected\ndiscountedd value.\nThis particular notation assumes that the tree is recombining . It assumes, in\nother words, that the date-n payoffs are path independent\u2014 the option payoff\nis a function only of the terminal stock price and does not depend on the path\nby which this price is reached (see Figure 30.1 ). We return to this topic later\nin this chapter.\n2. As discussed in Chapter 16, the risk-neutral probabilities are not the actual probabilities of the\n782 Chapter 30\nUNDERLYING ASSETS AND PATH-INDEPENDENT\nVERSUS PATH-DEPENDENT PAYOFFS\nStockprices Bondvalue\nSUU R2\nSU R\nS0 SUD = SDU 1 R2\nSD R\nSDD R2\nDate0 Date1 Date2 Date0 Date1 Date2\nPath-independent asset with payoffs at Date 2 Path-dependent asset with payoffs at Date 2\nPayoffUU PayoffUU\n0 0\nPayoffUD\nValue today PayoffUD = PayoffDU Value today\nPayoffDU\n0 0\nPayoffDD PayoffDD\nDate0 Date1 Date2 Date0 Date1 Date2\nFigure 30.1\nRecombining versus non-recombining binomial models."
        ],
        "30.4": [
            "What is the purpose of using a Monte Carlo method for pricing an at-the-money option?\nWhat does the initial stock price represent in the binary Monte Carlo model?\nHow is the stock price tree depicted in a binomial model?\nWhat are state prices and risk-neutral probabilities in financial modeling?\nHow is a random price path generated with the Monte Carlo method?\nWhat factors determine the path of stock price in Monte Carlo simulation?\nCan you explain the role of the risk-neutral probabilities in a Monte Carlo simulation?\nHow do actual probabilities differ from risk-neutral probabilities in the Monte Carlo pricing model?\nWhy is the two-period model extended in a Monte Carlo simulation?\nWhat does the average discounted payoff represent in a binary Monte Carlo model? \nWhat does the actual option price represent in this financial model?\nHow does the Monte Carlo method facilitate convergence to the actual option price? \nWhat would happen if we produce a new set of random paths in a Monte Carlo simulation? \nExplain how the terminal stock price and option payoff are calculated in the binary Monte Carlo model. \nWhat are the implications of the stock price going down in both periods? \nWhat impact does the interest rate have on the pricing of an option using the Monte Carlo method? \nWhat computation takes place in cell B32 in this example of a Monte Carlo simulation? \nHow are the payoffs calculated in the option pricing model using state prices?",
            "30.4 Pricing a Call Using the Binomial Monte Carlo Model\n\nWe start with a ridiculously simple example. We use Monte Carlo to price a\n783 Using Monte Carlo Methods for Option Pricing\nor down each period. In the spreadsheet below we use Monte Carlo methods\nto price an at-the-money option on a stock whose price today is S = 50. There\n0\nare two periods, and in each period the stock price goes either Up = 1.4 or\nDown = 0.9; the interest rate is R = 1.05. Given Up and Down, the stock price\ntree looks like Figure 30.2 .\nUp 1.4\nDown 0.9\nS = 98 = 50*1.42\nUU\nS = 70\nU\nS =50 S = S = 63 = 50*1.4*0.9\n0 UD DU\nS = 45\nD\nS = 40.5 = 50*0.92\nDD\nDate 0 Date 1 Date 2\nFigure 30.2\nStock price tree in a standard recombining binomial model.\n784 Chapter 30\nA B C D\nSIMPLE SIMULATION:\nTWO PATHS IN A TWO-DATE MODEL\n1\n2 Initial stock price 50\n3 X 50\n4\n5 Up 1.4\n6 Down 0.9\n7 R 1.05\n8\n9 State prices\n10 q u 0.2857<-- =(B7-B6)/(B7*(B5-B6))\n11 q d 0.6667<-- =(B7-B6)/(B7*(B5-B6))\n12\n13 Risk-neutral probabilities\n14 \u03c0 u 0.3000<-- =(B7-B6)/(B7*(B5-B6))\n15 \u03c0 d 0.7000<-- =(B7-B6)/(B7*(B5-B6))\n16\n17 Random paths and the Monte Carlo price\n18 First period, up (1) or down (0)? 0 0<-- =IF(RAND()>$B$15,1,0)\n19 Second period, up (1) or down (0)? 0 1<-- =IF(RAND()>$B$15,1,0)\n20\n21 Total ups 0 1<-- =SUM(C18:C19)\n22 Terminal stock price 40.5 63<-- =$B$2*up^C21*down^(2-C21)\n23 Option payoff 0 13<-- =MAX(C22-$B$3,0)\n24\n25 Average discounted payoff 5.8957<-- =AVERAGE(23:23)/R_^2\n26\n27 Computing the actual option price with state prices\n28 Payoffs\n29 top 48<-- =MAX(B2*up^2-B3,0)\n30 middle 13<-- =MAX(B2*up*down-B3,0)\n31 bottom 0<-- =MAX(B2*down^2-B3,0)\n32 Actual option price 8.8707<-- =q_up^2*B29+2*q_up*q_down*B30+q_down^2*B31\nThe state prices and risk-neutral probabilities are computed in cells B10:B11\nand B14:B15. Cells B18:B19 and C18:C19 show two random price paths. In\neach period we use a random number from Excel generated by the function\nRand . If R and( ) >\u03c0 , then the stock price goes Up, and if R and() \u2264\u03c0 then\nD D\n785 Using Monte Carlo Methods for Option Pricing\n\u2022 I n the first price path (cells B18:B19), the stock price goes down in both\nperiods. The terminal stock price is 40.5 and the option \u2019 s payoff is 0 (cell B23).\n\u2022 I n the second price path (cells C18:C19), the stock price goes up in the first\nperiod and down in the second period. The terminal stock price is 63 and the\noption \u2019 s payoff is 13 (cell C23).\nIf these were the only two random price paths, the Monte Carlo option price\nwould be the discounted average 5.8957 (cell B25). Notice that we have also\ncomputed the actual call price using the state prices; cell B32 shows this price\nto be 8.8707.\nRisk-Neutral Probabilities in Monte Carlo\nNotice the role of the risk-neutral probabilities in the Monte Carlo simu-\nlation: The price path is determined n ot by the actual probabilities , but\nby the risk-neutral probabilities \u03c0 and \u03c0 . There is no role for the actual\nU D\nprobabilities in the Monte Carlo pricing.\nExtending the Two-Period Model\nYou can \u2019 t, of course, run a Monte Carlo simulation by using only two price\npaths. In the spreadsheet below, we\u2019 v e extended our price paths to all the\ncolumns in the spreadsheet. Excel \u2019 s spreadsheet is 256 columns wide; this\nmeans that the computation in cell B25 is the average of the option value over\n786 Chapter 30\nA B C D E F G H I\nSIMPLE SIMULATION: A TWO-DATE MODEL\nas many price paths as there are columns\npressing F9 runs the simulation and will change the value in cell B25\nThis value should be compared to the actual option price in cell B32\n1\n2 Initial stock price 50\n3 X 50\n4\n5 Up 1.4\n6 Down 0.9\n7 R 1.05\n8\n9 State prices\n10 qu 0.2857<-- =(B7-B6)/(B7*(B5-B6))\n11 qd 0.6667<-- =(B7-B6)/(B7*(B5-B6))\n12\n13 Risk-neutral probabilities\n14 \u03c0 u 0.3000<-- =(B7-B6)/(B7*(B5-B6))\n15 \u03c0 d 0.7000<-- =(B7-B6)/(B7*(B5-B6))\n16\n17 Random paths and the Monte Carlo price\n18 First period, up (1) or down (0)? 0 0 1 0 0 0 1 1\n19 Second period, up (1) or down (0)? 0 1 1 0 1 0 0 0\n20\n21 Total ups 0 1 2 0 1 0 1 1\n22 Terminal stock price 40.5 63 98 40.5 63 40.5 63 63\n23 Option payoff 0 13 48 0 13 0 13 13\n24\n25 Average discounted payoff 8.7502<-- =AVERAGE(23:23)/R_^2\n26\n27 Computing the actual option price with state prices\n28 Payoffs\n29 top 48<-- =MAX(B2*up^2-B3,0)\n30 middle 13<-- =MAX(B2*up*down-B3,0)\n31 bottom 0<-- =MAX(B2*down^2-B3,0)\n32 Actual option price 8.8707<-- =q_up^2*B29+2*q_up*q_down*B30+q_down^2*B31\nThe average discounted payoff (cell B25) is 8.7502. This value is random,\nmeaning it will change each time we press F9 to produce a new set of random\npaths. Monte Carlo methods imply that for even more paths we would con-\nverge to the actual option price of 8.8707. In the next section we show that\nthe Monte Carlo method eventually produces convergence to this price."
        ],
        "30.5": [
            "What does the term \"Monte Carlo methods\" mean in the context of financial modeling?\nWhat is the central principle of Monte Carlo simulation when applied to financial modeling?\nWhat is a plain-vanilla call in the context of option pricing?\nHow are risk-neutral probabilities used in the Monte Carlo method for option pricing?\nWhat are the significant principles of the Monte Carlo simulation?\nIn the context of financial modeling, what is the significance of risk-neutral probabilities?\nHow is the Monte Carlo method employed for the pricing of plain-vanilla call options?\nWhat does the term 'Black-Scholes' refer to in this context?\nWhat does it mean for an option's exercise price and time to maturity to be lognormally distributed?\nHow does the Monte Carlo method impact the efficiency of financial modeling routines?\nWhat does the term 'Asian options' refer to in financial modeling?\nWhat function does the Monte Carlo technology serve within VBA for financial modeling?\nHow does the lognormal distribution of an option's exercise price and time to maturity affect the pricing of the option?\nCan you explain how price paths are generated using risk-neutral probabilities in a Monte Carlo simulation?\nWhat improvements can be made to Monte Carlo routines to make them more efficient in financial modeling?\nWhat is the concept of risk-neutral probabilities and how is it incorporated into the price path in financial modeling? \nWhat is the significance of function VanillaCall in a spreadsheet as an implementation of Monte Carlo method? \nWhat does the concept of terminal payoff depend on in Asian options?\nCan you explain how to determine the value of an option using Monte Carlo method? \nWhat does a low standard deviation signify in a Monte Carlo method?",
            "30.5 Monte Carlo Plain-Vanilla Call Pricing Converges to Black-Scholes\n\nN ow that we understand the principles, we extend our logic. We write a VBA\nroutine which prices a plain-vanilla call using Monte Carlo methods under\n787 Using Monte Carlo Methods for Option Pricing\nOur basic setup is as follows: We price a European call on a stock whose\ncurrent price is S . The option \u2019 s exercise price is X , and the time to maturity\n0\nof the option is T. We assume that the stock price is lognormally distributed\nwith mean \u03bc and standard deviation \u03c3 .\nTo price the call using Monte Carlo:\n\u2022 We divide the unit time interval into n divisions. This means that\n\u0394 t = 1/ n .\n\u2022 For each \u0394 t, we define U p \u0394t =exp\u23a1 \u23a3\u03bc\u0394t+\u03c3 \u0394t\u23a4 \u23a6 and Down \u0394t =\ne xp\u23a1 \u23a3\u03bc\u0394t\u2212\u03c3 \u0394t\u23a4 \u23a6 . The interest rate on the interval \u0394 t is R = exp[ r \u0394 t ].\n\u0394 t\n\u2022 This means that the state prices and risk-neutral probabilities are given by\nR \u2212Down Up \u2212R\nq = \u0394t \u0394t , q = \u0394t \u0394t\nu R ( Up \u2212Down ) d R ( Up \u2212Down )\n\u0394t \u0394t \u0394t \u0394t \u0394t \u0394t\nR \u2212Down Up \u2212R\n\u03c0 = \u0394t \u0394t , \u03c0 = \u0394t \u0394t =1\u2212\u03c0\nuu Up \u2212Down d Up \u2212Down u\n\u0394t \u0394t \u0394t \u0394t\n\u2022 Since the time to maturity of the option is T , the price path to T requires m\n= T / \u0394 t periods. A price path of lengthm is created by determining the Up or\nDown move of the stock as a function of a random number between 0 and 1\nand the risk-neutral probability \u03c0 . As discussed in the example in section 30.3,\nd\nif the random number is greater than \u03c0 , the stock makes an Up move; other-\nd\nwise it makes a Down move.\nA VBA Routine\nThe VBA routine below defines a function V anillaCall . This function requires\nas inputs the variables mentioned above. The variable Runs is the number of\nrandom price paths created; these paths are averaged to determine the Monte\n788 Chapter 30\nFunction VanillaCall(S0, Exercise, Mean, sigma, _\nInterest, Time, Divisions, Runs)\ndeltat = 1 / Divisions\ninterestdelta = Exp(Interest * deltat)\nup = Exp(Mean * deltat + _\nsigma * Sqr(deltat))\ndown = Exp(Mean * deltat - _\nsigma * Sqr(deltat))\npathlength = Int(Time / deltat)\n\u2018Risk-neutral probabilities\npiup = (interestdelta - down) / _\n(up - down)\npidown = 1 - piup\nTemp = 0\nFor Index = 1 To Runs\nUpcounter = 0\n\u2018Generate terminal price\nFor j = 1 To pathlength\nIf Rnd > pidown Then Upcounter = _\nUpcounter + 1\nNext j\ncallvalue = Application.Max(S0 * _\n(up \u2227 Upcounter) * (down \u2227 (pathlength - _\n789 Using Monte Carlo Methods for Option Pricing\n/ (interestdelta \u2227 pathlength)\nTemp = Temp + callvalue\nNext Index\nVanillaCall = Temp / Runs\nEnd Function\nThe number of Up moves is stored in a counter called U pcounter and\nthe value of the call for each R un is the discounted value of the call payoff\nfor a particular terminal price S * Up Upcounter Downp athlength \u2212 U pcounter , where\n0\npathlength = Int(Time / deltat) is the integer part of T / \u0394 t :\ncallvalue = Application.Max(S0 * (up \u2227\nUpcounter) * _\n(down \u2227 (pathlength - Upcounter)) _\n- Exercise, 0) / (interestdelta \u2227\npathlength)\nThe Monte Carlo value of the call is given by: VanillaCall =\nTemp / Runs .\nUnderstanding the Principles of the Monte Carlo Simulation\nFor future reference we state the principles of the Monte Carlo simulation.\nThese principles hold not only for the plain-vanilla options of this section, but\nalso for the Asian options treated later in this chapter:\n\u2022 Price paths are generated by using the risk-neutral probabilities. In the\nprogram VanillaCall, for example, the price of the stock moves Up if the\nrandom number generator > \u03c0 and moves Down if the random number gen-\nD\nerator \u2264 \u03c0 . Effectively this means that the risk-neutral probabilities {\u03c0 = 1\nD U\n\u2212 \u03c0 , \u03c0 } of each price path are incorporated into the price path itself.\nD D\n\u2022 T he value of the option using Monte Carlo is determined by the discounted\n790 Chapter 30\nImplementing the MC Function VanillaCall in a Spreadsheet\nThe spreadsheet below shows the implementation of V anillaCall . The value\nin cell B14 is the option value as computed by the Black-Scholes formula; the\nfunction B SCall was defined in Chapter 19.\nA B C\n1 MONTE CARLO PRICING OF PLAIN-VANILLA CALLS\n2 S 0 , current stock price 50\n3 X, exercise price 50\n4 r, interest rate 10%\n5 T, time 0.8\n6 \u03bc, mean stock return 33%\n7 \u03c3, sigma--standard deviation of stock return 30%\n8\n9 n, divisions of unit time 200\n10 Runs 3,000\n11\n12 VanillaCall 7.5861<-- =vanillacall(B2,B3,B6,B7,B4,B5,B9,B10)\n13\n14 BS call 7.2782<-- =BSCall(B2,B3,B5,B4,B7)\nT he function divides the time to option expiration T = 0.8 (cell B5) into 100\ndivisions (cell B9), so that \u0394 t = 1/200. Each time the function is called, it\nruns 3,000 price paths (cell B10). A particular call of the function shown\nabove produced the value 7.5861 (cell B12), whereas the Black-Scholes call\nvalue\u2014computed with the function BSCall defined in Chapter 19\u2014is 7.2782\n(cell B14).\nH ow good is this MC routine? One way to test it is to run it many\ntimes. In the spreadsheet below, we\u2019 v e run 40 instances of the function\n791 Using Monte Carlo Methods for Option Pricing\nA B C D E\n1 RUNNING THE MONTE CARLO FUNCTION MANY TIMES\n2 S 0 , current stock price 50\n3 X, exercise price 50\n4 r, interest rate 10%\n5 T, time 0.8\n6 \u03bc, mean stock return 33%\n7 \u03c3, sigma--standard deviation of stock return 30%\n8\n9 n, divisions 100\n10 Runs 3,000\n11\n12 VanillaCall 6.9059<-- =vanillacall(B2,B3,B6,B7,B4,B5,B9,B10)\n13\n14 BS call 7.2782<-- =BSCall(B2,B3,B5,B4,B7)\n15\n16 Multiple runs of the function\n17 7.4154 7.0526 7.2989 7.3993<--\n18 7.2086 7.1906 7.4140 7.2986=vanillacall(B2,B3,B6,\n19 7.1909 7.0336 7.2967 7.4546B7,B4,B5,B9,B10)\n20 7.5312 7.3078 7.5679 7.2017\n21 7.1911 7.0003 6.8358 7.1334\n22 7.2903 7.3150 7.3853 7.0925\n23 7.6109 7.3928 7.1644 7.4126\n24 7.6070 7.2575 7.1837 7.2717\n25 7.2296 7.5758 7.1568 7.4572\n26 7.3825 7.0926 7.1412 7.1313\n27\n28 7.2793<-- =AVERAGE(A17:D26)\n29 0.1765<-- =STDEV.S(A17:D26)\nT he average value (cell A28) has a relatively low standard deviation (cell\nA29). The Monte Carlo routine works pretty well.\nImproving the Efficiency of the MC Routine\nM onte Carlo routines are inherently very wasteful\u2014you have to run them\nmany times to get a reasonable approximation to the true value. Thus\nthere is a lot of mileage in making a particular routine more efficient.\nContinuing with our V anillaCall example, we show one example of such an\nefficiency gain.\nSuppose that after j random numbers the random price is such that there is\nno chance that the call option will be in the money. Denote the number of Ups\nafter j random coin tosses by Upcounter ( j) . Then the call option cannot be in\nthe money after n random numbers if S UpU pcounter ( j ) + ( n \u2212 j ) Downj \u2212 Upcounter ( j ) < X .\n0\nThis formula assumes that all the remaining random numbers (there will be\n792 Chapter 30\nF or this case, we should stop choosing random numbers after j and let the\ncall value be zero. The VBA routine below implements this logic:\nFunction BetterVanillaCall(S0, Exercise, Mean, _\nsigma, Interest, Time, Divisions, Runs)\ndeltat = Time / Divisions\ninterestdelta = Exp(Interest * deltat)\nup = Exp(Mean * deltat + sigma * Sqr(deltat))\ndown = Exp(Mean * deltat - sigma * Sqr(deltat))\npathlength = Int(Time / deltat)\n\u2018Risk-neutral probabilities\npiup = (interestdelta - down)/(up - down)\npidown = 1 - piup\nTemp = 0\nFor Index = 1 To Runs\nUpcounter = 0\n\u2018Generate terminal price\nFor j = 1 To pathlength\nIf Rnd > pidown Then Upcounter = _\nUpcounter + 1\nIf S0 * up \u2227 (Upcounter + pathlength - j) _\n* down \u2227 (j - Upcounter) < X _\nThen GoTo Compute\nNext j\nCompute:\ncallvalue = Application.Max(S0 * _\n(up \u2227 Upcounter) * (down \u2227 _\n793 Using Monte Carlo Methods for Option Pricing\n- Exercise, 0) / (interestdelta _\n\u2227 pathlength)\nTemp = Temp + callvalue\nNext Index\nBetterVanillaCall = Temp / Runs\nEnd Function\nT he highlighted portions of the code show the changes. The lines called\nCompute simply calculate the C allvalue .\nThe spreadsheet below shows the implementation:\nA B C\nMONTE CARLO PRICING OF PLAIN-VANILLA CALLS\nBetterVanillaCall: A somewhat more efficient function: If, after j random\nnumbers which produce k Up moves, S *Up(k+n-j)*Down(j-k)<X, then we abort\n0\nthe random price path and let the call value = 0\n1\n2 S 0 , current stock price 50\n3 X, exercise price 45\n4 r, interest rate 6%\n5 T, time 0.8\n6 \u03bc, mean stock return 12%\n7 \u03c3, sigma--standard deviation of stock return 30%\n8\n9 n, divisions 100\n10 Runs 2,000\n11\n12 VanillaCall 9.0001<-- =bettervanillacall(B2,B3,B6,B7,B4,B5,B9,B10)\n13\n14 BS call 9.2931<-- =BSCall(B2,B3,B5,B4,B7)\nWhere Do We Go from Here?\nNow that we understand the Monte Carlo technology and its implementation\nin VBA, we can extend our examples in two directions. In the next section we\ndiscuss the pricing of Asian options\u2014options in which the option\u2019 s terminal\npayoff depends on the average price over the path. In section 30.6 we discuss\n794 Chapter 30"
        ],
        "30.6": [
            "What is an Asian option in the context of financial modelling?\nWhat does the payoff of an Asian option depend on?\nWhat are the two common kinds of Asian options?\nHow is the payoff of the first kind of Asian option calculated?\nWhat scenarios or markets commonly use average strike options?\nWhy are Asian options particularly useful when the user sells the underlying during the period?\nHow does an Asian option mitigate the effect of price manipulation in the underlying?\nWhat is the role of risk-neutral probabilities in pricing an Asian option?\nHow are risk-neutral probabilities used in the computation of an Asian option's price?\nHow is an Asian option price path dependent?\nWhat is the difference between Asian options and plain vanilla options in terms of path consideration?\nWhy is pricing Asian options considered difficult?\nWhat is the process to calculate the value of an Asian option when the stock price either increases by 40% or decreases by 20% each period?\nHow do you calculate the average stock price along the path of an Asian option?\nWhat is the significance of average price in the payoff calculation of an Asian option?\nWhy can two paths with the same starting and ending price have different option payoffs?\nHow is an option price calculated using discounted expected payoff value?",
            "30.6 Pricing Asian Options\n\nA n Asian option is an option whose payoff depends in some way on the\naverage price of the asset over a period of time prior to option expiration.3\nAsian options are sometimes called \u201caverage price options.\u201d There are two\ncommon kinds of Asian options:\n\u2022 In the first kind of Asian option, the option \u2019 s payoff is based on the differ-\nence between the average price of the underlying asset and the strike price:\nMax[Average underlying \u2013 Strike, 0]. The examples in Figures 30.3 and 30.4\nof the oil contract traded on the NYMEX and the traded average price option\n(TAPO) traded on the London Metals Exchange are this kind of option.\n\u2022 I n the second kind of Asian option, the option\u2019 s exercise price is the average\nof the underlying asset \u2019 s price over a period preceding option maturity:\nMax[Terminal underlying \u2013 average underlying, 0]. Such average strike\noptions are common in markets for electric energy. They assist hedgers whose\nprimary risks are related to the average price of the underlying.\nAsian options are particularly useful when the user sells the underlying\nduring the period and is therefore exposed to the average price and when there\nis danger of price manipulation in the underlying. The Asian option mitigates\nthe effect of manipulation, since it is based not on a single price, but on a\nsequence of prices.\n3. See www.riskglossary.com/articles/asian_option.htm and www.global-derivatives.com/option\ns/asian-options.php for some definitions and a discussion of the literature. A list of references is\n795 Using Monte Carlo Methods for Option Pricing\nFigure 30.3\n796 Chapter 30\nFigure 30.4\nAsian options on copper traded on the London Metals Exchange (LME). www.basemetals.com/\nhtml/cuinfo.htm\nAn Initial Example of an Asian Option\nW e start by considering an Asian option on a stock whose price either increases\nby 40% or decreases by 20% each period. We look at five dates, starting with\n797 Using Monte Carlo Methods for Option Pricing\nA B C D E F G H I J\n1 ASIAN OPTION PICTURE\n2 Initial stock price 30\n3 Up 1.4\n4 Down 0.8\n5 R, 1+interest rate 1.08\n6 Exercise price 50\n7\n8 State prices\n9 qu 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n10 qd 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n11\n12 Risk-neutral probabilities\n13 \u03c0 u 0.4667<-- =B9*$B$5\n14 \u03c0 d 0.5333<-- =B10*$B$5\n15\n16\n17 115.25 <-- =G18*B3\n18 Stock price 82.32\n19 58.80 65.86 <-- =G18*B4\n20 42.00 47.04\n21 30.00 33.60 37.63 <-- =G20*B4\n22 24.00 26.88\n23 19.20 21.50 <-- =G22*B4\n24 15.36\n25 12.29 <-- =G24*B4\n26\n27\n28 1.3605 <-- =G29*$B$5\n29 Bond price 1.2597\n30 1.1664 1.3605 <-- =G31*$B$5\n31 1.0800 1.2597\n32 1.0000 1.1664 1.3605\n33 1.0800 1.2597\n34 1.1664 1.3605\n35 1.2597\n36 1.3605\nT o compute the value of the option, we first compute each price path .\nThere are 16 such paths. The spreadsheet below shows each path, the average\nstock price over the path, the option payoff, and the path\u2019 s risk-neutral\n798 Chapter 30\nA B C D E F G H I J K L M N O P\n1 PRICING AN ASIAN OPTION BY PRICING ALL THE PATHS\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7 Formula in cell O16: =$B$11^4\n8 State price, Up: qU 0.4321<-- =(B5-B4)/(B5*(B3-B4)) Formula in cell O18: =$B$11^3*$B$12\n9 State price, Down, qD 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n10 Formula in cell M16 =AVERAGE(G16:K16)\n11 Risk-neutral prob., Up 0.4667<-- =B8*B5\n12 Risk-neutral prob., Down 0.5333<-- =B9*B5 Formula in cell N16 =MAX(M16-$B$6,0)\n13\n14 STOCK PRICE\nPath\nPeriod Period Period Period Period Period Period Period Period Average Option risk-neutral\n15 Paths 1 2 3 4 0 1 2 3 4 stock price payoff probability\n16 All up (1 path) up up up up 30.00 42.00 58.80 82.32 115.25 65.67 35.67 0.0474\n17\n18 One down (4 paths) down up up up 30.00 24.00 33.60 47.04 65.86 40.10 10.10 0.0542\n19 up down up up 30.00 42.00 33.60 47.04 65.86 43.70 13.70 0.0542\n20 up up down up 30.00 42.00 58.80 47.04 65.86 48.74 18.74 0.0542\n21 up up up down 30.00 42.00 58.80 82.32 65.86 55.80 25.80 0.0542\n22\n23 Two down (6 paths) down down up up 30.00 24.00 19.20 26.88 37.63 27.54 0.00 0.0619\n24 down up down up 30.00 24.00 33.60 26.88 37.63 30.42 0.42 0.0619\n25 down up up down 30.00 24.00 33.60 47.04 37.63 34.45 4.45 0.0619\n26 up down down up 30.00 42.00 33.60 26.88 37.63 34.02 4.02 0.0619\n27 up up down down 30.00 42.00 58.80 47.04 37.63 43.09 13.09 0.0619\n28 up down up down 30.00 42.00 33.60 47.04 37.63 38.05 8.05 0.0619\n29\n30 Three down (4 paths) up down down down 30.00 42.00 33.60 26.88 21.50 30.80 0.80 0.0708\n31 down up down down 30.00 24.00 33.60 26.88 21.50 27.20 0.00 0.0708\n32 down down up down 30.00 24.00 19.20 26.88 21.50 24.32 0.00 0.0708\n33 down down down up 30.00 24.00 19.20 15.36 21.50 22.01 0.00 0.0708\n34\n35 Four down (1 path) down down down down 30.00 24.00 19.20 15.36 12.29 20.17 0.00 0.0809\n36\n37 Option value 5.3756\n38\n39\n40 Formula in cell N37 =SUMPRODUCT(N16:N35,O16:O35)/B5^4\n41\nThe paths are determined by the number and the sequence of the Up and\nthe Down movements of the stock. For explanatory purposes we have high-\nlighted two price paths:\n\u2022 Along the path {up, down, up, up} the terminal stock price is 65.856, the\naverage price is 43.699, the option payoff is 13.699, and the discounted\n799 Using Monte Carlo Methods for Option Pricing\nA B C\n1 PATH PRICE EXAMPLE: {Up, Down, Up, Up}\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7\n8 State price, Up: qU 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n9 State price, Down, qD 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n10\n11 Risk-neutral prob., Up 0.4667<-- =B8*B5\n12 Risk-neutral prob., Down 0.5333<-- =B9*B5\n13\nPrice at\nPrice movement:\nDate beginning of\nUp or Down\n14 period\n15 0 30.000\n16 1 42.000 Up\n17 2 33.600 Down\n18 3 47.040 Up\n19 4 65.856 Up\nAverage price along\n20 path 43.699 <-- =AVERAGE(B15:B19)\n21 Option payoff at path end 13.699 <-- =MAX(B20-$B$6,0)\n22 Path risk-neutral price 0.0542 <-- =B11^COUNTIF(C16:C19,\"Up\")*B12^COUNTIF(C16:C19,\"Down\")\nValue of path: Payoff *\nrisk-neutral price *\n23 discount factor 0.546 <-- =B21*B22/B5^4\nT he average stock price along this path is 43.699, so that the option pays\noff max[43.699 \u2212 30,0] = 13.699.\n\u2022 Along the path {up, up, down, up} the terminal stock price is the same as\nbefore: 65.856. However, the average price and thus the option payoff and\n800 Chapter 30\nA B C\n1 PATH PRICE EXAMPLE: {Up, Up, Down, Up}\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7\n8 State price, Up: qU 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n9 State price, Down, qD 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n10\n11 Risk-neutral prob., Up 0.4667<-- =B8*B5\n12 Risk-neutral prob., Down 0.5333<-- =B9*B5\n13\nPrice at\nPrice movement:\nDate beginning of\nUp or Down\n14 period\n15 0 30.000\n16 1 42.000 Up\n17 2 58.800 Up\n18 3 47.040 Down\n19 4 65.856 Up\nAverage price along\n20 path 48.739 <-- =AVERAGE(B15:B19)\n21 Option payoff at path end 18.739 <-- =MAX(B20-$B$6,0)\n22 Path risk-neutral price 0.0542 <-- =B11^COUNTIF(C16:C19,\"Up\")*B12^COUNTIF(C16:C19,\"Down\")\nValue of path: Payoff *\nrisk-neutral price *\n23 discount factor 0.747 <-- =B21*B22/B5^4\nT hese two paths illustrate what we mean when we say that an Asian option\nprice is path dependent : Two paths\u2014both starting at the initial stock price of\n30 and ending at 65.856\u2014have different option payoffs because the stock price\naverage along the path is different.\nT his example, which we\u2019 v e not yet concluded, also illustrates the difficulty\nof pricing Asian options: Each single path must be dealt with\u201416 separate\npaths. This distinguishes Asian options from the case of ordinary options\n(\u201cplain vanilla,\u201d in the jargon of option pricers); for the particular example\nwe \u2019 re considering here, a plain-vanilla option requires dealing only with five\nending prices.\nT o price the Asian option, we attach a risk-neutral probability to each\n801 Using Monte Carlo Methods for Option Pricing\nM N O P\nPath\nAverage Option risk-neutral\n15 stock price payoff probability\n16 65.67 35.67 0.0474 <-- =B11^4\n17\n18 40.10 10.10 0.0542 <-- =$B$11^3*$B$12\n19 43.70 13.70 0.0542\n20 48.74 18.74 0.0542\n21 55.80 25.80 0.0542\n22\n23 27.54 0.00 0.0619 <-- =$B$11^2*$B$12^2\n24 30.42 0.42 0.0619\n25 34.45 4.45 0.0619\n26 34.02 4.02 0.0619\n27 43.09 13.09 0.0619\n28 38.05 8.05 0.0619\n29\n30 30.80 0.80 0.0708 <-- =$B$11*$B$12^3\n31 27.20 0.00 0.0708\n32 24.32 0.00 0.0708\n33 22.01 0.00 0.0708\n34\n35 20.17 0.00 0.0809 <-- =$B$12^4\n36\n37 Option value 5.3756<-- =SUMPRODUCT(N16:N35,O16:O35)/B5^4\nT he option price is the discounted expected payoff value, where the expecta-\ntions are computed with the risk-neutral probabilities:\n\u2211 \u03c0 \u2217Option payoff on path\nPath\nAllpaths =5.3756\nRn\nRisk-Neutral Probabilities\u2013Again\nW e repeat our earlier comments (page 789) about the role of risk-neutral\nprobabilities: Each path is priced by its discounted risk-neutral probabil-\nity, which is a function of the Up, Down, and R . The actual state prob-\n802 Chapter 30"
        ],
        "30.7": [
            "What does the Monte Carlo simulation in pricing options involve?\nWhat is the role of VBA code in pricing options using the Monte Carlo method? \nWhat are the calculations involved in generating the price path in VBA code for Monte Carlo simulation?\nHow does the MCAsian function price the Asian options?\nWhat is the role of risk-neutral probabilities in Monte Carlo simulations for Asian options?\nHow are the option payoffs calculated in Monte Carlo simulation-based option pricing?\nWhat challenges can one face while pricing options directly in a spreadsheet?\nWhat factors may lead to the need for hundreds or thousands of simulations while pricing options?\nWhat does the computation regarding the option price involve after generating a large number of price paths?\nWhat's the effect of increasing the number of runs on the standard deviation of the estimates in option pricing through Monte Carlo simulation?\nHow is Monte Carlo simulation used in Asian options with more periods?\nWhat parameters are defined in the procedure of section 30.4 for pricing Asian options?\nWhat is the significance of dividing unit time interval into n subperiods for pricing Asian Options?\nHow does the number of runs affect the pricing of Asian options using the Monte Carlo method? \nIn terms of Asian options with more periods, how are mean return and standard deviation defined?\nWhat is meant by sub-intervals in the context of Asian options pricing?",
            "30.7 Pricing Asian Options with a VBA Program\n\nOur spreadsheet example in the previous section illustrates both the principle\nof Monte Carlo pricing of options and the problematics of pricing the options\ndirectly in a spreadsheet. For four periods, we require the computation of 2 4\n= 16 paths. For a more general problem with n periods, there are 2 n paths to\nconsider; this rapidly becomes too large for even a very powerful computer.\nIn order to accurately price the options, you would need hundreds or thousands\nof simulations. Doing this in a spreadsheet directly would be cumbersome.\nThe obvious answer is to write some VBA code to automate the process and\nwhich allows us to run an arbitrarily large number of simulations.\nI n this section we write VBA code to do a Monte Carlo simulation of Asian\npricing options. We generate price paths by simulating a sequence of Up and\nDown movements of the underlying stock price; the probability of Up or Down\ndepends on the risk-neutral probabilities\u2014in this sense our Monte Carlo simu-\nlation for Asian options is similar to that illustrated in section 30.4 for plain-\nvanilla options. For each price path generated, we calculate the option payoff,\nand after generating a large number of price paths, we compute the option\nprice by discounting and averaging these payoffs. The VBA function,\nMCAsian , which prices the Asian options, is given below:\nFunction MCAsian(initial, Exercise, Up, Down, _\nInterest, Periods, Runs)\nDim PricePath() As Double\nReDim PricePath(Periods + 1)\n\u2018Risk-neutral probabilities\npiup = (Interest - Down) / (Up - Down)\npidown = 1 - piup\nTemp = 0\nFor Index = 1 To Runs\n\u2018Generate path\nFor i = 1 To Periods\n803 Using Monte Carlo Methods for Option Pricing\npathprob = 1\nIf Rnd > pidown Then\nPricePath(i) = PricePath(i - 1) _\n* Up\nElse:\nPricePath(i) = PricePath(i - 1) * _\nDown\nEnd If\nNext i\nPriceAverage = Application.Sum _\n(PricePath) / (Periods + 1)\ncallpayoff = Application.Max _\n(PriceAverage - Exercise, 0)\nTemp = Temp + callpayoff\nNext Index\nMCAsian = (Temp / Interest \u2227 Periods) / _\nRuns\nEnd Function\nHere \u2019 s the implementation of the function in a spreadsheet:\nA B C\nPRICING AN ASIAN OPTION BY MONTE CARLO\n1\n2 Up 1.4\n3 Down 0.8\n4 Interest 1.08\n5 Initialprice 30\n6 Periods 20\n7 Exercise 30\n8 Runs 500\n804 Chapter 30\nT he function in cell B9 is our Monte Carlo valuation of the option\u2014the simu-\nlated value. Any recalculation of the spreadsheet will cause the function to\nrerun and recompute the option value.\nBelow we show a block of replications of the function. Each of the\ncells A10:F17 contains = MCAsian(Initialprice,exercise,Up,Down,Interest,\nPeriods,Runs) , so that we calculate 48 simulations of the option value.\nAA BB CC DD EE FF GG\nPPRRIICCIINNGG AANN AASSIIAANN OOPPTTIIOONN----VVBBAA FFUUNNCCTTIIOONN\nPPrriicceess aann AAssiiaann ooppttiioonn wwiitthh 44 ppeerriiooddss aanndd 110000 rruunnss ffoorr eeaacchh ssiimmuullaattiioonn\n11\n22 UUpp 11..44\n33 DDoowwnn 00..88\n44 IInntteerreesstt 11..0088\n55 IInniittiiaallpprriiccee 3300\n66 PPeerriiooddss 44\n77 EExxeerrcciissee 3300\n88 RRuunnss 110000\n99\n1100 55..55660044 55..55112277 55..33113377 55..99556688 44..99334499 55..77992266<<----\n1111 66..22334433 44..77668833 55..88440044 55..55007722 55..99223399 55..00889911==MMCCAAssiiaann(($$BB$$55,,$$BB$$77,,$$BB$$22\n1122 55..33773377 55..33555555 44..22555522 44..88445588 55..33661199 66..33332299,,$$BB$$33,,$$BB$$44,,$$BB$$66,,$$BB$$88))\n1133 44..33889999 66..00221111 55..44446611 55..55228811 55..77556600 66..22775566\n1144 44..88668855 55..33116666 44..55552299 44..88559977 55..33448855 55..88226677\n1155 66..00223355 44..55332211 44..44884433 44..88887799 44..99119999 55..33224499\n1166 55..22009955 44..77994444 55..44997766 44..44991166 55..66222233 55..33332222\n1177 55..22445522 55..66668844 55..44779977 55..22880011 55..99556644 33..88441100\n1188\n1199 AAvveerraaggee ooff MMCC ssiimmuullaattiioonnss 55..33007711<<---- ==AAVVEERRAAGGEE((AA1100::FF1177))\n2200 TTrruuee vvaalluuee 55..33775566<<---- FFrroomm SSeeccttiioonn 3300..66\n2211\n2222 33..88441100<<---- ==MMIINN((AA1100::FF1177))\n2233 66..33332299<<---- ==MMAAXX((AA1100::FF1177))\n2244 00..55663311<<---- ==SSTTDDEEVV..SS((AA1100::FF1177))\nWe have deliberately priced the Asian option for which we know the true\nvalue\u2014as we showed in section 30.6, the value of an Asian option in a four-\nperiod model with the parameters for Up, Down, and Interest illustrated above,\nis 5.3756. The average of our Monte Carlo simulations is 5.3071, with a stan-\n805 Using Monte Carlo Methods for Option Pricing\nW hen we increase the number of runs (cell B8), we will usually decrease\nthe standard deviation of our estimates (cell B24), which is equivalent to\nincreasing the accuracy of the simulation. In the example below, we have run\nthe 48 simulations 500 runs each:\nA B C D E F\nPRICING AN ASIAN OPTION--VBA FUNCTION\nPrices an Asian option with 4 periods and 500 runs for\neach simulation\n1\n2 Up 1.4\n3 Down 0.8\n4 Interest 1.08\n5 Initialprice 30\n6 Periods 4\n7 Exercise 30\n8 Runs 500\n9\n10 5.4918 5.2237 5.4857 5.6620 5.0970 5.3702\n11 6.0799 5.2819 5.8147 5.4304 5.5054 5.0958\n12 5.5832 5.7454 5.0490 5.5856 5.0470 5.8236\n13 5.3436 5.3475 5.5037 5.4204 5.2500 6.1101\n14 4.9375 5.3760 5.3095 5.4251 5.4096 5.1571\n15 5.5058 5.2473 5.1213 6.1103 5.2689 5.0927\n16 5.6943 5.2531 5.0314 5.7414 4.8099 5.0938\n17 5.0082 5.3070 5.3588 5.1692 5.7047 4.8963\n18\n19 Average of MC simulations 5.3828<-- =AVERAGE(A10:F17)\n20 True value 5.3756<-- From Section 30.6\n21\n22 4.8099<-- =MIN(A10:F17)\n23 6.1103<-- =MAX(A10:F17)\n24 0.3088<-- =STDEV.S(A10:F17)\nAs you can see, the standard deviation is much reduced\u2014about half of the\nstandard deviation with 100 runs.4\nAsian Options with More Periods\nIn the following spreadsheet we divide the unit time interval into n subperiods.\nWe follow the procedure of section 30.4 for defining the returns, state prices,\nand risk-neutral probabilities over the subperiod \u0394 t . Here is the resulting\nspreadsheet:\n4. The bad news, of course, is that we have to increase the number of runs by a factor of 5 to\n806 Chapter 30\nA B C D E F\nPRICING AN ASIAN OPTION--VBA FUNCTION\nEach time interval is divided into n subintervals. In this\nsimulation the initial stock price = 50.00, the exercise price =\n45.00, the time to maturity = 0.40, and the unit time interval is\ndivided into 80 subintervals. The stock price process has\nmean return = 15.00% and standard deviation = 1.25%, and the\ninterest rate = 8.00%.\n1 There are 100 runs in each Monte Carlo simulation\n2 S0, current stock price 50\n3 X, exercise price 45\n4 T, time to option exercise 0.4\n5 r, interest rate 8%\n6 \u03bc, mean stock return 15%\n7 \u03c3, standard deviation of stock return 22%\n8\n9 n, number of sub-intervals of T 80\n10 Delta t 0.0125<-- =1/B9\n11\n12 Up over 1 sub-interval 1.0268<-- =EXP(B6*B10+B7*SQRT(B10))\n13 Down over 1 sub-interval 0.9775<-- =EXP(B6*B10-B7*SQRT(B10))\n14 Interest over 1 sub-interval 1.0010<-- =EXP(B5*B10)\n15\n16 Runs 100\n17\n18 5.5148 5.1334 6.1348 5.8025 6.0843 5.8046\n19 6.0585 6.1534 5.8453 6.0183 6.2981 5.3826\n20 5.4753 5.9614 5.9462 5.3539 6.5194 5.6043\n21 5.5941 6.0015 5.7392 6.1450 5.7562 5.8220\n22 5.3215 6.0690 5.4965 5.0476 5.1488 5.7132\n23 5.3827 6.0806 5.4600 6.0932 5.4499 5.6005\n24 6.1500 5.7218 6.0046 6.1990 5.4302 5.2791\n25 5.7279 6.2467 5.6817 5.6702 5.6883 5.2343\n26\n27 Average of above 5.7510<-- =AVERAGE(A18:F25)\n28 Minimum 5.0476<-- =MIN(A18:F25)\n29 Maxmimum 6.5194<-- =MAX(A18:F25)\n30 Standard deviation 0.3481<-- =STDEV(A18:F25)\nT he block of results in cells A18:F25 gives 48 results for running the\nfunction MCAsian. Below this block we give the statistics for these\nsimulations.\nT he above simulations use 100 (cell B16) price paths per iteration of the\nfunction MCAsian; this is the number contained in cell B16. We can use\n807 Using Monte Carlo Methods for Option Pricing\nB C D E F G H I\n32 Data table: Sensitivity of results on number of runs\nAverage\nStandard\nRuns of 48 Minimum Maximum\ndeviation\n33 MCAsian\n34 <-- =B30 , data table header (hidden)\n35 50 5.7832 4.9871 6.6371 0.4255\n36 100 5.7343 4.8668 6.4071 0.3309 48 MCAsian Simula(cid:415)ons, Varying the Runs\n37 150 5.7689 5.1077 6.4571 0.3145\n38 200 5.7052 5.2953 6.1088 0.2047 7.0\n39 250 5.7285 5.3057 6.2896 0.2198 6.5\n40 300 5.7208 5.1867 6.4113 0.2666\n41 350 5.7163 5.2251 6.1966 0.2093 6.0\n42 400 5.7248 5.3671 6.3500 0.1972\n5.5\n43 450 5.6868 5.2898 5.9580 0.1707\n44 500 5.7353 5.3822 6.1974 0.1636 5.0\n45 550 5.7321 5.1561 6.0600 0.1808\n46 4.5\n47 4.0\n48 50 100 150 200 250 300 350 400 450 500 550\n49\n50 Average Minimum Maximum\n51\nIt is clear that increasing the number of runs narrows the bounds on the\nsimulation."
        ],
        "30.8": [
            "- What is a barrier option?\n- How does the payoff of a barrier option depend upon the price?\n- What is a knockin barrier call option and how does it pay off?\n- Can you explain about a knockout barrier call or put option and its payoffs?\n- Is it difficult for an option to be in the money at expiration if a barrier is imposed?\n- Why do barrier options have lower value than regular options?\n- What is an example of a barrier call option?\n- Is pricing barrier options with Monte Carlo necessarily a good idea? Why or why not?\n- How would a knockin barrier call option pay off only if the stock price goes through the barrier?\n- What is the equation for a barrier knockin and barrier knockout?\n- Under what circumstances does the knockout barrier call pay off?\n- What happens when the Boolean function evaluates to TRUE or FALSE?\n- How is the terminal stock price related to the option exercise price?\n- How is the value of a barrier call calculated in case of discounted expected payoff?\n- What happens when we change the condition to price the knockin barrier call?\n- What is the purpose of the boolean function in cell O17 while pricing the knockin barrier call?\n- Can you explain the principle of pricing barrier options that the price of a knockin plus a knockout equals a vanilla option?\n- What changes in calculations for a knockout option when we switch to evaluating a knockin option?\n- How can Monte Carlo methods be used for option pricing?\n- Considering the pricing of a knockin barrier call, what does the function (1-M17)*MAX(K17-$B$6,0) evaluate to?\n- What is knockin value and knockout value in barrier options? How are these values calculated?\n- Can the value of a barrier call be described as the discounted expected payoff of the option?",
            "30.8 Pricing Barrier Options with Monte Carlo5\n\nA barrier option\u2019 s payoff depends on whether the price reaches a specific level\nduring the life of the option:\n\u2022 A knockin barrier call option has payoff Max(S \u2212 X, 0) only if at some time\nT\nt < T , S > K. A knockin put has the same condition but pays off Max( X \u2212 S ,\nt T\n0).\n\u2022 A knockout barrier call or put option has these payoffs provided that at no\ntime before T does the stock price reach the barrier.\nI mposing a barrier makes it more difficult for an option to be in the money\nat expiration; thus barrier options have lower value than regular options.\nA Simple Example of a Barrier Call Option\nBelow we show an extended example for a knockout barrier option which is\nsimilar to the example for an Asian option given in section 30.6:\n5 . P ricing barrier options with Monte Carlo isn\u2019 t necessarily a good idea, but it\u2019 s a good exercise.\n808 Chapter 30\nA B C D E F G H I J K L M N O P\n1 PRICING A KNOCKOUT BARRIER OPTION\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7 Barrier 50.00\n8\n9 qU 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n10qD 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n11\n12Risk-neutral probability, up 0.4667<-- =B9*B5 Formula in cell M17: = MAX(G17:K17)<$B$7\n13Risk-neutral probability, down 0.5333<-- =B10*B5\n14\n15 STOCK PRICE\nPaths Period 1 Period 2 Period 3 Period 4 Period 0 Period 1 Period 2 Period 3 Period 4\nMax(St)< riskP -na eth utralK n oo pc tik oo nu t\n16 Barrier? probability payoff\n17All up (1 path) up up up up 30.00 42.00 58.80 82.32 115.25 FALSE 0.0474 0.00\n18\n19One down (4 paths) down up up up 30.00 24.00 33.60 47.04 65.86 FALSE 0.0542 0.00\n20 up down up up 30.00 42.00 33.60 47.04 65.86 FALSE 0.0542 0.00\n21 up up down up 30.00 42.00 58.80 47.04 65.86 FALSE 0.0542 0.00\n22 up up up down 30.00 42.00 58.80 82.32 65.86 FALSE 0.0542 0.00\n23\n24Two down (6 paths) down down up up 30.00 24.00 19.20 26.88 37.63 TRUE 0.0619 7.63\n25 down up down up 30.00 24.00 33.60 26.88 37.63 TRUE 0.0619 7.63\n26 down up up down 30.00 24.00 33.60 47.04 37.63 TRUE 0.0619 7.63\n27 up down down up 30.00 42.00 33.60 26.88 37.63 TRUE 0.0619 7.63\n28 up up down down 30.00 42.00 58.80 47.04 37.63 FALSE 0.0619 0.00\n29 up down up down 30.00 42.00 33.60 47.04 37.63 TRUE 0.0619 7.63\n30\n31Three down (4 paths) up down down down 30.00 42.00 33.60 26.88 21.50 TRUE 0.0708 0.00\n32 down up down down 30.00 24.00 33.60 26.88 21.50 TRUE 0.0708 0.00\n33 down down up down 30.00 24.00 19.20 26.88 21.50 TRUE 0.0708 0.00\n34 down down down up 30.00 24.00 19.20 15.36 21.50 TRUE 0.0708 0.00\n35\n36Four down (1 path) down down down down 30.00 24.00 19.20 15.36 12.29 TRUE 0.0809 0.00\n37\n38 Knockout value 1.7375\n39\nFormula in cell N38:\n=SUMPRODUCT(O17:O36,N17:N36)/B5^4\n40\n41\nFormula in cell O36:\n42\n=M36*MAX(K36-$B$6,0)\nIn this example, we model a five-date, four-period barrier call option. The\nbarrier is 50 (cell B7). A knockout option pays off only if the price never goes\nthrough this barrier, and a knockin option pays off only if the stock price goes\nthrough the barrier. In an equation:\nBarrierknockin \u23a7max[ S \u2212X,0] ifS >Barrier fort<T\n=\u23a8 T t\ncall payoff \u23a9 0 otheerwise\nBarrierknockout \u23a7max[ S \u2212X,0] ifS <Barrierr fort<T\n=\u23a8 T t\n809 Using Monte Carlo Methods for Option Pricing\nThe knockout barrier call illustrated above pays off only when two things\nhappen simultaneously:\n\u2022 T he stock price does not exceed the barrier. This happens for all the\npaths labeled \u201cTRUE\u201d in column M. To check this condition in cell M17\nwe use the Boolean function ( = MAX(G17:K17) < $B$7). 6 This function\nevaluates to TRUE or FALSE, depending on whether the condition is met.\nOther cells in column M use a similar condition. When used in a formula as\nin the bullet below, the Boolean function evaluates to 1 if TRUE and to 0 if\nFALSE.\n\u2022 The terminal stock price S is greater than the option exercise price of 30.\nT\nIn cell O18 we use the condition M17*MAX(K17-$B$6,0) to evaluate the\noption payoff.\n(cid:4284) If M17 = 0 (meaning that S t > 50 somewhere along the path and the option\nwas \u201cknocked out\u201d), then the option doesn \u2019 t pay off.\n(cid:4284) If M17 = 1 (so that S t < 50 throughout the path), then the option has a\nstandard call payoff of max( S \u2212 X ,0).\nT\nA s in all previous cases discussed in this chapter, the barrier call\u2019 s value is\nthe discounted expected payoff of the option, where the probabilities are the\nrisk-neutral probabilities:\n\u2211 \u03c0Payoff\nj j\nallstates\nOptionvalue= j =1.7375\nR4\nThe Knockin Barrier Call\nBy changing the condition in column O we can price the knockin barrier call.\nThis time we write (in cell O17, for example) the function = (1-M17)*MAX\n(K17-$B$6,0). The value in M17 tests whether the barrier has never been\npassed; if this is FALSE (i.e., has a value of zero), then the option is \u201cknocked\nin\u201d and the payoff is like that of a regular call. If M17 is TRUE, then the barrier\nhas not been passed and the option does not pay off:\n810 Chapter 30\nA B C D E F G H I J K L M N O P\n1 PRICING A KNOCKIN BARRIER OPTION\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7 Barrier 50.00\n8\n9 qU 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n10qD 0.4938<-- =(B3-B5)/(B5*(B3-B4))\n11\n12Risk-neutral probability, up 0.4667<-- =B9*B5 Formula in cell M17: = MAX(G17:K17)<$B$7\n13Risk-neutral probability, down 0.5333<-- =B10*B5\n14\n15 STOCK PRICE\nPaths Period 1 Period 2 Period 3 Period 4 Period 0 Period 1 Period 2 Period 3 Period 4 Max(St)< riskP -na eth utral Option\n16 Barrier? probability payoff\n17All up (1 path) up up up up 30.00 42.00 58.80 82.32 115.25 FALSE 0.0474 85.25\n18\n19 One down (4 paths) down up up up 30.00 24.00 33.60 47.04 65.86 FALSE 0.0542 35.86\n20 up down up up 30.00 42.00 33.60 47.04 65.86 FALSE 0.0542 35.86\n21 up up down up 30.00 42.00 58.80 47.04 65.86 FALSE 0.0542 35.86\n22 up up up down 30.00 42.00 58.80 82.32 65.86 FALSE 0.0542 35.86\n23\n24Two down (6 paths) down down up up 30.00 24.00 19.20 26.88 37.63 TRUE 0.0619 0.00\n25 down up down up 30.00 24.00 33.60 26.88 37.63 TRUE 0.0619 0.00\n26 down up up down 30.00 24.00 33.60 47.04 37.63 TRUE 0.0619 0.00\n27 up down down up 30.00 42.00 33.60 26.88 37.63 TRUE 0.0619 0.00\n28 up up down down 30.00 42.00 58.80 47.04 37.63 FALSE 0.0619 7.63\n29 up down up down 30.00 42.00 33.60 47.04 37.63 TRUE 0.0619 0.00\n30\n31Three down (4 paths) up down down down 30.00 42.00 33.60 26.88 21.50 TRUE 0.0708 0.00\n32 down up down down 30.00 24.00 33.60 26.88 21.50 TRUE 0.0708 0.00\n33 down down up down 30.00 24.00 19.20 26.88 21.50 TRUE 0.0708 0.00\n34 down down down up 30.00 24.00 19.20 15.36 21.50 TRUE 0.0708 0.00\n35\n36Four down (1 path) down down down down 30.00 24.00 19.20 15.36 12.29 TRUE 0.0809 0.00\n37\n38 Knockin value 9.0334\n39\nFormula in cell N38:\n=SUMPRODUCT(O17:O36,N17:N36)/B5^4\n40\n41\nFormula in cell O36:\n=(1-M36)*MAX(K36-$B$6,0)\n42\n43\nT he spreadsheets for the knockout and knockin barriers illustrate another\nprinciple of pricing barrier options: The price of a knockin plus a knockout\n811 Using Monte Carlo Methods for Option Pricing\nA B C D E F G H I J K L M N O P Q\n1 KNOCKIN + KNOCKOUT = PLAIN VANILLA\n2 Initial stock price 30\n3 Up 1.40\n4 Down 0.80\n5 Interest 1.08\n6 Option exercise price 30\n7 Barrier 50.00\n8\n9 qU 0.4321<-- =(B5-B4)/(B5*(B3-B4))\n10qD 0.4938<-- =(B3-B5)/(B5*(B3-B4)) Formula in cell M17: = MAX(G17:K17)<$B$7\n11\n12Risk-neutral probability, up 0.4667<-- =B9*B5\n13Risk-neutral probability, down 0.5333<-- =B10*B5\n14\n15 STOCK PRICE\n16\nPaths Period 1Period 2 Period 3 Period 4 Period 0 Period 1 Period 2 Period 3 Period 4 M Baa rx r( iS et r) ?< r pis rokP - bna aet bh u ilt ir ta yl Kn po ac yk oo ffut K pn ao yc ok fi fn vP al nai in lla\n17All up (1 path) up up up up 30.00 42.00 58.80 82.32 115.25 FALSE 0.0474 0 85.2480 85.2480\n18\n19One down (4 paths) down up up up 30.00 24.00 33.60 47.04 65.86 FALSE 0.0542 0 35.8560 35.8560\n20 up down up up 30.00 42.00 33.60 47.04 65.86 FALSE 0.0542 0 35.8560 35.8560\n21 up up down up 30.00 42.00 58.80 47.04 65.86 FALSE 0.0542 0 35.8560 35.8560\n22 up up up down 30.00 42.00 58.80 82.32 65.86 FALSE 0.0542 0 35.8560 35.8560\n23\n24Two down (6 paths) down down up up 30.00 24.00 19.20 26.88 37.63 TRUE 0.0619 7.632 0.0000 7.6320\n25 down up down up 30.00 24.00 33.60 26.88 37.63 TRUE 0.0619 7.632 0.0000 7.6320\n26 down up up down 30.00 24.00 33.60 47.04 37.63 TRUE 0.0619 7.632 0.0000 7.6320\n27 up down down up 30.00 42.00 33.60 26.88 37.63 TRUE 0.0619 7.632 0.0000 7.6320\n28 up up down down 30.00 42.00 58.80 47.04 37.63 FALSE 0.0619 0 7.6320 7.6320\n29 up down up down 30.00 42.00 33.60 47.04 37.63 TRUE 0.0619 7.632 0.0000 7.6320\n30\n31Three down (4 paths) up down down down 30.00 42.00 33.60 26.88 21.50 TRUE 0.0708 0 0.0000 0.0000\n32 down up down down 30.00 24.00 33.60 26.88 21.50 TRUE 0.0708 0 0.0000 0.0000\n33 down down up down 30.00 24.00 19.20 26.88 21.50 TRUE 0.0708 0 0.0000 0.0000\n34 down down down up 30.00 24.00 19.20 15.36 21.50 TRUE 0.0708 0 0.0000 0.0000\n35\n36Four down (1 path) down down down down 30.00 24.00 19.20 15.36 12.29 TRUE 0.0809 0 0.0000 0.0000\n37\n38 Knockin 9.0334<-- =SUMPRODUCT(N17:N36,P17:P36)/B5^4\n39 Knockout 1.7375<-- =SUMPRODUCT(N17:N36,O17:O36)/B5^4\n40 Sum 10.7708<-- =L38+L39\n41 Plain vanilla 10.7708<-- =SUMPRODUCT(N17:N36,Q17:Q36)/B5^4\n42\nFormula in cell P36:\n43 =(1-M36)*MAX(K36-$B$6,0)\n44\nFormula in cell O36:\n4 45\n6\n=M36*MAX(K36-$B$6,0)"
        ],
        "30.9": [
            "What is Monte Carlo method in the context of option pricing?\nWhat is a Barrier option in financial modeling?\nCan you explain the concept of knockin and knockout options?\nWhat are the key parameters needed to price a Barrier option using the Monte Carlo method?\nExplain the purpose of the function MCBarrierIn in the context of option pricing.\nWhich software language is used for writing the function for pricing knockout options?\nWhat is the role of the VBA function MCBarrierOut in pricing barrier options?\nHow is the function MCBarrierOut similar to the function MCAsian?\nWhat defines the operative part for the \"knockin\" option in the code snippet provided?\nWhat is meant by 'Risk-neutral probabilities' in the context of the provided code for Barrier Option pricing?\nIn the formula in Monte Carlo Method, how is the PricePath generated?\nHow does the Excel's Max function used in the implementation of Monte Carlo Method for option pricing?\nHow does the number of runs influence the approximations in the Barrier option's pricing?\nWhat is the role of subperiods in implementing the functions MCBarrierIn and MCBarrierOut?\nHow is the concept of 'discounting' implemented in the VBA functions for option pricing?\nWhat is the relevance of the Black-Scholes call in relation to the sum of knockin and knockout options?\nHow do the number of divisions of the unit time interval affect the approximation of the Black-Scholes call?\nCan you explain the meaning of 'Initial', 'Exercise', 'Barrier', 'Up', 'Down', 'Interest', 'Periods', 'Runs' in the context of the provided code?\nWhat is the role of the Interest in pricing an Barrier option?\nWhat is meant by 'Generate path' in the context of this provided code for Barrier Option pricing?\nIn what context is the 'Exercise' used while pricing the Barrier options?",
            "30.9 Using VBA and Monte Carlo to Price a Barrier Option\n\nW e write two VBA functions to price knockin and knockout barrier options.\nHere is the function for knockout options:\nFunction MCBarrierIn(Initial, Exercise, Barrier, Up, _\nDown, Interest, Periods, Runs)\nDim PricePath() As Double\nReDim PricePath(Periods + 1)\n\u2018Risk-neutral probabilities\npiup = (Interest - Down) / (Up - Down)\n812 Chapter 30\nTemp = 0\nFor Index = 1 To Runs\n\u2018Generate path\nFor i = 1 To Periods\nPricePath(0) = Initial\npathprob = 1\nIf Rnd > pidown Then\nPricePath(i) = PricePath(i - 1) * Up\nElse:\nPricePath(i) = PricePath(i - 1) * Down\nEnd If\nNext i\nIf Application.Max(PricePath) > Barrier Then _\nCallpayoff = _\nApplication.Max(PricePath(Periods) - _\nExercise, 0) _\nElse Callpayoff = 0\nTemp = Temp + Callpayoff\nNext Index\nMCBarrierIn = (Temp / Interest \u2227 Periods) / Runs\nEnd Function\nFunction MCBarrierOut(Initial, Exercise, _\nBarrier, Up, Down, Interest, Periods, Runs)\nDim PricePath() As Double\nReDim PricePath(Periods + 1)\n\u2018Risk-neutral probabilities\npiup = (Interest - Down) / (Up - Down)\npidown = 1 - piup\n813 Using Monte Carlo Methods for Option Pricing\nFor Index = 1 To Runs\n\u2018Generate path\nFor i = 1 To Periods\nPricePath(0) = Initial\npathprob = 1\nIf Rnd > pidown Then\nPricePath(i) = PricePath(i - 1) * Up\nElse:\nPricePath(i) = PricePath(i - 1) * Down\nEnd If\nNext i\nIf Application.Max(PricePath) < Barrier _\nThen Callpayoff = Application.Max _\n(PricePath(Periods) - Exercise, 0) _\nElse: Callpayoff = 0\nTemp = Temp + Callpayoff\nNext Index\nMCBarrierOut = (Temp / Interest \u2227 Periods) _\n/ Runs\nEnd Function\nSince this function is very similar to the function M CAsian of section 30.6,\nwe will not discuss it, except to point out that the operative part for the\n\u201cknockin\u201d option is contained in the following lines (note the use of Excel\u2019 s\nMax function\u2014in the form of Application.Max; VBA does not have its own\n814 Chapter 30\nIf Application.Max(PricePath) < Barrier Then\nCallpayoff = _\nApplication.Max(PricePath(Periods) -\nExercise, 0) _\nElse Callpayoff = 0\nIn the spreadsheet below we use this function and its associated function\nMCBarrierOut to price the options previously priced in our extensive\nexample:\nA B C D E F\nPRICING BARRIER OPTIONS\nBY MONTE CARLO\n1\n2 Up 1.4\n3 Down 0.8\n4 Interest 1.08\n5\n6 Initialprice 30\n7 Periods 4\n8 Exercise 30\n9 Barrier 50\n10\n11 Runs 100\n12\n13 Knockin option value 7.0810<-- =mcbarrierin(B6,B8,B9,B2,B3,B4,B7,B11)\n14 Actual value 9.0334<-- ='Initial knockin'!N38\n15\n16 Knockout option value 1.6829<-- =mcbarrierout(B6,B8,B9,B2,B3,B4,B7,B11)\n17 Actual value 1.7375<-- Determined from fully-worked out example\n18\n19 48 iterations of MCBarrierIn\n20 7.7944 7.2408 8.4210 9.2159 6.8481 13.1353\n21 11.6143 8.3860 9.5916 9.1598 7.6430 11.3200\n22 9.3154 6.7095 7.2673 9.2593 9.7948 8.9174\n23 11.0269 10.1018 7.4959 7.5435 9.3069 9.3799\n24 11.7265 8.4210 6.5369 10.6289 8.8613 8.6327\n25 9.5016 9.6350 9.1037 7.9066 8.2262 8.9565\n26 10.9358 7.4440 9.2550 12.1806 8.1056 8.9216\n27 6.3771 7.4440 9.4318 9.3323 9.5831 9.1428\n28\n29 Average of simulations 9.0162<-- =AVERAGE(A20:F27)\n30 True value 9.0334<-- =B14\n31\n32 6.3771<-- =MIN(A20:F27)\n33 13.1353<-- =MAX(A20:F27)\n815 Using Monte Carlo Methods for Option Pricing\nFinally, we can also show the implementation of the functions\nMCBarrierIn and MCBarrierOut for the case where the unit period is\ndivided into n subperiods:\nA B C D E F\nPRICING BARRIER OPTIONS--VBA FUNCTION\nEach time interval is divided into n subintervals. In this simulation\nthe initial stock price = 50.00, the exercise price = 45.00, the time\nto maturity = 0.40, and the unit time interval is divided into 80\nsubintervals. The stock price process has mean return = 15.00%\nand standard deviation = 1.25%, and the interest rate = 8.00%.\nThere are 100 runs in each Monte Carlo simulation\n1\n2 S0, current stock price 50\n3 X, exercise price 45\n4 Barrier 50\n5 T, time to option exercise 0.4\n6 r, interest rate 8%\n7 \u03bc, mean stock return 15%\n8 \u03c3, standard deviation of stock return 22%\n9\n10 n, number of sub-intervals of 1 period 80\n11 Delta t 0.0125<-- =1/B10\n12\n13 Up over 1 sub-interval 1.0268<-- =EXP(B7*B11+B8*SQRT(B11))\n14 Down over 1 sub-interval 0.9775<-- =EXP(B7*B11-B8*SQRT(B11))\n15 Interest over 1 sub-interval 1.0010<-- =EXP(B6*B11)\n16\n17 Runs 100\n18\n19 6.3585 6.9583 6.3533 7.7962 6.1659 7.0748\n20 7.6459 6.6480 7.3670 7.0983 7.6145 7.5518\n21 7.5930 6.0479 7.4641 6.9369 7.3640 6.8484\n22 6.6697 6.8640 7.5060 5.5781 6.5915 6.8637\n23 6.5892 6.0845 7.4208 6.6688 6.2547 7.0869\n24 6.7855 6.8115 7.4927 8.0739 6.5437 6.8094\n25 7.1895 6.7203 6.4660 7.2249 7.4684 6.1946\n26 7.4440 7.3391 5.8421 7.1641 6.9199 6.3297\n27\n28 Average of above 6.9142<-- =AVERAGE(A19:F26)\n29 Minimum 5.5781<-- =MIN(A19:F26)\n30 Maxmimum 8.0739<-- =MAX(A19:F26)\n31 Standard deviation 0.5542<-- =STDEV(A19:F26)\nA s for the case discussed in section 30.6 for Asian options, as the number\nof runs (cell B17) gets larger, the approximations become better, although the\n816 Chapter 30\nB C D E F G H\nAverage\nStandard\nRuns of 48 Minimum Maximum\ndeviation\n34 MCBarrierIn\n35 <-- =B31 , data table header (hidden)\n36 50 6.9429 4.9848 8.3475 0.8578\n37 100 6.8413 5.6721 8.6888 0.6402 48 MCBarrierIn, Varying the Number of Runs\n38 150 6.8778 6.0454 8.1278 0.5073\n9.0\n39 200 6.9010 5.9834 8.0931 0.5616\n40 250 7.0201 5.6747 7.8031 0.4348 8.5\n41 300 6.8057 5.7971 7.4750 0.3576 8.0\n42 350 6.9462 6.2091 7.5758 0.3026 7.5\n43 400 6.9964 6.1380 7.6593 0.3181 7.0\n44 450 6.9201 6.0998 7.6141 0.3294 6.5\n45 500 6.9382 6.2906 7.7124 0.3502 6.0\n46 550 6.8899 6.3473 7.5942 0.2355 5.5\n47 5.0\n48 4.5\n49 50 100 150 200 250 300 350 400 450 500 550\n50\n51 Average Minimum Maximum\n52\nF inally, we can show that the sum of the knockin plus knockout is approxi-\nmately equal to the Black-Scholes call when n , the number of divisions of the\nunit time interval, is very large:\nA B C\nKNOCKIN + KNOCKOUT = CALL\nThe almost-continuous case\n1\n2 S0, current stock price 30\n3 X, exercise price 30\n4 Barrier 40\n5 T, time to option exercise 0.4\n6 r, interest rate 8%\n7 \u03bc, mean stock return 15%\n8 \u03c3, standard deviation of stock return 22%\n9\n10 n, number of subintervals of 1 period 200\n11 Delta t 0.0050<-- =1/B10\n12\n13 Up over 1 subinterval 1.0164<-- =EXP(B7*B11+B8*SQRT(B11))\n14 Down over 1 subinterval 0.9853<-- =EXP(B7*B11-B8*SQRT(B11))\n15 Interest over 1 subinterval 1.0004<-- =EXP(B6*B11)\n16\n17 Runs 700\n18\n19 Knockout barrier 1.653148<-- =mcbarrierout(B2,B3,B4,B13,B14,B15,INT(B10*B5),B17)\n20 Knockin barrier 0.504321<-- =mcbarrierin(B2,B3,B4,B13,B14,B15,INT(B10*B5),B17)\n21 Sum of knockout + knockin 2.157468<-- =B19+B20\n817 Using Monte Carlo Methods for Option Pricing"
        ],
        "30.10": [
            "What are Monte Carlo methods in financial modelling?\nCan you explain the connection between Monte Carlo methods and option pricing?\nWhat is considered the \"second best\" method of pricing in financial modelling?\nWhat makes Monte Carlo methods easy to program in VBA?\nWhy are Monte Carlo methods easy to see in Excel?\nWhat types of options have been illustrates using Monte Carlo methods in financial modelling?\nWhat is meant by 'plain-vanilla' options in financial modelling?\nCan you define 'Asian' options and 'barrier' options in the context of financial modelling?\nFor what kinds of options are Monte Carlo methods typically used? \nWhat are path-dependent options in financial modelling? \nWhat are some of the variations of path-dependent options and their Monte Carlo solutions?\nIn what cases would one prefer to use Monte Carlo methods instead of analytical formulas?",
            "30.10 Summary\n\nMonte Carlo methods\u2014simulations of option pricing by tracing out many\npaths of the stock price\u2014are at best a \u201csecond best\u201d method of pricing. But\nin cases where no analytical formulas are available, Monte Carlo is easy to\nprogram in VBA and easy to see in Excel. In this chapter we have illustrated\nMonte Carlo methods for plain-vanilla options, Asian options, and barrier\noptions. Other variations of path-dependent options and their Monte Carlo\nsolutions are considered in the exercises."
        ]
    },
    "31": {
        "31.1": [
            "What are data table commands in financial modeling?\nWhat is the use of data table commands in financial modeling?\nWhat does sensitivity analysis mean in the context of financial modeling?\nWhat opportunities does Excel offer when working with data tables?\nHow does change in one variable impact a data table in Excel?\nWhat happens when two variables are changed in a data table?\nWhat are array functions in Excel and how do they contribute to data tables?\nWhat does it mean that Excel data tables change dynamically?\nWhat are one-dimensional Excel data tables?\nWhat are two-dimensional Excel data tables?\nCan you explain how to build one-dimensional and two-dimensional data tables in Excel?\nWhat is the difference between one-dimensional and two-dimensional data tables in Excel?",
            "31.1 Overview\n\nD ata table commands are powerful commands that make it possible to do\ncomplex sensitivity analyses. Excel offers the opportunity to build a table in\nwhich only one variable is changed, or one in which two variables are changed.\nExcel data tables are array functions, and thus change dynamically when\nrelated spreadsheet cells are changed.\nI n this chapter you will learn how to build both one-dimensional and two-\ndimensional Excel data tables."
        ],
        "31.2": [
            "What does the term \"project\" refer to in the context of financial modeling?\nWhat does the initial cost of a project represent?\nCan you explain the concept of subsequent cash flows in financial modeling?\nWhat does it mean when cash flows are growing at rate g from year 1-7 in a project?\nWhat is the formula to calculate the cash flow in year t?\nWhat is meant by the term 'discount rate'?\nHow is the Net Present Value (NPV) of the project calculated?\nWhat is the significance of the internal rate of return (IRR) in the context of a project's financial model?\nWhat does it imply when the NPV equals zero in the context of IRR?\nHow can these financial calculations be done in Excel?\nWhat is the significance of the initial cash flow, growth rate, and discount rate in calculating the NPV of a project?\nHow can you calculate NPV and IRR by using Excel?\nWhat are cell addresses in Excel and why they are needed?\nWhat does the cash flow represent in year 0 of a project?\nCan you explain the relevance of growth rate in the cash flow of each subsequent year?",
            "31.2 An Example\n\nConsider a project which has an initial cost of $1,150, and seven subsequent\ncash flows. The cash flows in years 1\u20137 grow at rate g , so that the cash flow\nin year t is CF t = CF t \u2212 1 *(1 + g) . Given a discount rate r , the net present value\n(NPV) of the project is\nCF CF\n( 1+g)\nCF\n( 1+g)2\nCF\n( 11+g)6\nNPV =\u22121,150+ 1 + 1 + 1 +\u2026++ 1\n( 1+r)1 ( 1+r)2 ( 1+r)3 ( 1+r)7\nThe internal rate of return (IRR), i , is the rate at which the NPV equals zero:\nCF CF\n( 1+g)\nCF\n( 1+g)2\nCF\n(( 1+g)6\n0=1,150+ 1 + 1 + 1 +\u2026++ 1\n( 1+i)1 ( 1+i)2 ( 1+i)3 ( 1+i)7\nThese calculations are easily done in Excel. In the following example\nthe initial cash flow is 234, the growth rate g = 10%, and the discount rate\nr = 15%:\nA B C D E F G H I\n1 CF 1 234\n2 Growth rate 10%\n3 Discount rate 15%\n4\n5 Year 0 1 2 3 4 5 6 7\n6 Cash flow -1150.00 234.00 257.40 283.14 311.45 342.60 376.86 414.55\n7\n8 NPV 101.46 <-- =+B6+NPV(B3,C6:I6)\n824 Chapter 31\nNote the cell addresses for the growth rate, the discount rate, the NPV, and the\nIRR. They will be needed below."
        ],
        "31.3": [
            "What does a one-dimensional data table in financial modeling refer to?\nCan you explain the sensitivity analysis in financial modeling?\nHow are NPV (Net Present Value) and IRR (Internal Rate of Return) related to the growth rate in a one-dimensional data table?\nWhat is the function of the command \"Data Table\" in relation to sensitivity analysis in financial modeling?\nIn a sensitivity analysis, how to set up the structure of a one-dimensional data table? \nHow is the growth rate variable represented in a one-dimensional data table for financial modeling?\nHow do the labels \"NPV\" and \"IRR\" get assigned to their corresponding formulas in a one-dimensional data table?\nWhat are the two main parts of a data table spreadsheet in financial modeling?\nWhat function does the \"Data|What-if Analysis|Data Table\" command serve in setting up a data table in financial modeling?\nCan you explain the usage of \"Row input cell\" and \"Column input cell\" while performing the command \"Data|What-if Analysis|Data Table\" in financial modeling? \nIn a one-dimensional data table, how can we vary the growth rate to see its effect on NPV and IRR?\nWhat are the steps to conduct a sensitivity analysis using a one-dimensional data table in financial modeling?",
            "31.3 Setting Up a One-Dimensional Data Table\n\nWe refer to a data table that does sensitivity analysis by varying one parameter\nas a one-dimensional data table. This section discusses such tables, and section\n31.4 discusses two-dimensional data tables.\nS uppose we want to know how the NPV and IRR are affected by a change\nin the growth rate. The command D ata Table allows us to do this simply. The\nfirst step is to set up the table \u2019 s structure. In the example below, we put the\nformulas for the NPV and IRR on the top row and we put the variable we wish\nto vary (in this case the growth rate) in the first column. At this point the table\nlooks like this:\nF G H I J\n10\n11 =B8 =B9\n12\n13 NPV IRR\n14 101.46 17.6%\n15 0\n16 Growth 5%\n17 rate 10%\n18 15%\n19\nT he actual table (as opposed to the labels for the columns and the rows) is\noutlined in the dark border. The numbers directly under the labels \u201cNPV\u201d and\n\u201cIRR\u201d refer to the corresponding formulas in the previous picture. Thus, if the\ncell B8 contains the calculation for the NPV, then the cell under the letters\n\u201cNPV\u201d contains the formula \u201c =B 8.\u201d Similarly, if the cell B9 contains the\noriginal calculation for the IRR, then the cell under \u201cIRR\u201d in the table contains\n825 Data Tables\nWe like to think of a data table spreadsheet as having two parts:\n\u2022 A basic example.\n\u2022 A table that does a sensitivity analysis on the basic example. In our\nexample, the first row of the table contains references to calculations\ndone in our basic example. While there are other ways to do data tables,\nthis structure is both typical and easy to understand.\nNow do the following:\n\u2022 Highlight the table area (outlined in the dark border).\n\u2022 Activate the command Data|What-if Analysis|Data Table . You will get a\ndialog box which asks you to indicate a Row input cell and/or a C olumn\ninput cell .\nIn this case, the variable we wish to change is in the left-hand column of our\ntable, so we leave the Row input cell blank and indicate cell B2 (this cell\ncontains the growth rate in our basic example.) in the Column input cell box.\nHere \u2019 s the result:\nF G H I J\n10\n11 =B8 =B9\n12\n13 NPV IRR\n14 101.46 17.6%\n15 0 -176.46 9.71%\n16 Growth 5% -47.82 13.67%\n17 rate 10% 101.46 17.60%\n18 15% 274.35 21.50%\n826 Chapter 31"
        ],
        "31.4": [
            "What is the Data Table command used for in financial modeling?\nCan you provide examples of parameters that could be varied using the Data Table command?\nWhat does the net present value (NPV) refer to in financial modeling?\nIn the context of financial modeling, what could it mean to calculate NPV for different growth rates and discount rates?\nHow can the row and column input cells be utilized in the Data Table command?\nCan you explain the role of a formula in the upper left-hand corner of the Data Table?\nWhat is the purpose of referring to a basic example in the Data Table?\nWhen creating a two-dimensional data table, how would you interpret the results in financial terms?\nWhat is the significance of noting the site of the discount rate in the basic example when working with Data Tables?\nHow does one use different growth rates and discount rates to calculate net present value (NPV)?\nWhy is it important to build a two-dimensional data table in financial modeling?",
            "31.4 Building a Two-Dimensional Data Table\n\nW e can also use the D ata Table command to vary o ne formula while changing\ntwo parameters. Suppose, for example, that we want to calculate the net present\nvalue (NPV) of the cash flows for different growth rates and different discount\nrates. We create a new table which looks like this:\nF G H I J\n21 =B8 Discount rate \u2193\n22 101.46 7% 10% 12%\n23 Growth 0\n24 rate --> 5%\n25 10%\n26 15%\nT he upper left-hand corner of the table contains the formula \u201c =B 8\u201d as a refer-\nence to the basic example.\nW e now use the Data Table command again. This time we fill in both the\nRow input cell (indicating cell B3, the site of the discount rate in our basic\nexample) and the Column input cell (indicating cell B2).\nHere \u2019 s the result:\nF G H I J\n21 =B8 Discount rate \u2193\n22 101.46 7% 10% 12%\n23 Growth 0 111.09 -10.79 -82.08\n24 rate --> 5% 297.62 150.74 65.13\n25 10% 515.79 339.09 236.44\n827 Data Tables"
        ],
        "31.5": [
            "What is the effect of hiding formula cells in a data table?\nCan you explain how to hide the formula cells in a data table?\nWhat does the Format Cells command do in terms of data tables?\nWhat is the purpose of the 'Number | Custom' option when hiding formula cells?\nWhat is the meaning of inserting a semicolon into the 'Type' box when hiding formula cells?\nWhat is the impact of hidden formula cells on the appearance of data tables?\nCan the cells containing formulas in a data table be hidden?\nWhat are the steps to hide formula cells in a data table?\nWhat is the effect of hiding the formula cells on financial models presented in a data table?",
            "31.5 An Aesthetic Note: Hiding the Formula Cells\n\nD ata tables tend to look a bit strange, because the formula being calculated\nshows up in the data table (in our examples: in the top row of the first data\ntable, and in the left-hand top corner of the second data table). You can make\nyour tables look nicer by h iding the formula cells. To do this, mark the offend-\ning cells and use the F ormat Cells command (or press the right mouse button\nand go to the Number|Custom ). In the dialog box go to the box marked Type\nand insert a semicolon into the box. Here \u2019 s the way this looks for the previous\n828 Chapter 31\nThe cell contents will now be hidden. This gives the following result.\nF G H I J\n10\n11 =B8 =B9\n12\n13 NPV IRR\n14\n15 0 -176.46 9.71%\n16 Growth 5% -47.82 13.67%\n17 rate 10% 101.46 17.60%\n18 15% 274.35 21.50%\n19"
        ],
        "31.6": [
            "What is an Excel Data Table in context of financial modeling?\nHow are Excel Data Tables dynamically linked to the initial example?\nWhat happens when a parameter in the original example is changed in an Excel Data Table?\nWhat is an example of a change that causes corresponding column or row of the data table to change?\nWhat is Cash Flow in context of Excel Data Tables?\nWhat is Growth Rate in context of an Excel Data Table, and how does it influence the financial model?\nWhat does Discount Rate mean in an Excel Data Table, and how does it impact the model?\nHow do Year and Cash Flow interact within an Excel Data Table?\nHow to calculate Net Present Value (NPV) using Excel Data Tables?\nHow to calculate Internal Rate of Return (IRR) using Excel Data Tables?\nWhat is the significance of Growth Rate in determining NPV and IRR? \nWhat would be the impact on NPV and IRR if the initial cash flow is changed from 234 to 300 in an Excel Data Table? \nIn financial modeling, what is a parameter?\nWhat changes when the initial cash flow is altered in financial modeling?\nWhat role does initial cash flow play in determining NPV and IRR?",
            "31.6 Excel Data Tables Are Arrays\n\nThis means that Excel data tables are dynamically linked to your initial\nexample. When you change a parameter in the original example, the corre-\nsponding column or row of the data table changes. For example, if we change\nthe initial cash flow from 234 to 300, here\u2019 s what will happen in the data table\npictured above:\nA B C D E F G H I J\n1 CF 1 300\n2 Growth rate 10%\n3 Discount rate 15%\n4\n5 Year 0 1 2 3 4 5 6 7\n6 Cash flow -1150.00 300.00 330.00 363.00 399.30 439.23 483.15 531.47\n7\n8 NPV 454.43 <-- =+B6+NPV(B3,C6:I6)\n9 IRR 26.01% <-- =IRR(B6:I6,0)\n10\n11 =B8 =B9\n12\n13 NPV IRR\n14\n15 0 98.13 17.80%\n16 Growth 5% 263.06 21.92%\n17 rate 10% 454.43 26.01%\n18 15% 676.09 30.07%\n829 Data Tables"
        ],
        "31.7": [
            "- What is the use of data tables in financial modeling?\n- What is the function of \"=RAND()\" in the context of financial models?\n- How does \"=AVERAGE()\" function operate in the context of the example provided?\n- What is variance and how is it calculated in financial models?\n- How is the Sigma value calculated in this context?\n- Which Excel function is used to generate the Sigma value?\n- What is the purpose of running multiple iterations of random simulations in financial modelling?\n- What does the pressing of F9 do in random simulations?\n- In the context of the pension problem, what does the mean annual return represent?\n- What is meant by \"Standard Deviation of return\" in the context of the pension problem?\n- What function is used to model the amount left after a specific period in a pension fund?\n- What does the cell function \"Norm.S.Inv(Rand( ))\" mean in terms of financial modeling?\n- What does a negative balance in a pension fund signify?\n- How does the data table on blank cell technique enhance the accuracy of a financial model?\n- What is the significance of running simulations in financial modelling?\n- How does changing the annual withdrawal amount affect the pension fund's output?\n- What is the purpose of running statistics in these financial models?",
            "31.7 Data Tables on Blank Cells (Advanced)\n\nA n exciting use of data tables is to run multiple iterations of random\nsimulations. Here\u2019 s an example: Suppose you use R and( ) to create 10\nrandom numbers between 0 and 1. This Excel random number generator is\ndiscussed in detail in Chapter 24. The simulation we are describing might\nlook like this:\nA B C D E F\n1 10 RANDOM NUMBERS\n2 0.9428<-- =RAND() Statistics\n3 0.0698<-- =RAND() Mean 0.5679<-- =AVERAGE(A2:A11)\n4 0.6437<-- =RAND() Variance 0.0878<-- =VAR.P(A2:A11)\n5 0.2236<-- =RAND() Sigma 0.2963<-- =SQRT(E4)\n6 0.8855<-- =RAND()\n7 0.3245<-- =RAND()\n8 0.4922<-- =RAND()\n9 0.9802<-- =RAND()\n10 0.6795<-- =RAND()\n11 0.4377<-- =RAND()\nI f you want to repeat this experiment 10 times, your spreadsheet might look\n830 Chapter 31\nA B C D E F G H I J K\n1 10 RANDOM NUMBERS\n2 0.1304<-- =RAND() Statistics\n3 0.0249<-- =RAND() Mean 0.5337<-- =AVERAGE(A2:A11)\n4 0.5569<-- =RAND() Variance 0.1521<-- =VAR.P(A2:A11)\n5 0.8470<-- =RAND() Sigma 0.3900<-- =SQRT(E4)\n6 0.9996<-- =RAND()\n7 0.9951<-- =RAND()\n8 0.9524<-- =RAND()\n9 0.0621<-- =RAND()\n10 0.6378<-- =RAND()\n11 0.1309<-- =RAND()\n12\n13 10 experiments: each cell contains Rand()\n14 1 2 3 4 5 6 7 8 9 10\n15 0.6073 0.9267 0.3659 0.9473 0.5307 0.7728 0.6772 0.8663 0.1242 0.9285\n16 0.4076 0.3475 0.4079 0.0923 0.1159 0.3125 0.9913 0.9525 0.1252 0.5522\n17 0.5411 0.4921 0.0958 0.7892 0.5212 0.4310 0.9040 0.0733 0.9615 0.9775\n18 0.2448 0.7231 0.3462 0.9175 0.3743 0.2937 0.1035 0.3312 0.8416 0.5376\n19 0.2678 0.7630 0.3316 0.0017 0.4115 0.6189 0.0608 0.3203 0.0959 0.4950\n20 0.2402 0.7870 0.3109 0.3760 0.3872 0.1488 0.6636 0.3832 0.3897 0.6506\n21 0.1288 0.2508 0.2282 0.6406 0.8679 0.9740 0.1927 0.0848 0.6565 0.4739\n22 0.6039 0.9266 0.4174 0.5396 0.5827 0.3528 0.9261 0.2797 0.3899 0.8880\n23 0.0390 0.2560 0.3029 0.5665 0.0725 0.4498 0.2902 0.5482 0.7215 0.6274\n24 0.2482 0.4922 0.5431 0.9500 0.7878 0.5518 0.5362 0.0747 0.5163 0.8535\n25\n26 Statistics for the 10 experiments\n27 Mean 0.3329 0.5965 0.3350 0.5821 0.4652 0.4906 0.5345 0.3914 0.4822 0.6984\n28 Variance 0.0353 0.0617 0.0127 0.1049 0.0581 0.0545 0.1122 0.0882 0.0870 0.0337\n29 Sigma 0.1880 0.2485 0.1126 0.3238 0.2410 0.2335 0.3350 0.2969 0.2949 0.1836\nUsing Data Table with Blank Cell Reference\nThere \u2019 s a more efficient way of running this experiment, illustrated below.\n831 Data Tables\nT he result looks something like this (\u201csomething\u201d because by the nature of\nthis experiment, the results are random, so that each push of F9 will produce\n832 Chapter 31\nA B C D E F\n1 BETTER WAY OF RUNNING THE EXPERIMENT\n2 0.5948<-- =RAND() Statistics\n3 0.0850<-- =RAND() Mean 0.5053<-- =AVERAGE(A2:A11)\n4 0.9396<-- =RAND() Variance 0.0717<-- =VAR.P(A2:A11)\n5 0.4272<-- =RAND() Sigma 0.2677<-- =SQRT(E4)\n6 0.1722<-- =RAND()\n7 0.4833<-- =RAND()\n8 0.6271<-- =RAND()\n9 0.8981<-- =RAND()\n10 0.2721<-- =RAND()\n11 0.5537<-- =RAND()\n12\n13 Data table\n14 Experiment Mean Variance Sigma\n15 0.5053 0.0717 0.2677<-- =E5, data table header\n16 1 0.5527 0.1225 0.3500\n17 2 0.4129 0.0624 0.2498\n18 3 0.5433 0.1072 0.3275\n19 4 0.4453 0.0862 0.2937\n20 5 0.3300 0.0420 0.2051\n21 6 0.5339 0.0719 0.2681\n22 7 0.6534 0.0601 0.2451\n23 8 0.2358 0.0157 0.1253\n24 9 0.4701 0.0884 0.2973\n25 10 0.6402 0.0469 0.2165\nA Slightly More Realistic Example (Also More Advanced)\nWhy use this technique? Go back to the pension problems discussed in section\n27.6. Suppose you retire at age 75 with \u20ac 1 ,000,000 in savings. You want to\ninvest this 60% in the risky asset that has a mean annual return \u03bc = 11% and\na standard deviation of return \u03c3 = 30%. You plan to withdraw \u20ac 1 00,000 at the\nend of this and each of the next 9 years.\nT he amount you\u2019 l l have left at the end of 10 years depends on the random\nannual return on the risky asset. As explained in Chapter 26, this can be\nmodeled by using Exp(mu + sigma*Norm.S.Inv(Rand( ))) . We embed this\nfunction and the assumptions in the spreadsheet below. The amount left is\ncell B24. In the example shown below, this number is positive, but it can\u2014\ndepending on the parameters\u2014also be negative.1\n1. This negative number is, of course, problematic! Maybe you have other resources, maybe you\nshould change your spending policy during the 10 years, or maybe you should die sooner (Heaven\n833 Data Tables\nA B C D E F\n1 PENSION PROBLEM\n2 Current savings 1,000,000\n3 Invested in\n4 Risky asset 60%\n5 Risk free asset 40%<-- =1-B4\n6 Annual withdrawal 100,000\n7\n8 Return paramets\n9 Risk free rate 4%\n=B14*$B$4*EXP(mu+sigma*NORM.S.INV(R\nRisky asset mean\n10 return \u03bc 11% AND())+$B$5*EXP(riskfree))\n11 Risky asset sigma \u03c3 30%\n12\nSavings at Savings Withdrawal\nbeginning at end of at end of Net after\n13 Age of year year year withdrawal\n14 75 1,000,000 1,437,841 100,000 1,337,841<-- =C14-D14\n15 76 1,337,841 1,097,621 100,000 997,621\n16 77 997,621 713,551 100,000 613,551\n17 78 613,551 722,186 100,000 622,186\n18 79 622,186 543,920 100,000 443,920\n19 80 443,920 483,394 100,000 383,394\n20 81 383,394 651,125 100,000 551,125\n21 82 551,125 380,550 100,000 280,550\n22 83 280,550 339,858 100,000 239,858\n23 84 239,858 252,465 100,000 152,465\n24 85 152,465\nN ow we use our new \u201cdata table on blank cell\u201d technique to run 20 simulations\nto see what the final (cell B24) amount might be:\nA B C D E F G H I J\n1 PENSION PROBLEM\n2 Current savings 1,000,000\n3 Invested in\n4 Risky asset 60%\n5 Risk free asset 40%<-- =1-B4\n6 Annual withdrawal 100,000\n7\n8 Return paramets\n9 Risk free rate 4%\nRisky asset mean =B14*$B$4*EXP(mu+sigma*NORM.S.INV(R\n10 return \u03bc 11% AND())+$B$5*EXP(riskfree))\n11 Risky asset sigma \u03c3 30%\n12 Data table\nSavings at Savings Withdrawal\nbeginning at end of at end of Net after Ending\n13 Age of year year year withdrawal Simulation amount\n14 75 1,000,000 1,045,933 100,000 945,933<-- =C14-D14 -356,997<-- =B24, data table header\n15 76 945,933 742,643 100,000 642,643 1 -301,825\n16 77 642,643 477,596 100,000 377,596 2 2,830,285\n17 78 377,596 342,151 100,000 242,151 3 -585,010\n18 79 242,151 208,010 100,000 108,010 4 -117,106\n19 80 108,010 96,006 100,000 -3,994 5 -507,590\n20 81 -3,994 -4,144 100,000 -104,144 6 -135,525\n21 82 -104,144 -100,014 100,000 -200,014 7 -64,976\n22 83 -200,014 -241,630 100,000 -341,630 8 1,265,134\n23 84 -341,630 -256,997 100,000 -356,997 9 -345,502\n834 Chapter 31\nEven Better\nWe can do a simulation on the annual amount withdrawn:\nH ere are some results, showing 10 simulations for five different annual with-\ndrawal amounts. For fun and for a sanity check, we \u2019 ve also run some statistics\n835 Data Tables\nG H I J K L M\n12 Data table: Terminal legacy as funciton of withdrawal\n13 Annual withdrawal \u2193\n14 -585,609 50,000 75,000 100,000 125,000 150,000\n15 1 494,149 546,991 561,325 1,187,944 -1,709,883\n16 Simulation --> 2 294,802 746,571 -419,406 -322,478 -634,332\n17 3 167,369 773,073 -41,438 -425,747 638,336\n18 4 5,224,365 -54,924 -608,211 -291,104 814,324\n19 5 292,638 947,669 131,293 1,263,636 1,338,209\n20 6 142,418 53,797 2,087,825 -122,044 -656,701\n21 7 3,670,562 -95,539 -24,299 -551,433 -74,548\n22 8 2,043,177 150,463 94,271 -362,274 1,483,009\n23 9 246,264 1,285,907 105,789 -280,146 -837,601\n24 10 608,727 166,481 -340,866 -1,718,429 426,265\n25\n26 Average 1,318,447 452,049 154,628 -162,207 78,708\n27 Sigma 1,778,101 474,664 755,472 856,126 1,035,210"
        ],
        "31.8": [
            "What are Data Tables in financial modelling?\nWhat could be a potential disadvantage of using Data Tables in financial modelling?\nHow can excessive use of Data Tables affect your computer's performance?\nCan Data Tables slow down your spreadsheet? \nWhat is meant by the statement \"Data Tables can stop your computer\" in the context of financial modeling?\nIs it always benefitial to use Data Tables in financial modelling?\nWhat should be taken into consideration while using Data Tables for financial computing processes?",
            "31.8 Data Tables Can Stop Your Computer\n\nData tables are amazing, but they can be an incredibly wasteful use of com-\nputer resources! A few juicy data tables can slow your spreadsheet to a crawl.\n836 Chapter 31"
        ]
    },
    "32": {
        "32.1": [
            "What is a matrix in terms of financial modeling?\nWhat are the different types of matrices?\nWhat is a row vector in the context of matrices?\nWhat is a column vector in relation to matrices?\nWhat is a square matrix?\nHow is a matrix or a vector denoted in financial modeling?\nWhat does a single letter often denote in the context of matrices and vectors?\nWhat is a symmetric matrix?\nWhy are variance-covariance matrices used in portfolio discussions?\nWhat is the importance of matrices in portfolio optimization?\nWhat is meant by the term 'efficient portfolios' in financial modelling?\nHow are matrices used to calculate portfolio mathematics?\nWhat is the role of matrices in financial modeling?",
            "32.1 Overview\n\nThe portfolio optimization chapters of F inancial Modeling (Chapters 8\u201313)\nmake extensive use of matrices to find efficient portfolios. This chapter con-\ntains enough information about matrices to make it possible for you to do the\ncalculations required for portfolio mathematics.\nA matrix is a rectangular array of numbers. All of the following are\nmatrices:\nA B C D E F G H I\n1 MATRICES IN EXCEL\nMatrix C\nMatrix A (a row vector) Matrix B (square 3 x 3 matrix) (column\nvector)\n2\n3 2 3 4 13 -8 -3 13\n4 -8 10 -1 -8\n5 -3 -1 11 -3\n6\n7 Matrix D (a 4 x 3 matrix)\n8 13 -8 -3\n9 -8 10 -1\n10 -3 -1 11\n11 0 13 3\nA matrix with only one row is also called a row vector; a matrix with only\none column is also called a c olumn vector. A matrix with an equal number of\nrows and columns is called a s quare matrix .\nA single letter is often used to denote a matrix or a vector. In this case we\noften write, for example, B = [ b ] , where b stands for the entry in row i and\nij ij\ncolumn j of the matrix. For a vector we might write A = [ a ] or C = [ c ] . Thus\ni i\nfor the examples given above:\na =4, b =10, c =13, d =0\n3 22 1 41\nThe matrix B above is s ymmetric, meaning that b = b. (The variance-\nij ji\ncovariance matrices used in the portfolio discussion of Chapters 8\u201313 are\n840 Chapter 32"
        ],
        "32.2": [
            "What does multiplying a matrix by a scalar represent?\nCan matrices be added together, and if so, under which circumstances?\nCan you explain the process of matrix addition?\nWhat is a matrix transposition and what does it involve?\nHow are the rows and columns affected during the process of transposition?\nHow is array function used in the transposition of matrices?\nWhat conditions must be met in order to multiply two matrices?\nCan you explain the process of matrix multiplication?\nWhat are row vector and column vector in the context of matrix?\nWhy is the order of multiplication critical in the case of matrices?\nWhat is 'commutative' in context of multiplication of matrices?\nHow are matrices multiplied using the function MMult in Excel?\nWhat are the possible errors that can occur while performing matrix multiplication in Excel?",
            "32.2 Matrix Operations\n\nI n this section we briefly review the basic operations on a matrix: multiplying\na matrix by a scalar, adding matrices, transposition of matrices, and matrix\nmultiplication.\nMultiplication by a Scalar\nM ultiplying a matrix by a scalar multiplies every entry in the matrix by the\nscalar. Thus, for example:\nA B C D E\nMULTIPLYING A MATRIX BY A SCALAR\n1\n2 Scalar 6\n3\n4 Matrix B 13 -8 -3\n5 -8 10 -1\n6 -3 -1 11\n7\n8 Scalar * Matrix B\n9 78 -48 -18<-- =D4*$B$2\n10 -48 60 -6\n11 -18 -6 66 .\nMatrix Addition\nM atrices may be added together provided they have the same number of rows\nand columns. Adding two vectors or matrices is accomplished by adding their\ncorresponding entries. Thus if A = [ a ] and B = [ b ], A + B = [ a + b ] :\nij ij ij ij\nA B C D E F G H I\n1 ADDITION OF MATRICES\n2 Matrix A Matrix B Sum of A + B\n3 1 3 2 3 3 6 <-- =B3+E3\n4 3 0 23 5 26 5\n5 6 -9 8 6 14 -3\n6 5 11 -15 1 -10 12\n841 Matrices\nMatrix Transposition\nTransposition is an operation by which the rows of a matrix are turned into\ncolumns and vice versa. Thus for the matrix E :\nA B C D E F G H I\n1 TRANSPOSITION OF MATRICES\n2 Matrix E Transpose of E: ET\n3 1 2 3 4 1 0 16<-- {=TRANSPOSE(A3:D5)}\n4 0 3 77 -9 2 3 7\n5 16 7 7 2 3 77 7\n6 4 -9 2\n7\nCells F3:H6 are generated with the array function Transpose(A3:D5). This function is inserted by marking off the target\narea, typing the formula, and then finishing by pressing [Ctrl]+[Shift]+[Enter] . See Chapter 34 for more details.\n8\nThe illustration above uses the array function T ranspose . More details on\nthe use of array functions are given in Chapter 34.\nMultiplication of Matrices\nYou can multiply matrix A by matrix B to get product A B . However, you can\nonly do this if the number of columns in A equals the number of rows in B .\nThe resulting product AB is a matrix with the number of rows as A and the\nnumber of columns as in B .\nC onfused? A couple of examples will help. Suppose that X is a row vector\nand that Y is a column vector, both with n coordinates:\n\u23a1y \u23a4\n1\nX =[ x\n1\n(cid:2) x n] ,Y =\u23a2\n\u23a2\n(cid:3) \u23a5 \u23a5.\n\u23a3\u23a2y \u23a6\u23a5\nn\nThen the product of X and the product of X and Y are defined by\n\u23a1y \u23a4\nXY =[ x\n1\n(cid:2) x n]\u23a2\n\u23a2\n(cid:3)1 \u23a5 \u23a5=\u2211n x iy i.\n\u23a3\u23a2y \u23a6\u23a5 i=1\nn\nNow suppose that A and B are two matrices, and that A has n columns and\n842 Chapter 32\n\u23a1b (cid:2) b \u23a4\n\u23a1a a (cid:2) a \u23a4 \u23a2 11 1m \u23a5\nA=\u23a2 \u23a2 (cid:3)11 12 1n \u23a5 \u23a5 B=\u23a2 \u23a2b (cid:3)21 (cid:2) b 2m\u23a5 \u23a5.\n\u23a3\u23a2a a (cid:2) a \u23a6\u23a5 \u23a2 \u23a5\np1 p2 pn \u23a3\u23a3b (cid:2) b \u23a6\nn1 nm\nThen the product of A and B , written AB , is defined by the matrix:\n\u23a1 \u23a2\u2211n\na b\n\u2211n\na b \u2026\n\u2211n\na b\n\u23a4\n\u23a5\n1h h1 1h h2 1h hm\n\u23a2h=1 h=1 h=1 \u23a5\nAB=\u23a2\n\u23a2\n(cid:3) \u23a5\n\u23a5,withijth\nelement=\u2211n\na b\n(cid:3) ih hj\n\u23a2 \u23a5 h=1\n\u23a2 \u23a5\n\u23a2\u2211n\na b \u2026 \u2026\n\u2211n\na b \u23a5\n\u23a3 ph h1 ph hm\u23a6\nh=1 hh=1\nNote that the i j th coordinate of A B is the product of the i th row of A times the\nj th column of B . For example, if\n\u23a1 2 \u22126\u23a4 \u23a1 6 9 \u221212\u23a4 \u23a1 42 6 \u221248\u23a4\nA= \u23a2 \u23a5, B= \u23a2 \u23a5 then AB= \u23a2 \u23a5.\n\u23a3\u22129 3\u23a6 \u23a3\u22125 2 4\u23a6 \u23a3\u221269 \u221275 120\u23a6\u23a6\nThe order of matrix multiplication is critical. Multiplication of matrices is not\ncommutative; that is, AB \u2260 BA. As the above example shows, the fact that it\nis possible to multiply A times B does not always imply that the multiplication\nBA is even defined.\nTo multiply matrices in Excel, we use the array function MMult :\nA B C D E F\n1 MULTIPLYING MATRICES\n2 Matrix A Matrix B\n3 2 -7 6 9 -12\n4 0 3 -5 2 4\n5\n6 Product AB\n7 47 4 -52 <-- {=MMULT(A3:B4,D3:F4)}\n8 -15 6 12\nTo multiply two matrices together, the number of columns in the first matrix\n843 Matrices\nB, but we cannot multiply B times A. If you try this in Excel, the function\nMMult will give you an error message:\nA B C D E F\nMATRIX MULTIPLICATION:\nNumber of columns of first matrix must equal\n1 number of rows of second matrix\n2 Matrix A Matrix B\n3 2 -7 6 9 -12\n4 0 3 -5 2 4\n5\n6 Product BA\n7 #VALUE! #VALUE! #VALUE! <-- {=MMULT(D3:F4,A3:B4)}\n8 #VALUE! #VALUE! #VALUE!"
        ],
        "32.3": [
            "What is an identity matrix in financial modeling? \nCan you explain the relationship between an identity matrix and any matrix A? \nWhat is the inverse of a matrix? \nHow to compute the inverse of a matrix? \nWhat functionalities does Excel offer to compute the inverse of matrices? \nWhat kind of work is required to compute an inverse matrix? \nWhat is the purpose of MMult in matrix multiplication? \nWhat does an expression like 1.07E-15 refer to in matrix computation? \nWhat is a nonsingular matrix in the context of financial modeling? \nWhat are the conditions for a matrix to be considered nonsingular? \nCan you elaborate on the meaning and implications of matrix inversion? \nWhat is an ill-conditioned matrix and when might it be problematic? \nWhat does it mean when a vector X solves the system in the context of matrix inversion?",
            "32.3 Matrix Inverses\n\nA square matrix I is called the identity matrix if all its off-diagonal entries are\n0 and all its diagonal entries are 1. Thus\n\u23a11 0 (cid:2) 0 0\u23a4\n\u23a2 \u23a5\n0 1 (cid:2) 0 0\n\u23a2 \u23a5\nI =\u23a2(cid:3) (cid:3) (cid:3) (cid:3)\u23a5\n\u23a2 \u23a5\n\u23a20 0 1 0\u23a5\n\u23a3\u23a2 0 0 (cid:2) 0 1\u23a6\u23a5\nI t is easy to confirm that multiplying any matrix A by the identity matrix of\nthe proper dimension leaves that A unchanged. Thus, if I is an n \u00d7 n identity\nn\nmatrix and A is an n \u00d7 m matrix,I A = A. Similarly, ifI is an m \u00d7 m identity\nm\nmatrix, AI = A .\nN ow suppose we are given a square matrix A of dimension n . The n \u00d7 n\nmatrix A \u2212 1 is called the inverse of A if A \u2212 1 A = A \u2212A 1 = I . The computation\nof an inverse matrix can be a lot of work; fortunately, however Excel has\nthe array function MInverse which does the calculations for us. Here\u2019 s an\n844 Chapter 32\nA B C D E F G H I J\nMATRIX INVERSE\n1 Use array function Minverse to compute the inverse of a square matrix\n2 Matrix A Inverse of A\n3 1 -9 16 1 -0.0217 1.8913 0.5362 -1.1449<-- {=MINVERSE(A3:D6)}\n4 3 3 2 3 0.0000 -1.0000 -0.1667 0.6667\n5 2 4 0 -2 0.0652 -0.6739 -0.1087 0.4348\n6 5 7 3 4 -0.0217 -0.1087 -0.2971 0.1884\n7\n8 Verifying the inverse\nWe multiply A*Inverse A: cells below contain array\n9 function {=MMULT(A3:D6,F3:I6)}\n10 1 1.07E-15 -2.22045E-16 -9.4369E-16\n11 0 1 -1.11022E-16 2.22045E-16\n12 6.94E-18 8.33E-17 1 5.55112E-16\n13 1.39E-17 1.17E-15 -4.44089E-16 1\nAs illustrated above, you can use MMult to verify that the product of the\nabove matrix and its inverse indeed give the identity matrix. Expressions like\n1.07E-15 mean 1.07*10 \u2212 15, and are thus essentially zero; you can use\nFormat|Cells|Number to specify the number of decimal places and get rid of\nthese ugly expressions:\nA B C D\nWe multiply A*Inverse A: cells below contain array\n9 function {=MMULT(A3:D6,F3:I6)}\n10 1.0000 0.0000 0.0000 0.0000\n11 0.0000 1.0000 0.0000 0.0000\n12 0.0000 0.0000 1.0000 0.0000\n13 0.0000 0.0000 0.0000 1.0000\nA square matrix that has an inverse is called a nonsingular matrix . The\nconditions for a matrix to be nonsingular are the following: Consider a square\nmatrix A of dimension n . It can be shown that A = [ a ] is nonsingular if and\nij\nonly if the only solution to the n equations\n\u2211 a x =0, j=1,\u2026,n\nij i\ni\nis x = 0, i = 1, \u2026 , n . Matrix inversion is a tricky business. If there exists a\ni\nvector X whose components are almost zero and which solves the above\nsystem, then the matrix is ill-conditioned , and it may be very difficult to find\n845 Matrices"
        ],
        "32.4": [
            "What is a system of linear equations?\nWhat does it mean for a system of linear equations to be written in matrix notation?\nWhat are the components of a system of linear equations in matrix notation?\nCan you explain what a column vector of unknowns is in the context of a system of linear equations?\nHow about the column vector of constants in the same context?\nWhat does it mean for a matrix to be square and non-singular?\nWhat are the implications of having a square and non-singular matrix in a system of linear equations?\nCan you elaborate on the solution process of a system of linear equations when the matrix A is square and non-singular?\nHow do you pre-multiply both sides of an equation?\nHow does the solution of a system of linear equations change with the inverse of a matrix?\nCan you provide an example of a system of linear equations and method to solve it?\nHow can you verify that a solution indeed solves the system of linear equations?\nIn what circumstance would a system of linear equations not have a unique solution? \nHow is the inverse of a matrix used to solve a system of linear equations?\nHow do you define a matrix of coefficients in a system of linear equations?\nHow can systems of linear equations be solved using Excel?",
            "32.4 Solving Systems of Simultaneous Linear Equations\n\nA system of n linear equations in m unknown is written as:\na x + a x + (cid:2) + a x = y\n11 1 12 2 1n n 1\na x + a x + (cid:2) + a x = y\n21 1 22 1 2n 1 2\n(cid:3)\na x + a x + (cid:2) ++ a x = y\nn1 1 n2 1 nn 1 n\nWriting the matrix of coefficients as A = [ a ], the column vector of unknowns\nij\nas X = [ x] , and the column vector of constants as Y = [ y] , we may write the\nj j\nabove system in matrix notation as A X = Y .\nNot every system of linear equations has a solution, and not every solution\nof such a system is unique. The system A X = Y always has a unique solution,\nhowever, if the matrix A is square and nonsingular. In this case the solution is\nfound by pre-multiplying both sides of the equation A X = Y by the inverse ofA :\nsinceAX =Y\u21d2A\u22121AX =A\u22121Y\u21d2X =A\u22121Y\nHere is an example. Suppose we want to solve the 3 x 3 system of\nequations:\n3x + 4x + 66x = 16\n1 2 3\n\u221233x + x = 77\n2 3\n42x + 3x + 2x = 12\n1 2 3\nWe set this up and solve it in Excel as follows:\nA B C D E F G H\n1 SOLVING SIMULTANEOUS EQUATIONS\nColumn Solution\nMatrix A of coefficients\n2 vector y A-1 Y\n3 3 4 66 16 0.4343\n4 0 -33 1 77 -2.3223<-- {=MMULT(MINVERSE(A3:C5),E3:E5)}\n5 42 3 2 12 0.3634\n6\n7 Checking that the solution works\n8 16\n9 77<-- {=MMULT(A3:C5,G3:G5)}\n10 12\nIn cells B8:B10 we check that the solution indeed solves the system by\n846 Chapter 32"
        ],
        "32.5": [
            "- What is the variance-covariance matrix?\n- How can the variance-covariance matrix be calculated for stock returns?\n- What is the correlation matrix?\n- How is the correlation matrix different from the variance-covariance matrix?\n- What are unit rows and unit columns in the context of portfolio computations?\n- What is the Global Minimum Variance Portfolio (GMVP)?\n- How is the Global Minimum Variance Portfolio calculated as a row and as a column in financial modeling?\n- How are unit row vectors and unit column vectors defined in financial computations?\n- How can these vector functions be used in computations for Global Minimum Variance Portfolio?\n- How could Excel be used to compute the variance-covariance matrix?\n- Can you explain the role of the range in var-covar function?\n- What is the purpose of the numcols function in the var-covar function? \n- What role does the technical note provided in the book play in embedding the matrix functions into the spreadsheet?\n- How do the numrows and numcols functions facilitate the computation of the correlation matrix?\n- Why is the function CorrMatrix used in financial modeling?\n- Why is the correlation matrix seen as an obvious variation on the variance-covariance matrix?\n- What relevance does the variance-covariance matrix hold in calculating the Global Minimum Variance Portfolio (GMVP)?\n- Clarify the significance of the UnitrowVector function in financial modeling.\n- What is the purpose of the UnitColVector function in financial modeling?\n- What is the value of having these matrix functions embedded in a spreadsheet?\n- What does the calculation require for computing the Global Minimum Variance Portfolio using the variance-covariance matrix?",
            "32.5 Some Homemade Matrix Functions\n\nI n the chapters on portfolio problems we use a number of matrix functions\nthat are not included in Excel. The functions in this section need to be embed-\nded into the spreadsheet where they are used\u2014see the Technical Note at the\nbeginning of this book or Chapter 36 of the VBA section.\nVariance-Covariance Matrix\nW hen dealing with stock returns, we often need to compute the variance-\ncovariance matrix. The following function does the trick:\n\u2018My thanks to Amir Kirsch and Beni Czaczkes\nFunction VarCovar(rng As Range) As Variant\nDim i As Integer\nDim j As Integer\nDim numcols As Integer\nnumcols = rng.Columns.Count\nnumrows = rng.Rows.Count\nDim matrix() As Double\nReDim matrix(numcols - 1, numcols - 1)\nFor i = 1 To numcols\nFor j = 1 To numcols\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction. _\nCovar(rng.Columns(i), rng.Columns(j)) _\n* numrows / (numrows - 1)\nNext j\nNext i\nVarCovar = matrix\nEnd Function\nHere is an application. The spreadsheet below shows five years of monthly\n847 Matrices\nA B C D E F G H I J K\n1 FIVE YEARS OF RETURNS FOR 10 STOCKS\nArcelor- General Bank of\n2 McDonalds US Steel Mi(cid:425)al Microso(cid:332) Apple Kellogg Electric America Pfizer Exxon\n3 Date MCD X MT MSFT AAPL K GE BAC PFE XOM\n4 1-Mar-07 3.07% 11.18% 3.91% -1.06% 9.36% 3.13% 1.27% 0.38% 1.17% 5.13%\n5 2-Apr-07 6.93% 2.37% 1.00% 7.18% 7.15% 2.84% 4.17% -0.25% 4.64% 5.08%\n6 1-May-07 4.59% 11.02% 12.16% 2.80% 19.42% 2.55% 1.91% 0.73% 4.89% 5.09%\n7 1-Jun-07 0.41% -3.98% 3.93% -4.06% 0.70% -4.14% 2.60% -3.66% -7.23% 0.85%\n8 2-Jul-07 -5.85% -10.11% -2.23% -1.66% 7.66% 0.04% 1.24% -3.06% -8.39% 1.49%\n9 1-Aug-07 2.83% -3.72% 8.65% -0.53% 4.97% 6.42% 0.28% 6.66% 6.70% 1.09%\n56 1-Jul-11 2.53% -14.09% -10.97% 5.24% 15.12% 0.82% -5.16% -12.05% -6.79% -1.97%\n57 1-Aug-11 5.12% -28.23% -33.99% -2.32% -1.46% -1.86% -9.36% -17.20% -0.27% -6.85%\n58 1-Sep-11 -2.92% -31.32% -32.29% -6.66% -0.92% -2.10% -5.99% -28.81% -7.13% -1.89%\n59 3-Oct-11 5.58% 14.13% 26.47% 6.77% 5.97% 1.90% 9.37% 10.99% 8.57% 7.24%\n60 1-Nov-11 3.58% 7.58% -8.23% -3.27% -5.74% -8.89% -4.89% -22.61% 5.11% 3.56%\n61 1-Dec-11 4.91% -3.13% -3.78% 1.47% 5.79% 2.83% 12.79% 2.18% 7.56% 5.24%\n62 3-Jan-12 -1.28% 13.17% 12.05% 12.88% 11.97% -2.10% 4.37% 24.87% -1.13% -1.22%\n63 1-Feb-12 0.94% 2.85% 12.71% 4.11% 7.73% 1.38% 2.22% 13.74% -0.19% 1.90%\nTo compute the variance-covariance matrix:\nA B C D E F G H I J K\n1 VARIANCE-COVARIANCE MATRIX FOR 10 STOCKS\n2 MCD X MT MSFT AAPL K GE BAC PFE XOM\n3 MCD 0.0020 0.0037 0.0028 0.0015 0.0017 0.0007 0.0020 0.0031 0.0015 0.0011\n4 X 0.0037 0.0380 0.0284 0.0076 0.0111 0.0031 0.0127 0.0176 0.0043 0.0043\n5 MT 0.0028 0.0284 0.0267 0.0065 0.0097 0.0031 0.0102 0.0133 0.0038 0.0039\n6 MSFT 0.0015 0.0076 0.0065 0.0063 0.0049 0.0010 0.0046 0.0079 0.0018 0.0014\n7 AAPL 0.0017 0.0111 0.0097 0.0049 0.0126 0.0016 0.0049 0.0049 0.0007 0.0020\n8 K 0.0007 0.0031 0.0031 0.0010 0.0016 0.0026 0.0028 0.0046 0.0011 0.0003\n9 GE 0.0020 0.0127 0.0102 0.0046 0.0049 0.0028 0.0122 0.0163 0.0041 0.0022\n10 BAC 0.0031 0.0176 0.0133 0.0079 0.0049 0.0046 0.0163 0.0393 0.0080 0.0017\n11 PFE 0.0015 0.0043 0.0038 0.0018 0.0007 0.0011 0.0041 0.0080 0.0041 0.0011\n12 XOM 0.0011 0.0043 0.0039 0.0014 0.0020 0.0003 0.0022 0.0017 0.0011 0.0026\n13\n14 Formula: {=VARCOVAR('Return data'!B4:K63)}\nCorrelation Matrix\nAn obvious variation on the previous function computes the correlation matrix\n848 Chapter 32\nFunction CorrMatrix(rng As Range) As Variant\nDim i As Integer\nDim j As Integer\nDim numCols As Integer\nnumCols = rng.Columns.Count\nnumRows = rng.Rows.Count\nDim matrix() As Double\nReDim matrix(numCols - 1, numCols - 1)\nFor i = 1 To numCols\nFor j = 1 To numCols\nmatrix(i - 1, j - 1) = _\nApplication.WorksheetFunction.\nCorrel(rng.Columns(i), rng.Columns(j))\nNext j\nNext i\nCorrMatrix = matrix\nEnd Function\nApplied to the above example:\nA B C D E F G H I J K\n1 CORRELATION MATRIX FOR 10 STOCKS\n2 MCD X MT MSFT AAPL K GE BAC PFE XOM\n3 MCD 1.0000 0.4199 0.3859 0.4238 0.3379 0.2920 0.4064 0.3506 0.5411 0.4741\n4 X 0.4199 1.0000 0.8898 0.4898 0.5062 0.3078 0.5904 0.4556 0.3491 0.4361\n5 MT 0.3859 0.8898 1.0000 0.5044 0.5277 0.3692 0.5659 0.4103 0.3602 0.4620\n6 MSFT 0.4238 0.4898 0.5044 1.0000 0.5497 0.2416 0.5312 0.5050 0.3542 0.3581\n7 AAPL 0.3379 0.5062 0.5277 0.5497 1.0000 0.2827 0.3964 0.2205 0.0945 0.3425\n8 K 0.2920 0.3078 0.3692 0.2416 0.2827 1.0000 0.4846 0.4559 0.3487 0.1234\n9 GE 0.4064 0.5904 0.5659 0.5312 0.3964 0.4846 1.0000 0.7461 0.5842 0.3926\n10 BAC 0.3506 0.4556 0.4103 0.5050 0.2205 0.4559 0.7461 1.0000 0.6328 0.1723\n11 PFE 0.5411 0.3491 0.3602 0.3542 0.0945 0.3487 0.5842 0.6328 1.0000 0.3435\n12 XOM 0.4741 0.4361 0.4620 0.3581 0.3425 0.1234 0.3926 0.1723 0.3435 1.0000\n13\n849 Matrices\nUnit Rows and Unit Columns\nP ortfolio computations sometimes use unit rows or columns. For example\nglobal minimum variance portfolio (GMVP) of Chapter 10 has the following\nformula:\nunitrow(N)\u2217S\nGMVPasrow=\nunitrow(N)\u2217S\u2217unitcolumn(N)\nS\u2217unitcolumn(N)\nGMVPascolummn=\nunitrow(N)\u2217S\u2217unitcolumn(N)\nwhereSisthevarriance\u2212covariancematrix:\n\u23a1\u03c3 \u03c3 \u03c3 (cid:2) \u03c3 \u23a4\n11 12 13 1N\n\u23a2 \u23a5\n\u03c3 \u03c3 \u03c3 (cid:2) \u03c3\n\u23a2 21 22 23 2N\u23a5\nS=\u23a2\u03c3 \u03c3 \u03c3 (cid:2) \u03c3 \u23a5\n\u23a2 31 322 33 3N\u23a5\n(cid:3)\n\u23a2 \u23a5\n\u23a3\u23a2\u03c3 \u03c3 \u03c3 (cid:2) \u03c3 \u23a6\u23a5\nN1 N2 N3 NN\nT he denominator of the above formulas is simply the sum of the numerator,\nand we can thus rewrite the formulas as:\nunitrow(N)\u2217S\nGMVPasrow=\nSum( unitrow(N)\u2217S)\nS\u2217unitccolumn(N)\nGMVPascolumn=\nSum( S\u2217unitcolumn(N))\n850 Chapter 32\n\u2018With thanks to Priyush Singh and Ayal Itzkovitz\nFunction UnitrowVector(numcols As Integer) _\nAs Variant\nDim i As Integer\nDim vector() As Integer\nReDim vector(0, numcols - 1)\nFor i = 1 To numcols\nvector(0, i - 1) = 1\nNext i\nUnitrowVector = vector\nEnd Function\nFunction UnitColVector(numrows As Integer) As Variant\nDim i As Integer\nDim vector() As Integer\nReDim vector(numrows - 1, 1)\nFor i = 1 To numrows\nvector(i - 1, 0) = 1\nNext i\nUnitColVector = vector\nEnd Function\nHere \u2019 s an example of these functions in a spreadsheet:\nA B C D E\n1 ROWANDCOLUMNUNITVECTORS\n2 1 <-- {=UNITCOLVECTOR(5)}\n3 1\n4 1\n5 1\n6 1\n7\n8 1 1 1 1<-- {=UNITROWVECTOR(4)}\nA more interesting use of these functions is to use them directly in a\n851 Matrices\nA B C D E F G H I J K\n1 COMPUTINGTHEGLOBALMINIMUMVARIANCEPORTFOLIO(GMVP)\n2 MCD X MT MSFT AAPL K GE BAC PFE XOM\n3 MCD 0.0020 0.0037 0.0028 0.0015 0.0017 0.0007 0.0020 0.0031 0.0015 0.0011\n4 X 0.0037 0.0380 0.0284 0.0076 0.0111 0.0031 0.0127 0.0176 0.0043 0.0043\n5 MT 0.0028 0.0284 0.0267 0.0065 0.0097 0.0031 0.0102 0.0133 0.0038 0.0039\n6 MSFT 0.0015 0.0076 0.0065 0.0063 0.0049 0.0010 0.0046 0.0079 0.0018 0.0014\n7 AAPL 0.0017 0.0111 0.0097 0.0049 0.0126 0.0016 0.0049 0.0049 0.0007 0.0020\n8 K 0.0007 0.0031 0.0031 0.0010 0.0016 0.0026 0.0028 0.0046 0.0011 0.0003\n9 GE 0.0020 0.0127 0.0102 0.0046 0.0049 0.0028 0.0122 0.0163 0.0041 0.0022\n10 BAC 0.0031 0.0176 0.0133 0.0079 0.0049 0.0046 0.0163 0.0393 0.0080 0.0017\n11 PFE 0.0015 0.0043 0.0038 0.0018 0.0007 0.0011 0.0041 0.0080 0.0041 0.0011\n12 XOM 0.0011 0.0043 0.0039 0.0014 0.0020 0.0003 0.0022 0.0017 0.0011 0.0026\n13\n14 GMVP\n15 MCD 0.0326<-- {=MMULT(B3:K12,UNITCOLVECTOR(10))/SUM(MMULT(B3:K12,UNITCOLVECTOR(10)))}\n16 X 0.2117\n17 MT 0.1754\n18 MSFT 0.0705\n19 AAPL 0.0873\n20 K 0.0340\n21 GE 0.1166\n22 BAC 0.1891\n23 PFE 0.0493\n24 XOM 0.0335\n25\n26 MCD X MT MSFT AAPL K GE BAC PFE XOM\n27 0.0326 0.2117 0.1754 0.0705 0.0873 0.0340 0.1166 0.1891 0.0493 0.0335\n28 Formula: {=MMULT(UNITROWVECTOR(10),B3:K12)/SUM(MMULT(UNITROWVECTOR(10),B3:K12))}"
        ]
    },
    "33": {
        "33.1": [
            "What is financial modeling in Excel?\nWhat are some of the financial functions used in Excel for financial modeling?\nCan you explain the purpose of the NPV function in Excel?\nWhat does the IRR function do in Excel?\nHow is the PV function used in Excel?\nWhat is the PMT function in Excel and when is it used?\nWhat are the applications of XIRR and XNPV functions in Excel?\nCould you define the 'Date' functions in Excel?\nWhat does the NOW function do in Excel?\nHow is the TODAY function used in Excel?\nWhat is the WEEKDAY function and how is it used in Excel?\nExplain the purpose of the MONTH function in Excel.\nCan you explain the DATEDIF function in Excel?\nWhat are some of the statistical functions present in Excel?\nBriefly describe what the AVERAGE function does in Excel?\nWhat is the purpose of the VAR function?\nHow to use VARP in Excel?\nWhere would a Correl function be used in Excel?\nWhat is the COVAR function in Excel?\nCould you describe the regression functions in Excel?\nWhat is the purpose of the SLOPE function in Excel?\nWhere is the INTERCEPT function used in Excel?\nDefine the RSQ function in Excel.\nWhat does the LINEST function do in Excel?\nWhat are some conditional functions in Excel?\nDefine IF function in Excel.\nWhat is the usage of VLOOKUP function in Excel?\nExplain HLOOKUP function in Excel.\nWhat are the uses of LARGE function in Excel?\nWhere is the RANK function used in Excel?\nWhat does the PERCENTILE function do in Excel?\nHow is the COUNT function used in Excel?\nWhat does the OFFSET function do in Excel?",
            "33.1 Overview\n\nE xcel contains several hundred functions. This chapter surveys only those\nfunctions used in this book. The functions discussed are the following:\n\u2022 Financial functions: NPV , IRR , PV , PMT , XIRR , and X NPV\n\u2022 Date functions: Now , Today , Date , Weekday , Month , Datedif\n\u2022 Statistical functions: Average , Var , Varp , Stdev , Stdevp , Correl , Covar\n\u2022 Regression functions: Slope , Intercept , Rsq , Linest\n\u2022 Conditional functions: If , VLookup , HLookup\n\u2022 Large , Rank , Percentile , Percentrank\n\u2022 Count , CountA , CountIf\n\u2022 Offset\nA separate chapter, Chapter 34, is devoted to the important topic of array\nfunctions."
        ],
        "33.2": [
            "What is the NPV function in Excel?\nHow does the Excel definition of NPV differ from the standard finance definition?\nWhat is the significance of the first cash flow in the Excel definition of NPV?\nCan you explain how to calculate NPV in Excel using an example?\nWhat potential bug does the NPV function have in Excel, and how can it cause confusion?\nWhat is the Internal Rate of Return (IRR)?\nWhat is the Excel syntax for the IRR function?\nWhat is the role of the 'guess' parameter in the IRR function?\nWhat happens when there are multiple internal rates of return for a sequence of cash flows?\nIn the context of cash flows, what does a change of sign signify?\nWhat is the 'PV' function in Excel?\nHow does the PV function handle payments made at different dates?\nHow does the PV function deal with negative and positive payment values?\nWhat does the 'PMT' function in Excel calculate?\nWhat equation is solved while performing PMT function calculation in Excel?\nWhat is the significance of a loan table and how can it be calculated using the PMT function?\nWhat is the role of IPMT and PPMT functions in Excel?\nHow does a loan table show the split of a loan's flat payments?\nHow do the PMT, IPMT, and PPMT functions interact in Excel?\nHow are principal and interest payments calculated at the end of each year?",
            "33.2 Financial Functions\n\nE xcel has a large number of financial functions. The main functions used in\nthis book are explored in this section.\nNPV\nThe Excel definition of N PV differs somewhat from the standard finance defi-\nnition. In the finance literature, the net present value of a sequence of cash\nflows C , C , C , \u2026, C at a discount rate r refers to the expression\n0 1 2 n\n\u2211n C\nt orC\n+\u2211n C\nt\n( 1+r)t 0 ( 1+r)t\nt=0 t=1\nIn many cases C represents the cost of the asset purchased and is therefore\n0\nnegative.\nThe Excel definition of N PV always assumes that the first cash flow occurs\nafter one period. The user who wants the standard finance expression must\ntherefore calculate NPV(r,{C , \u2026 , C }) + C . Here is an example:\n856 Chapter 33\nA B C D\n1 EXCEL'S NPV FUNCTION\n2 Discount rate 10%\n3\nPresent\n4 Year Cash flow value\n5 0 -100.00 -100.00 <-- =B5/(1+$B$2)^A5\n6 1 35.00 31.82\n7 2 33.00 27.27\n8 3 34.00 25.54\n9 4 25.00 17.08\n10 5 16.00 9.93\n11\nPresent value\n12 of future cash 111.65 <-- =SUM(C6:C10)\n13 flows 111.65 <-- =NPV(B2,B6:B10)\n14 Net present value 11.65 <-- =B5+NPV(B2,B6:B10)\nThe NPV function has a potential bug: It differentiates between blank cells\nand cells containing zeros. This can cause some confusion, as can be seen in\nthe example below. The present value of the cash flows in B5:B7 is 65.75,\n100\nwhich corresponds to . But in the otherwise similar example of the cash\n1.153\nflows in B11:B13, Excel \u2019 s NPV function regards the first cash flow as being\n100\n100, and returns the answer =86.96 . So\u2014in using NPV you have to be\n1.15\nexplicit in putting in zeros for zero cash flows.\nA B C\n1 NPV IGNORES BLANK CELLS!\n2 Discount rate 15%\n3\n4 Year Cash flow\n5 1 0.00\n6 2 0.00\n7 3 100.00\n8 Present value 65.75<-- =NPV(B2,B5:B7)\n9\n10 Year Cash flow\n11 1\n12 2\n13 3 100.00\n857 Excel Functions\nIRR\nT he internal rate of return (IRR) of a sequence of cash flows C , C , C , \u2026,\n0 1 2\nC is an interest rate r such that the net present value of the cash flows is zero:\nn\n\u2211n C\nt =0\n( 1+r)t\nt=0\nThe Excel syntax for the I RR function is I RR(cash flows , guess) . Here\ncash flows represents the whole sequence of cash flows, including the first\ncash flow C , and guess is an optional starting point for the algorithm which\n0\ncalculates the IRR.\nGuess is not required, and when there is only one IRR it is usually\nirrelevant:\nA B C\n1 EXCEL'S IRR FUNCTION\n2 Year Cash flow\n3 0 -100\n4 1 35\n5 2 33\n6 3 34\n7 4 25\n8 5 16\n9\n10 IRR 15.00%<-- =IRR(B3:B8)\n858 Chapter 33\nI f there are multiple IRRs, then choice of guess can make a difference.\nConsider, for example, the following cash flows:\nA B C D E F G H I\n1 MULTIPLE IRRs\nCash\n2 Year flows 30,000\n3 0 -11,000\n25,000\n4 1 15,000\n20,000\n5 2 15,000\n6 3 15,000 15,000\n7 4 15,000 10,000\n8 5 15,000\n5,000\n9 6 15,000\n0\n10 7 15,000\n0% 20% 40% 60% 80% 100% 120% 140% 160%\n11 8 15,000 -5,000\n12 9 15,000 -10,000\n13 10 -135,000 -15,000\n14\n15 IRR 1.86% <-- =IRR(B3:B13,0)\n16 135.99% <-- =IRR(B3:B13,2)\nVPN\nNPV of Cash Flows\nDiscount rate\nThe graph (created from a Data Table which is not shown) shows that there\nare two IRRs, since the NPV curve crosses the x -axis twice. To find both these\nIRRs, we have to change the g uess (though the precise value of guess is still\nnot critical). In the example below we have changed both guesses, but still get\nthe same answer:\nA B C D\n15 IRR 1.86% <-- =IRR(B3:B13,0)\n16 135.99% <-- =IRR(B3:B13,2)\nNote A given set of cash flows typically has more than one IRR if there is\nmore than one change of sign in the cash flows\u2014in the above example, the\ninitial cash flow is negative, and CF \u2013CF are positive (this accounts for one\n1 9\nchange of sign); but then CF is negative\u2014making a second change of sign.\n10\nIf you suspect that a set of cash flows has more than one IRR, the first thing\n859 Excel Functions\nnumber of times that the NPV graph crosses the x- axis identifies the number\nof IRRs (and also their approximate values).\nPV\nThis function calculates the present value of an annuity (a series of fixed\nperiodic payments). For example:\nA B C\n1 THE PV FUNCTION\n2 Payments made at the end of the period\n3 Rate 10%\n4 Number of periods 10.00\n5 Periodic payment 100.00\n6 Present value -614.46 <-- =PV(B3,B4,B5)\nThus $\n614.46=\u221110 100\n. Here are two things to note about the P V function:\n( 1.10)t\nt=1\n\u2022 Writing PV(B3,B4,B5) assumes that payments are made at dates 1, 2, \u2026 ,\n10. If the payments are made at dates 0, 1, 2, \u2026 , 9, you should write:\nA B C\n9 Payments made at the beginning of the period\n10 Rate 10%\n11 Number of periods 10.00\n12 Periodic payment 100.00\n13 Present value -675.90 <-- =PV(B10,B11,B12,,1)\nThe formula PV(B10,B11,B12,,1) can also be generated from the\n860 Chapter 33\n\u2022 Irritatingly, the PV function (and the PMT , IPMT , and PPMT functions\u2014\nsee below) produces a negative answer when the payment or future value is\npositive (there is a logic here, but it \u2019 s not worth explaining). The solution is\nobvious: Either write - PV(B3,B4,B5) or let the payment be negative by writing\nPV(B3,B4,-B5) .\nPMT\nThis function calculates the payment necessary to pay off a loan with equal\npayments over a fixed number of periods. For example, the first calculation\nbelow shows that a loan of $1,000, to be paid off over 10 years at an interest\nrate of 8% will require equal annual payments of interest and principal of\n$149.03. The calculation performed is the solution of the following\nequation:\n\u2211n X\n=Initialloan principal\n( 1+r)t\n861 Excel Functions\nA B C\n1 THE PMT FUNCTION\n2 Payments made at the end of the period\n3 Rate 8%\n4 Number of periods 10.00\n5 Principal 1,000.00\n6 Payment -149.03 <-- =PMT(B3,B4,B5)\n7\n8 Payments made at the beginning of the period\n9 Rate 8%\n10 Number of periods 10.00\n11 Principal 1,000.00\n12 Payment -137.99 <-- =PMT(B9,B10,B11,,1)\nLoan tables can be calculated using the PMT function. These tables\u2014explained\nin detail in Chapter 1\u2014show the split between interest and principal of each\npayment. In each period, the payment on the loan (calculated with P MT ) is\nsplit:\n\u2022 We first calculate the interest owing for that period on the principal outstand-\ning at the beginning of the period. In the table below, at the end of year 1, we\nowe $80 ( = 8% * $1,000) of interest on the loan principal outstanding at the\nbeginning of the year.\n\u2022 The remainder of the payment (for year 1: $69.03) goes to reduce the prin-\n862 Chapter 33\nA B C D E F\n1 LOAN TABLE\n2 Interest 8%\n3 Number of periods 10 =$B$5\n4 Principal 1,000\n5 Annual payment 149.03 <-- =-PMT(B2,B3,B4)\n6\n7 Split payment into\nPrincipal at\nbeginning Repayment\n8 Year of year Payment Interest of principal\n9 1 1,000.00 149.03 80.00 69.03 <-- =C9-D9\n10 2 930.97 149.03 74.48 74.55\n11 3 856.42 149.03 68.51 80.52\n12 4 775.90 149.03 62.07 86.96\n13 5 688.95 149.03 55.12 93.91\n14 6 595.03 149.03 47.60 101.43\n15 7 493.60 149.03 39.49 109.54\n16 8 384.06 149.03 30.73 118.30\n17 9 265.76 149.03 21.26 127.77\n18 10 137.99 149.03 11.04 137.99\n19\n20 =B9-E9 =$B$2*B9\nNote that at the end of the 10 years the repayment of principal is exactly equal\nto the principal outstanding at the beginning of the year (i.e., the loan has been\npaid off).\nThe Functions IPMT and PPMT\nAs you have seen above, a loan table shows the split of a loan\u2019 s flat payments\n(computed with P MT ) between interest and principal. In the loan table of the\nprevious subsection, we computed this split by first computing the flat payment\nper period (column C), then taking the interest on the principal at the beginning\nof the period (column D), and finally subtracting this interest from the period\u2019 s\ntotal payment (column E).\nIPMT and P PMT perform this calculation without the necessity of relying\n863 Excel Functions\nA B C D E\n1 IPMT AND PPMT\n2 Interest 8%\n3 Number of periods 10\n4 Principal 1,000\n5\nPrincipal Interest\npayment at payment at\n6 Year end year end year\n7 1 69.03 <-- =PPMT($B$2,A7,$B$3,-$B$4) 80.00 <-- =IPMT($B$2,A7,$B$3,-$B$4)\n8 2 74.55 <-- =PPMT($B$2,A8,$B$3,-$B$4) 74.48 <-- =IPMT($B$2,A8,$B$3,-$B$4)\n9 3 80.52 68.51\n10 4 86.96 62.07\n11 5 93.91 55.12\n12 6 101.43 47.60\n13 7 109.54 39.49\n14 8 118.30 30.73\n15 9 127.77 21.26\n16 10 137.99 11.04\nAs you can see, the payments computed are the same as in the loan table\nof the previous subsection."
        ],
        "33.3": [
            "What does Excel translate dates into?\nCan you subtract two dates in Excel, and if so, what does it yield?\nHow can you add a number to a date in Excel to find another date?\nHow does Excel interpret times entered into a cell?\nDoes Excel recognize 24-hour times?\nHow does Excel interpret AM and PM symbols when entered with time?\nCan you subtract times in Excel just like dates? \nHow are times represented in Excel when the cells are formatted with Format|Cells|Number|General?\nWhat happens when you type in a date and a time and reformat in Excel?\nDoes Excel have a set of time and date functions, and if so, what are some examples?\nWhat is the Excel function Now() used for?\nWhat does the Excel function Today() do?\nHow is the Excel function Date(yyyy,mm,dd) used?\nWhat does the Excel function Weekday do?\nWhat information does the Excel function Month, Weeknum, Day give you?\nWhat does the Excel function Datedif compute?\nHow do you calculate the number of years, months, and days between two dates using the Datedif function in Excel?\nWhat does \"md\" in the Datedif function signify?\nWhat does \"ym\" in the Datedif function signify?\nWhat does \"yd\" in the Datedif function signify?",
            "33.3 Dates and Date Functions\n\nRead the quote from the Excel help below and you will know almost every-\n864 Chapter 33\nT he basic fact you need to know is that Excel translates dates into a number:\nHere \u2019 s an example: Suppose you decide to type a date into a cell:\nWhen you hit [Enter], Excel decides that you \u2019 ve entered a date. Here \u2019 s the\nway it appears:\nN ote that in the formula bar (indicated by the arrow above), Excel interprets\nthe date entered as 03-02-2015 . 1 When you reformat the cell as F ormat\nCells|Number|General, you see that Excel interprets this date as the number\n42038, the number 1 being 1 January 1900.\nSpreadsheet dates can be subtracted: In the spreadsheet below we \u2019 ve entered\ntwo dates and subtracted them to find the number of days between the dates:\n1 . T he way this appears and is interpreted depends on the Regional Settings entered in the\n865 Excel Functions\nA B C\n1 Date1 15-Aug-40\n2 Date2 28-Sep-52\n3 Days between 4427 <-- =B2-B1\nYou can also add a number to a date to find another date. What, for example,\nwas the date 165 days after 16 November 1947?\nB C\n5 16-Nov-47\n6 29-Apr-48 <-- =B5+165\nStretching Out Dates\nIn the two cells below we \u2019 ve put in two dates and then \u201cstretched\u201d the cells\nout to add more dates with the same difference between them:\nWrite in two dates; mark both Grab the handle (arrow on previ- The result: More dates added with\ncells. ous drawing) and pull same spacing (in this case, 6\nmonths):\nTimes in a Spreadsheet\nHours, minutes, etc., can also be typed into a cell. In the cell below, we \u2019 ve\n866 Chapter 33\nWhen we hit [Enter], Excel interprets this as 8:22 AM:\nE xcel recognizes 24-hour times and also recognizes the symbol a for AM\nand p for PM:\nAs entered When you hit [Enter]\nNote that the p is separated from the time by a space. (Of\ncourse AM is represented by an a .)\nEXCEL RECOGNIZES 24-HOUR CLOCK\n867 Excel Functions\nYou can subtract times just like you subtract dates; cell B5 below tells you\nthat 7 hours and 32 minutes have elapsed between the two times (ignore the\n\u201cAM\u201d in B5):\nB C D\n3 3:48 PM\n4 8:16 AM\n5 7:32 AM <-- =B3-B4\nW hen you reformat the cells above with Format|Cells|Number|General ,\nyou can see that times are represented in Excel as fractions of a day:\nB C D\n3 0.658333\n4 0.344444\n5 0.313889 <-- =B3-B4\nIf you type in a date and a time and reformat, you can also see this:\nHere \u2019 s what you typed: Here \u2019 s how it appears:\n868 Chapter 33\nTime and Date Functions in Excel\nE xcel has a whole set of time and date functions. Here are several functions\nwhich we find useful:\n\u2022 Now reads the computer clock and represents the date and the time. N ow\ntakes no arguments and is written with empty parentheses: Now( ) .\n\u2022 Today reads the computer \u2019 s clock and prints the date. This function, like\nNow , is written with empty parentheses: T oday( ) .\n\u2022 Date(yyyy,mm,dd) gives the date entered.\n\u2022 Weekday gives the day of the week\n\u2022 Month, Weeknum, Day give the month, week, day of a date\nHere are some of these functions in a spreadsheet:\nA B C\nSerial Date/Time\n1 representation Format\n2 41620.41885 12-12-13 10:03 <-- =NOW()\n3 41620 12-12-13 <-- =TODAY()\n4 43924 Apr-3-2020 <-- =DATE(2020,4,3)\n5\n6 Different formatting of Now()\n7 12-Dec-13 <-- =NOW()\n8 12-12-13 10:03 <-- =NOW()\n9 10:03 AM<-- =NOW()\n10\n11 Using Weekday, Month, Weeknum, Day\n12 5 <-- =WEEKDAY(NOW())\n13 5 <-- =WEEKDAY(\"3apr1947\")\n14 4 <-- =MONTH(B4)\n15 12 <-- =MONTH(NOW())\n16 50 <-- =WEEKNUM(NOW())\n17 12 <-- =DAY(NOW())\nCalculating the Difference Between Two Dates: The Function Datedif\nThe Excel function D atedif computes the difference between two dates in\n869 Excel Functions\nA B C D\n1 DATEDIF COMPUTES THE DIFFERENCE BETWEEN TWO DATES\n2 Date1 03-Apr-47\n3 Date2 15-Jan-13\n4\n5 65<-- =DATEDIF(B2,B3,\"y\") Number of years between dates\n6 789<-- =DATEDIF(B2,B3,\"m\") Number of months between dates\n7 24029<-- =DATEDIF(B2,B3,\"d\") Number of days between dates\n8 12<-- =DATEDIF(B2,B3,\"md\") Number of days in excess of full number of months\n9 9<-- =DATEDIF(B2,B3,\"ym\") Number of months in excess of full number of years\n10 287<-- =DATEDIF(B2,B3,\"yd\") Number of days in excess of full number of years"
        ],
        "33.4": [
            "What is the function of XIRR and XNPV in financial modelling?\nHow does the XIRR function calculate the internal rate of return?\nWhat happens when cash flows are unevenly spaced in the XIRR and XNPV functions?\nWhat is the effective annual interest rate in terms of financial modelling? \nHow does a daily rate factor in the calculation of the XIRR function? \nWhat is meant by discounting each cash flow in financial modeling?\nCan you explain what a net present value (NPV) is? \nWhat is the key difference between NPV and XNPV functions when calculating net present value?\nHow does the XNPV function work with unevenly spaced cash flows?\nWhat are the limitations of the XIRR and XNPV functions?\nIn what circumstances does the XNPV function fail to work?\nWhat is the effect of having a zero discount rate on the XNPV function?\nHow does the function NXNPV resolve the problem with XNPV and zero discount rates?\nHow is the internal rate of return calculated by the XIRR function?\nWhat are the challenges of the XIRR function when dealing with multiple internal rates of return?\nCan you explain how the function NXIRR resolves these issues with the XIRR function?\nWhat is the solution for calculating multiple internal rates of return?\nWhat is the use of the \"Guess\" switch in calculating the XIRR value?\nHow can unequal spacing of cash flows affect the calculations of IRR and NPV?\nWhat is the role of the discount rate in financial modeling calculations?",
            "33.4 The Functions XIRR, XNPV\n\nT he functions XIRR and XNPV calculate the internal rate of return and the\nnet present value for a series of cash flows received on specific dates. They\nare especially useful for calculating IRR and NPV when the dates are unevenly\nspaced.2 If you do not have these functions, you will have to go to\nFile|Options|Add-Ins|Manage . Choose A dd-Ins and mark A nalysis ToolPak :\n2. Excel \u2019 s IRR function assumes that the first cash flow occurs today, the next cash flow occurs\none period hence, the following cash flow two periods hence, etc. Excel\u2019 s N PV function assumes\nthat the first cash flow occurs one period from now, the next cash flow in two periods, etc. We\ncall this \u201ceven spacing of cash flows.\u201d When this is not the case, you \u2019 ll need the X IRR and X NPV\n870 Chapter 33\nXIRR\nH ere\u2019 s an example: You pay $600 on 16 February 2001 for an asset that repays\n$100 on 5 April, $100 on 15 July 2001, and then $100 on every 22 September\nfrom 2001 until 2009. The dates are not evenly spaced, so that you cannot use\nIRR . With XIRR (cell B16 below), you can compute the annualized IRR (the\neffective annual interest rate EAIR, as defined in Chapter 2).\nA B C\n1 THE EXCEL XIRR FUNCTION\n2 Date Payment\n3 16-Feb-01 -600\n4 05-Apr-01 100\n5 15-Jul-01 100\n6 22-Sep-01 100\n7 22-Sep-02 100\n8 22-Sep-03 100\n9 22-Sep-04 100\n10 22-Sep-05 100\n11 22-Sep-06 100\n12 22-Sep-07 100\n13 22-Sep-08 100\n14 22-Sep-09 100\n15\n16 XIRR 21.97% <-- =XIRR(B3:B14,A3:A14)\nThe XIRR function works by discounting each cash flow at the daily rate.\nIn our example the first cash flow of $100 occurs 48 days from now, the second\nin 149 days, \u2026 The X IRR transforms 21.97% to a daily rate and uses it to\ndiscount the cash flows:\n100 100 100\n\u2212600+ + +...+ =0\n871 Excel Functions\nA B C D E\nHOW DOES XIRR WORK?\n1 XIRR computes the daily internal rate of return\nPresent\n2 Date Payment Days from initial date value\n3 16-Feb-01 -600 -600.00 <-- =B3\n4 05-Apr-01 100 48 97.42 <-- =B4/(1+$B$16)^(C4/365)\n5 15-Jul-01 100 149 92.21 <-- =B5/(1+$B$16)^(C5/365)\n6 22-Sep-01 100 218 88.81 <-- =B6/(1+$B$16)^(C6/365)\n7 22-Sep-02 100 583 72.81 <-- =B7/(1+$B$16)^(C7/365)\n8 22-Sep-03 100 948 59.70 <-- =B8/(1+$B$16)^(C8/365)\n9 22-Sep-04 100 1,314 48.91\n10 22-Sep-05 100 1,679 40.10\n11 22-Sep-06 100 2,044 32.88\n12 22-Sep-07 100 2,409 26.96\n13 22-Sep-08 100 2,775 22.09\n14 22-Sep-09 100 3,140 18.11\n15\n16 XIRR 21.97% <-- =XIRR(B3:B14,A3:A14) 0.00 <-- =SUM(D3:D14)\n17\n18 Cell C4 contains the\n19 formula =A4-$A$3\nXNPV\nThe XNPV function computes the NPV for unevenly spaced cash flows. In\nthe example below, we use the function to compute the NPV on the same\n872 Chapter 33\nA B C\n1 THE EXCEL XNPV FUNCTION\n2 Date Payment\n3 16-Feb-01 -600\n4 05-Apr-01 100\n5 15-Jul-01 100\n6 22-Sep-01 100\n7 22-Sep-02 100\n8 22-Sep-03 100\n9 22-Sep-04 100\n10 22-Sep-05 100\n11 22-Sep-06 100\n12 22-Sep-07 100\n13 22-Sep-08 100\n14 22-Sep-09 100\n15\n16 Discount rate 15%\n17 XNPV 97.29 <-- =XNPV(B16,B3:B14,A3:A14)\nNotice that XNPV requires you to indicate all the cash flows (starting with\nthe initial cash flow), as opposed to NPV, which starts from the first cash flow.\nBugs in XIRR and XNPV\nXIRR and X NPV address the problems of discounting when cash flows are\ntime dated, but they have two bugs: XNPV does not work with zero discount\nrates, and X IRR does not solve multiple internal rates of return. Below we\ndiscuss these problems. We then define two new functions, N XNPV and\nNXIRR , that solve these problems. These two functions are included as addi-\ntional functions in the spreadsheet that accompanies this chapter.3\nProblem: XNPV Doesn \u2019 t Work with Zero Discount Rates\nXNPV works fine with positive discount rates but fails when discount rates\nare zero. 4 We illustrate this below.\n3. The two additional functions NXIRR and NXNPV were developed by Benjamin Czaczkes.\nRead \u201cAdding Getformula to Your Spreadsheet\u201d on the disk that accompanies this book to see\nhow you can copy these functions into your own spreadsheets.\n4. Recall that when the discount rate is zero, the net present value is just the sum of all the cash\n873 Excel Functions\nA B C D E F\n1 XNPV DOES NOT WORK WITH ZERO DISCOUNT RATES\n2 Discount rate 3% Discount rate 0%\n3 XNPV 579.00<-- =XNPV(B2,B6:B11,A6:A11) XNPV #NUM! <-- =XNPV(E2,E6:E11,D6:D11)\n4\n5 Date Cash flow Date Cash flow\n6 13-Jan-12 -1,000 13-Jan-12 -1,000\n7 18-Aug-12 115 18-Aug-12 115\n8 20-Jan-13 121 20-Jan-13 121\n9 15-Jul-13 100 15-Jul-13 100\n10 01-Jan-14 333 01-Jan-14 333\n11 16-Jul-14 1,011 16-Jul-14 1,011\nOur new function NXNPV solves this problem:\nA B C D E F\n1 NXNPV SOLVES THE PROBLEM\n2 Discount rate 3% Discount rate 0%\n3 XNPV 579.00<-- =nXNPV(B2,B6:B11,A6:A11) XNPV 680<-- =nXNPV(E2,E6:E11,D6:D11)\n4\n5 Date Cash flow Date Cash flow\n6 13-Jan-12 -1,000 13-Jan-12 -1,000\n7 18-Aug-12 115 18-Aug-12 115\n8 20-Jan-13 121 20-Jan-13 121\n9 15-Jul-13 100 15-Jul-13 100\n10 01-Jan-14 333 01-Jan-14 333\n11 16-Jul-14 1,011 16-Jul-14 1,011\nProblem: XIRR Doesn \u2019 t Work with Two IRRs\nThe Guess switch on XIRR doesn\u2019 t work. As shown below, this means that\nXIRR is unable to compute the IRR for cash flows having multiple rates of\n874 Chapter 33\nA B C D E F G\n1 PROBLEMS WITH XIRR\n2 Discount rate 22%\n3 Net present value 65.09<-- =nXNPV(B2,B9:B15,A9:A15), no Guess\n4 IRR #NUM! <-- =XIRR(B9:B15,A9:A15)\n5 #NUM! <-- =XIRR(B9:B15,A9:A15,35%), Guess = 5% Data table: XNPV as function of discount rate\n6 #NUM! <-- =XIRR(B9:B15,A9:A15,5%), Guess = 35% Discount NPV\n7 65.09<-- =B3, data table header\n8 Date Cash flow 0% -100.00\n9 30-Jun-13 -500 4% -15.97\n10 14-Feb-14 100 8% 33.62\n11 14-Feb-15 300 12% 59.64\n12 14-Feb-16 400 16% 69.54\n13 14-Feb-17 600 20% 68.52\n14 14-Feb-18 800 24% 60.19\n15 14-Feb-19 -1800 28% 47.09\n16 32% 30.97\n17 100 36% 13.10\n18 40% -5.68\n19 44% -24.75\n20 50 48% -43.70\n21 52% -62.25\n22 0 56% -80.23\n23 0% 5% 10% 15% 20% 25% 30% 35% 40% 45% 50% 55% 60%\n24 -50\n25\n26\n27 -100\n28\n29 -150\n30\neulav\ntneserp\nteN\nTwo IRRs\nDiscount rate\nF rom the data table, it is evident that there are two internal rates of return\n(around 5% and around 40%). But the XIRR function does not identify either\n(see cells B4:B6). The additional function N XIRR solves this problem:\nA B C\n1 NXIRR SOLVES THE PROBLEM\n2 IRR 5.06%<-- =nXIRR(B7:B13,A7:A13)\n3 38.80%<-- =nXIRR(B7:B13,A7:A13,35%), Guess = 35%\n4 5.06%<-- =nXIRR(B7:B13,A7:A13,5%), Guess = 5%\n5\n6 Date Cash flow\n7 30-Jun-13 -500\n8 14-Feb-14 100\n9 14-Feb-15 300\n10 14-Feb-16 400\n11 14-Feb-17 600\n12 14-Feb-18 800\n875 Excel Functions"
        ],
        "33.5": [
            "What are statistical functions in Excel?\nWhat does the function Var calculate in Excel?\nWhat does the function Var.p calculate in Excel?\nHow is the population variance calculated in Excel?\nWhat is the function used to calculate the sample variance in Excel?\nHow is the standard deviation calculated in Excel?\nWhat is the difference between the functions Varp and Var in Excel?\nWhat does the function Stdevp calculate in Excel?\nWhat are the functions used to compute the covariance and correlation of two series of numbers in Excel?\nHow does the Correl function work in Excel?\nWhat is the function Covar used for in Excel?\nWhat is the role of new functions like Covariance.s and Covariance.p introduced in Excel 2013?\nWhat does the function DAverage do in Excel?\nWhat does the function DCount do in Excel?\nWhat does the function DMin do in Excel?\nWhat does the function DVar do in Excel?\nWhat does the function DVarP do in Excel?\nWhat does the function DStdev do in Excel?\nWhat does the function DStevP do in Excel?\nHow can you compute statistics for a database using Excel's statistical functions?\nIn the context of financial modeling, how can you manipulate stock returns and prices using Excel functions?\nHow is the function DSTDEV used in statistical analysis of financial data in Excel? \nWhat is the purpose of the \"D Functions\" in Excel's statistical functions and how can it be used for analyzing returns for a specific period? \nWhat are the ways to compute sample variance and population variance in Excel?\nWhat is the role of Covar, Covariance.s, Covariance.p, and Correl functions in Excel? \nHow do you calculate average return of returns greater than a specific value using DAVERAGE function in Excel?\nWhat function would you use in Excel to compute the population standard deviation?",
            "33.5 Statistical Functions\n\nExcel contains a number of statistical functions. We illustrate these functions\nusing the following example. Note that with the introduction of Excel 2013,\nsome of these functions have been renamed, though all of the functions still\nwork; thus, for example, the population variance can be computed with the\nfunction V ar (old versions of Excel) or Var.p (new versions).\nA B C D E F G H\n1 BASIC STATISTICAL FUNCTIONS\n2 Observation X Y\n3 1 35.30 10.98 13 Regression via XY Plot\n4 2 29.70 11.13\n5 3 30.80 12.51 12\n6 4 58.80 8.40\n7 5 61.40 9.27 11\n8 6 71.30 8.73\n9 7 74.40 6.36 10\n10 8 76.70 8.50\n11 9 70.70 7.82 9\n12 10 57.50 9.14 y = -0.089x + 14.328\n13 8 R\u00b2 = 0.8189\n14 7\n15\n16 6\n17 25 35 45 55 65 75 85\n18\n19 Average 56.66 9.28<-- =AVERAGE(C3:C12) Correlation -0.9049<-- =CORREL(B2:B12,C2:C12)\n20 Sample variance 334.15 3.23<-- =VAR(C3:C12) Covariance 40.4206<-- =COVAR(B19:B29,C19:C29)\n21 334.15 3.23<-- =VAR.S(C3:C12) 44.4627<-- =COVARIANCE.S(B19:B29,C19:C29)\n22 Population variance 300.73 2.91<-- =VARP(C3:C12) 40.4206<-- =COVARIANCE.P(B19:B29,C19:C29)\n23 300.73 2.91<-- =VAR.P(C3:C12)\n24 Sample standard deviation 18.28 1.80<-- =STDEV(C3:C12) Regression intercept 14.3285<-- =INTERCEPT(C3:C12,B3:B12)\n25 18.28 1.80<-- =SQRT(C21) Regression slope -0.0890<-- =SLOPE(C3:C12,B3:B12)\n26 18.28 1.80<-- =STDEV.S(C3:C12) Regression r-squared 0.8189<-- =RSQ(C3:C12,B3:B12)\n27 Population standard deviation 17.34 1.71<-- =STDEVP(C3:C12)\n28 17.34 1.71<-- =SQRT(C22)\n29 17.34 1.71<-- =STDEV.P(C3:C12)\nThe functions Varp , Var.p , Stdevp, and Stdev.p calculate the population\nvariance and standard deviation, whereas the functions V ar, Stdev , Var.s ,\nStdev.s compute the sample variance and standard deviation. The difference\nbetween these two functions is that Varp assumes that your data are the whole\npopulation and thus divides by the number of data points, whereas V ar assumes\nthat the data are samples from the distribution:\nVarp( x,\u2026,x )= 1 \u2211N ( x \u2212Average( x,\u2026,x ))2\n1 N N i 1 N\ni=1\nStdevp( x,\u2026,x )== Varp( x,\u2026,x )\n1 N 1 N\nVar( x,\u2026,x )= 1 \u2211\u2211N ( x \u2212Average( x,\u2026,x ))2\n1 N N\u22121 i 1 N\ni=1\nStdev( x,\u2026,x )= Var( x,\u2026,x )\n876 Chapter 33\nCovar, Covariance.s, Covariance.p, and Correl\nT hese functions\u2014used extensively in the portfolio chapters (8\u201313)\u2014are used\nto compute the covariance and correlation of two series of numbers. The func-\ntions C ovariance.s and Covariance.p (computing the sample and the popula-\ntion covariance respectively) are new with Excel 2013. For the definitions, we\nrefer you to section 8.2. Below is an example in which we compute the covari-\nance and correlation for returns on McDonald \u2019 s stock and Wendy \u2019 s stock. Note\nthe two computations for the correlation. In the first (cell E9) we use the Excel\nCorrel function; in cell E10 we use the definition correlation = Correlation\n(MCD, WEN) = Covar (MCD, WEN) / (\u03c3 * \u03c3 ) . The function C ovar is\nMCD WEN\nthe population covariance (that is, divides by 1/M , where M is the population\nsize). Cells E11 and E12 give two more variations to the calculation of the\ncorrelation.\nA B C D E F\nCOMPUTING COVARIANCE AND CORRELATION\nFOR MCDONALD'S (MCD) AND WENDY'S (WEN)\nHighlighted cells are new functions with Excel 2013\n1\n2 Date MCD WEN Covariance\n3 1-Aug-05 4.01% -8.97% 0.00085<-- =COVAR(B3:B26,C3:C26)\n4 1-Sep-05 3.14% -4.30% 0.00085<-- =COVARIANCE.P(B3:B26,C3:C26)\n5 3-Oct-05 -5.78% 3.42% 0.00085<-- =COVARIANCE.P(B3:B26,C3:C26)\n6 1-Nov-05 8.89% 8.71% 0.00089<-- =COVARIANCE.S(B3:B26,C3:C26)\n7 1-Dec-05 -0.36% 8.44%\n8 3-Jan-06 3.76% 6.47% Correlation\n9 1-Feb-06 -0.29% -1.52% 0.36204<-- =CORREL(B3:B26,C3:C26)\n10 1-Mar-06 -1.60% 6.97% 0.36204<-- =COVAR(B3:B26,C3:C26)/(STDEVP(B3:B26)*STDEVP(C3:C26))\n11 3-Apr-06 0.62% -0.45% 0.36204<-- =COVARIANCE.P(B3:B26,C3:C26)/(STDEV.P(B3:B26)*STDEV.P(C3:C26))\n12 1-May-06 -4.14% -2.20% 0.36204<-- =COVARIANCE.S(B3:B26,C3:C26)/(STDEV.S(B3:B26)*STDEV.S(C3:C26))\n13 1-Jun-06 1.29% -3.35%\n14 3-Jul-06 5.20% 3.17%\n15 1-Aug-06 1.41% 6.29%\n16 1-Sep-06 8.61% 4.74%\n17 2-Oct-06 6.90% 9.76%\n18 1-Nov-06 2.53% -5.79%\nComputing Statistics for a Database\nExcel has a whole family of statistical functions that works on databases.\nThese functions all start with the letter \u201cD\u201d (for \u201cdata,\u201d get it?). The list\nincludes DAverage , DCount , DMin , DVar ( the sample variance), DVarP (the\npopulation variance), DStdev , and DStevP. There are more, but we\u2019 l l leave\n877 Excel Functions\nT o see how these functions work, consider the following example: We have\na set of monthly stock prices and returns for Apple. Suppose we want to cal-\nculate the average return of all the returns that are greater than 10%:\nA B C D E F G H I\n1 MANIPULATING APPLE STOCK RETURNS, PRICES USING DAVERAGE, DVAR, etc.\n2 Criterion range (2 rows)\n3 Date AAPL Return Date AAPL Return\n4 7-Sep-01 7.69 >10%\n5 1-Oct-01 8.70 12.34%<-- =LN(B5/B4)\n6 1-Nov-01 10.56 19.38% Average 15.38%<-- =DAVERAGE(A3:C140,3,F3:H4)\n7 3-Dec-01 10.85 2.71% Variance 0.0021<-- =DVAR(A3:C140,3,F3:H4)\n8 2-Jan-02 12.25 12.14% Sigma 4.55%<-- =DSTDEV(A3:C140,3,F3:H4)\n9 1-Feb-02 10.75 -13.06%\n10 1-Mar-02 11.73 8.72%\n11 1-Apr-02 12.03 2.53%\nLooking at the above example, we see that there are three parts:\n\u2022 The database is in cells A3:C140. It has headers Date , AAPL , Return .\n\u2022 There is a two-row Criterion range: The top row matches the headers of\nthe database, and the bottom row has \u201c> 10%\u201d under Return .\n\u2022 Now the functions: DAverage(A3:C140,3,F3:H4) computes the average for\nall returns that are greater than 10%. DVar with the arguments computes the\npopulation variance, and D Stdev \u2026\nIf you change the criterion range, you get a different answer:\nF G H I\n2 Criterion range (2 rows)\n3 Date AAPL Return\n4 <9%\n5\n6 Average -1.71% <-- =DAVERAGE(A3:C140,3,F3:H4)\n7 Variance 0.0078 <-- =DVAR(A3:C140,3,F3:H4)\n878 Chapter 33\nAdvanced Use of the \u201cD\u201d Functions\nS uppose we want to know the statistics for Apple\u2019 s returns for a specific year.\nHere \u2019 s the trick:\nF G H I\n2 Criterion range (2 rows)\nAAPL\nstock\n3 Date price Return\n4 >38353 <-- =\">\"&TEXT(G11,\"0\")\n5\n6 Average 2.88% <-- =DAVERAGE(A3:C140,3,F3:H4)\n7 Variance 0.0114 <-- =DVAR(A3:C140,3,F3:H4)\n8 Sigma 10.67% <-- =DSTDEV(A3:C140,3,F3:H4)\n9\n10\n11 Date 01-Jan-05\nW e\u2019 v e put the date in cell G11, and used the Text function to create an\nappropriate criterion under the D ate header.\nO ne more example and we leave the rest to you. We want to find Apple\u2019 s\nreturn statistics for each of the years. We expand the database and the criterion\nrange by adding in the year. A single example for 2001 shows the average\nreturn and sigma for that year to be 11.47% and 3.47%. 5 Running a data table\nwith Year as the parameter to be varied gives the results below:\n879 Excel Functions\nA B C D E F G H I J K\n1 FINDING APPLE'S YEAR-BY-YEAR RETURN STATISTICS\n2 Criterion range below\nAAPL AAPL\nstock stock\n3 Date price Return Year Date price Return Year\n4 7-Sep-01 7.69 2001\n5 1-Oct-01 8.70 12.34% 2001<-- =YEAR(A5)\n6 1-Nov-01 10.56 19.38% 2001 Average 11.47%<-- =DAVERAGE(A3:D140,3,G3:J4)\n7 3-Dec-01 10.85 2.71% 2001 Sigma 8.37%<-- =DSTDEV(A3:D140,3,G3:J4)\n8 2-Jan-02 12.25 12.14% 2002\n9 1-Feb-02 10.75 -13.06% 2002 Data base: vary the year in criterion range\n10 1-Mar-02 11.73 8.72% 2002 Average Sigma\n11 1-Apr-02 12.03 2.53% 2002 <-- =H7, data base header\n12 1-May-02 11.55 -4.07% 2002 2001 11.47% 8.37%\n13 3-Jun-02 8.78 -27.42% 2002 2002 -3.53% 11.42%\n14 1-Jul-02 7.56 -14.96% 2002 2003 3.33% 9.11%\n15 1-Aug-02 7.31 -3.36% 2002 2004 9.19% 10.56%\n16 3-Sep-02 7.19 -1.66% 2002 2005 6.69% 10.75%\n17 1-Oct-02 7.96 10.17% 2002 2006 1.38% 10.80%\n18 1-Nov-02 7.68 -3.58% 2002 2007 7.07% 7.69%\n19 2-Dec-02 7.10 -7.85% 2002 2008 -7.02% 18.29%\n20 2-Jan-03 7.12 0.28% 2003 2009 7.53% 5.85%\n21 3-Feb-03 7.44 4.40% 2003 2010 3.55% 7.51%\n22 3-Mar-03 7.01 -5.95% 2003 2011 1.90% 5.62%\n23 1-Apr-03 7.05 0.57% 2003 2012 2.35% 8.56%\n24 1-May-03 8.90 23.30% 2003\n25 2-Jun-03 9.45 6.00% 2003 AAPL Returns 2001-2012\n26 1-Jul-03 10.45 10.06% 2003 20%\n27 1-Aug-03 11.21 7.02% 2003\n28 2-Sep-03 10.27 -8.76% 2003 15%\n29 1-Oct-03 11.34 9.91% 2003\n30 3-Nov-03 10.36 -9.04% 2003 10%\n31 1-Dec-03 10.59 2.20% 2003\n5%\n32 2-Jan-04 11.18 5.42% 2004\n33 2-Feb-04 11.85 5.82% 2004 0%\n34 1-Mar-04 13.40 12.29% 2004 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012\n35 1-Apr-04 12.78 -4.74% 2004 -5%\n36 3-May-04 13.91 8.47% 2004\n37 1-Jun-04 16.13 14.81% 2004 -10%\n38 1-Jul-04 16.03 -0.62% 2004 Average Sigma\n39 2-Aug-04 17.09 6.40% 2004\n40 1-Sep-04 19.20 11.64% 2004"
        ],
        "33.6": [
            "What are the techniques to produce Ordinary Least Squares regression with Excel?\nWhat is the purpose of the Intercept function in Excel?\nHow are Slope, Intercept, and Rsq functions used in a simple regression model in Excel?\nHow can you produce a simple regression model using a scatter plot and trendline in Excel?\nWhat is the process of using an XY Scatter Chart to create a regression model in Excel?\nHow do you plot data using an XY scatter chart in Excel?\nWhat is the purpose of the Trendline function in Excel?\nWhat is the process of using Data Analysis for Regressions in Excel?\nHow does the Data Analysis add-in for Excel assist in creating regressions?\nHow are the intercept, slope, and R2 calculated using Excel functions?\nCan the Data Analysis module in Excel be used for multiple regressions?\nWhat is the Index function in Excel and how does it work?\nHow is the Index function used along with Linest to create a regression model in Excel?\nWhat is the function of the Linest tool in Excel?\nWhat are the key elements in the output of the Linest function in Excel?\nHow to perform a t-test on the slope using Excel functions?\nHow is the Linest function used for multiple regressions in Excel?\nWhat is the significance of multiple regressions in Excel?\nWhat is the difference between a simple regression and a multiple regression in Excel?\nHow are the actual and the predicted y-values compared using Excel functions?\nWhat is the equation for multiple regression in Excel?\nWhat does R-squared indicate in a regression model in Excel?",
            "33.6 Regressions with Excel\n\nThere are several techniques to produce an ordinary least squares regression\nwith Excel. We illustrate three techniques using the McDonald\u2019 s and Wendy\u2019 s\n880 Chapter 33\nA B C D E F G H I J K\n1 REGRESSING WEN ON MCD\n2 Date MCD WEN\n3 1-Aug-05 4.01% -8.97%\n4 1-Sep-05 3.14% -4.30% 20%\n5 3-Oct-05 -5.78% 3.42%\n6 1-Nov-05 8.89% 8.71% 15%\n7 1-Dec-05 -0.36% 8.44%\n8 3-Jan-06 3.76% 6.47% 10%\n9 1-Feb-06 -0.29% -1.52%\n10 1-Mar-06 -1.60% 6.97% 5%\n11 3-Apr-06 0.62% -0.45%\n12 1-May-06 -4.14% -2.20% 0%\n-8% -6% -4% -2% 0% 2% 4% 6% 8% 10%\n13 1-Jun-06 1.29% -3.35%\n-5%\n14 3-Jul-06 5.20% 3.17%\n15 1-Aug-06 1.41% 6.29%\n-10%\n16 1-Sep-06 8.61% 4.74%\n17 2-Oct-06 6.90% 9.76% -15%\n18 1-Nov-06 2.53% -5.79%\n19 1-Dec-06 5.47% 1.59% Regression using functions\n20 3-Jan-07 0.05% 2.58% Intercept 0.0038<-- =INTERCEPT(C3:C26,B3:B26)\n21 1-Feb-07 -1.50% -5.51% Slope 0.6381<-- =SLOPE(C3:C26,B3:B26)\n22 1-Mar-07 3.07% -2.38% R-squared 0.1311<-- =RSQ(C3:C26,B3:B26)\n23 2-Apr-07 6.92% 18.61%\n24 1-May-07 4.59% 6.57% Note that\n25 1-Jun-07 0.41% -8.80% Intercept 0.0038<-- =AVERAGE(C3:C26)-F21*AVERAGE(B3:B26)\n26 2-Jul-07 3.37% 1.11% Slope 0.6381<-- =COVARIANCE.P(C3:C26,B3:B26)/VAR.P(B3:B26)\n27 0.6381<-- =COVARIANCE.S(C3:C26,B3:B26)/VAR.S(B3:B26)\n28 R-squared 0.1311<-- =CORREL(C3:C26,B3:B26)^2\nUsing Excel Functions\nT he first technique involves the functions Slope , Intercept, and Rsq ; these\nfunctions give the parameters for a simple regression of the data in column B\non column C. Using these numbers, the best linear explanation of the relation\nbetween the returns on WEN and MCD is:\nW EN =0.0038+0.6381MCD,R2 =13.11%\nUsing a Scatter Plot and Trendline\nA nother way that we can produce a simple regression is to graph the data in a\nscatter chart and then use the Trendline function to compute the regression.\n\u2022 First plot the data using an XY Scatter Chart .\n\u2022 Click the data and then go to Add Trendline . The menu of regressions is\ngiven below the picture that follows this bullet.\nNEW\nXY Sca(cid:2)er Chart: WEN vs MCD\n881 Excel Functions\nHere \u2019 s the menu. We \u2019 ve indicated that we want a linear regression and\n882 Chapter 33\n20%\ny = 0.6381x + 0.0038\n15%\nR\u00b2 = 0.1311\n10%\n5%\n0%\n-8% -6% -4% -2% 0% 2% 4% 6% 8% 10%\n-5%\n-10%\n-15%\nUsing Data Analysis for Regressions\nUsing the same data as before, we press Data|Data Analysis|Regression .6 In\nthe picture below, we\u2019 v e asked that the output be put in cell E4:\nNEW\nHere \u2019 s the final result:\nXY Sca(cid:425)er Chart: WEN vs MCD\nMCD\n6. This procedure is available only if you \u2019 ve installed the Data Analysis add-in. If you don \u2019 t see\nData Analysis on your Excel Data menu, go to File|Options|Add-Ins. At the bottom of the\nresulting screen, indicate Manage Add-Ins. On the next screen put a checkmark next to A nalysis\n883 Excel Functions\nHere \u2019 s the output. We have highlighted cells corresponding to the intercept,\nslope, and R2 as computed by the relevant Excel functions:\nA B C D E F G H I J K\nREGRESSING WEN ON MCD: Using Data|Data Analysis|Regression\n1\n2 Date MCD WEN\n3 1-Aug-05 4.01% -8.97%\n4 1-Sep-05 3.14% -4.30% SUMMARY OUTPUT\n5 3-Oct-05 -5.78% 3.42%\n6 1-Nov-05 8.89% 8.71% Regression Statistics\n7 1-Dec-05 -0.36% 8.44% Multiple R 0.3620\n8 3-Jan-06 3.76% 6.47% R Square 0.1311\n9 1-Feb-06 -0.29% -1.52% Adjusted R Square 0.0916\n10 1-Mar-06 -1.60% 6.97% Standard Error 0.0627\n11 3-Apr-06 0.62% -0.45% Observations 24\n12 1-May-06 -4.14% -2.20%\n13 1-Jun-06 1.29% -3.35% ANOVA\n14 3-Jul-06 5.20% 3.17% df SS MS F Significance F\n15 1-Aug-06 1.41% 6.29% Regression 1 0.0131 0.0131 3.3186 0.0821\n16 1-Sep-06 8.61% 4.74% Residual 22 0.0865 0.0039\n17 2-Oct-06 6.90% 9.76% Total 23 0.0996\n18 1-Nov-06 2.53% -5.79%\n19 1-Dec-06 5.47% 1.59% Coefficients Standard Error t Stat P-value Lower 95% Upper 95%\n20 3-Jan-07 0.05% 2.58% Intercept 0.0038 0.0152 0.2477 0.8067 -0.0278 0.0354\n21 1-Feb-07 -1.50% -5.51% X Variable 1 0.6381 0.3503 1.8217 0.0821 -0.0883 1.3644\n22 1-Mar-07 3.07% -2.38%\n23 2-Apr-07 6.92% 18.61%\n24 1-May-07 4.59% 6.57% Intecept 0.0038<-- =INTERCEPT(C3:C26,B3:B26)\n25 1-Jun-07 0.41% -8.80% Slope 0.6381<-- =SLOPE(C3:C26,B3:B26)\n884 Chapter 33\nUsing Data Analysis|Regression for Multiple Regressions\nT he same module can be used for multiple regressions. In the picture below,\nwe \u2019 ve asked that the output be placed in cell F3:\nHere \u2019 s the output. Highlighted cells correspond to the most important values\nproduced in the previous example.\nF G H I J K L M N\n3 SUMMARY OUTPUT\n4\n5 Regression Statistics\n6 Multiple R 0.9589\n7 R Square 0.9196\n8 Adjusted R Square 0.8966\n9 Standard Error 0.5783\n10 Observations 10\n11\n12 ANOVA\nSignificance\n13 df SS MS F F\n14 Regression 2 26.7674 13.3837 40.0228 0.0001\n15 Residual 7 2.3408 0.3344\n16 Total 9 29.1082\n17\nStandard Lower Upper\n18 Coefficients Error t Stat P-value Lower 95% Upper 95% 95.0% 95.0%\n19 Intercept 14.1705 0.6271 22.5967 0.0000 12.6877 15.6534 12.6877 15.6534\n20 X Variable 1 -0.0987 0.0110 -8.9405 0.0000 -0.1248 -0.0726 -0.1248 -0.0726\n885 Excel Functions\nIndex\nT he discussion of the I ndex function belongs in the section on statistics only\nbecause we want to use it in our next subsection. We sometimes want to pick\nan individual value out of an array. In the example below, the range of cells\nA2:C4 contains a mixture of numbers and names. To pick out an individual\nitem from this range, we use = Index(A2:C4,row,column) , where r ow and\ncolumn are relative to the range itself. Thus \u201cHowie\u201d appears in row 2 and\ncolumn 3 of the range A2:C4.\nA B C\nUSING THE INDEX\nFUNCTION\n1\n2 a b 3\n3 Simon 6 Howie\n4 q 7 Jack\n5\n6 Howie <-- =INDEX(A2:C4,2,3)\nIn the next subsection we use the I ndex function to pick out a single item\nin the Linest array.\nUsing Linest\nExcel has an array function L inest whose output consists of a number of\nregression statistics for an ordinary least squares regression.7 Here is a picture\nof the spreadsheet and the L inest dialog box:\n7. There is also an Excel function Logest , whose syntax is exactly the same as that of L inest .\n886 Chapter 33\nLinest is an array function (see next chapter), which means that instead of\n[Enter], we press [Control] + [Shift] + [Enter] at the same time. With the data\nfrom the example above, we can use L inest to produce the following output:\nA B C D\n1 USING LINEST FOR A SIMPLE REGRESSION\n2 Observation X Y\n3 1 35.3 10.98\n4 2 29.7 11.13\n5 3 30.8 12.51\n6 4 58.8 8.4\n7 5 61.4 9.27\n8 6 71.3 8.73\n9 7 74.4 6.36\n10 8 76.7 8.5\n11 9 70.7 7.82\n12 10 57.5 9.14\n13\n14 Linest output\n15 slope intercept\n16 Slope (also =slope(C3:C12,B3:B12) )--> -0.0890 14.3285<-- Intercept\n17 Standard error of slope --> 0.0148 0.8770<-- Standard error of intercept\n18 R2 (also =Rsq(C3:C12,B3:B12) ) --> 0.8189 0.8117<-- Standard error of y values (also =Steyx(C3:C12,B3:B12) )\n19 F statistic --> 36.1825 8 <-- Degrees of freedom\n20 SSxy = Slope*(summed product of observations from means) --> 23.8377 5.2705<-- SSE = Residual sum of squares\n21\n22 Slope -0.0890<-- =INDEX(LINEST(C3:C12,B3:B12,,1),1,1)\n23 Intercept 14.3285<-- =INDEX(LINEST(C3:C12,B3:B12,,1),1,2)\n24 R2 0.8189<-- =INDEX(LINEST(C3:C12,B3:B12,,1),3,1)\n25 t-statistic 16.3376<-- =C23/INDEX(LINEST(C3:C12,B3:B12,,1),2,2)\n26\n27 Slope -0.0890<-- =INDEX(LINEST(C3:C12,B3:B12,,TRUE),1,1)\n28 Standard error of slope 0.0148<-- =INDEX(LINEST(C3:C12,B3:B12,,TRUE),2,1)\n887 Excel Functions\nLinest produces a block of output without column headers or row labels\nwhich identify the output. Excel \u2019 s Help provides a good explanation of the\nmeaning of the output; in the above picture, we have added in the\nexplanations.\nN ote the syntax of this function: L inest(y-range,x-range,constant,\nstatistics) . The y-range is the range of dependent variables and the x-range\nis the range of the independent variables. If c onstant i s omitted (as in the case\nabove) or set to True , then the regression is calculated normally; if c onstant\nis set to False , then the intercept is forced to be zero. If statistics is set to\nTrue (as in the case above), then the range of statistics is calculated; otherwise\nonly the slope and intercept are calculated.\nI ndividual items of this output can be accessed by using the function I ndex\ndiscussed above. Suppose, for example, that we want to do a simple t -test\non the slope; doing this requires us to divide the slope value by its standard\nerror.\nA B C D E F G H I J\n19 Linest output\n20 slope intercept\n21 Slope (also =slope(D4:D13,C4:C13))--> -0.0890 14.3285<-- Intercept\n22 Standard error of slope --> 0.0148 0.8770<-- Standard error of intercept\n23 R2 (also =Rsq(D4:D13,C4:C13) ) --> 0.8189 0.8117<-- Standard error of y values (also =Steyx(D4:D13,C4:C13) )\n24 F statistic --> 36.1825 8 <-- Degrees of freedom\n25 SSxy = Slope*(summed product of observations from means) --> 23.8377 5.2705<-- SSE = Residual sum of squares\n26\n27 Slope -0.0890<-- =INDEX(LINEST(D4:D13,C4:C13,,1),1,1)\n28 Intercept 14.3285<-- =INDEX(LINEST(D4:D13,C4:C13,,1),1,2)\n29 R2 0.8189<-- =INDEX(LINEST(D4:D13,C4:C13,,1),3,1)\n30\n31 Slope -0.0890<-- =INDEX(LINEST(D4:D13,C4:C13,,TRUE),1,1)\n32 S.e. of slope 0.0148<-- =INDEX(LINEST(D4:D13,C4:C13,,TRUE),2,1)\n888 Chapter 33\nMultiple Regressions with Linest\nLinest can also be used to do a multiple regression, as illustrated below:\nA B C D E F\nUSING LINEST TO DO A MULTIPLE REGRESSION\n1\n2 Observation X X Y\n1 2\n3 1 35.3 81.2 10.98\n4 2 29.7 22.5 11.13\n5 3 30.8 77.3 12.51\n6 4 58.8 34.8 8.4\n7 5 61.4 55.1 9.27\n8 6 71.3 124.8 8.73\n9 7 74.4 18.5 6.36\n10 8 76.7 234.6 8.5\n11 9 70.7 22.5 7.82\n12 10 57.5 123.3 9.14\n13\n14 x coeff. x coeff. intercept\n2 1\n15 Slope --> 0.0089 -0.0987 14.1705 <-- Intercept\n16 Standard error --> 0.0030 0.0110 0.6271\n17 R2 --> 0.9196 0.5783 #N/A\n18 F statistic --> 40.0228 7.0000 #N/A\n19 SS xy --> 26.7674 2.3408 #N/A\n20\n21\n22\n23 {=LINEST(E3:E12,C3:D12,,TRUE)}\n889 Excel Functions\nThe predicted versus the actual Y \u2019 s are shown below:\nA B C D E F G H I J K L M N\nUSING LINEST TO DO A MULTIPLE REGRESSION\n1\n2 Observation X1 X2 Y PredictedY\n3 1 35.3 81.2 10.98 11.4071<--=$E$15+$C$15*D3+$D$15*C3\n4 2 29.7 22.5 11.13 11.4394\n5 3 30.8 77.3 12.51 11.8166\n6 4 58.8 34.8 8.4 8.6770 12\n7 5 61.4 55.1 9.27 8.6004 11\n8 6 71.3 124.8 8.73 8.2413\n9 7 74.4 18.5 6.36 6.9932 10\n10 8 76.7 234.6 8.5 8.6817 9\n11 9 70.7 22.5 7.82 7.3937\n12 10 57.5 123.3 9.14 9.5897 8\n13\n14 x2 coeff. x1 coeff. intercept 7\n15 Slope --> 0.0089 -0.0987 14.1705<-- Intercept 6\n16 Standard error --> 0.0030 0.0110 0.6271 5 7 9 11 13\n17 R2 --> 0.9196 0.5783 #N/A Actual Y\n18 F statistic --> 40.0228 7.0000 #N/A\n19 SSxy --> 26.7674 2.3408 #N/A\nThe regression equation is\nY = 14.1705 - 0.0987*x1 + 0.0089*x2\n{=LINEST(E3:E12,C3:D12,,TRUE)}\nThe chart shows the predicted versus the actual Y. If all the\npredictions were exact (i.e., R2 = 100%), then the predicted points\n20 would all fall on the 45-degree line (the dark line)."
        ],
        "33.7": [
            "What are the three functions that allow you to put in conditional statements in Excel?\nCan you explain the syntax of Excel's If statement?\nHow can the If function be used in Excel to produce a certain output based on a condition?\nHow can We use If condition to print texts in Excel?\nWhat are the VLookup and HLookup functions in Excel?\nCan VLookup function be used to introduce a table search in an Excel spreadsheet? If yes, how?\nCan you illustrate an example of the VLookup function in Excel?\nIn the syntax VLookup(lookup_value,table,column), what does each term represent?\nWhat is the importance of having the first column of the lookup table in ascending order while using VLookup function?\nHow is the lookup_value used in the VLookup function?\nHow does the VLookup function determine the applicable row of the table?\nWhat is the role of the column entry in the VLookup function? \nHow are marginal tax rates represented using the VLookup function in Excel?",
            "33.7 Conditional Functions\n\nIf , VLookup, and H Lookup are three functions which allow you to put in\nconditional statements.\nT he syntax of Excel\u2019 s If statement is If(condition,output if condition is\ntrue, output if condition is false) . In the example below, if the initial number\nis B3 < 3, then the desired output is 15. If B3 > 3, then the output is 0:\nY\ndetciderP\nA B C\n1 THE IF FUNCTION\n2 Initialnumber 2\n3 Ifstatement 15<-- =IF(B2<=3,15,0)\n4\n5 Initialnumber 2\n6 If statement Less than or equal to 3 <-- =IF(B5<=3,\"Less than or equal to 3\",\"More than 3\")\nA s you can see in row 6, you can make If print text also, by enclosing the\ndesired text in double quotes. Since VLookup, and H Lookup both have the\n890 Chapter 33\nHLookup for yourself. V Lookup is a way to introduce a table search in your\nspreadsheet. Here is an example: Suppose the marginal tax rates on income\nare given by the table below (i.e., for income less than $8,000, the marginal\ntax rate is 0%; for income above $8,000, the marginal tax rate is 15%). Cell\nB9 illustrates how the function VLookup is used to look up the marginal\ntax rate.\nA B C\n1 VLOOKUP FUNCTION\nTax\n2 Income rate\n3 0 0%\n4 8,000 15%\n5 14,000 25%\n6 25,000 38%\n7\n8 Income 15,000\n9 Tax rate 25% <-- =VLOOKUP(B8,A3:B6,2)\nThe syntax of this function is VLookup(lookup_value,table,column) . The\nfirst column of the lookup table, A3:B6, must be arranged in ascending\n(increasing) order. The l ookup_value , in this case the income of 15,000, is\nused to determine the applicable row of the t able. The row is the first row\nwhose value is < the l ookup_value; in this case, this is the row which starts\nwith 14,000. The c olumn entry determines from which column of the appli-\ncable row the answer is taken; in this case the marginal tax rates are in\ncolumn 2."
        ],
        "33.8": [
            "What does the \"Large\" function in Excel return?\nWhat is the purpose of the \"Rank\" function in Excel?\nHow do you find the kth largest number in an array using Excel?\nWhat does the Excel function 'Rank' return when you specify a number and an array as parameters?\nWhen would you use the 'Percentile' function in Excel and what does it return?\nWhat is the purpose of the 'PercentRank' function in Excel?\nWhat is the result of the 'Large' function when the array is A3:A12 and k is 3?\nWhat is the result of the 'Rank' function when the specific number is 9.27 and the array is A3:A12?\nWhat does the 'Rank' function in Excel return when you specify an additional parameter?\nWhat is the percentile rank when the specific number is 9.27 and the array is A3:A12 in the 'PercentRank' function?\nWhat is the percentile when the percentile rank is 0.8 and the array is A3:A12 in the 'Percentile' function?",
            "33.8 Large and Rank, Percentile, and PercentRank\n\nLarge(array, k) returns thek th largest number of the a rray , and R ank(number,\narray) returns the rank in a rray of number .\n891 Excel Functions\nA B C\nLARGE, RANK, PERCENTILE,\nPERCENTRANK\n1\n2 Data\n3 10.98\n4 11.13\n5 12.51\n6 8.40\n7 9.27\n8 8.73\n9 6.36\n10 8.50\n11 7.82\n12 9.14\n13\n14 Ranking, k 3\n15 K-th largest 10.98 <-- =LARGE(A3:A12,B14)\n16\n17 Specific number 9.27\n18 Rank from top 4 <-- =RANK(B17,A3:A12)\n19 Rank from bottom 7 <-- =RANK(B17,A3:A12,1)\n20\n21 Percentile rank 0.8\n22 Percentile 11.01 <-- =PERCENTILE(A3:A12,B21)\n23\n24 Specific number 9.27\n25 Percentile ranking 0.666 <-- =PERCENTRANK(A3:A12,B24)\nT hus the third-largest number in the range A3:A12 is 10.98 and 9.27 is the\nfourth-largest number in the range A3:A12. If, as in cell B19, you specify an\nadditional parameter in the function Rank, you will see that 9.27 is the sev-\nenth-ranking number from the bottom of the range A3:A12.\nA s illustrated, Excel has similar functions for percentiles: Percentile and\nPercentRank ."
        ],
        "33.9": [
            "What does the Count function in Excel do?\nWhat is the purpose of the CountA function in Excel?\nCan you explain the functionality of the CountIfs function in Excel?\nWhat is the role of AverageIf and AverageIfs functions in Excel?\nWhen would you use the Count function in Excel?\nWhat is the benefit of using the CountA function in Excel?\nHow would you use the CountIfs function in a financial model?\nHow is the AverageIf function used in Excel?\nCan we use AverageIfs function for multiple conditions in Excel? \nIn context of financial modeling, how can the CountIf function be used with set conditions? \nCan you explain how to use the text function in conjunction with the CountIf function in Excel?\nHow does Excel's CountIf function work in the scenario of tracking weekly stock returns?\nWhat is the function of a Data Table in relation to CountIf function in Excel's financial modeling?\nHow would you use the CountIfs function for multiple-criteria counts in Excel?\nIn the context of stock returns, how can the upper and lower cutoff be used in the CountIfs function in Excel? \nWhat is the significance of setting upper and lower cutoffs in using the CountIfs function for multiple-criteria counts?",
            "33.9 Count, CountA, CountIf, CountIfs, AverageIf, AverageIfs\n\nAs their names suggest, all six of these functions count:\n\u2022 Count : Counts the number of numeric entries in a range of cells.\n\u2022 CountA : Counts all the non-blank cells in a range.\n892 Chapter 33\n\u2022 CountIfs : Counts cells depending on multiple conditions.\n\u2022 AverageIf and A verageIfs : Obvious.\nExamples of Count and CountA are given below:\nA B C D E F G\n1 COUNT, COUNTA\n2 Count: Count only numerical values 5<-- =COUNT(E2:G4) 1 two 3\n3 CountA: count all non-blank cells 8<-- =COUNTA(E2:G4) 4 six\n4 seven 8 9\nTo use CountIf we have to specify a condition. The spreadsheet below gives\na year of Merck \u2019 s weekly stock returns (some rows have been hidden):\nA B C D\nUSING COUNTIF ON MERCK'S WEEKLY STOCK\nRETURNS\n1\n2 Number of returns 52<-- =COUNT(C10:C61)\n3 Returns over 2% 13<-- =COUNTIF(C10:C61,\">2%\")\n4\n5 Cutoff 5%\n6 Returns over cutoff 2<-- =COUNTIF(C10:C61,\">\"&TEXT(B5,\"0.00%\"))\n7\nMerck\n8 Date price Return\n9 3-Jan-06 31.82\n10 9-Jan-06 32.15 1.03% <-- =LN(B10/B9)\n11 17-Jan-06 31.94 -0.66%\n12 23-Jan-06 33.33 4.26%\n13 30-Jan-06 33.04 -0.87%\n14 6-Feb-06 32.96 -0.24%\n15 13-Feb-06 34.63 4.94%\n16 21-Feb-06 33.72 -2.66%\n17 27-Feb-06 33.81 0.27%\n18 6-Mar-06 33.76 -0.15%\n19 13-Mar-06 34.61 2.49%\nIn cell B3 we count all stock returns which are over 2%. In cells B5:B6 we\nillustrate a different technique. The cutoff in cell B5 is introduced into C ountIf\nby means of the function Text .8 Changing the entry in cell B5 allows us to\n893 Excel Functions\ncount the number of returns above a certain level. Here is this information in\na Data Table :\nHere is the resulting table:\nA B C D E F G H\nUSING COUNTIF ON MERCK'S WEEKLY STOCK\nRETURNS\n1\n2 Number of returns 52<-- =COUNT(C10:C61)\n3 Returns over 2% 13<-- =COUNTIF(C10:C61,\">2%\") Data table: number of returns above cutoff\n4\n5 Cutoff 5% Cutoff 2<-- =B6, data table header\n6 Returns over cutoff 2<-- =COUNTIF(C10:C61,\">\"&TEXT(B5,\"0.00%\")) 0% 30\n7 1% 21\nMerck\n8 Date price Return 2% 13\n9 3-Jan-06 31.82 3% 8\n10 9-Jan-06 32.15 1.03% <-- =LN(B10/B9) 4% 6\n11 17-Jan-06 31.94 -0.66% 5% 2\n12 23-Jan-06 33.33 4.26% 6% 1\n13 30-Jan-06 33.04 -0.87% 7% 1\n14 6-Feb-06 32.96 -0.24% 8% 1\n15 13-Feb-06 34.63 4.94% 9% 1\n16 21-Feb-06 33.72 -2.66% 10% 0\nOf the 52 weekly returns, 30 are over 0%, 21 over 1%, \u2026\n894 Chapter 33\nA B C\nUSING COUNTIFS FOR MULTIPLE-CRITERIA COUNTS\n1\n2 Lower cutoff 2%\n3 Upper cutoff 4%\n4 One cutoff 13<-- =COUNTIF(C:C,\">2%\")\n5 Multiple cutoffs 7<-- =COUNTIFS(C:C,\"<4%\",C:C,\">2%\")\n6 7<-- =COUNTIFS(C:C,\"<\"&TEXT(B3,\"0%\"),C:C,\">\"&TEXT(B2,\"0%\"))\n7\nMerck\n8 Date price Return\n9 03-Jan-06 31.82\n10 09-Jan-06 32.15 1.03%\n11 17-Jan-06 31.94 -0.66%\n12 23-Jan-06 33.33 4.26%\n13 30-Jan-06 33.04 -0.87%"
        ],
        "33.10": [
            "What is a Boolean function in the context of financial modeling? \nWhat does it mean when Excel returns 'False' or 'True' after executing a Boolean function? \nWhat type of operation results in '0' when multiplying in Excel Boolean functions? \nHow could Boolean functions be used in spreadsheet calculations?\nWhy might Boolean functions be useful in financial modelling? \nWhat does the 'Count' function do in Excel? \nCan you explain the use of the 'CountIf' function in Excel? \nWhat does the 'Sumproduct' function do in Excel? \nHow can the 'Sumproduct' function be used with Boolean functions in financial modelling?\nCan you describe how to determine the average of returns between two bounds using Excel and Boolean functions? \nWhat types of financial problems could be solved using Boolean functions? \nHow can Boolean functions be helpful in analyzing monthly returns in financial modelling?\nHow does Boolean function in Excel let you translate logical operations into values?\nHow does the 'CountIf' function work with upper and lower bound data points in Excel?\nHow can SUMPRODUCT() function be used with Boolean functions to calculate average returns?",
            "33.10 Boolean Functions\n\nW hen you include a question in parentheses, you are setting up a B oolean\nfunction :\nA B C\nBASIC BOOLEAN\nFUNCTIONS\n1\n2 x 22\n3 y -15\n4\n5 Number 25\n6 Is number <= x? FALSE <-- =(B5<=B2)\n7 Is number > y? TRUE <-- =(B5>B3)\n8\n9 Multiplying 0<-- =B6*B7\nIn cell B6 we have written = (B5 < = B2); this asks whether B5 is less than or\nequal to B2: If the answer is positive, Excel returns False, else it returns True .\nMultiplying F alse*True or False*False gives 0 (see cell B9), and multiplying\n895 Excel Functions\nA B C\nBASIC BOOLEAN\n1 FUNCTIONS\n2 x 22\n3 y -15\n4\n5 Number 20\n6 Is number <= x? TRUE <-- =(B5<=B2)\n7 Is number > y? TRUE <-- =(B5>B3)\n8\n9 Multiplying 1<-- =B6*B7\nUsing Boolean Functions\nB oolean functions can be useful in the most unexpected places. In the spread-\nsheet below, the first two columns contain the monthly returns for Marriott for\na 2-year period. The problem we encounter is counting the number of returns\nwhich are between two arbitrary bounds, and taking the average of the returns\nwhich are between these bounds:\nA B C D E F G H\n1 USING BOOLEAN FUNCTIONS\nMarriott\nstock\n2 Date price Return\n3 7-Jan-05 31.20 How many data points? 24<-- =COUNT(C4:C27)\n4 1-Feb-05 31.65 1.43%<-- =LN(B4/B3) Maximal return 8.02%<-- =MAX(C4:C27)\n5 1-Mar-05 33.06 4.36% Minimal return -8.02%<-- =MIN(C4:C27)\n6 1-Apr-05 31.03 -6.34%\n7 2-May-05 33.40 7.36%\n8 1-Jun-05 33.78 1.13% Upper bound 5%\n9 1-Jul-05 33.91 0.38% Lower bound -2%\n10 1-Aug-05 31.30 -8.01%\n11 1-Sep-05 31.25 -0.16% How many < upper bound? 16<-- =COUNTIF(C4:C27,\"<\"&G8)\n12 3-Oct-05 29.58 -5.49% How many > lower bound? 19<-- =COUNTIF(C4:C27,\">\"&G9)\n13 1-Nov-05 32.05 8.02%\nHow many between upper =SUMPRODUCT((C4:C27>G9)*(C4:C27<G8),(C4:\n14 1-Dec-05 33.27 3.74% and lower bounds? 11C27>G9)*(C4:C27<G8))\n15 3-Jan-06 33.11 -0.48%\n=SUMPRODUCT((C4:C27>G9)*(C4:C27<G8),C4:C\nAverage of returns 27)/SUMPRODUCT((C4:C27>G9)*(C4:C27<G8),(C\n16 1-Feb-06 33.98 2.59% between the bounds 1.36%4:C27>G9)*(C4:C27<G8))\n17 1-Mar-06 34.14 0.47%\n18 3-Apr-06 36.36 6.30%\n19 1-May-06 35.99 -1.02%\n20 1-Jun-06 38.00 5.43%\n21 3-Jul-06 35.07 -8.02%\n22 1-Aug-06 37.61 6.99%\n23 1-Sep-06 38.59 2.57%\n24 2-Oct-06 41.71 7.77%\n25 1-Nov-06 45.09 7.79%\n26 1-Dec-06 47.72 5.67%\n896 Chapter 33\nIn cell G3 we use Count to determine the number of returns. Cells G11 and\nG12 use CountIf to determine how many returns are below the upper bound\nin cell G8 and how many are above the lower bound in cell G9. But how many\nof the returns are between the two bounds? You can \u2019 t do it with C ountIf , but\nwe can do it (cell G14) with a trick involving Boolean functions:\n=SUMPRODUCT(((cid:2)C(cid:4)4:C(cid:4)2(cid:4)7> (cid:4)G(cid:4)(cid:4)9)(cid:3)*((cid:4)C4(cid:4):C(cid:4)27(cid:4)< (cid:4)G(cid:4)(cid:5)8),\n\u2191\nCreates a vector of 1\u2019ss where\nthe returns are>lower bound(G9)\nand 0\u2019s where\nthe retturns are<upper bound(G9)\n((cid:2)C(cid:4)4:C(cid:4)2(cid:4)7> (cid:4)G(cid:4)(cid:4)9)(cid:3)\u2217((cid:4)C(cid:4)4:CC(cid:4)2(cid:4)7< (cid:4)G(cid:4)(cid:5)8))\n\u2191\n(cid:2)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)Dit(cid:4)to (cid:4)(cid:4)(cid:3)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:5)\n\u2191\nSumproduct multiplies the twwo vectors and sums the results.\nThis gives the number of ddata points between the two bounds.\nA similar trick is employed in cell G15 to find the average of the returns\nwhich are between the two bounds:\nSUMPRODUCT((C4:C27>G9)\u2217(C4:C27<G8),C4:C27)\n=\nSUMPRODUCT((C4:CC27>G9)\u2217(C4:C27<G8),\n(C4:C27>G9)\u2217(C4:C27<G8))\nNumerator: Mulltiplies vector of 1\u2019s and 0\u2019s times the returns,\nthus sumss the returns which are between the bounds\n=\nCounts the returrns which are between the bounds\nThis is all very tricky, but it is also very useful!"
        ],
        "33.11": [
            "What is the Offset function in Excel used for?\nCan the Offset function in Excel be used independently?\nWhat information does the Offset function in Excel specify?\nIn the Offset function, what does the value in cell B3 indicate?\nIn the Offset function, what does the value in cell B4 indicate?\nWhat are the specifications of the range in Offset function given by the values in cells B6 and B7?\nWhat condition must the values in cells B6 and B7 meet in the Offset function?\nCan the values in cells B3 and B4 in the Offset function be negative?\nWhat happens if the initial reference range in the Offset function starts above the range?\nWhat is the use of the Sum function in conjunction with the Offset function in Excel?",
            "33.11 Offset\n\nThe function O ffset allows us to specify a cell or a block of cells in an array.\nIt cannot be used by itself\u2014rather, it must be part of another Excel function.\nThe example below shows a large array of numbers. We want to sum a four-\nrow, five-column array of the larger array (these numbers are specified in cells\nB6 and B7); as specified in cells B3 and B4, we want this summed array to\nstart to the right and below the third row and the second column of the large\n897 Excel Functions\nA B C D E F G H\n1 USING OFFSET\n2 Starting corner\n3 Rows down 3\n4 Columns over 2\n5 Range to be summed\n6 Number of rows 4\n7 Number of columns 5\n8 Sum 811<-- =SUM(OFFSET(A11:H31,B3,B4,B6,B7))\n9 Check 811<-- =SUM(C14:G17)\n10\n11 89 34 72 42 41 89 75 41\n12 33 6 49 7 62 50 38 17\n13 71 69 42 68 39 75 32 77\n14 1 69 8 79 40 8 67 46\n15 70 12 44 48 88 27 38 51\n16 85 0 23 35 83 30 17 52\n17 30 50 16 28 73 4 55 68\n18 35 56 31 24 15 47 89 88\n19 99 31 55 60 45 24 28 3\n20 93 72 7 75 90 81 52 71\n21 62 56 55 19 73 81 33 76\n22 87 27 80 38 65 61 38 68\n23 10 59 27 81 6 83 51 1\n24 70 88 44 35 70 35 0 82\n25 98 45 17 45 89 19 58 42\n26 83 75 21 13 80 9 18 64\n27 32 23 4 86 88 52 52 69\n28 76 61 72 28 83 1 32 38\n29 64 87 32 67 50 73 19 83\n30 54 55 57 64 80 29 17 92\n31 12 95 66 59 48 78 87 23\nThe function OFFSET(A11:H31,B3,B4,B6,B7) in cell B8 specifies a block\nof cells within the range A11:H31. This range starts three rows below (the\nvalue in cell B3) and t wo columns to the right (the value in cell B4) of the top\nleft-hand cell of the range A11:H31. The range itself is four rows deep (the\nvalue in cell B6) and five columns wide (the value in cell B7).\nT he values in cells B6 and B7 always have to be positive, but the values in\nB3 and B4 can be negative as well as positive. In the example below the initial\nreference range is B22:H31, and Offset indicates a range which starts above\n898 Chapter 33\nA B C D E F G H I\nUSING OFFSET\n1 with negative value\n2 Starting corner\n3 Rows down -5\n4 Columns over 1\n5 Range to be summed\n6 Number of rows 4\n7 Number of columns 5\n8 Sum 899<-- =SUM(OFFSET(B22:H31,B3,B4,B6,B7))\n9 Check 899<-- =SUM(C17:G20)\n10\n11 89 34 72 42 41 89 75 41\n12 33 6 49 7 62 50 38 17\n13 71 69 42 68 39 75 32 77\n14 1 69 8 79 40 8 67 46\n15 70 12 44 48 88 27 38 51\n16 85 0 23 35 83 30 17 52\n17 30 50 16 28 73 4 55 68\n18 35 56 31 24 15 47 89 88\n19 99 31 55 60 45 24 28 3\n20 93 72 7 75 90 81 52 71\n21 62 56 55 19 73 81 33 76\n22 87 27 80 38 65 61 38 68\n23 10 59 27 81 6 83 51 1\n24 70 88 44 35 70 35 0 82\n25 98 45 17 45 89 19 58 42\n26 83 75 21 13 80 9 18 64\n27 32 23 4 86 88 52 52 69\n28 76 61 72 28 83 1 32 38\n29 64 87 32 67 50 73 19 83\n30 54 55 57 64 80 29 17 92\n31 12 95 66 59 48 78 87 23\n32\n34 Array Functions"
        ]
    },
    "34": {
        "34.1": [
            "What is an Excel array function or formula?\nWhat operations can a Excel array function perform?\nCan you design your own array functions in Excel?\nWhat functions can be used to operate on arrays in Excel?\nWhat critical thing should be remembered when entering array functions or formulas into a spreadsheet in Excel?\nWhat is the difference in procedure of entering an array function versus entering a normal function in Excel?\nWhat is the function of Transpose or MMult in Excel?\nHow can array formulas be helpful in doing portfolio calculations?\nHow can you use an array formula to identify the minimum or maximum of the off-diagonal elements of a matrix in Excel?\nWhat is the procedure to pick out the diagonal of a matrix using array formulas in Excel?",
            "34.1 Overview\n\nA n Excel array function or formula performs an operation on a rectangular\nblock of cells. In the simplest cases, built-in Excel array functions such as\nTranspose or MMult take an array and transpose it or take two matrices and\nmultiply them. Once you get the hang of array functions, you can design your\nown array formulas. In this chapter, for example, we show how to use array\nformulas to find the minimum or maximum of the off-diagonal elements of a\nmatrix or to pick out the diagonal of a matrix\u2014all useful tricks to know when\ndoing portfolio calculations such as those discussed in Chapters 8\u201313.\nT he one critical thing to remember about array functions or formulas is that\nthey are entered into a spreadsheet by pressing [Ctrl] + [Shift] + [Enter] keys\nsimultaneously; this contrasts with the usual procedure whereby we enter a\nfunction or formula only by pressing [Enter]."
        ],
        "34.2": [
            "What are some of the built-in Excel array functions discussed in financial modeling?\nWhat is the purpose of the Transpose function in Excel?\nHow do you implement the Transpose function in Excel array functions?\nWhat is the method for transposing an array in Excel without using a function?\nWhat is the difference between the Transpose function and Paste|Paste Special|Transpose in Excel?\nHow do the MMult and MInverse functions in Excel work?\nIn which situations can MMult(range1,range2) and MInverse(range) be used?\nWhat are the requirements for range in MInverse(range) function in Excel?\nWhat is the Frequency function in Excel used for?\nHow is the Excel array function Frequency(data_array,bins_array) applied in analyzing monthly return data for stocks?\nHow does changing the original set of cells affect the output of array functions in Excel?\nWhat insights can be gleaned from the output of the Frequency function in Excel applied to stock return data?\nWhat is the definition and use of a dynamic function in Excel?\nWhat does it mean when an array function is surrounded by curly brackets {} in Excel?\nIn the context of financial modeling, how are MMult and MInverse functions utilized in Excel?\nWhat are the implications of using the Frequency function in analyzing a 20-year period of monthly returns?\nWhat is the implication of changing something in the original range of the Excel Transpose function?\nWhat is the importance of ensuring that the first bin is below the minimum monthly return and the last bin is above the maximum monthly return when using the frequency function in Excel?",
            "34.2 Some Built-In Excel Array Functions\n\nI n this section we discuss some built-in Excel array functions: Transpose ,\nMMult , MInverse , and F requency . Other functions are discussed elsewhere\nin this book\u2014for example, the function L inest is discussed in Chapter 32.\nTranspose\nS uppose we\u2019 r e trying to calculate the transpose of a 3 x 2 (3 rows, 2 columns)\nmatrix that is in cells A2:B4 of the spreadsheet.\nA B\n2 1 5\n3 2 6\n4 3 7\nExcel has a function called Transpose( ) , but, like all array functions, its\nuse requires care:\n\u2022 Mark the target : Block off the cells D3:F4 into which you intend to put\nthe transposed matrix.\n\u2022 Type the array function: Now type = Transpose(A2:B4). This will appear\n900 Chapter 34\nusual tricks to show Excel which cells you want (e.g., pointing or using named\nranges).\nAt this point your spreadsheet looks like this:\n\u2022 [Ctrl] + [Shift] + [Enter]: When you\u2019 v e finished typing the formula, don \u2019 t\npress [Enter]! Instead, use [Ctrl] + [Shift] + [Enter]. This will put the array\nfunction into all of the blocked-off cells.\nHere \u2019 s what the final product will look like:\nA B C D E F G\n1 USING TRANSPOSE\n2 1 5\n3 2 6 1 2 3<-- {=TRANSPOSE(A2:B4)}\n4 3 7 5 6 7\nNotice that the array function is surrounded by curly brackets { }. You don \u2019 t\n901 Array Functions\nPaste|Paste Special|Transpose\nT here is, of course, another way to transpose an array: You can copy the origi-\nnal array, and then use P aste|Paste Special to transpose the range, clicking on\nTranspose :\nT his will transpose the range, but it will not link the original with the\ntarget range\u2014when you change something in the original range, the target\nrange is unchanged. The neat thing about the array function Transpose is\nthat it \u2019 s a dynamic function , as are all the array functions and formulas:\nWhen you change one of the initial set of cells, the transposed array also\n902 Chapter 34\nMMult and MInverse\u2014Multiplying and Inverting Matrices\nT hese two functions are used and explained in the portfolio chapters (8\u201313),\nso we only recapitulate briefly:\n\u2022 MMult(range1,range2) multiplies the matrix in r ange1 times that in\nrange2. Of course this is only possible if the number of columns in range1\nequals the number of rows in range2 .\n\u2022 MInverse(range) calculates the inverse of the matrix in r ange . Note that\nrange must be rectangular.\nFrequency\nThe Excel array function F requency(data_array,bins_array) calculates the\nfrequency distribution of a data set. The spreadsheet below shows monthly\nreturn data for Ford stock over the period January 1977\u2013December 2006. In\ncolumn E we have put the bins, taking care that the first bin will be b elow the\nminimum monthly return over the period and that the last bin will be a bove\nthe maximum monthly return. The range F8:F38 contains the array function\nFrequency (C4:C363,E8:E38). From the output we can, for example, deduce\nthat in the 20-year period there were two monthly returns between \u2212 25.71%\nA B C D E F G H I\n1 THE FREQUENCY ARRAY FUNCTION\nFord\nstock Monthly\n2 Date price return\n3 3-Jan-77 0.50\n4 1-Feb-77 0.48 -4.08%<-- =LN(B4/B3) Minimum -24.71%<-- =MIN(C4:C363)\n5 1-Mar-77 0.45 -6.45% Maximum 32.48%<-- =MAX(C4:C363)\n6 1-Apr-77 0.47 4.35%\n7 2-May-77 0.46 -2.15% Bin Frequency\n8 1-Jun-77 0.50 8.34% -25.71% 0<-- {=FREQUENCY(C4:C363,E8:E38)}\n9 1-Jul-77 0.48 -4.08% -23.71% 2\n10 1-Aug-77 0.47 -2.11% -21.71% 1\n11 1-Sep-77 0.50 6.19% -19.71% 2\n12 3-Oct-77 0.47 -6.19% -17.71% 6\n13 1-Nov-77 0.48 2.11% -15.71% 3\n14 1-Dec-77 0.50 4.08% -13.71% 5\n15 3-Jan-78 0.47 -6.19% -11.71% 8\n16 1-Feb-78 0.47 0.00% -9.71% 10\n17 1-Mar-78 0.51 8.17% -7.71% 18\n18 3-Apr-78 0.58 12.86% -5.71% 23\n19 1-May-78 0.56 -3.51% -3.71% 26\n20 1-Jun-78 0.53 -5.51% -1.71% 35\n21 3-Jul-78 0.53 0.00% 0.29% 35\n22 1-Aug-78 0.51 -3.85% 2.29% 37\n23 1-Sep-78 0.53 3.85% 4.29% 30\n24 2-Oct-78 0.48 -9.91% 6.29% 33\n25 1-Nov-78 0.49 2.06% 8.29% 22\n26 1-Dec-78 0.50 2.02% 10.29% 21\n27 2-Jan-79 0.50 0.00% 12.29% 9\n28 1-Feb-79 0.50 0.00% 14.29% 13\n29 1-Mar-79 0.53 5.83% 16.29% 5\n30 2-Apr-79 0.55 3.70% 18.29% 4\n31 1-May-79 0.53 -3.70% 20.29% 5\n32 1-Jun-79 0.53 0.00% 22.29% 2\n33 2-Jul-79 0.53 0.00% 24.29% 1\n34 1-Aug-79 0.55 3.70% 26.29% 1\n35 4-Sep-79 0.56 1.80% 28.29% 0\n36 1-Oct-79 0.48 -15.42% 30.29% 2\n37 1-Nov-79 0.40 -18.23% 32.29% 0\n38 3-Dec-79 0.42 4.88% 34.29% 1\n39 2-Jan-80 0.45 6.90%\n40 1-Feb-80 0.41 -9.31%\n41 3-Mar-4800 0.39 -5.00%\n37\n42 1-Apr-80 0.34 -13.72%\n43 1-May-80 0.34 0.00% 35 35 Frequency Distribution\n44 2-Jun-3805 0.34 0.00% 33 of Ford Returns\n45 1-Jul-80 0.40 16.25% 30 Jan 1977 - Dec 2006\n46 1-Aug-80 0.39 -2.53%\n30\n47 2-Sep-80 0.39 0.00%\n48 1-Oct-80 0.37 -5.26% 26\n4 59\n0\n13 -- DN eo cv --2 88 005 00 .. 23 92 -1 -94 .. 85 42 %%\n23 22\n51 2-Jan-81 0.29 0.00% 21\n52 2-Feb-2810 0.29 0.00%\n18\n53 2-Mar-81 0.35 18.81%\n54 1-Apr-81 0.32 -8.96%\n55 1-May-1815 0.34 6.06% 13\n56 1-Jun-81 0.35 2.90%\n57 1-Jul-81 0.32 -8.96% 10\n58 3-Aug-1810 0.30 -6.45% 8 9\n59 1-Sep-81 0.30 60.00%\n60 1-Oct-81 0.25 -18.23% 5 5 5\n61 2-Nov-815 0.25 0.003% 4\n62 1-Dec-81 2 01.252 0.00% 2 1 1 2 1\n63 4-Jan-82 0.28 11.33% 0 0\n64 1-Feb-820 0.29 3.51%\n65 1-Mar-82 0.32 9.84%\n66 1-Apr-82 0.34 6.06%\n67 3-May-82 0.35 2.90% 68 1-Jun-82 0.37 5.56%\n69 1-Jul-82 0.34 -8.46%\n70 2-Aug-82 0.42 21.13%\n71 1-Sep-82 0.39 -7.41%\n-25.7%\n- -23.7%\n-23.7%\n- -21.7%\n-21.7%\n- -19.7%\n-19.7%\n- -17.7%\n-17.7%\n- -15.7%\n-15.7%\n- -13.7%\n-13.7%\n- -11.7%\n-11.7%\n- -9.7%\n-9.7%\n- -7.7%\n-7.7%\n- -5.7%\n-5.7%\n- -3.7%\n-3.7%\n- -1.7%\n-1.7%\n- 0.3%\n0.3%\n- 2.3%\n2.3%\n- 4.3%\n4.3%\n- 6.3%\n6.3%\n- 8.3%\n8.3%\n- 10.3%\n10.3%\n- 12.3%\n12.3%\n- 14.3%\n14.3%\n- 16.3%\n16.3%\n- 18.3%\n18.3%\n- 20.3%\n20.3%\n- 22.3%\n22.3%\n- 24.3%\n24.3%\n- 26.3%\n26.3%\n- 28.3%\n28.3%\n- 30.3%\n30.3%\n- 32.3%\n32.3%\n904 Chapter 34"
        ],
        "34.3": [
            "What are array functions in financial modeling? \nWhat is the reason behind using array functions in financial modeling? \nCan you explain a situation where array functions would be useful in financial modeling? \nWhat is an example of a homemade array function based on investment returns? How does it work? \nWhat are the steps involved in computing the Compound Annual Return from 10 years of return data using array functions in Excel? \nWhat is the purpose of the Excel function Product in the context of computing the Compound Annual Return? \nWhat is meant by the term \"continuous compounded return\"? \nHow can array functions be used to compute the compound annual continuous return? \nCan you describe the process of computing the compound annual return with continuous compounding using array functions? \nWhat is the role of the logarithm function in calculating the average return over the period in array functions? \nWhat are discount factors and how can they be computed using an array function? \nHow can interest rates be managed when computing discount factors with an array function?\nWhat does a recursive formula mean in the context of checking results derived from array functions?\nWhat is the reason for using sum in array function while computing present value factors?\nWhat does ((1 + B3:B7) ^ A3:A7) signify in array functions? \nCan you explain how to build an array function when Excel's NPV function doesn't work?\nWhat is the significance of 'entering it with [Ctrl] + [Shift] + [Enter]' when dealing with array functions in Excel?",
            "34.3 Homemade Array Functions\n\nIn our experience array functions often arise out of situations where you are\ncalled upon to do long, repetitive calculations. You then discover that the same\ncalculation can be done in a single array function. In many cases it is not clear\nwhy a particular array technique should work. For example, in this chapter we\nwill use the fact that A3 + B6:B8 adds the contents of cell A3 to each of cells\nB6:B8. Why? Heaven only knows! We also use the (undocumented, as far as\nwe are aware) trick that B3:B7\u2227 A3:A7 raises cell B3 to the power A3, cell\nB4 to the power A4, \u2026 .\nI n this section we illustrate homemade array functions with two examples\nhaving to do with investment returns.\nComputing the Compound Annual Return from 10 Years of Return Data\nT he table below gives the annual returns for the Harvard University\nendowment. You are asked to compute the compound annual return over the 10-\nyear period. Assuming that the returns have been discretely computed\nEndowmentvalue\n(meaning that r = t ,t=1,\u2026,10) , you realize that the\nt Endowmentvalue\nt\u22121\ncompounded annual return is r=(( 1+r )\u2217( 1+r )\u2026\u2217( 1+r ))1/10\u22121 . In\n2002 2003 2011\ncell B14 below, we do this calculation with a single array function:\nA B C\nHARVARD UNIVERSITY ENDOWMENT RETURNS\nYears ending June 30\n1\n2 Year Return\n3 2002 -0.50%\n4 2003 12.50%\n5 2004 21.20%\n6 2005 19.20%\n7 2006 16.70%\n8 2007 23.00%\n9 2008 8.60%\n10 2009 -27.30%\n11 2010 11.40%\n12 2011 21.40%\n13\n14 Compound annual return 9.50%<-- {=PRODUCT(1+B3:B12)^(1/10)-1}\nThe Excel function Product multiplies the entries in a range of cells. The\n905 Array Functions\ntenth root, and subtracts 1 from the result\u2014all in one cell (entered, of course,\nwith [Ctrl] + [Shift] +[Enter]). 1\nComputing the Compound Annual Continuous Return\nColumn B of the spreadsheet below gives the amounts which accumulated\nin a customer account of the Youngtalk Investment Fund. The annual\n\u239b Account \u239e\ncontinuously compounded return is computed by r =ln\u239c t \u239f , and\nt \u239d Account \u23a0\nt\u22121\n1 \u221110\nthe average return over the period is r . In cell B15 below we do this\n10 t\nt=1\ncalculation by averaging the annual returns, and in cell B16 we show an array\nfunction which does the whole calculation in a single cell. Pretty neat!\n(cid:36) (cid:37) (cid:38) (cid:39)\nYOUNGTALK INVESTMENT FUND\n(cid:20)\nInvestment Continuous\nYear beginning of return for\n(cid:21) year year\n(cid:22) (cid:20)(cid:28)(cid:28)(cid:25) (cid:20)(cid:19)(cid:19)(cid:17)(cid:19)(cid:19)\n(cid:23) (cid:20)(cid:28)(cid:28)(cid:26) (cid:20)(cid:21)(cid:20)(cid:17)(cid:24)(cid:20) (cid:20)(cid:28)(cid:17)(cid:23)(cid:27)(cid:8)(cid:31)(cid:16)(cid:16)(cid:3)(cid:3)(cid:32)(cid:47)(cid:49)(cid:11)(cid:37)(cid:23)(cid:18)(cid:37)(cid:22)(cid:12)\n(cid:24) (cid:20)(cid:28)(cid:28)(cid:27) (cid:20)(cid:22)(cid:21)(cid:17)(cid:21)(cid:21) (cid:27)(cid:17)(cid:23)(cid:24)(cid:8)\n(cid:25) (cid:20)(cid:28)(cid:28)(cid:28) (cid:28)(cid:27)(cid:17)(cid:25)(cid:22) (cid:16)(cid:21)(cid:28)(cid:17)(cid:22)(cid:20)(cid:8)\n(cid:26) (cid:21)(cid:19)(cid:19)(cid:19) (cid:26)(cid:24)(cid:17)(cid:25)(cid:24) (cid:16)(cid:21)(cid:25)(cid:17)(cid:24)(cid:22)(cid:8)\n(cid:27) (cid:21)(cid:19)(cid:19)(cid:20) (cid:20)(cid:23)(cid:19)(cid:17)(cid:23)(cid:27) (cid:25)(cid:20)(cid:17)(cid:28)(cid:19)(cid:8)\n(cid:28) (cid:21)(cid:19)(cid:19)(cid:21) (cid:21)(cid:21)(cid:20)(cid:17)(cid:23)(cid:19) (cid:23)(cid:24)(cid:17)(cid:23)(cid:28)(cid:8)\n(cid:20)(cid:19) (cid:21)(cid:19)(cid:19)(cid:22) (cid:21)(cid:23)(cid:22)(cid:17)(cid:23)(cid:25) (cid:28)(cid:17)(cid:24)(cid:19)(cid:8)\n(cid:20)(cid:20) (cid:21)(cid:19)(cid:19)(cid:23) (cid:21)(cid:27)(cid:19)(cid:17)(cid:20)(cid:20) (cid:20)(cid:23)(cid:17)(cid:19)(cid:21)(cid:8)\n(cid:20)(cid:21) (cid:21)(cid:19)(cid:19)(cid:24) (cid:22)(cid:28)(cid:27)(cid:17)(cid:26)(cid:21) (cid:22)(cid:24)(cid:17)(cid:22)(cid:20)(cid:8)\n(cid:20)(cid:22) (cid:21)(cid:19)(cid:19)(cid:25) (cid:24)(cid:23)(cid:22)(cid:17)(cid:24)(cid:27) (cid:22)(cid:19)(cid:17)(cid:28)(cid:28)(cid:8)\n(cid:20)(cid:23)\n(cid:20)(cid:24) (cid:38)(cid:82)(cid:80)(cid:83)(cid:82)(cid:88)(cid:81)(cid:71)(cid:3)(cid:68)(cid:81)(cid:81)(cid:88)(cid:68)(cid:79)(cid:3)(cid:85)(cid:72)(cid:87)(cid:88)(cid:85)(cid:81) (cid:20)(cid:25)(cid:17)(cid:28)(cid:22)(cid:8)(cid:31)(cid:16)(cid:16)(cid:3)(cid:3)(cid:32)(cid:36)(cid:57)(cid:40)(cid:53)(cid:36)(cid:42)(cid:40)(cid:11)(cid:38)(cid:23)(cid:29)(cid:38)(cid:20)(cid:22)(cid:12)\n(cid:54)(cid:68)(cid:80)(cid:72)(cid:3)(cid:70)(cid:68)(cid:79)(cid:70)(cid:88)(cid:79)(cid:68)(cid:87)(cid:76)(cid:82)(cid:81)(cid:3)(cid:90)(cid:76)(cid:87)(cid:75)\n(cid:20)(cid:25) (cid:68)(cid:85)(cid:85)(cid:68)(cid:92)(cid:3)(cid:73)(cid:88)(cid:81)(cid:70)(cid:87)(cid:76)(cid:82)(cid:81) (cid:20)(cid:25)(cid:17)(cid:28)(cid:22)(cid:8)(cid:31)(cid:16)(cid:16)(cid:3)(cid:3)(cid:94)(cid:32)(cid:36)(cid:57)(cid:40)(cid:53)(cid:36)(cid:42)(cid:40)(cid:11)(cid:47)(cid:49)(cid:11)(cid:37)(cid:23)(cid:29)(cid:37)(cid:20)(cid:22)(cid:18)(cid:37)(cid:22)(cid:29)(cid:37)(cid:20)(cid:21)(cid:12)(cid:12)(cid:96)\n(cid:20)(cid:26) (cid:20)(cid:25)(cid:17)(cid:28)(cid:22)(cid:8)(cid:31)(cid:16)(cid:16)(cid:3)(cid:3)(cid:32)(cid:47)(cid:49)(cid:11)(cid:37)(cid:20)(cid:22)(cid:18)(cid:37)(cid:22)(cid:12)(cid:18)(cid:20)(cid:19)(cid:3)(cid:15)(cid:3)(cid:72)(cid:89)(cid:72)(cid:81)(cid:3)(cid:86)(cid:76)(cid:80)(cid:83)(cid:79)(cid:72)(cid:85)(cid:4)\n1. There is nothing in Excel documentation that indicates why this marvelous feature should work.\n906 Chapter 34\nA final note: Look at cell C17\u2014if you know some continuous-time\nmathematics, you will know that LN(B13/B3)/10 produces the same result.\nSimpler yet!\nComputing Discount Factors with an Array Function\nWe are given a set of interest rates r , r , \u2026 , and we want to compute the\n1 2\n\u2211n 1\nformula . Excel \u2019 s NPV function won\u2019 t work for this, so we\u2019 l l have\n( 1+r)t\nt=1 t\nto build our own function. The spreadsheet below shows two methods:\nA B C D\nCOMPUTING PRESENT VALUE FACTORS\nWITH AN ARRAY FUNCTION\n1\nInterest\nYear\n2 rate\n3 1 6.23%\n4 2 4.00%\n5 3 4.20%\n6 4 4.65%\n7 5 4.80%\n8\n9 Present value 4.3746<-- {=SUM(1/((1+B3:B7)^A3:A7))}\n10\n11 Checking the formula with a recursive formula\nInterest\n12 Year rate Sum of 1/(1+rt)t\n13 1 6.23% 0.9414 <-- =1/(1+B13)^A13\n14 2 4.00% 1.8659 <-- =C13+(1/(1+B14)^A14)\n15 3 4.20% 2.7498 <-- =C14+(1/(1+B15)^A15)\n16 4 4.65% 3.5836\n17 5 4.80% 4.3746 <-- =C16+(1/(1+B17)^A17)\nI n cell B9 we use an array function { = SUM(1/((1 + B3:B7) (cid:3578) A3:A7))} .\nWriting (1+ B3:B7) \u2227A 3:A7) adds 1 to each of cells B3:B7 and raises the result\nto the power in cells A3:A7. Applying Sum gives the result (of course, this\nbeing an array function, you have to enter it with [Ctrl] + [Shift] + [Enter]).\nA n alternative, given in rows 13\u201317, is to build the result recursively. This\n907 Array Functions"
        ],
        "34.4": [
            "What is an array formula in financial modeling?\nWhat role do matrices play in array functions?\nHow do you subtract a constant from a matrix in financial modeling?\nWhat are the steps to create an array formula with matrices?\nHow do you create a matrix with ones on the diagonal and zeros elsewhere?\nWhat kinds of formulas can be used to create a matrix of 1's and 0's?\nHow can Column and Row functions be used in Excel for financial modeling?\nWhat steps can be taken to find the maximum and minimum off-diagonal elements of a matrix?\nHow can the MAX and MIN functions be used in array formulas?\nWhat is the benefit of using non-array formulas in financial modeling?\nCan the MAX and MIN of off-diagonal elements of a matrix be found in one step? If so, how?\nWhat is the function of the VLOOKUP function in financial modeling?\nHow can off-diagonal elements be replaced using a lookup table?\nHow can array formulas simplify replacing the MAX and MIN of off-diagonal elements?\nWhat happens when applying the VLOOKUP function within an array formula in the context of a matrix?\nHow can the IF function be used in conjunction with VLOOKUP for replacing values in a matrix?",
            "34.4 Array Formulas with Matrices\n\nIn this section we create some array functions that have to do with matrices.\nSubtracting a Constant from a Matrix\nIn the portfolio computations of Chapters 8\u201313, we often have to subtract a\nconstant from a matrix. This is easy to do with an array formula, entered with\n[Ctrl] + [Shift] + [Enter].\nA B C D E\nSUBTRACTING A CONSTANT\nFROM A MATRIX\n1\n2 Matrix\n3 1 6 Constant 3\n4 2 6\n5 3 8\n6 4 9\n7 5 10\n8\nMatrix minus\n9 constant\n10 -2 3\n11 -1 3 <-- {=A3:B7-E3}\n12 0 5\n13 1 6\n14 2 7\nCreating a Matrix with Ones on the Diagonal and Zeros Elsewhere\nT his is a problem that comes up in Chapter 10: We want a matrix which has\na diagonal of 1\u2019 s , but has zero off-diagonal elements. The spreadsheet below\n908 Chapter 34\n(cid:36) (cid:37) (cid:38) (cid:39) (cid:40) (cid:41)\nCREATING A MATRIX OF 1'S AND 0'S\nWe want 1 on diagonal, and 0 elsewhere\nthis comes up in Chapter 10\n(cid:20)\nCreating a diagonal matrix of 1's. The cells below contain the array formula\n(cid:21) =IF(B3:E3=A4:A7,1,0)}\n(cid:22) A B C D\n(cid:23) A (cid:20) (cid:19) (cid:19) (cid:19)\n(cid:24) B (cid:19) (cid:20) (cid:19) (cid:19)\n(cid:25) C (cid:19) (cid:19) (cid:20) (cid:19)\n(cid:26) D (cid:19) (cid:19) (cid:19) (cid:20)\n(cid:27)\nCreating a diagonal matrix of 1's. The cells below contain the array formula\n(cid:28) =IF(B$10=$A11,1,0)}\n(cid:20)(cid:19) A B C D\n(cid:20)(cid:20) A (cid:20) (cid:19) (cid:19) (cid:19)\n(cid:20)(cid:21) B (cid:19) (cid:20) (cid:19) (cid:19)\n(cid:20)(cid:22) C (cid:19) (cid:19) (cid:20) (cid:19)\n(cid:20)(cid:23) D (cid:19) (cid:19) (cid:19) (cid:20)\n(cid:20)(cid:24)\nCreating a diagonal matrix of 1's when there are no borders. The cells below\ncontain the array formula =IF(ROW()-ROW($B$17)=COLUMN()-\n(cid:20)(cid:25) COLUMN($B$17),1,0)}\n(cid:20)(cid:26) (cid:20) (cid:19) (cid:19) (cid:19)\n(cid:20)(cid:27) (cid:19) (cid:20) (cid:19) (cid:19)\n(cid:20)(cid:28) (cid:19) (cid:19) (cid:20) (cid:19)\n(cid:21)(cid:19) (cid:19) (cid:19) (cid:19) (cid:20) (cid:3)\nThe first and second methods rely on the labeling of the rows and the\ncolumns. In the first example, the formula = IF(B3:E3=A4:A7,1,0) tests\nwhether the row label equals the column heading; if this is true, we put a 1 in\nthe cell, and otherwise we put in a 0. In the second example we use an I f\nfunction with mixed absolute and relative references to create the same effect.\nIn the third example, there are no column or row labels, and we rely on the\nfunctions Columnand Rowto test the equality of the relative row and column\nplaces in the matrix.\nFinding the Maximum and Minimum Off-Diagonal Elements of a Matrix\nWe want to find the maximal and minimal elements of the off-diagonal ele-\n909 Array Functions\nA B C D E F\nFINDING THE MAX,MIN OF\nOFF-DIAGONAL ELEMENTS OF A MATRIX\nthe long way\n1\n2 The source matrix\n3 A B C D\n4 A 10 2 3 4\n5 B -3 20 4 -3\n6 C 1 5 60 6\n7 D 4 2 -10 25\n8\nRANGE below contains array formula\n9 =IF(B3:E3=A4:A7,\"\",B4:E7)\n10 A B C D\n11 A 2 3 4<-- {=IF(B3:E3=A4:A7,\"\",B4:E7)}\n12 B -3 4 -3\n13 C 1 5 6\n14 D 4 2 -10\n15\n16 Max of off-diagonals 6<-- =MAX(B11:E14)\n17 Min of off-diagonals -10<-- =MIN(B11:E14)\n18\n19\n20 Using only non-array formulas\nRange below contains the non-array formula\n21 =IF(B$3=$A4,\"\",B4)\n22 A B C D\n23 A 2 3 4<-- =IF(E$3=$A4,\"\",E4)\n24 B -3 4 -3\n25 C 1 5 6\n26 D 4 2 -10\n27\n28 Max of off-diagonals 6<-- =MAX(B23:E26)\n29 Min of off-diagonals -10<-- =MIN(B23:E26)\nI n the example above we first use an array function to replace all the diago-\nnal elements with a blank cell. We can then use M ax and M in to determine\nthe extreme off-diagonal elements. As shown in rows 20\u201329, we could also\nhave used the non-array formula = IF(B$3 = $A4,\u201d\u201d,B4) in cell B11 and copied\nit to the rest of the matrix.\nWe can also find the maximum and minimum by incorporating the array\n910 Chapter 34\nA B C D E F\nFINDING THE MAX,MIN OF OFF-DIAGONAL\nELEMENTS OF A MATRIX\nin one step\n1\n2 The source matrix\n3 A B C D\n4 A 10 2 3 4\n5 B -3 20 4 -3\n6 C 1 5 60 6\n7 D 4 2 -10 25\n8\n9 Max of off-diagonals 6 <-- {=MAX(IF(B3:E3=A4:A7,\"\",B4:E7))}\n10 Min of off-diagonals -10 <-- {=MIN(IF(B3:E3=A4:A7,\"\",B4:E7))}\nReplacing the Off-Diagonals Using VLookup\nN ow suppose that we want to replace the off-diagonal elements using a lookup\ntable, as illustrated below:\nA B C D E F\nREPLACING THE MAX,MIN OF OFF-DIAGONAL ELEMENTS OF A MATRIX\nlong way, non-array formulas\n1\n2 The source matrix\n3 A B C D\n4 A 10 2 3 4\n5 B -3 20 4 -3\n6 C 1 5 60 6\n7 D 4 2 -10 25\n8\n9 Lookup table for replacements\n10 -10 i\n11 -6 ii\n12 -2 iii\n13 2 iv\n14 6 v\n15 10 vi\n16\nRange below contains non-array formula\n=IF(B$3=$A4,B4,VLOOKUP(B4,$A$10:$B$15,2)),\n17 which has been copied to all the cells\n18 A B C D\n19 A 10 iv iv iv <-- =IF(E$3=$A4,E4,VLOOKUP(E4,$A$10:$B$15,2))\n20 B ii 20 iv ii\n21 C iii iv 60 v\n911 Array Functions\nArray formulas can simplify this procedure:\nA B C D E F\nREPLACING THE MAX,MIN OF OFF-DIAGONAL ELEMENTS OF A MATRIX\nUsing array formula\n1\n2 The source matrix\n3 A B C D\n4 A 10 2 3 4\n5 B -3 20 4 -3\n6 C 1 5 60 6\n7 D 4 2 -10 25\n8\n9 Lookup table for replacements\n10 -10 i\n11 -6 ii\n12 -2 iii\n13 2 iv\n14 6 v\n15 10 vi\n16\nRange below contains array formula\n17 =IF(B3:E3=A4:A7,B4:E7,VLOOKUP(B4:E7,A10:B15,2))\n18 A B C D\n19 A 10 iv iv iv <-- {=IF(B3:E3=A4:A7,B4:E7,VLOOKUP(B4:E7,A10:B15,2))}\n20 B ii 20 iv ii\n21 C iii iv 60 v\n22 D iv iv i 25"
        ]
    },
    "35": {
        "35.1": [
            "What are the topics covered in Excel hints?\nWhat is the function of fast fills and copy in Excel?\nHow can graph titles be modified as data changes in Excel?\nHow can multi-line cells be created in Excel & what are their uses?\nWhat's the method to type Greek symbols in Excel?\nWhat does typing sub- and superscripts in Excel entail?\nWhat is the process of naming cells in Excel?\nHow can cells be hidden in Excel?\nWhat is the concept of formula auditing in Excel?\nWhat's the process of writing on multiple spreadsheets in Excel?\nWhat is the use of Excel's personal notebook and how is it utilized for copy paste and quick format?",
            "35.1 Overview\n\nT his chapter covers a grab bag of Excel hints dealing with problems and needs\nthat we sometimes run into. The chapter makes no pretence at uniformity or\nextensiveness of coverage. Topics covered include:\n\u2022 Fast fills and copy\n\u2022 Graph titles that change when data changes\n\u2022 Creating multi-line cells (useful for putting line breaks in cells and linked\ngraph titles)\n\u2022 Typing Greek symbols\n\u2022 Typing sub- and superscripts (but not both)\n\u2022 Naming cells\n\u2022 Hiding cells\n\u2022 Formula auditing\n\u2022 Writing on multiple spreadsheets\n\u2022 Using Excel \u2019 s personal notebook to copy and paste and format quickly"
        ],
        "35.2": [
            "What is the fast copy method used in Excel?\nWhat does dragging on the fill handle of a cell do in Excel?\nWhat is the output when double-clicking on the fill handle?\nHow can you automatically fill a range in Excel with a formula?\nWhat happens when double-clicking on the fill handle with a filled cell next to it?\nCan you explain the operation of the fill handle function in Excel?\nWhat is the significance of the fill handle in Excel for financial modelling?\nHow does the fill handle function aid in data filling in Excel?\nWhat happens in Excel when you double click on the fill handle of a cell that has a filled cell next to it?\nCan you explain the operation of the auto-fill/copy function in Excel?\nWhat is the possible outcome of using the fill handle function in a column with filled and unfilled cells?\nHow does Excel's fill handle function aid in data management and organization?\nHow can a user apply a formula to multiple cells in Excel using the fill handle?",
            "35.2 Fast Copy: Filling in Data Next to Filled-In Column\n\nUsually, we copy cells by dragging on the fill handle of the cell with the\nformula. There is sometimes an easier method. Consider the following\nsituation:\nA B C\n1 AUTO FILL/COPY\n2 1 2\n3 2 5 <-- =B2+3\n4 3\n5 4\n6 5\n7 6\n8 7\n914 Chapter 35\nN ow double-click on \u201cfill handle\u201d (shown below with the cross). After double-\nclicking, the range B2:B9 will automatically fill with the formula\nin B3.\nHere \u2019 s the result:\nA B C\n1 AUTO FILL/COPY\n2 1 2\n3 2 5 <-- =B2+3\n4 3 8\n5 4 11\n6 5 14\n7 6 17\n8 7 20\n9 8 23\n10\nDouble-clicking on the \"fill\nhandle\" of a cell will fill in the rest\nof the column provided there's a\nfilled cell next to it.\n915 Some Excel Hints"
        ],
        "35.3": [
            "What does filling cells with a series in Excel mean?\nCan you explain the process of filling cells with a series in Excel?\nWhat command in Excel assists in filling cells with a series?\nWhat does the Editing|Fill|Series command in Excel Home tab do?\nWhat should the result be when filling cells with a series starting from cell A1?\nWhat are some potential other options available with the fill series command in Excel?\nWhat is the usefulness of the 'Fill Cells with a Series' command?\nHow can Excel's 'Fill Series' command assist with financial modeling tasks?",
            "35.3 Filling Cells with a Series\n\nSometimes we want to fill a set of cells with a series. This can be accomplished\nby going to Editing|Fill|Series on the Home tab:\nHere \u2019 s an example. Starting with cell A1, we want to fill a column with cells\n916 Chapter 35\nClicking OK gives\nA\n1 1\n2 4\n3 7\n4 10\n5 13\n6 16\nT his interesting command has several other options which we leave for you\nto try."
        ],
        "35.4": [
            "What is a multi-line cell in Excel?\nHow can you insert a line break in a cell on Excel?\nWhat keys should you press to create a line break within a cell in Excel?\nWhat is an alternative way to make a cell multi-line in Excel?\nWhat is the purpose of word-wrapping a cell in Excel?\nHow can word-wrapping be applied to a cell in Excel?\nWhat effect does setting the vertical alignment to Center have on a cell in Excel? \nWhy may one want to run a line over into neighboring cells in Excel? \nHow can you change the alignment of an Excel cell using the Home|Number|Alignment path?",
            "35.4 Multi-Line Cells\n\nIt is sometimes useful to put a line break in a cell, thus creating a multi-line\ncell. Do this with [Alt] + [Enter] where you want a line break.\nA\n1 PUTTING LINE BREAKS IN CELLS\nThis is a multi-line cell. The break was\nentered by inserting [Alt]+[Enter] at the\n2 first break point.\nThere are, of course other ways to make a cell multi-lined. The most obvious\n917 Some Excel Hints\nH ere\u2019 s the cell after we word-wrap it. (Note that in the dialog box above we\u2019 v e\nalso set the vertical alignment of the cell to Center .)\nA\nThe line in this cell runs over into\nneighboring cells, but by using\nHome|Number|Alignment we can\n1 word wrap the cell."
        ],
        "35.5": [
            "What does a line break in a cell with text formulas mean in Excel?\nWhat function is used to create a line break in an Excel cell?\nWhat does the formula '=A1&Char(10)&A2' signify in Excel?\nWhat is the purpose of Char(10) in Excel formulas?\nWhy might you want to use a line break in an Excel cell with a text formula?\nWhat happens when you push Word Wrap on the Home tab in Excel?\nWhat does Char(10) represent in an Excel formula?\nWhat is the significance of a hard line return in Excel?\nHow to induce a break between the contents of two cells in Excel?\nWhat happens if the formula '=A1&Char(10)&A2' is not correctly formatted in Excel?\nWhat method is used to create multi-line cells with text formulas in Excel?",
            "35.5 Multi-Line Cells with Text Formulas\n\nS ometimes you want to put a line break in a cell which has text formulas in\nit. In the example below, the text formula in cell A4 combines the text in cells\n918 Chapter 35\nA B\n1 Simon\n2 Jack\n3 SimonJack <-- =A1&A2\n4 Simon Jack <-- =A1&CHAR(10)&A2, not correctly formatted\nSimon\n5 Jack <-- =A1&CHAR(10)&A2, pushed the Wrap Text on the Home tab\nWe can put a line break into the text formula by doing two things:\n\u2022 Put Char(10) between A1 and A2\u2014that is, write the formula\n= A1&Char(10)&A2 into the cell.C har(10) is the code for a hard line return.\n\u2022 Push Word Wrap on the Home tab. Now you will have a break between\nthe contents of the two cells at the point you entered Char(10) ."
        ],
        "35.6": [
            "What is the function of the Excel trick mentioned in the context of multiple spreadsheets?\nWhat is the process involved in writing on multiple spreadsheets simultaneously in Excel?\nWhat keys should be pressed to perform writing in multiple spreadsheets in Excel?\nWhat happens when you write on one spreadsheet when multiple spreadsheets are selected in Excel?\nWhat are some applications of writing simultaneously on multiple spreadsheets in Excel?\nWhat is produced when a user writes in one of the sheets with multiple spreadsheets selected in Excel?\nHow can one produce identical spreadsheets using the Excel trick mentioned?",
            "35.6 Writing on Multiple Spreadsheets\n\nThis Excel trick enables you to write in multiple spreadsheets at the same time.\nFirst: Hold down [Shift] and indicate several spreadsheet tabs by clicking on\nthem. In the example below we \u2019 ve clicked on the tabs labeled Spreadsheet1 ,\nSpreadsheet2 , Spreadsheet3. Now\u2014whatever you write on one sheet will be\n919 Some Excel Hints\nNow anything we write in one of the sheets is also written in the same cells\nof all the others, so that we can produce three identical spreadsheets:"
        ],
        "35.7": [
            "What does moving multiple sheets in an Excel notebook involve?\nWhat key combination is used to write on multiple sheets in Excel?\nWhat is the role of the 'Shift' key in managing multiple sheets in an Excel notebook?\nWhat steps are involved in moving or copying multiple sheets within the same Excel notebook?\nWhat menu item in Excel is used to move or copy sheets?",
            "35.7 Moving Multiple Sheets of an Excel Notebook\n\nW e write on multiple sheets by holding down [Shift] and marking the tabs of\nthe relevant spreadsheets. A similar trick works to move multiple sheets of the\nsame Excel notebook:\n\u2022 Mark the multiple sheets by holding down [Shift] and clicking on the appro-\npriate sheets.\n\u2022 Now use Edit|Move or copy sheet to move or copy the sheets to another\n920 Chapter 35"
        ],
        "35.8": [
            "What is the function of the Text function in Excel?\nCan you provide some examples of how to use the Text function in Excel to convert numbers to text?\nHow can the Text function be used to format data in Excel differently?\nWhat does cell B3 represent using Text function in Excel?\nWhy is cell B7 formatted as a percentage with two decimal points?\nWhat happens when you format the tax rate as one decimal in Excel?\nWhy is cell B8 rounded off in the example given?\nWhat is the relevance of cell B10's example in terms of Text function in Excel?\nWhat does the phrase \"dates in Excel are just numbers that express the number of days from 1 January 1900\" mean?\nHow is the income represented using Text function in Excel?\nWhat is the purpose of using text functions to create chart titles that update themselves?\nHow can the income of $15,000 in cell B2 be expressed as a date using the Text function?\nWhat is the downside of text functions in financial data modelling on Excel?",
            "35.8 Text Functions in Excel\n\nThe Text function lets you change numbers to text. Here are some\nexamples:\nA B C\n1 TEXT FUNCTIONS\n2 Income 15,000\n3 Tax rate 35%\n4 Taxes owed 5,250<-- =B3*B2\n5\n6\n7 Tax rate as text 35.00% <-- =TEXT(B3,\"0.00%\")\n8 0.4 <-- =TEXT(B3,\"0.0\")\n9\n10 Income as date Jan. 24, 1941 <-- =TEXT(B2,\"mmm. dd, yyyy\")\nNote that you can choose different ways of formatting the cell B3 in text\nform\u2014in cell B7 we have formatted the tax rate as a percentage with two\ndecimal points, whereas in cell B8 we have formatted the tax rate as one\ndecimal, causing it to be rounded off.\nN ote also the somewhat stupid example in cell B10: Since dates in Excel\nare just numbers that express the number of days from 1 January 1900, we\ncan express the income of $15,000 in cell B2 as a date.\nI n the next section we use text functions to create chart titles that update\nthemselves."
        ],
        "35.9": [
            "What is a chart title that updates in Excel?\nHow can we make a chart title update when a parameter on the spreadsheet changes?\nWhat is the purpose of using a \"proxy title\" while creating a chart in Excel?\nWhat steps are involved in making graph titles update automatically in Excel?\nHow can the text function be used in Excel to show the growth rate on a chart title? \nHow does changing the growth rate affect the title of a graph in Excel?\nHow can a cell reference be used to update a graph title in Excel?\nWhat does inserting an equal sign in the formula bar do while updating a graph title in Excel?\nWhere should the updated title be created for an Excel chart?\nWhat is the significance of using cell D22 to update a graph title in Excel?\nHow does the formula = \u201cCash Flow Graph When Growth = \u201c &TEXT(B2,\u201d0.0% \u201d) work in Excel?\nWhat are the key steps to update a chart title in Excel based on a parameter in the spreadsheet? \nHow does a chart title in Excel react when a cell value is updated?\nHow can you create a dynamic title in Excel that responds to changes in data?\nCan you explain the process of making financial graph titles update automatically in Excel?",
            "35.9 Chart Titles That Update\n\nY ou want to have the chart title change when a parameter on the spreadsheet\nchanges. For example, in the next spreadsheet, you want the chart title to\n921 Some Excel Hints\nA B C D E F G H I\n1 CHART TITLES THAT UPDATE AUTOMATICALLY\n2 Growth 15%\n3\n4 Year Cash flow\n5 1 100.00\n6 2 115.00 <-- =B5*(1+$B$2)\n7 3 132.25 <-- =B6*(1+$B$2)\n8 4 152.09 200\n9 5 174.90\n10 150\n11\n12 100\n13\n14 50\n15\n16 0\n17 1 2 3 4 5\n18\n19\nChart title below contains the text function\n20 =\"Cash Flow Growth Rate = \"&TEXT(B2,\"0.0%\")\n21\n22 Cash Flow Growth Rate = 15.0%\nwofl\nhsaC\nCash Flow Growth Rate = 15.0%\nYear\nOnce we have completed the necessary steps, changing the growth rate will\n922 Chapter 35\nA B C D E F G H I\n1 CHART TITLES THAT UPDATE AUTOMATICALLY\n2 Growth 5%\n3\n4 Year Cash flow\n5 1 100.00\n6 2 105.00 <-- =B5*(1+$B$2)\n7 3 110.25 <-- =B6*(1+$B$2)\n8 4 115.76 150\n9 5 121.55\n10\n11 100\n12\n13\n50\n14\n15\n16 0\n17 1 2 3 4 5\n18\n19\nTo make graph titles update automatically, carry out the following steps:\n\u2022 C reate the graph you want in the format you want it. Give the graph a \u201cproxy\ntitle.\u201d (It makes no difference what; you \u2019 re going to eliminate it soon.) At this\nstage your graph might look like:\nwofl\nhsaC\nCash Flow Growth Rate = 5.0%\n923 Some Excel Hints\nA B C D E F G H I\n1 CHART TITLES THAT UPDATE AUTOMATICALLY\n2 Growth 12%\n3\n4 Year Cash flow\n5 1 100.00\n6 2 112.00 <-- =B5*(1+$B$2)\n7 3 125.44\n8 4 140.49 asdfasdf\n9 5 157.35\n10 6 176.23\n11 7 197.38 250\n12 200\n150\n13\n100\n14\n50\n15\n0\n16\n1 2 3 4 5 6 7\n17\nYear\n18\n19\nChart title below contains text function\n=\"Cash Flow Graph When\n20 Growth = \"&TEXT(B2,\"0.0%\")\n21\n22 Cash Flow Graph When G rowth = 12.0%\nwolf\nhsaC\n\u2022 Create the title you want in a cell. In the example above, cell D22 contains\nthe formula: = \u201cCash Flow Graph When Growth = \u201c &TEXT(B2,\u201d0.0% \u201d)\n\u2022 Click on the graph title to mark it, and then go to the formula bar and insert\nan equal sign to indicate a formula. Then p oint at cell D22 with the formula\nand click [Enter]. In the picture below, you see the chart title highlighted and\nin the formula bar \u201c =C hanging graph titles!$D$22\u201d indicating the title of the\n924 Chapter 35"
        ],
        "35.10": [
            "What does the Greek symbol \u03bc in financial modeling stand for? \nWhat does the Greek symbol \u03c3 in financial modeling represent? \nWhat is the role of the Greek symbol \u0394t in financial modeling? \nHow can one type Greek letters in a spreadsheet? \nWhat are the Greek equivalents for the lowercase \"m\" and \"s\"? \nWhat are the Greek equivalents for uppercase \"S\" and \"D\"? \nHow can the font be changed in a cell in Excel? \nWhat happens when you press [Enter] after changing the font to Symbol? \nHow to put Greek symbols in Excel cells? \nWhat is the initial stock price in the given scenario? \nWhat is the mean and standard deviation in the context of the given scenario? \nWhat does Delta in financial modeling indicate?",
            "35.10 Putting Greek Symbols in Cells\n\nHow do we type Greek letters in a spreadsheet?\nA B\nGREEK AND SYMBOLS\nIN CELLS\n1\n2 Initial stock price 30\n3 Mean, \u03bc 15%\n4 Standard deviation, \u03c3 20%\n5 Delta, \u0394t 0.004\nThis is fairly simple, if you know the Greek equivalents for the Greek letters\n(for example, \u03bc and \u03c3 are lowercase \u201cm\u201d and \u201cs,\u201d respectively, \u03a3 and \u0394 are\nuppercase \u201cS\u201d and \u201cD\u201d). For example, we first typed \u201cDelta, Dt\u201d into cell A5\n925 Some Excel Hints\nWe then changed the font from Arial to Symbol:\nPressing [Enter] produces the desired result."
        ],
        "35.11": [
            "What is meant by superscripts and subscripts in Excel?\nHow can you create superscripts in Excel?\nCan you make subscripts in Excel, and if so, how?\nIs it possible to have a superscript and subscript on the same letter in Excel? \nWhat are the limitations in using superscripts and subscripts in Excel?\nHow can you identify text to be changed into a superscript or subscript in Excel?\nWhat happens when you attempt to put a subscript and a superscript on the same letter in Excel?\nWhat is the process to enter text into a cell in Excel that you want to change into a subscript or superscript?\nHow does the display of superscripts and subscripts appear in Excel?",
            "35.11 Superscripts and Subscripts\n\nIt is not a problem to type subscripts or superscripts in Excel. Enter text into\na cell, and then mark the letters you want to turn into a subscript or\nsuperscript:\n926 Chapter 35\nHere \u2019 s the result:\nA B\nSUPERSCRIPTS/SUBSCRIPTS IN\nCELLS\n1\n2 x2\n3\nCannot put superscript and\n4 x2 i subscript one above the other\nAs you can see in cell A4 above, you cannot put a subscript and a superscript\non the same letter. That is, you cannot create x2 .\ni"
        ],
        "35.12": [
            "What are named cells in Excel?\nHow can one refer a cell by a name in Excel?\nWhat are the steps to assign a name to a cell in Excel?\nHow to use the assigned name of a cell in Excel?\nWhat is the significance of using named cells in Excel?\nCan Excel automatically recognize cell names in certain scenarios?\nHow to use column headers as cell names in Excel?\nWhat is the function of the Name Manager in Excel?\nWhat are the procedures to manage named cells in Excel?\nHow can the tax paid be calculated using named cells in Excel?\nCan named cells be utilized across an entire Excel notebook?",
            "35.12 Named Cells\n\n927 Some Excel Hints\nA B C\n1 NAMED CELLS\n2 Income 15,000\n3 Tax rate 33%\n4 Tax paid 4,950<-- =B3*B2\nWe want to refer to cell B3 by the name \u201ctax.\u201d To do this, we mark the cell\nand then go to the name tab on the toolbar:\nT yping in the word \u201ctax\u201d on the highlighted B3 allows us to reference B3 by\nthis name anywhere in the Excel notebook:\nA B C\n1 NAMED CELLS\n2 Income 15,000\n3 Tax rate 33%\n4 Tax paid 4,950<-- =tax*B2\nSometimes Excel lets us use cell names without ever actually going through\nthe procedure just described. In the next example, Excel lets us use the column\nheaders as cell names:\nA B C D\n7 Sales Margin Profit\n8 1000 20% 200<-- =Sales*Margin\n9 5000 30% 1500<-- =Sales*Margin\nTo manage the named cells, go to the N ame Manager on the F ormulas\n928 Chapter 35"
        ],
        "35.13": [
            "What does hiding cells in data tables mean in the context of Excel?\nWhat is the function of a data table header in Excel?\nHow to hide the contents of a cell in Excel?\nWhat happens when a semicolon is put in the Number|Custom|Type box in Excel?\nWhy is it advised to annotate your spreadsheet in Excel?\nAfter a few weeks/months, how can you know if a cell in Excel has something in it?\nIn Excel, how can you hide a cell that contains a reference to another cell containing a formula?\nCan you mention the use of three semicolons in Excel formatting for hiding content?\nWhat does the function IF do in Excel?\nWhen is it necessary to use three semicolons instead of one in Excel cell formatting and why?\nWhat happens when the command IF(B2+B3<15,\"aaa\",\"bbb\") is executed in Excel?\nWhat could be the reason for hiding a cell content in Excel?\nCan storing formulas in a cell affect its visibility in Excel? \nWhat could be potential issues if data table headers are not hidden when copied into other documents?",
            "35.13 Hiding Cells (in Data Tables and Other Places)\n\nI n this text, we have often hidden the cell contents of data table headers. Here\u2019 s\na simple data table (this topic is discussed in detail in Chapter 31):\nA B C D\n1 HIDING CELLS\n2 Payment 100\n3 Number of payments 15\n4 Discount rate 15%\n5 Present value $584.74 <-- =PV(B4,B3,-B2)\n6\nPV of\n7 payments\n8 Data table 584.74<-- =B5 , data table header\n9 0% 1,500.00\n10 3% 1,193.79\n11 6% 971.22\n12 9% 806.07\n13 12% 681.09\n14 15% 584.74\n15 18% 509.16\n16 21% 448.90\nThe data table header in cell C8 is necessary for the table to work, but it is\nugly and may be confusing if the table is copied into other documents. To hide\nthe contents of C8, mark the cell and go to the Format Cells menu (or click\n929 Some Excel Hints\nIn the Number|Custom|Type box we have put in a semicolon. This pre-\nserves the cell contents but prevents them from being seen. Now when you\ncopy the cells, this is the way they will appear:\nB C D\nPV of\n7 payments\n8 <-- =B5 , data table header\n9 0% 1,500.00\n10 3% 1,193.79\n11 6% 971.22\n12 9% 806.07\n13 12% 681.09\n14 15% 584.74\n15 18% 509.16\n930 Chapter 35\nNote the comment in cell D8: We advise you always to a nnotate your\nspreadsheet, so that when you come back to it after a few weeks/months, you\nwill know that cell C8 really does have something in it!\nO ne final note: To hide a cell which contains a reference to another cell\ncontaining a formula, three semicolons (;;; ) may be necessary. In the spread-\nsheet below, cell B4 contains the function IF . Cell B6 refers to this cell. To\nhide B6, we use three semicolons instead of one in the F ormat\nCells|Number|Custom|Type. (If there \u2019 s logic here, it escapes us!)\nA B C\nHIDING A CELL WHICH REFERS TO A\nFORMULA\n1\n2 a 33\n3 b 8\n4 c bbb <-- =IF(B2+B3<15,\"aaa\",\"bbb\")\n5\n6 Cell to be hidden --> <-- =B4"
        ],
        "35.14": [
            "What is formula auditing in Excel?\nHow does formula auditing help in financial modelling in Excel?\nWhat is the function of precedents and dependents in Excel during formula auditing?\nWhy should one avoid cells without either precedents or dependents in spreadsheets during formula auditing?\nWhat is the significance of the 'Tools|Formula Auditing' in Excel?\nHow does the PMT function work in Excel in relation to loan terms and annual payments?\nWhat constitutes a flat payment schedule in financial modeling?\nHow can Excel distinguish the cells used in a formula?\nWhat is the significance of loan principal, interest rate and loan term in a flat payment schedule?\nHow do you calculate the annual payment of a loan in financial modeling using Excel?\nWhat does the split payment formula in Excel denote in a flat payment schedule?\nHow are 'Return of Interest' and 'Return of Principal' calculated in a flat payment schedule model?\nCan you explain the term 'good spreadhseet writing' in the context of financial modeling in Excel?\nWhy is there a need to implement a general rule of good spreadsheet writing in financial modeling?\nWhat are some of the benefits of using formula auditing in financial modelling?\nHow do Excel formulas help in tracking the return of interest and return of principal in a flat payment schedule?",
            "35.14 Formula Auditing\n\nExcel can tell you where you \u2019 ve used a cell in your formulas and which cells\na particular formula depends on. Clicking on T ools|Formula Auditing brings\n931 Some Excel Hints\nHere \u2019 s the result:\nA B C D E F G\n1 FLAT PAYMENT SCHEDULES\n2 Loan principal 10,000\n3 Interest rate 7%\n4 Loan term 6<-- Number of years over which loan is repaid\n5 Annual payment 2,097.96 <-- =PMT(B3,B4,-B2)\n6\n7 Split payment into: =$B$3*C9\nPrincipal\nat beginning Payment at Return of\n8 Year of year end of year Interest principal\n9 1 10,000.00 2,097.96 700.00 1,397.96\n10 2 8,602.04 2,097.96 602.14 1,495.82 =D9-E9\n11 3 7,106.23 2,097.96 497.44 1,600.52\n12 =C9-F9 4 5,505.70 2,097.96 385.40 1,712.56\n13 5 3,793.15 2,097.96 265.52 1,832.44\n14 6 1,960.71 2,097.96 137.25 1,960.71\n932 Chapter 35\nIn a similar way we can check to see which cells are precedents of a par-\nticular cell:\nA B C D E F G\n1 FLAT PAYMENT SCHEDULES\n2 Loan principal 10,000\n3 Interest rate 7%\n4 Loan term 6<-- Number of years over which loan is repaid\n5 Annual payment 2,097.96 <-- =PMT(B3,B4,-B2)\n6\n7 Split payment into: =$B$3*C9\nPrincipal\nat beginning Payment at Return of\n8 Year of year end of year Interest principal\n9 1 10,000.00 2,097.96 700.00 1,397.96\n10 2 8,602.04 2,097.96 602.14 1,495.82 =D9-E9\n11 3 7,106.23 2,097.96 497.44 1,600.52\n12 =C9-F9 4 5,505.70 2,097.96 385.40 1,712.56\n13 5 3,793.15 2,097.96 265.52 1,832.44\n14 6 1,960.71 2,097.96 137.25 1,960.71\n15 7 0.00\nF ormula auditing can help you implement a general rule of good spreadsheet\nwriting: You should try to avoid cells which don \u2019 t have either precedents or\ndependents."
        ],
        "35.15": [
            "What does the Format Cells|Custom function in Excel allow you to do?\nWhat happens when you add a comma at the end of the format in the Type box in Excel?\nHow would an income statement appear if the millions are formatted as thousands in Excel?\nHow does adding another comma to the Type box in Excel affect the format?\nWhat does the # ,### indicate in the Excel's Format Cells|Custom option?\nWhat does the notation '=#B2*2' represent in Excel?\nIf you multiply the Sales cell by 2 in Excel, how does it show up in the cell if the Format Cells|Custom function is used?\nIn formatting numbers in Excel, does the actual number in the cell change?\nHow can you format numbers in Excel to round and drop the last three digits?\nHow to maintain the original values in the cells while displaying them as rounded off to nearest thousands in Excel? \nWhat is the role of the Type box in Excel's Format Cells|Custom option?",
            "35.15 Formatting Millions as Thousands\n\nB y using Format Cells|Custom you can change millions into thousands. To\nsee where this is handy, consider the following income statement:\nA B\n1 INCOME STATEMENT\n2 Sales 31,235,689\n3 Cost of goods sold 15,250,888\n4 Sales, general, and administrative 2,356,188\n5 Interest 1,999,824\n6 Profits before taxes 11,628,789\n7 Taxes 4,418,940\n933 Some Excel Hints\nWe want to make the income statement appear in thousands (in other words,\ninstead of 31,235,689 we will see 31,236. Here \u2019 s how this can be done:\nIn the Type box we have indicated # ,###, . The comma at the end indicates\nthat we want Excel to drop the last three digits in the number (and round the\nnumber), and the # ,### indicates that we want the remaining numbers to\nappear with a comma. This is merely a formatting change\u2014the actual numbers\nare not changed: In cell B10 in the output below, we \u2019 ve multiplied the Sales\nby 2; the result is 62,471,378.\nA dding another comma to the Type box (that is, #,###,,) will drop another\n934 Chapter 35\nA B C\n1 INCOME STATEMENT\n2 Sales 31,236\n3 Cost of goods sold 15,251\n4 Sales, general, and administrative 2,356\n5 Interest 2,000\n6 Profits before taxes 11,629\n7 Taxes 4,419\n8 Profits after taxes 7,210\n9\n10 The cells retain their values 62,471,378 <-- =B2*2"
        ],
        "35.16": [
            "What is Excel's personal notebook and how can it be used?\nCan you explain the 'Copy as Picture' feature in Excel?\nHow can this feature be automated and saved in Excel's personal notebook?\nCan macros be attached to key sequences in Excel? \nWhat steps are involved in creating a Personal.xlsb file?\nWhat is the purpose of the Developer tab in Excel?\nHow can you edit Excel's personal notebook? \nWhat role does a macro serve in automating frequent procedures in Excel?\nHow can repetitive actions be automated in Excel using VBA?\nWhat is VBA and how is it integrated with Excel?\nWhat is the importance of VBA in financial modelling?\nWhat is a subroutine in VBA?\nHow can repetetive actions be automated using subroutines in Excel?\nHow can you record a macro and save it in the Personal.xlsb notebook?\nHow can you edit the Personal.xlsb file?\nWhat does saving a Personal Macro Workbook entail? \nHow to assign a keyboard shortcut for a macro in Excel?\nWhat is the process of copying a section from Excel and then pasting it in Microsoft Word using a macro?\nWhat is meant by number formatting in Excel's personal notebook?\nHow is 'Visual Basic for Applications' used in the financial community?\nHow can you automate the process of copying a region as a picture in Excel?\nWhat is the process of quick number formatting in Excel?\nWhat is a Personal Macro Workbook and how to save a shortcut in it? \nCan the copy as picture feature be automated using a macro in Excel?\nWhat is the purpose and method of using the Range function in creating a macro in Excel? \nWhat is the function and significance of the \"Format: = xlPicture\" command in Excel's VBA code?",
            "35.16 Excel \u2019 s Personal Notebook: Automating Frequent Procedures\n\nExcel \u2019 s personal notebook allows you to save macros and procedures that only\nyou can access. We give two examples of such procedures:\n\u2022 We explain Excel \u2019 s Copy as Picture feature and show how to attach this to\na macro stored in your personal notebook. This greatly simplifies copying from\nExcel and pasting into Microsoft Word (all the copy/pastes in this book were\nmade this way).\n\u2022 We explain how to save number formatting in the personal notebook.\nUsing the Copy as Picture Feature of Excel1\nExcel 2010 and 2013 contain a very nice way to copy from Excel as a picture.\nThis is useful for embedding pictures of Excel spreadsheets into Word without\na link. Here \u2019 s the way it works:\n1. In Excel indicate the selection you want to copy:\n935 Some Excel Hints\n2. On the Home tab go to Copy|Copy as Picture:\n3. Indicate As shown when printed :\n4. You can now go to Microsoft Word and Copy and Paste. The result: You\nget a picture without any Excel link.\nA B C D E F\n2 Variance-covariance matrix Means\n3 0.2000 -0.0200 0.0250 -0.0080 3%\n4 -0.0200 0.3000 0.0600 0.0030 2%\n5 0.0250 0.0600 0.4000 0.0000 8%\n936 Chapter 35\nAutomating the Procedure\nWe want to automate this procedure:\n\u2022 Turn it into a macro.\n\u2022 Attach a key sequence (in this case, [Ctrl] + q) to the macro.\n\u2022 Make the macro and key sequence available in all your Excel\nspreadsheets.\nT o do this, you have to create a Personal.xlsb file. This file is hidden but\nactivates each time you start Excel. It\u2019 s yours only\u2014other readers of your\nspreadsheets won \u2019 t see it. Here are the steps:\n\u2022 Activate the Developer tab on the menu bar.\n\u2022 Use Record Macro to save a macro as a personal notebook.\n\u2022 Edit the personal notebook with what you want.\nActivate the Developer Tab\nGo to File|Options|Customize Ribbon and activate the D eveloper tab as\n\n938 Chapter 35\nUse Record Macro\nThe Developer tab allows you to record a macro and save it as part of the\nPersonal.xlsb notebook. We will illustrate with the copy as picture feature.\n1. Open a blank Excel notebook and click on the D eveloper tab and then on\nRecord Macro :\nE xcel will ask for details of the recording. Here\u2019 s what I wrote. Note that I\u2019 m\nsaving this as a P ersonal Macro Workbook and that I \u2019 m using the shortcut\nkeystrokes [Ctrl] + q:\n2. Now go to the Home tab, mark an area of the spreadsheet, and go through\n939 Some Excel Hints\n3. Go back to the Developer tab and stop the recording:\n4 . C lose down Excel. Excel will ask you if you want to save the Personal\n940 Chapter 35\nThis creates the following file (\u201csimon benninga\u201d is of course my user name\non my computer\u2014you will substitute your user name):\nC:\\Users\\simonbenninga\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\\nPERSONAL.XLSB\nEdit the Personal Notebook\nN ow that you\u2019 v e saved the Personal.xlsb file, you may want to edit it. Open\nany Excel file, hit [Alt] + [F11] to go the VBA editor. Note that the Personal\nfile is also there:\nW e have edited this by deleting the line Range(\u201cC3:G10\u201d).Select . The\nresulting macro is given below.\nRange(\u201cC3:G10\u201d) :\nSub Macro1()\n\u2018\n\u2018 Macro1 Macro\n\u2018 Copy as picture\n\u2018\n\u2018 Keyboard Shortcut: Ctrl + q\nSelection.CopyPicture Appearance: = xlPrinter, _\nFormat: = xlPicture\n941 Some Excel Hints\nUsing the Macro\nF rom now on, whenever you open a file on y our computer, you can use [Ctrl]\n+ q to copy a region as a picture. Note that this feature works only on your\ncomputer\u2014it \u2019 s in your personal notebook.\nQuick Number Formatting\nWe often want to format numbers with comma separators and without deci-\nmals. For example:\nA B\n1 1356.001 1987.398\n2 3387.3 4458.98\nTo make the formatting of these numbers uniform:\n\u2022 Mark the numbers.\n942 Chapter 35\nThe result:\nA B\n1 1,356 1,987\n2 3,387 4,459\nBy using the same routine as for Copy and Paste as Picture above, we can\ngenerate a macro in our personal notebook. We have assigned [Ctrl] + w to\nthis macro:\nSub Commas()\n\u2018 Commas Macro\n\u2018 Keyboard Shortcut: Ctrl + w\nSelection.NumberFormat = \u201c#,##0\u201d\nVII\nVISUAL BASIC FOR APPLICATIONS (VBA)\nVisual Basic for Applications (VBA) is the programming language attached\nto Excel. VBA is very functional and flexible. Because of its ready integration\nwith Excel worksheets, VBA is widely used in the financial community. VBA\nincorporates many features that are part of standard programming languages,\nand it is not difficult to master if you have some programming experience.\nY ou do not need to be proficient in VBA to understand Sections I\u2013VI of\nFinancial Modeling. These sections can be understood without anything more\nthan the very rudimentary VBA principles incorporated in the preface to this\nbook (or alternatively in the small file called \u201cAdding Getformula to your\nSpreadsheet\u201d that is part of the disk that comes with the book).\nT he four chapters of this section cover Visual Basic for Applications (VBA)\ntopics for the reader interested in developing his or her own programs. Chapter\n36 shows how to write functions that can be added in to Excel spreadsheets.\nFinancial Modeling uses many of these \u201chomemade\u201d functions. Examples are\nthe two-stage Gordon model (Chapter 3), Black-Scholes pricing of options\n(Chapter 17), and derivation of the Nelson-Siegel term structure (Chapter 22).\nC hapter 37 discusses more advanced topics related to variables and arrays\nin VBA. We have used this topic in fixing the bugs in Excel\u2019 s X NPV and\nXIRR functions (Chapter 1). Chapter 38 shows how to build subroutines in\nVBA. A subroutine is not a function, but rather an automation of some repeti-\ntive action. F inancial Modeling uses subroutines in a number of places\u2014for\nexample, in computing the efficient frontier without short sales (Chapter 12).\nFinally, Chapter 39 discusses objects and add-ins. Among other topics dis-\n36 User-Defined Functions with VBA"
        ]
    },
    "36": {
        "36.1": [
            "What is Visual Basic for Applications (VBA)?\nHow is VBA integrated with Excel?\nWhat are user-defined functions in VBA?\nWhat versions of Excel are compatible with VBA?\nHow is VBA used in financial modeling?\nWhat are the uses of VBA's programming language?\nWhat is the compatibility of Excel 2013 working environment with VBA?\nWhat versions of VBA are compatible with all versions of Excel?\nWhat is the role of VBA in Microsoft Office applications?\nWhat does a complete programming language and environment mean in context to VBA?",
            "36.1 Overview\n\nC hapters 36\u201339 discuss the uses of Excel\u2019 s programming language, Visual\nBasic for Applications (VBA). VBA provides a complete programming lan-\nguage and environment fully integrated with Excel and all other Microsoft\nOffice applications. In this chapter we introduce user-defined functions, which\nare used in various places in this book.\nT he examples and screen shots depict the Excel 2013 working environment\nbut are fully compatible (unless otherwise noted) with all versions of Excel\nusing Visual Basic for Applications (Version 5 and above)."
        ],
        "36.2": [
            "What is the VBA Editor used for in financial modeling functions?\nWhat is an example of a function that can be defined using VBA?\nWhat is a user-defined function in Excel?\nWhat is the purpose of a Personal Macro Workbook in Excel's VBA?\nHow can a VBA function be made available across multiple worksheets?\nWhat are the steps to activate the VBA editor in Excel?\nWhat is the role of a module in a user-defined function in VBA?\nCan you explain the key elements of a user-defined function in Excel?\nWhat does VBA do when you end the first line of the function with a tap on the Enter key?\nHow does VBA respond to recognized programming language keywords?\nCould you provide an example of a simple user-defined function that adds two numbers?\nHow can a user-defined function be used in a spreadsheet?\nWhat role does indentation play in writing VBA code?\nHow is a function inserted in a spreadsheet if you already know its name?\nHow can Excel's Function Wizard be utilized to work with user-defined function?\nWhat happens when a user-defined function is selected in Excel's Function Wizard?\nWhy might the Excel dialogue box not provide an explanation or help for a user-defined function?",
            "36.2 Using the VBA Editor to Build a User-Defined Function\n\nThroughout this book we have used VBA to define functions that are not\nincluded in Excel. One example is the function G etformula that is attached\nto all the spreadsheets in this book; another example is the function that com-\nputes the Black-Scholes option value (Chapter 17). In this section we show\nyou how to build a user-defined function. A user function is a saved list of\ninstructions for Excel that produces a value. Once defined, a user function can\nbe used inside an Excel worksheet like any other function. 1\n1 . U ser-defined functions are usually attached to a specific workbook and are only available if\nthat workbook is currently open in Excel. If you want a macro to be available whenever you use\nExcel on a specific computer save it in the P ersonal Macro Workbook; see Chapter 35, section16.\nAnother way of having access to a VBA function across worksheets is to put it in an add-in; see\n946 Chapter 36\nI n this section we will write our first user-defined function. Before you can\ndo this, you need to activate the VBA editor. You can do this either by using\nthe keyboard shortcut [Alt] + F11 or from the Excel ribbon ( Developer\nTab|Visual Basic Editor) . By default, Excel doesn\u2019 t display the Developer\ntab on the Excel ribbon. To show the Developer tab, go to File|Options|\n947 User-Defined Functions with VBA\nT he result in both cases is a new window like the following screen shot (your\n948 Chapter 36\nA user-defined function needs to be written in a module. To open a new\nmodule, select Insert|Module from the menu in the VBA editor environment.\nThis will open a new window, as illustrated in the next screen shot:\nW e are now ready to write our first function. This function (named \u201c plus \u201d)\nwill add together two numbers.\nA user-defined function in Excel has three obligatory elements:\n1. A header line with the name of the function and a list of parameters.\n2. A closing line (usually inserted by VBA).\n3. Some program lines between the header and the closing line.\nStart writing the first line of the function:\n949 User-Defined Functions with VBA\nAs soon as you end the line with a tap on the Enter key, VBA will do a\ncleanup job. The color of all the words that VBA recognizes as part of its\nprogramming language (\u201creserved words\u201d) will change. All reserved words\nwill be capitalized. A space will be added after the comma separating the first\nparameter from the second parameter. The closing line for the function will\nbe inserted, and the cursor will be in position between the header and the\n950 Chapter 36\nWe are now ready to type our function line. This is the line that makes our\nfunction do something. 2 Our first function will take two variables and return\ntheir sum:\nFunction plus(parameter1, parameter2)\nplus = parameter1 + parameter2\nEnd Function\nYou can now use this function in your spreadsheet:\nA B C\n1 PLUS IN ACTION\n2 Parameter1 3.25\n3 Parameter2 1.5\n4 Plus 4.75<-- =plus(B2,B3)\n2. The indentation of lines in VBA code, which we added manually, is not required by VBA but\n951 User-Defined Functions with VBA\nThe fastest way to insert a function (assuming you know its name) is to start\ntyping the name. When the suggested list of names narrows down, select the\n952 Chapter 36\nY ou can also use the function in the Excel Function Wizard. Clicking on this\n953 User-Defined Functions with VBA\nSelecting User Defined from the pull-down menu will present the following\nscreen listing all user-defined functions; one of them should be the function\n954 Chapter 36\nWhen you select plus and click OK, you will see that Excel treats this like\nany other function, bringing up a dialogue box that asks for the location or\nvalue of parameter1 and parameter2 :\nNotice that at this point there is no explanation or help for the function. The\n955 User-Defined Functions with VBA"
        ],
        "36.3": [
            "What is the purpose of Excel's Function Wizard?\nHow does Excel explain its own functions?\nHow can you attach a text description to a function in Excel?\nWhat is the purpose of activating the macro selection box in Excel?\nHow can you activate the macro selection box in Excel from the ribbon?\nWhat is the function of the keyboard shortcut [Alt] + F8 in Excel?\nWhat happens when you type the name of the function in the Macro name box in Excel?\nWhat does it mean if the function name doesn't appear in the macro dialogue box?\nHow do you add a description to a function in Excel?\nWhy is it important to have a help line for functions in Excel?\nWhat are the steps to close the macro selection box in Excel?\nDo all Excel functions have help lines?\nCan user-defined functions in Excel have the same help lines and help file entry as Excel's own functions? \nWhy might certain aspects of user-defined functions go beyond the scope of an introduction to Excel's Function Wizard?",
            "36.3 Providing Help for User-Defined Functions in the Function Wizard\n\nExcel \u2019 s Function Wizard (shown below) provides a short help line (an explana-\ntion of what the function does). Here\u2019 s how Excel explains its own functions\n956 Chapter 36\nTo attach a text description to our function, activate the macro selection box.\nYou can do this either from the Excel ribbon (D eveloper|Macros ) or by using\nthe keyboard shortcut [Alt] + F8.\nClick in the Macro name box, and type the name of the function (notice\nthat you don \u2019 t see the function name in the macro dialogue box above \u2026 you\n957 User-Defined Functions with VBA\n958 Chapter 36\nType the description in the Description box. Click O K , and close the macro\nselection box. Our function now has a help line.\nExcel functions have help lines attached to each of the parameters and a\nhelp file entry. We can supply the same for our function; sadly, the subject is\nbeyond the scope of this introduction."
        ],
        "36.4": [
            "What does it mean to save an Excel workbook with VBA content?\nWhat is a \"macro-enabled file\" in the context of Excel workbooks with VBA content?\nHow does Excel notify you when you try to save a workbook with VBA content the first time?\nWhat is the purpose of the 'Save As' dialog in Excel when saving a workbook with VBA content?\nWhat is the selection referred to as the \"second option\" when saving an Excel workbook with VBA content?\nWhat is the implication of using the 'xlsm' file type in Excel?\nWhy would someone want to change the default Excel file type to 'xlsm'?\nWhat steps are needed to save an Excel workbook with VBA content? \nWhat is the process to change the default Excel file type to 'xlsm' when frequently using VBA?\nHow does Excel handle saving workbooks with VBA content?",
            "36.4 Saving Excel Workbook with VBA Content\n\nAt some point in the process, you need to save your work.3 Starting with Excel\n2007, an Excel workbook with VBA content has to be saved as a \u201cmacro-\nenabled file.\u201d When you first try to save a workbook with VBA content, Excel\nwill present you with the following message:\n959 User-Defined Functions with VBA\nYou should choose No and get the S ave As dialog to enable you to choose\n960 Chapter 36\nNow open the circled selection, select the second option, x lsm , and save the\nworkbook. If you use VBA often, then you might consider changing the default\nExcel file type to xlsm .4"
        ],
        "36.5": [
            "What does VBA stand for in the context of financial modeling?\nWhat does it mean to 'use the wrong syntax' when using VBA?\nIn the context of VBA, what is a parameter?\nWhat is the function of the 'Enter' key when using VBA?\nHow are errors corrected in VBA?\nWhat does it mean when an error message pops up in VBA?\nWhat are the consequences of a typing error in VBA programming?\nWhat is the process to correct a mistake you've recognized in VBA?\nIn VBA, what is the purpose of the 'Help' feature?\nWhat is 'debug-break mode' in VBA?\nHow does one exit debug-break mode in VBA?\nHow can you fix a function in VBA?\nWhy is it important to have VBA check the module for errors?\nWhat is the purpose of Debug|Compile VBAproject in VBA?\nHow does VBA notify the user of a mistake?",
            "36.5 Fixing Mistakes in VBA\n\nO nce you start using VBA, you\u2019 r e sure to make mistakes. In this section we\nillustrate several typical mistakes and help you correct them. This list is not\nmeant to be exhaustive\u2014we have selected mistakes typically made by VBA\nbeginners.\nMistake 1: Using the Wrong Syntax\nS uppose that in writing Plus you forget the \u201c+ \u201d between p arameter1 and\nparameter2 (recall that the function is supposed to return parameter1 +\nparameter2 ). Once you hit the Enter key, you get the following error message:\nClicking the OK button corrects this problem.\n961 User-Defined Functions with VBA\nMistake 2: Right Syntax with a Typing Error\nI t\u2019 s easy to make typing errors that will only be detected once you try to use\nthe function. In the example below, we define two functions\u2014f unction1 and\nfunction2 . Unfortunately, the program line for f unction2 mistakenly calls the\nfunction \u201cfunction1\u201d:\nThe VBA editor does not immediately recognize this mistake. The mistake\nwill pop up when you try to use the function in a worksheet. Excel will notify\nyou that you \u2019 ve made a mistake and take you to the VBA editor:\nIf you recognize your mistake, you can correct it. You can also try to go to\nthe VBA help by clicking Help (in many cases this will lead to an incompre-\n962 Chapter 36\nS uppose you recognize your mistake. You click OK, and get ready to correct\nthe error by replacing the word \u201cFunction1\u201d with \u201cFunction2.\u201d At this point\nyour screen looks like this:\nNotice:\nA. The word [break] in the title bar.\nB. The offending symbol is selected.\nC . T he function line is highlighted and pointed to by an arrow in the margin.\nBecause VBA found an error while trying to execute the function, it moved\ninto a special execution mode called debug-break mode. For now all we need\nto do is get out of this special mode so we can get on with our work. We do\nthis by clicking the icon on the VBA toolbar. Now you can fix the function\nand use it.\nWe can (and should) have VBA check the module for errors before trying\nto use the functions in the module. From the VBA menu we select\nDebug|Compile VBAproject; this will find the first error in the module and\n963 User-Defined Functions with VBA"
        ],
        "36.6": [
            "What is the purpose of If statements in VBA Functions?\nWhat is a one-line If statement in VBA?\nHow does the one-line If statement execute a VBA function?\nWhat is an example of a one-line If statement in VBA that includes the 'Else' condition?\nWhat happens when the 'Else' part is omitted in a one-line If statement?\nIn OneLineIf function, what output is returned when the Parameter is greater than 5?\nIn OneLineIf function, what output is returned when the Parameter is less than 5?\nWhat is a good programming practice before introducing an If statement in a function?\nWhat purpose does assigning a value to a function serve before introducing an If statement?\nWhat is OneLineIf3 function and what does it return by default if the condition on Parameter is not fulfilled?\nWhat are If...ElseIf statements in VBA?\nHow are If...ElseIf statements used in VBA functions and what is their structure?\nWhat does BlockIf function returns when the parameter is less than zero?\nWhat does BlockIf function returns when the parameter is equal to zero?\nWhat does BlockIf function returns when the parameter is greater than zero?\nWhat is a nested If structure in VBA?\nCan If statements be used as part of the statements used in another If statement?\nWhat must an If statement in a nested If structure be?\nHow does a NestedIf function-demonstrate a nested If structure work in Excel?\nWhat is the output of the NestedIf function in Excel when P1 is greater than 10 and P2 is greater than 5?\nWhat does the NestedIf function return when both P1 and P2 are equal and greater than 5?",
            "36.6 Conditional Execution: Using If Statements in VBA Functions\n\nI n this section we explore the I f statements available to you in VBA. Not all\nthings in life are linear, and sometimes decisions have to be made. If state-\nments are one way of doing this in VBA\nThe One-Line If Statement\nThe one-line If statement is the simplest way to control the execution of a\nVBA function: One statement is executed if a condition is true and another is\nexecuted if a condition is not true. The complete condition and its statement\nshould be on one line. Here\u2019 s an example:\nFunction OneLineIf(Parameter)\nIf Parameter > 5 Then OneLineIf = 1\nElse OneLineIf = 15\nEnd Function\nW e can now use the function OneLineIf in Excel. When Parameter is >\n5, OneLineIf returns 1 and when P arameter is < 5, OneLineIf returns 15.\nA B C\n1 ONELINEIF IN ACTION\n2 Parameter\n3 12 1<-- =OneLineIf(A3)\n4 3 15<-- =OneLineIf(A4)\nThe one-line If statement doesn\u2019 t even need the E lse part. The function\nbelow, O neLineIf2 , returns 0 if the condition \u201cParameter > 5\u201d is not\nfulfilled:\nFunction OneLineIf2(Parameter)\nIf Parameter > 5 Then OneLineIf = 1\n964 Chapter 36\nA B C\nONELINEIF2 IN ACTION\n6\n7 Parameter\n8 12 1<-- =OneLineIf2(A8)\n9 3 0<-- =OneLineIf2(A9)\nGood Programming Practice: Assign a Value to Your Function First\nI n the above functions, it would be good programming practice to first assign\na value to the function before introducing the If statement. This way we know\nthat O neLineIf3 defaults to \u2212 16 if the condition on P arameter is not\nfulfilled.\nFunction OneLineIf3(Parameter)\nOneLineIf3 = -16\nIf Parameter > 5 Then OneLineIf3 = 1\nEnd Function\nTo see the difference this makes, look at the spreadsheet below:\nA B C\nONELINEIF3 IN ACTION\n11\n12 Parameter\n13 12 1<-- =OneLineIf3(A13)\n14 3 -16<-- =OneLineIf3(A14)\nIf \u2026 ElseIf Statements\nIf more than one statement is to be conditionally executed, the block I f\u2026\nElseIf statement can be used. It uses the following syntax:\nIf Condition0 T hen\nStatements\nElseIf Condition1 T hen\n965 User-Defined Functions with VBA\n[\u2026 More ElseIfs \u2026]\nElse\nStatements\nEnd If\nThe Else and E lseIf clauses are both optional. You may have as many E lseIf\nclauses as you want following an If, but none can appear after an E lse clause.\nIf statements can be contained within one another.\nHere \u2019 s an example:\nFunction BlockIf(Parameter)\nIf Parameter < 0 Then\nBlockIf = -1\nElseIf Parameter = 0 Then\nBlockIf = 0\nElse\nBlockIf = 1\nEnd If\nEnd Function\nHere \u2019 s how this function works in Excel:\nA B C\nBLOCKIF IN ACTION\n23\n24 Parameter\n25 -3 -1<-- =BlockIf(A25)\n26 0 0<-- =BlockIf(A26)\n27 13 1<-- =BlockIf(A27)\nNested If Structures\nAs stated in the previous section, I f statements can be used as part of the\nstatements used in another I f statement. A program structure that has some If\nstatements inside others is called a n ested If structure. Each I f statement in the\nstructure must be a complete I f statement. Either the one-line or the block\n966 Chapter 36\nThe following function demonstrates the use of the NestedIf structure:\nFunction NestedIf(P1, P2)\nIf P1 > 10 Then\nIf P2 > 5 Then NestedIf = 1 Else NestedIf\n= 2\nElseIf P1 < -10 Then\nIf P2 > 5 Then\nNestedIf = 3\nElse\nNestedIf = 4\nEnd If\nElse\nIf P2 > 5 Then\nIf P1 = P2 Then NestedIf = 5 Else\nNestedIf = 6\nElse\nNestedIf = 7\nEnd If\nEnd If\nEnd Function\nThis is how it looks in Excel:\nA B C D\nNESTEDIF IN ACTION\n30\n31 11 6 1<-- =NestedIf(A31,B31)\n32 22 3 2<-- =NestedIf(A32,B32)\n33 -22 6 3<-- =NestedIf(A33,B33)\n34 -57.3 4 4<-- =NestedIf(A34,B34)\n35 6 6 5<-- =NestedIf(A35,B35)\n36 -5 7 6<-- =NestedIf(A36,B36)\n967 User-Defined Functions with VBA"
        ],
        "36.7": [
            "What are Boolean expressions in the context of VBA functions?\nWhat are the two possible values of a Boolean expression?\nCan you name some of the most common comparison operators used in VBA?\nWhat does the '<' operator signify in VBA?\nWhat is meant by '<=' operator in VBA code?\nWhat does the '>' operator represent in VBA?\nWhat is the purpose of '>=' operator in VBA?\nWhat is meant by '=' operator in VBA?\nWhat is the significance of '<>' operator in VBA?\nWhat is the role of the \"And\" Boolean operator in VBA?\nHow can the Function AndDemo be used to check two conditions at the same time?\nWhat value does the AndDemo function return if both conditions hold?\nWhat value does the AndDemo function return if either one of the conditions is violated?\nWhat is the use of parentheses in the conditions mentioned in AndDemo function?\nCan you explain what does the \"Or\" Boolean operator do in VBA?\nWhat value does the OrDemo function return if at least one of the conditions hold?\nWhat value does the OrDemo function return if both conditions are violated?\nIs the concept of parentheses in the conditions applied in OrDemo function similar to that in AndDemo function?\nWhat role does parameters play in these VBA functions? \nWhat is the practical application of Boolean and comparison operators in financial modelling? \nWhat are the use cases for VBA user-defined functions in the field of finance modelling?\nCan you explain how to use VBA for creating custom financial models?",
            "36.7 The Boolean and Comparison Operators\n\nT he expressions used as conditions in an I f statement are also known\nas Boolean expressions. Boolean expressions can have one of two values:\nTRUE when the condition holds, and FALSE when the condition is violated.\nUsually Boolean expressions are constructed using the Comparison and/or\nBoolean operators. The following is a list of the most common Comparison\noperators.\nOperator Meaning\n< Less than\n< = Less than or equal to\n> Greater than\n> = Greater than or equal to\n= Equal to\n< > Not equal to\nThe And Boolean Operator\nThe next function uses a Boolean operator to check whether two conditions\nhold at the same time.\nFunction AndDemo(parameter1, parameter2)\nIf (parameter1 < 10) And (parameter2 > 15) _\nThen\nAndDemo = 3\nElse\nAndDemo = 12\nEnd If\n968 Chapter 36\nHere are some illustrations:\nA B C D\n1 ANDDEMO IN ACTION\n2 parameter1parameter2\n3 9 14 12<-- =AndDemo(A3,B3)\n4 9 16 3<-- =AndDemo(A4,B4)\n5 11 14 12<-- =AndDemo(A5,B5)\n6 11 16 12<-- =AndDemo(A6,B6)\nNotice what AndDemo does: It checks b oth conditions (parameter1 < 10)\nand (parameter2 > 15). If both conditions hold, then the combined conditions\nhold and the function returns a value of 3. Otherwise (i.e., if either one of the\nconditions is violated) it returns 12. (Note that both conditions are in\nparentheses.)\nT he following function and screen shot demonstrate all four possible com-\nbinations of two conditions and the resulting combined condition:\nFunction AndTable(parameter1, parameter2)\nAndDemoTable = parameter1 And parameter2\nEnd Function\nA B C D\n1 ANDDEMO IN ACTION\n2 parameter1 parameter2\n3 9 14 12<-- =AndDemo(A3,B3)\n4 9 16 3<-- =AndDemo(A4,B4)\n5 11 14 12<-- =AndDemo(A5,B5)\n969 User-Defined Functions with VBA\nThe Or Boolean Operator\nT he function O rDemo, illustrated below, checks whether at least one of two\nconditions holds:\nFunction OrDemo(parameter1, parameter2)\nIf (parameter1 < 10) Or (parameter2 > 15) _\nThen\nOrDemo = 3\nElse\nOrDemo = 12\nEnd If\nEnd Function\nA B C D\n18 ORDEMO IN ACTION\n19 parameter1parameter2\n20 9 14 3<-- =OrDemo(A20,B20)\n21 9 16 3<-- =OrDemo(A21,B21)\n22 11 14 12<-- =OrDemo(A22,B22)\n23 11 16 3<-- =OrDemo(A23,B23)\nNotice what OrDemo does: It checks whether either the first condition\n(Parameter1 < 10) or the second condition (Parameter2 > 15) or both\nconditions hold. Only if both conditions are violated will the function return\na value of 12. Otherwise (i.e., if either one or both of the conditions hold) it\nreturns 3. (Note that both conditions are in parentheses.)\nT he following function and the screen shot demonstrate all four possible\ncombinations of two conditions and the resulting combined condition:\nFunction OrDemoTable(parameter1, parameter2)\nOrDemoTable = parameter1 Or parameter2\n970 Chapter 36\nA B C D\n1 ORTABLE IN ACTION\nparameter1 parameter2\n2\n3 FALSE FALSE FALSE <-- =ORDemoTable(A3,B3)\n4 FALSE TRUE TRUE <-- =ORDemoTable(A4,B4)\n5 TRUE FALSE TRUE <-- =ORDemoTable(A5,B5)\n6 TRUE TRUE TRUE <-- =ORDemoTable(A6,B6)"
        ],
        "36.8": [
            "What is the function of loops in VBA?\nWhat is a top-checking loop in VBA?\nCan you explain the concept of a bottom-checking loop in VBA?\nWhat is the purpose of a Do statement in VBA?\nHow does a Do While statement work in VBA?\nHow is the behavior of the Do While statement demonstrated in the DoWhileDemo function?\nWhat is the difference between the Do While statement and the Do Loop While statement in VBA?\nHow does the Do Until statement work in VBA?\nHow does the Do Loop Until statement different from the Do Until statement in VBA?\nWhat is the Do Loop Until statement used for in VBA modeling?\nWhat is the purpose of a For loop in financial modeling?\nHow does a For loop differ from other looping constructs in VBA?\nHow is the behavior of the For loop demonstrated in the ForDemo1 function?\nWhat is the role of the Step part in a For loop statement?\nHow executing a For loop be different if the increment is not 1?\nCan the For loop count down? If yes, how can it be achieved?\nWhat does the function ForDemo2 demonstrate?\nHow can we exit a For loop early?\nWhat does the Exit For statement do in a For loop?\nHow is the Exit For statement used in the ExitForDemo function?",
            "36.8 Loops\n\nLooping structures are used when you need to do something repeatedly. As\nalways there is more than one way to achieve the desired effect. In general\nthere are two major looping constructs:\n\u2022 A top-checking loop : The loop condition is checked before anything else\ngets done. The something to be done can be left undone if the condition is not\nfulfilled on entry to the loop.\n\u2022 A bottom-checking loop: The loop condition is checked after the something\nto be done is done. The something to be done will always be done at least\nonce.\nV BA has the two major looping structures covered from all possible angles\nby the Do statement and its variations. All the following subsections will use\na version of the factorial function for demonstration purposes. The function\nused is defined as:\n971 User-Defined Functions with VBA\nThe Do While Statement\nThe Do While statement is a member of the top-checking loops family. It\nmakes VBA execute one or more statements z ero or more times, while a\ncondition is true. The following function demonstrates this behavior:\nFunction DoWhileDemo(N)\nIf N < 2 Then\nDoWhileDemo = 1\nElse\ni = 1\nj = 1\nDo While i < = N\nj = j * i\ni = i + 1\nLoop\nDoWhileDemo = j\nEnd If\nEnd Function\nA B C\nDOWHILEDEMO IN ACTION\n1\n2 5 120<-- =DoWhileDemo(A2)\n3 9 362880<-- =DoWhileDemo(A3)\n972 Chapter 36\nThe Do \u2026 Loop While Statement\nThe Do \u2026 L oop While statement is a member of the bottom-checking loops\nfamily. It makes VBA execute one or more statements one or more times,\nwhile a condition is true. The following function demonstrates this behavior:\nFunction DoLoopWhileDemo(N)\nIf N < 2 Then\nDoLoopWhileDemo = 1\nElse\ni = 1\nj = 1\nDo\nj = j * i\ni = i + 1\nLoop While i < = N\nDoLoopWhileDemo = j\nEnd If\nEnd Function\nA B C\nDOLOOPWHILEDEMO IN ACTION\n1\n2 5 120<-- =DoLoopWhileDemo(A2)\n3 9 362880<-- =DoLoopWhileDemo(A3)\n973 User-Defined Functions with VBA\nThe Do Until Statement\nThe Do Until s tatement is a member of the top-checking loops family. It\nmakes VBA execute one or more statements zero or more times, until a condi-\ntion is met. The following function demonstrates this behavior:\nFunction DoUntilDemo(N)\nIf N < 2 Then\nDoUntilDemo = 1\nElse\ni = 1\nj = 1\nDo Until i > N\nj = j * i\ni = i + 1\nLoop\nDoUntilDemo = j\nEnd If\nEnd Function\nA B C\nDOUNTILDEMO IN ACTION\n1\n2 5 120<-- =DoUntilDemo(A2)\n3 9 362880<-- =DoUntilDemo(A3)\n974 Chapter 36\nThe Do \u2026 Loop Until Statement\nThe Do \u2026 L oop Until s tatement is a member of the bottom-checking loops\nfamily. It makes VBA execute one or more statements o ne or more times, until\na condition becomes true. The following function demonstrates this\nbehavior:\nFunction DoLoopUntilDemo(N)\nIf N < 2 Then\nDoLoopUntilDemo = 1\nElse\ni = 1\nj = 1\nDo\nj = j * i\ni = i + 1\nLoop Until i > N\nDoLoopUntilDemo = j\nEnd If\nEnd Function\nA B C\nDOLOOPUNTILDEMO IN ACTION\n1\n2 5 120<-- =DoLoopUntilDemo(A2)\n3 9 362880<-- =DoLoopUntilDemo(A3)\n975 User-Defined Functions with VBA\nThe For Loop\nO ne last (for now) variation on the loopy theme, the For loop, is used mainly\nfor loops where the number of times the action is repeated is known in\nadvance. The following functions demonstrate its use and variations:\nFunction ForDemo1(N)\nIf N < = 1 Then\nForDemo1 = 1\nElse\nj = 1\nFor i = 1 To N Step 1\nj = j * i\nNext i\nForDemo1 = j\nEnd If\nEnd Function\nA B C\nFORDEMO1 IN ACTION\n1\n2 5 120<-- =ForDemo1(A2)\n3 9 362880<-- =ForDemo1(A3)\n4 13 6227020800<-- =ForDemo1(A4)\nThe Step p art of the statement can be dropped if (as is in our case) the\nincrement is 1. For example:\nFor i = 1 To N\nj = j * i\n976 Chapter 36\nI f you want the loop to count down, the S tep argument can be negative, as\ndemonstrated in the next function:\nFunction ForDemo2(N)\nIf N < = 1 Then\nForDemo2 = 1\nElse\nj = 1\nFor i = N To 1 Step -1\nj = j * i\nNext i\nForDemo2 = j\nEnd If\nEnd Function\nA B C\nFORDEMO2 IN ACTION\n1\n2 5 120<-- =ForDemo2(A2)\n3 9 362880<-- =ForDemo2(A3)\n4 13 6227020800<-- =ForDemo2(A4)\nThe For loop can be exited early by using the Exit For statement as demon-\nstrated in the next function (not the factorial function).\nFunction ExitForDemo(Parameter1, Parameter2)\nSum = 0\nFor i = 1 To Parameter1\nSum = Sum + i\nIf Sum > Parameter2 Then Exit For\nNext i\nExitForDemo = Sum\n977 User-Defined Functions with VBA\nA B C D\nEXITFORDEMO IN ACTION\n1\n2 Parameter1 Parameter2\n3 5 22 15<-- =ExitForDemo(A3,B3)\n4 6 22 21<-- =ExitForDemo(A4,B4)\n5 7 22 28<-- =ExitForDemo(A5,B5)\n6 8 22 28<-- =ExitForDemo(A6,B6)"
        ],
        "36.9": [
            "What functions of Excel can VBA use?\nHow is the binomial distribution defined?\nWhat does the variable 'p' represent in the binomial distribution?\nWhat does the variable 'x' represent in the binomial distribution?\nWhat does the variable 'n' represent in the binomial distribution?\nWhat is the function of the binomial coefficient?\nHow can number of ways of choosing x elements from among n elements be calculated?\nHow is the function 'Combin' used in Excel to calculate possible number of teams that can be formed from a set of candidates?\nHow is the binomial function applied inside a spreadsheet?\nWhat is the role of 'Application.WorksheetFunction.Combin(n, x)' in the VBA binomial function? \nWhy are most but not all Excel worksheet functions used in VBA?\nWhen is the underscore (_) used in VBA coding and what is its function?\nWhat causes Excel to return the error message \"#VALUE!\" in the binomial function when using VBA?\nWhat is the criterion for the variable 'x' in the computation used in the binomial function?\nWhat is the subject of Excel error values and where can it be discussed in detail?",
            "36.9 Using Excel Functions in VBA\n\nVBA can use most of Excel \u2019 s worksheet functions. We illustrate by showing\nhow to define the binomial distribution (even though this, itself, is an Excel\nfunction). The probability distribution of a binomial random variable is defined\n\u239bn\u239e\nas\nBinom( p,n,x)=\u239c\n\u239f\npx( 1\u2212p)n\u2212x\nwhere p is the probability of success;\n\u239dx\u23a0\n\u239bn\u239e n!\nx is the number of successes, and n is the number of trials. \u239c \u239f =\n\u239dx\u23a0 ( n\u2212x)\n!x!\nis the binomial coefficient, which gives the number of ways of choosing\nx elements from among n elements. For example, suppose you want to\nform a two-person team from eight candidates and you want to know\nhow many possible teams can be formed. The answer is given by\n\u239b8\u239e 8! 8\u22c57\u22c56\u22c55\u22c54\u22c53\u22c52\u22c51\n\u239c \u239f = = =28 . The Excel function Combin (8, 2) does\n\u239d2\u23a0 6!2! 6\u22c55\u22c54\u22c53\u22c52\u22c51\u22172\u22c51\nthis calculation.\nWe use this Excel function in the following VBA function:\nFunction Binomial(p, n, x)\nBinomial = Application.WorksheetFunction. _\nCombin(n, x) * p \u2227 x * (1 - p) \u2227 (n - x)\n978 Chapter 36\nAs usual, this can be applied inside a spreadsheet:\nA B C\nBINOMIAL IN ACTION\n1\n2 p 0.5\n3 n 10\n4 x 6\n5 Binomial 0.20507813<-- =Binomial(B2,B3,B4)\nNote that we used Application.WorksheetFunction.Combin(n, x) to\n\u239bn\u239e\ncompute \u239c \u239f in our function. As you might guess from its name (A pplication.\n\u239dx\u23a0\nWorksheetFunction.Something) , this function is the Excel Worksheet func-\ntion C ombin( ) . Most, but not all,5 Excel worksheet functions can be used in\nVBA in exactly the same way. For a complete list see the Help file.\nOne more thing to notice is the underscore (_) preceded by a space at the\nend of line 2. If a line gets too long to deal with, it can be continued on the\nnext line using this contraption (the second and third lines of B inomial are\none line as far as VBA is concerned). 6\nS uppose we try to use our Binomial function to calculate Binomial\n(0.5,10,15) . This won \u2019 t work:\nA B C\nBINOMIAL IN ACTION\n1\n2 p 0.5\n3 n 10\n4 x 15\n5 Binomial #VALUE! <-- =Binomial(B2,B3,B4)\n5 . W hen an equivalent function is available as a native VBA function, the corresponding\nExcel function is not available in VBA. For example, in VBA use rnd( ) and not Application.\nWorksheetFunction.Rand() and sqr( ) and not Application.WorksheetFunction.Sqrt( ) .\n6 . W hat\u2019 s too long? This is a matter of programming taste, but for our purposes any line over\n979 User-Defined Functions with VBA\n\u239bn\u239e\nThe reason for the problem is that in the computation \u239c \u239f used in\n\u239dx\u23a0\nBinomial , we have to have x < n . In this case, VBA causes Excel to return the\nerror message # VALUE! . The subject of Excel error values is somewhat\nobscure and is discussed in the Appendix to this chapter."
        ],
        "36.10": [
            "What are user-defined functions in VBA?\nWhat is the COMBIN function in Excel?\nHow is the factorial function defined for any positive number?\nCan user-defined functions be used within other user-defined functions?\nCan you recurse in user-defined functions? If so, what is an example?\nWhat is the role of the HomeFactorial function within the user-defined function HomeCombin?\nHow is the binomial function represented using the user-defined functions HomeCombin and HomeFactorial in VBA?\nWhat happens if you ask for the HomeFactorial of a negative number?\nWhat is a factorial function, and how is it used within HomeFactorial?\nWhat is the purpose of using error values in financial modeling VBA functions, and when might they be necessary?\nHow does Excel handle non-integer or negative inputs when using the HomeFactorial function?\nWhat do the terms xlErrValue and xlErrNum indicate in VBA financial modeling?\nHow are comments included in VBA code?\nWhat does the term \"recursion\" mean in the context of user-defined functions in VBA?",
            "36.10 Using User-Defined Functions in User-Defined Functions\n\nUser-defined functions can be used in other user-defined functions, just\nlike Excel functions. The next function is a replacement for the COMBIN\nworksheet function. COMBIN is defined as\nc( n,x)= n!\nwhere !\n( n\u2212x)\n!x!\nstands for the factorial function. (Recall that the factorial function n ! is defined\nfor any n > 0: 0! = 1, and for n > 0, n ! = n *( n \u2212 1)*( n \u2212 2) \u2026 1.)\nWe will now write our VBA version of the two functions: the factorial func-\ntion and the COMBIN function.\n1 Function HomeFactorial(n)\n2 If Int(n) < > n Then\n3 HomeFactorial = CVErr(xlErrValue)\n4 ElseIf n < 0 Then\n5 HomeFactorial = CVErr(xlErrNum)\n6 ElseIf n = 0 Then\n7 HomeFactorial = 1\n8 Else\n9 HomeFactorial = HomeFactorial(n - 1) * n\n10 End If\n11 End Function\nL ine 2 checks if the input is an integer by comparing the integer part of \u201cn\u201d\n980 Chapter 36\nasking for H omeFactorial(3.3) , then line 3 of the program will cause Excel\nto return # VALUE!. Similarly, lines 4 and 5 check if we have improperly asked\nfor HomeFactorial of a negative number; if this is the case, then line 5 causes\nExcel to return # NUM! . For a fuller explanation of the use of error values, see\nthe Appendix to this chapter.\nLine 9 introduces a new concept; the function uses itself to calculate the\nvalue it should return. This is called recursion. Here \u2019 s an illustration of the\nfunction in action:\nA B C D E\nRECURSION IN ACTION\n1\n2 1 1<-- 1 1<-- =HomeFactorial(A2)\n3 2 2<-- =B2*A3 2<-- =HomeFactorial(A3)\n4 3 6<-- =B3*A4 6<-- =HomeFactorial(A4)\n5 4 24<-- =B4*A5 24<-- =HomeFactorial(A5)\n6 5 120<-- =B5*A6 120<-- =HomeFactorial(A6)\nWe can now use HomeFactorial to create our VBA version of Combin\n(which we will call HomeCombin ):\nFunction HomeCombin(n, x)\nHomeCombin = HomeFactorial(n) / _\n(HomeFactorial(n - x) * HomeFactorial(x))\n981 User-Defined Functions with VBA\nFinally, we can use H omeCombin to create a VBA version of the binomial\nfunction:\nFunction HomeBinom(p, n, x)\nIf n < 0 Then\nHomeBinom = CVErr(xlErrValue) \u2018Make the function\n\u2018return #VALUE!\nElseIf x > n Or x < 0 Then\nHomeBinom = CVErr(xlErrNum) \u2018Make the function\n\u2018return #NUM!\nElse\nHomeBinom = HomeCombin(n, x) _\n* p \u2227 x * p \u2227 (n - x)\nEnd If\nEnd Function\nPutting Comments in VBA Code\nA s illustrated above, VBA will ignore anything on a line which follows\nan apostrophe (note that each new line of comments has to begin with\nan apostrophe."
        ]
    },
    "37": {
        "37.1": [
            "What is a function variable definition in financial modeling?\nWhat is an array in relation to financial modeling?\nHow is an array referenced in financial modeling?\nWhat are some examples of one- and two-dimensional arrays in financial modeling?\nHow is the relationship between arrays and worksheet ranges relevant in financial modeling?\nWhat distinguishes simple arrays from dynamic arrays?\nHow can the size of dynamic arrays be changed at run time?\nIn what ways are arrays utilized as parameters in financial modeling?\nWhat are typed variables in the context of financial modeling?\nCan you explain the concept of vectors and matrices in relation to arrays?\nWhat are the benefits of using arrays in the programming aspects of financial modeling?\nWhat could be potential applications for dynamic arrays in financial modeling? \nIn what context are typed variables used in financial modeling?\nWhat does it mean by arrays of the same type sharing the same name?",
            "37.1 Overview\n\nI n the first part of this chapter we introduce function variable definitions. The\nsecond part of the chapter introduces arrays. An array is a group of variables\nof the same type sharing the same name and referenced individually using an\nindex. Vectors and matrices are good examples of one- and two-dimensional\narrays. The relationship between arrays and worksheet ranges opens the dis-\ncussion, followed by sections describing simple and dynamic arrays (whose\nsize can be changed at run time). The chapter concludes with sections on the\nuse of arrays as parameters and a short discussion of typed variables."
        ],
        "37.2": [
            "What is the purpose of function variables in VBA?\nCan you explain the difference between parameter variables and simple variables in VBA?\nIn the context of VBA, how are parameters defined when a function is created?\nWhat is a common method of defining simple variables used within VBA?\nWhat does it mean when a variable is not recognized by Excel or other VBA functions?\nWhat is the implication of a variable being recognized only in the function where it was defined?\nIn what instances might it be beneficial to define variables at the start of a function in VBA?\nWhat is the 'Dim' statement in VBA used for?\nWhat is the purpose of the 'Option Explicit' statement in VBA?\nWhat does the Option Explicit statement do in terms of undeclared variable usage within a VBA module?\nWhat are the implications of using an undeclared variable if the Option Explicit statement is activated?\nHow can the definition of variables help to prevent errors in VBA functions?\nWhat will Excel do differently when a typing error in function is made and the Option Explicit statement is activated?\nWhat steps are necessary to correct an issue highlighted by the Option Explicit statement?",
            "37.2 Defining Function Variables\n\nFunction variables are used to store values. Function variables can be either\nparameter or simple variables. Parameters are defined when the function is\ndefined by listing them within parentheses after the function \u2019 s name. Up until\nnow we used simple variables as and when needed, relying on VBA to define\nthe variable for us when it was first used. In most scenarios encountered in\nthis book, this practice is good enough, and it has the advantage of being quick.\nThe first time we encountered both flavors of function variables was in\nthe function DoWhileDemo :\nFunction DoWhileDemo(N)\nIf N < 2 Then\nDoWhileDemo = 1\nElse\ni = 1 \u2018 A Loop counter\nj = 1 \u2018 An accumulator for the series\nDo While i < = N\nj = j * i\ni = i + 1\nLoop\nDoWhileDemo = j\nEnd If\n990 Chapter 37\nT he variable N i s a parameter that gets its value from the application that\nactivates the function (either Excel or another function). The variables i , j are\nsimple variables. Function variables (aka internal or local variables) of both\ntypes are recognized only in the function in which they were defined (implic-\nitly or explicitly) and are not recognized by Excel or by other VBA\nfunctions.\nAs this is a very short function, there really is no reason to define the vari-\nables explicitly and the addition of comments makes everything clear enough.\nLonger functions with more variables might benefit by defining the variables\nat the top of the function, as it makes for more maintainable, and clear pro-\ngramming. Simple variables are defined using the Dim statement as demon-\nstrated by the following function:\nFunction NewDoWhileDemo(N)\nDim i \u2018 a Loop counter\nDim j \u2018 An accumulator for the series\nIf N < 2 Then\nNewDoWhileDemo = 1\nElse\ni = 1\nj = 1\nDo While i < = N\nj = j * i\ni = i + 1\nLoop\nNewDoWhileDemo = j\nEnd If\nEnd Function\nThe Option Explicit Statement\nWe can make VBA alert us if we use an undeclared variable by inserting the\nOption Explicit statement as the first line in the module. With this statement\nany use of an undeclared variable will result in an error and not the creation\nof a new variable. The O ption Explicit statement holds for all the routines in\n991 Variables and Arrays\nF orcing the definition of variables can help prevent errors from creeping\ninto your functions. Here is an (slightly forced) example: The following func-\ntion contains a typing error (\u201cTemp\u201d is spelled \u201cRemp\u201d):\nFunction Typo(Parameter)\nRemp = Parameter * 3 + 1\nTypo = Temp\nEnd Function\nWithout the Option Explicit statement, Excel merrily displays the follow-\ning result:\nA B C\n1 TYPO IN ACTION\n2 5 0 <-- =Typo(A2)\nHowever, inserting the Option Explicit statement before the VBA code and\n992 Chapter 37\nOnce we are alerted to the problem, we can click the OK button, stop VBA\nfrom running, and fix the problem by replacing \u201cRemp\u201d with \u201cTemp.\u201d (Recall\nfrom Chapter 36 that after you fix the mistake in VBA, you have to press the\nbutton on the VBA editor toolbar.)"
        ],
        "37.3": [
            "What is a VBA array?\nWhat is an index in reference to a VBA array?\nWhat does it mean if a parameter is left type-less?\nWhat is the role of a variant parameter in a VBA function?\nWhat is the purpose of a SumRange function in VBA?\nWhat can be considered the first and last element of a variable R treated as an array?\nHow are indices used in ranges treated as arrays in VBA?\nWhat happens when a rectangular range is passed to a function in VBA?\nHow does VBA treat a rectangular array?\nWhat role does the second parameter in the function SumRange1 play?\nWhat is the purpose of a Payback Period Function in financial modelling?\nHow does the Payback function in VBA present a solution for a given investment scenario?\nUnder what circumstances would the Payback function return a wrong answer?\nHow can the issue with the Payback function be rectified in a situation when the investment does not pay back its initial outlay?\nWhat information would the PayBack1 function provide compared to the PayBack function in VBA?",
            "37.3 Arrays and Excel Ranges\n\nA VBA array is a group of variables of the same type sharing the same name\nand referenced individually using an index (or indices). VBA has its own\nversion of arrays and we shall deal with this type of array in the following\nsections. For now let us demonstrate the V ariant. If we want a function to\naccept an Excel range as a parameter we have to leave the parameter type-less,\nor declare the parameter as Variant (which amounts to the same thing). From\ninside the function the variable looks like an array. To demonstrate, we shall\nnow write a small function, S umRange , that sums the value in the first four\nelements of its parameter.\nFunction SumRange(R)\nS = 0\nFor i = 1 To 4\nS = R(i) + S\nNext i\nSumRange = S\nEnd Function\nA B\n1 SUMRANGE IN ACTION\n2 1 <-- 1\n3 2 <-- 2 A B C D\n4 3 <-- 3 1 SUMRANGE IN ACTION\n5 4 <-- 4 2 1 2 3 4\n993 Variables and Arrays\nIn both cases the variable R can be treated as an array, with the first element\nbeing R(1) and the last element R(4). Each of the elements can be treated as\na single variable, that is, R (2) is a variable and so is R(i-3) (assuming that i-3\nhas an integer value > = 1 and< = 4). Ranges treated as arrays always start with\nindex 1.\nWhat happens if the range passed to our function is rectangular? To dem-\nonstrate, we introduce a modified version of S umRange, inserting a second\nparameter that tells the function how many elements to sum.\nFunction SumRange1(R, N)\nS = 0\nFor i = 1 To N\nS = R(i) + S\nNext i\nSumRange = S\nEnd Function\nA B C D\n1 SUMRANGE1 IN ACTION\n2 3 4 5\n3 6 7 8\n4 9 10 11\n5 18 <-- =SumRange1(A2:C4,4)\n6 25 <-- =SumRange1(A2:C4,5)\n7 33 <-- =SumRange1(A2:C4,6)\nAs we can see, VBA treats the rectangular array as a linear array composed\nof the rows of the original range. The second parameter of the function\nSumRange1 indicates how many elements should be summed. Thus,\nfor example, Sumrange1(A2:C4,5) sums the first row plus two cells in the\nsecond row.\nA Payback Period Function\nA slightly more complex use of ranges can be shown with a simple Payback\n994 Chapter 37\nthe period of time required for the return on an investment to \u201crepay\u201d the sum\nof the original investment. For example, a $1,000 investment which pays cash\nflows of $500 per year has a 2-year payback period. To simplify matters, the\nfunction PayBack defined below gives a whole year solution. If the sum of\nthe cash flows for 5 years is < 0 and for 6 years is > 0, then the function will\nreturn 6. We also assume that the first cash flow is the initial investment (nega-\ntive) and that no other cash flows are negative.\nFunction PayBack(R, N)\nTemp = 0\nFor i = 1 To N\nTemp = Temp + R(i)\nIf Temp > = 0 Then Exit For\nNext i\nPayBack = i - 1\nEnd Function\nA B C D E F\n1 PAYBACK IN ACTION\n2 Period 1 2 3 4 5\n3 Cash-flow -1500 400 600 600 300\n4 PayBack 3 <-- =PayBack(B3:F3,5)\nT here are a few problems with this function as currently defined. One is that\nthe function returns a wrong answer if the investment does not pay back its\ninitial outlay, as demonstrated by the next screen shot.\nA B C D E F\n1 PAYBACK IN ACTION\n2 Period 1 2 3 4 5\n3 Cash-flow -4000 400 600 600 300\n995 Variables and Arrays\nT he problem is solved by inserting a check before returning the payback\nperiod.\nFunction PayBack1(r, n)\nTemp = 0\nFor i = 1 To n\nTemp = Temp + r(i)\nIf Temp > = 0 Then Exit For\nNext i\nIf Temp > = 0 Then\nPayBack1 = i - 1\nElse\nPayBack1 = \u201cNo Payback\u201d\nEnd If\nEnd Function\nA B C D E F\n1 PAYBACK1 IN ACTION\n2 Period 1 2 3 4 5\n3 Cash-flow -4000 400 600 600 300\n4 PayBack No Payback <-- =PayBack1(B3:F3,5)"
        ],
        "37.4": [
            "What is a VBA array in financial modeling?\nHow do you declare a VBA array? \nWhat is the role of the Dim statement in VBA array declaration?\nWhat is the default initial value of an index of VBA arrays?\nHow many elements does a MyArray with a declared value of 5 have?\nHow is an array element treated in VBA arrays?\nWhat is the function of the concatenation operator in VBA arrays?\nWhat happens when you try to access an array element outside the declared array in VBA?\nWhat are the functions LBound and UBound in VBA?\nHow are these functions useful in dealing with arrays?\nWhat is the role of the second parameter when using LBound and UBound functions on a multidimensional array?\nCan the LBound and UBound functions work for a range passed to a function? If not, how can we achieve the required results?\nHow can we make a VBA function case agnostic?\nWhat is the Excel language for the net present value of a series of cash flows?\nHow can we calculate the net present value using Excel?\nWhat is nNPV function?\nWhat is the meaning of the definition of the internal rate of return (IRR)?\nWhat is the technique of successive refinement used for in financial modeling?\nHow can we calculate IRR using this technique?\nWhat is the default value of guess parameter in the nIRR function?\nWhat is an optional parameter and how is it declared?\nWhat is the significance of the 'Option base' statement in VBA?\nHow can we change the starting index of VBA arrays?\nWhat is the implication of 'Option Base 1' statement in arrays?",
            "37.4 Simple VBA Arrays\n\nThere are several ways to declare VBA arrays, all using the Dim statement.\nThe simplest way to declare an array is simply to tell VBA the largest value\nthe array index can take. Unless you indicate otherwise, VBA arrays always\nstart with index 0. In the function below, MyArray has 6 elements numbered\n996 Chapter 37\nFunction ArrayDemo1()\nDim MyArray(5)\nFor i = 0 To 5\nMyArray(i) = i * i\nNext i\nS = \u201c\u201d\nFor i = 0 To 5\nS = S & \u201c # \u201c & MyArray(i)\nNext i\nArrayDemo1 = S\nEnd Function\nIf you use ArrayDemo1 in a spreadsheet, here is the result:\nA B\n1 ARRAYDEMO1 IN ACTION\n2 # 0 # 1 # 4 # 9 # 16 # 25 <-- =ArrayDemo1()\nNotice:\n\u2022 MyArray has six elements (variables), the first being M yArray(0) and the\nlast M yArray(5) . All VBA arrays start from 0, unless you specify otherwise\n(see discussion of Option Base below).\n\u2022 An array element is treated just like a variable. M yArray(2) is a variable\nand so is MyArray(i-3) (assuming that i-3 has an integer value > = 0 and\n< = 5).\n\u2022 The use of the concatenation operator &. This operator concatenates (com-\nbines) its two operands to create a string. If an operand to the concatenation\noperator is not a string, it is converted to a string, and then the concatenation\ntakes place.\nI f you try and access an array element that is not part of the array, VBA will\n997 Variables and Arrays\nFunction ArrayDemo2(N)\nDim MyArray(5)\nDim i As Integer\nFor i = 0 To 5\nMyArray(i) = i * i\nNext i\nArrayDemo2 = MyArray(N)\nEnd Function\nA B C\n1 ARRAYDEMO2 IN ACTION\n2 0 0 <-- =ArrayDemo2(A2)\n3 1 1 <-- =ArrayDemo2(A3)\n4 2 4 <-- =ArrayDemo2(A4)\n5 3 9 <-- =ArrayDemo2(A5)\n6 4 16 <-- =ArrayDemo2(A6)\n7 5 25 <-- =ArrayDemo2(A7)\n8 6 #VALUE! <-- =ArrayDemo2(A8)\nLBound and UBound\nLBound and U Bound are two internal VBA functions that are very useful\nwhen dealing with arrays . T hese functions return the minimum and maximum\nvalue that an array index can have. The following function demonstrates their\nuse on a one-dimensional array:\nFunction ArrayDemo3(N)\nDim MyArray(5)\nIf N = \u201cLB\u201d Then\nArrayDemo3 = LBound(MyArray)\nElseIf N = \u201cUB\u201d Then\nArrayDemo3 = UBound(MyArray)\nEnd If\n998 Chapter 37\nA B C\n1 ARRAYDEMO3 IN ACTION\n2 LB 0 <-- =ArrayDemo3(A2)\n3 UB 5 <-- =ArrayDemo3(A3)\nNote that the array MyArray has six elements, the first being M yArray(0)\nas indicated by LBound , and the last being M yArray(5) as indicated by\nUBound .\nWhen used on a multidimensional array, a second parameter should be sup-\nplied indicating the dimension in whose bounds we are interested, as the next\nfunction demonstrates.\nFunction ArrayDemo4(Dimension, Bound)\nDim MyArray(2, 3, 4)\nIf Bound = \u201cLB\u201d Then\nArrayDemo4 = LBound(MyArray, Dimension)\nElseIf Bound = \u201cUB\u201d Then\nArrayDemo4 = UBound(MyArray, Dimension)\nEnd If\nEnd Function\nA B C D\n1 ARRAYDEMO4 IN ACTION\n2 LB 1 0 <-- =ArrayDemo4(B2,A2)\n3 UB 1 2 <-- =ArrayDemo4(B3,A3)\n4 LB 2 0 <-- =ArrayDemo4(B4,A4)\n5 UB 2 3 <-- =ArrayDemo4(B5,A5)\n6 LB 3 0 <-- =ArrayDemo4(B6,A6)\n999 Variables and Arrays\nHow to Get the Bound of an Excel Range in a Function\nS adly the internal functions UBound and LBound do not work for a range\npassed to a function. We can make use of the fact that the parameter is actually\na range and use some of its properties to get the result we need. The following\nfunction demonstrates this:\nFunction RangeBound(R, What)\nIf What = \u201cC\u201d Then\nRangeBound = R.Columns.Count\nElseIf What = \u201cR\u201d Then\nRangeBound = R.Rows.Count\nEnd If\nEnd Function\nA B C\n1 RANGEBOUND IN ACTION\n2 C 2 <-- =rangebound(D1:E5,A2)\n3 R 5 <-- =rangebound(D2:E6,A3)\n4 c 0 <-- =rangebound(D3:E7,A4)\n5 r 0 <-- =rangebound(D4:E8,A5)\nD id you notice that the function does not work with lowercase characters?\nIf we want to be case agnostic, as one usually does, we can use the VBA func-\ntion UCase to convert \u201cwhat\u201d to uppercase.\nFunction RangeBound1(R, What)\nIf UCase(What) = \u201cC\u201d Then\nRangeBound1 = R.Columns.Count\nElseIf UCase(What) = \u201cR\u201d Then\nRangeBound1 = R.Rows.Count\nEnd If\n1000 Chapter 37\nA B C\n1 RANGEBOUND1 IN ACTION\n2 C 2 <-- =rangebound1(D1:E5,A2)\n3 R 5 <-- =rangebound1(D2:E6,A3)\n4 c 2 <-- =rangebound1(D3:E7,A4)\n5 r 5 <-- =rangebound1(D4:E8,A5)\n6 1 0 <-- =rangebound1(D5:E9,A6)\nFixing Excel \u2019 s NPV Function\nRecall from Chapter 1 that\nE xcel\u2019 s language about discounted cash flows differs somewhat from the standard\nfinance nomenclature. Excel uses the letters NPV to denote the present value (n ot the\nnet present value) of a series of cash flows.\nTo calculate the finance net present value of a series of cash flows using Excel, we\nhave to calculate the present value of the future cash flows (using the Excel NPV func-\ntion) and subtract from this present value the time-zero cash flow. (This is often the\ncost of the asset.)\nLet us try and write a function n NPV that addresses this shortcoming. In\nthe process we shall learn a few things about Excel Ranges in VBA. In order\nto make the function simple, it will only work on a row of cash flows.\nFunction nNPV(Rate, R)\nnNPV = R(1) + Application.WorksheetFunction _\n.npv(Rate, R.Range(\u201cB1\u201d, R.End(xlToRight)))\nEnd Function\nR.Range(CellTopLeft,CellBottomRight) returns a range defined by its\nparameters. Note that the cell addresses are relative to R and not the\nworksheet.\nR.End(Direction) returns one of the four possible last cells in theR accord-\ning to D irection . Possible values for D irection are xlDown, xlToLeft,\n1001 Variables and Arrays\nAssuming R is a row of cells, R.Range(\u201cB1\u201d, R.End(xlToRight)) returns\na range containing all the cells in R excluding the first one.\nA B C D E F\n1 NNPV IN ACTION\n2 Cash Flows \u25b6 -400 100 100 100 100\n3 Rate \u25b6 10%\n4 Excel NPV \u25b6 -75.4667776 <-- =NPV($B$3,$B$2:$F$2)\n5 Excel C 0+NPV \u25b6 -83.01345537 <-- =$B$2+NPV($B$3,$C$2:$F$2)\n6 nNPV \u25b6 -83.01345537 <-- =nNPV($B$3,$B$2:$F$2)\nA New IRR Function\nA nother useful function we can write using our newly acquired tools is n IRR .\nRecall from Chapter 1 that the internal rate of return (IRR) is defined as the\ncompound rate of return r that makes the NPV equal to zero:\nC F\n+\u2211N CF\nt =0\n0 ( 1+r)t\nt=0\nWe now use a technique called successive refinement to calculate IRR:\n1. If we were given an initial guess for r we use it and if not we use 50% to\ncalculate NPV.\n2 . I f the calculated NPV is zero (or sufficiently near) we return the current\nguess.\n3. If the calculated NPV is negative we set our guess to r = r + r /2.\n4. If the calculated NPV is positive we set our guess to r = r \u2212 r /2.\n5. We shall now recalculate NPV.\n6. Repeat steps 2\u20135.\nW e assume that the first cash flow is negative and that all others are\n1002 Chapter 37\nHere is the function:\nFunction nIRR(R, Optional guess = 0.5)\nn = nNPV(guess, R)\nDo While Abs(npv) > 0.0001\nIf n < 0 Then\nguess = guess - guess / 2\nElse\nguess = guess + guess / 2\nEnd If\nn = nNPV(guess, R)\nLoop\nnIRR = guess\nEnd Function\nOptional Parameters\nNote that the use of Optional guess = 0.5 to declare the last parameter as\noptional and give it a default value if the user did not supply one. Once a\nparameter is declared as optional, all the following parameters have to be\ndeclared optional as well. For example, this declaration is fine:\n1003 Variables and Arrays\nWhereas this will result in an error:\nAs noted, this function is very slow so it might take a few seconds to calculate\nits results.\nA B C D E F\n1 NIRR IN ACTION\n2 Cash Flows \u25b6 -375 100 100 100 100\n3 Guess \u25b6 5%\n4 IRR \u25b6 2.63247% <-- =IRR($B$2:$F$2,$B$3)\n5 nIRR \u25b6 2.63247% <-- =nIRR($B$2:$F$2,$B$3)\n6 nIRR \u25b6 2.63248% <-- =nIRR($B$2:$F$2)\n7 nNPV \u25b6 7.708E-11 <-- =nNPV($B$4,$B$2:$F$2)\n8 nNPV \u25b6 9.795E-06 <-- =nNPV($B$5,$B$2:$F$2)\n1004 Chapter 37\nThe Option Base Statement\nExcel arrays start at 1, whereas VBA arrays start at 0, unless otherwise defined.\nWe can use a module option to make all not specifically declared array indices\nstart at 1. We use A rrayDemo3 to demonstrate. We open a new VBA module\nwith first line \u201cOptionBase1.\u201d We rename our previous function to reflect this\nchange.\nOption Base 1\nFunction ArrayDemo3OptionBase1(N)\nDim MyArray(5)\nIf N = \u201cLB\u201d Then\nArrayDemo3OptionBase1 = LBound(MyArray)\nElseIf N = \u201cUB\u201d Then\nArrayDemo3OptionBase1 = UBound(MyArray)\nEnd If\nEnd Function\nI f we insert Option Base 1 as the first line of the module to get (the only\nchange is in cell B2 where we get 1 and not 0).\nA B C\n1 ARRAYDEMO3OPTIONBASE1 IN ACTION\n2 LB 1 <-- =ArrayDemo3Optionbase1(A2)\n3 UB 5 <-- =ArrayDemo3Optionbase1(A3)\nThe Option Base 1 statement, like all option statements, should be inserted\nbefore all functions and subroutines in a module. Like all option statements,\n1005 Variables and Arrays"
        ],
        "37.5": [
            "What is a multidimensional array in the context of Visual Basic for Applications (VBA)?\nWhat is the role of indices in a multidimensional array?\nWhat's the maximum limit for indices that we can declare in an array in VBA?\nCan you explain how to declare a multidimensional array in VBA with an example?\nWhat are the key components in the syntax for declaring a multidimensional array in VBA?\nCan you explain how the Matrix1 function works in VBA with multidimensional arrays?\nWhat is the role of rows and columns in a two-dimensional array?\nWhat are the functions LBound and UBound and how they are used with multidimensional arrays in VBA?\nWhat does the argument to LBound and UBound represent in a multidimensional array in VBA?\nWhat happens when LBound and UBound are used with only one argument?\nHow does Matrix2 function work with LBound and UBound functions in VBA for multidimensional arrays?",
            "37.5 Multidimensional Arrays\n\nArrays can have more than one index. In a two-dimensional array the first\nindex refers to the rows and the second to the columns. There is no formal\nlimit to the number of indices you can declare in an array. The syntax for\ndeclaring a multidimensional array is demonstrated in the following\nfunctions:\nFunction Matrix1(R, C)\nDim MyMat(2, 1)\nFor i = 0 To 2\nFor j = 0 To 1\nMyMat(i, j) = i * j\nNext j\nNext i\nIf R > = 0 And R < = 2 And C > = 0 And C < = 1 _\nThen\nMatrix1 = MyMat(R, C)\nEnd If\nEnd Function\nA B C D\n1 MATRIX1 IN ACTION\n2 R C Matrix1(R,C)\n3 0 0 0 <-- =Matrix1(A3,B3)\n4 1 0 0 <-- =Matrix1(A4,B4)\n5 2 0 0 <-- =Matrix1(A5,B5)\n6 0 1 0 <-- =Matrix1(A6,B6)\n7 1 1 1 <-- =Matrix1(A7,B7)\n8 2 1 2 <-- =Matrix1(A8,B8)\n9 3 1 0 <-- =Matrix1(A9,B9)\n1006 Chapter 37\nThe following function demonstrates the use of L Bound and U Bound with\nmultidimensional arrays:\nFunction Matrix2(R, C)\nDim MyMat(1, 1)\nFor i = LBound(MyMat, 1) To UBound(MyMat, 1)\nFor j = LBound(MyMat, 2) To _\nUBound(MyMat, 2)\nMyMat(i, j) = i * j\nNext j\nNext i\nIf R > = LBound(MyMat, 1) And _\nR < = UBound(MyMat, 1) And _\nC > = LBound(MyMat, 2) And _\nC < = UBound(MyMat, 2) Then\nMatrix2 = MyMat(R, C)\nEnd If\nEnd Function\nA B C D\n1 MATRIX2 IN ACTION\n2 R C Matrix2(R,C)\n3 0 0 0 <-- =Matrix2(A3,B3)\n4 1 0 0 <-- =Matrix2(A4,B4)\n5 2 0 0 <-- =Matrix2(A5,B5)\n6 0 1 0 <-- =Matrix2(A6,B6)\n7 1 1 1 <-- =Matrix2(A7,B7)\n8 1 2 0 <-- =Matrix2(A8,B8)\nNote the use of the second argument to LBound and U Bound . If used with\nonly one argument, both functions return the largest index value the first\ndimension of the array can have; if the array has more than one dimension (as\nin this case), we can use a second argument to the function to specify the\n1007 Variables and Arrays"
        ],
        "37.6": [
            "What is a dynamic array in VBA?\nHow do you declare a dynamic array in VBA?\nWhat is the role of the ReDim statement in setting the size of a dynamic array?\nHow can you change the size of an array when the program is running?\nHow can you use a variable to set the size of a dynamic array?\nWhat does the ReDim Preserve statement do in VBA?\nWhat limitations are imposed by the use of the ReDim Preserve statement?\nWhat is the use of the ReDim Preserve statement in interactive programs?\nHow is the present value of a series of future cash flows calculated using dynamic arrays in VBA?\nWhat is the function of the interest rate in calculating the present value of a future cash flow series with a dynamic array?\nWhat happens when you change the size of a dynamic array in VBA?\nHow do you determine the size of an original input in VBA, using dynamic arrays?\nHow is the ReDim statement used to re-dimension an array in VBA?",
            "37.6 Dynamic Arrays and the ReDim Statement\n\nE very so often it can be handy to have the size of an array set (and reset) when\nthe program is running. Dynamic arrays are arrays that can have their size\nchanged at run time. You declare dynamic arrays using the Dim statement but\nwith nothing in the parentheses, as in:\nDim SomeName()\nBefore you can use the array you need to set its size using the ReDim state-\nment, as in:\nReDim ArrayName(SomeIntegerExpression)\nFor example, you might type\nReDim Prices(12)\nTo set the size of the dynamic array P rices to 12 elements, a more typical\ncase would involve the use of a variable for the size as in:\nReDim Prices(I)\nThis will set the size of Prices to the value of I.\nThe ReDim statement can also be used to change the size of a dynamic\narray (or indeed any VBA array). If you change the size of an array, all the\n1008 Chapter 37\nReDim Preserve ArrayName(SomeIntegerExpression)\nThe following function calculates the present value of a series of future cash\nflows. To simplify the function, the interest rate is fixed at 5% per period. The\nfunction illustrates the use of a dynamic array (the variable CF) that derives\nits size from the size of the original input (the variable n ):\nFunction DynPV(r As Range)\n\u2018 n is number of periods\n\u2018 cf() is dynamic array for cash\n\u2018 fl ows\nDim n\nDim cf()\nDim Temp\nDim i\n\u2018Below we distinguish if the data\n\u2018is in a column or in a row\nIf r.Columns.Count = 1 Then\nn = r.Rows.Count\nElseIf r.Rows.Count = 1 Then\nn = r.Columns.Count\nElse\nExit Function\nEnd If\n\u2018 re-dimension the array\nReDim cf(1 To n)\nFor i = 1 To n\ncf(i) = r(i)\nNext i\nTemp = 0\nFor i = 1 To n\nTemp = Temp + cf(i) / 1.05 \u2227 i\nNext i\nDynPV = Temp\n1009 Variables and Arrays\nRunning the function produces the following:\nA B C\n1 DYNPV IN VERTICAL ACTION\n2 Cash Flows\n3 100\n4 200\n5 300\n6 DynPV \u25b6 535.79527 <-- =DynPV(A3:A5)\nA B C D\n1 DYNPV IN HORIZONTAL ACTION\n2 Cash Flows \u25b6 100 200 300\n3 DynPV \u25b6 535.79527 <-- =DynPV(B2:D2)\nUsing the ReDim Preserve Statement\nAs stated previously the P reserve part of the ReDim statement prevents the\nloss of data from the re-dimensioned array. The use of Preserve imposes two\nmajor limitations on the use of R eDim .\n\u2022 The inability to change the lower boundary of the index.\n\u2022 The inability to change the number of dimensions.\nT he main use of the ReDim Preserve is in interactive programs and as such\nit will be demonstrated in a later chapter dealing with user interaction."
        ],
        "37.7": [
            "What is an Array Assignment in financial modeling?\nWhat is the function of ArrayAssignError() in VBA?\nWhat does the Dim Array1(5) signify in VBA?\nWhat operation does Array1(i) = i * i perform?\nCan you assign one array to another directly in VBA? Why or why not?\nWhat is the purpose of the For loop in assigning arrays in VBA?\nWhat is the significance of the \"End Function\" statement in a VBA function?\nWhat does the \"Next i\" command do in a VBA For loop?\nHow can you assign elements of one array to another in VBA?\nWhat is the role of the \":\" operator in VBA statements?\nHow can you place two or more short statements on the same line in VBA?\nWhat is a shorter way to assign arrays in VBA? \nCan you give an example of the use of a For loop to assign each element in an array separately in VBA? \nIn the context of VBA, why is the use of a For loop necessary for array assignment?",
            "37.7 Array Assignment\n\nH ere\u2019 s an error that\u2019 s easy to make: In the following example we want to tell\n1010 Chapter 37\nFunction ArrayAssignError()\nDim Array1(5)\nDim Array2(5)\nFor i = 0 To 4\nArray1(i) = i * i\nNext i\nArray2 = Array1\nArrayAssignError = Array2\nEnd Function\nVBA doesn \u2019 t allow this, as you can see on the next screen shot.\nO bviously one way to assign arrays is to assign each element separately\nusing a For loop.\nFor I = 0 To 4: Array2(I) = Array1(I):\n1011 Variables and Arrays\nThe : Operator\nN ote the use of the \u201c: \u201d operator to signal the end of a statement. This way we\ncan put two or more short statements on the same line. Another, much shorter,\nway of assigning arrays is discussed in the next section."
        ],
        "37.8": [
            "What is a Variant type variable in VBA?\nHow can a Variant type variable contain an array?\nWhat is the procedure to declare a Variant type variable containing an array?\nWhat is the use of the Array() function in VBA and how is it used in context with a Variant variable?\nWhat is the significance of the ReDim statement when working with Variant type in VBA?\nWhat does the statement `If r.Columns.Count = 1 Then \u2018data in column` imply in terms of data in a Variant containing an array?\nIn the context of data in an array, what is meant by \u2018data in column\u2019 in VBA?\nIn VBA, what is the significance of initializing an unassigned Variant variable as an array?\nWhat does the statement `n = r.Rows.Count` imply in the context of counting elements in an array?\nWhat occurs if the condition `If j > = 1 And j < = n Then` is met in VBA?\nHow can this Variant containing an array be applied in a worksheet context?\nWhat is the significance of the statement `ArrayAssign = Array2(j)` in VBA?\nWhat role does data in rows play in this context?\nWhat would be the consequence of invalid data in terms of array assignment?",
            "37.8 Variants Containing an Array\n\nA Variant type variable can contain an array. The procedure is somewhat more\ncomplicated than the declaration of a normal array, but the reward in terms of\nassignment is sometimes worth the inconvenience. The following function\ndemonstrates the use of a V ariant containing an array:\n01 Function ArrayAssign(r, j)\n02 Dim Array1 \u2018This is a variant\n03 Dim Array2 \u2018This is a variant\n04 Dim n \u2018number of elements\n\u2018in R\n05 Array1 = Array()\n06 If r.Columns.Count = 1 Then \u2018data in column\n07 n = r.Rows.Count\n08 ElseIf r.Rows.Count = 1 Then \u2018data in row\n09 n = r.Columns.Count\n10 Else \u2018invalid data\n11 Exit Function\n12 End If\n13 ReDim Array1(1 To n)\n14 For i = 1 To n\n15 Array1(i) = r(i)\n16 Next i\n17 \u2018****************************Watch this spot\n18 Array2 = Array1 \u2018Watch this spot\n19 \u2018****************************Watch this spot\n20 If j > = 1 And j < = n Then\n21 ArrayAssign = Array2(j)\n22 End If\n1012 Chapter 37\nThe Array() function (on the fifth line) returns a V ariant containing an\narray. The assignment on the same line makes A rray1 into an array (not ini-\ntialized at the moment). The ReDim statement on line 15 makes Array1 into\nan n element array. The reward for all our trouble is illustrated on line 18.\nHere is the function in a worksheet context:\nA B C D E\n1 ARRAYASSIGN IN HORIZONTAL ACTION\n2 55 88 77 12 99\n3 1 55 <-- =ArrayAssign($A$2:$E$2,A3)\n4 2 88 <-- =ArrayAssign($A$2:$E$2,A4)\n5 3 77 <-- =ArrayAssign($A$2:$E$2,A5)\n6 4 12 <-- =ArrayAssign($A$2:$E$2,A6)\n7 5 99 <-- =ArrayAssign($A$2:$E$2,A7)\n8 6 0 <-- =ArrayAssign($A$2:$E$2,A8)"
        ],
        "37.9": [
            "What does it mean to use arrays as parameters to functions in VBA?\nWhat does the ComputePV function compute in financial modeling?\nHow do you use the LBound and UBound functions with arrays in VBA?\nWhat is the purpose of the GetN function in this context?\nWhat does the function NewDynPV do in the given context?\nHow does the dynamic array for cash flows work in the NewDynPV function?\nWhat does the function fNPV calculate in the financial modeling context?\nHow is the fIRR function used to make IRR and NPV calculations faster?\nWhat does the Do While Abs(npv) operation do in the fIRR function?\nHow can the performance of the financial modeling functions be further improved?\nCan arrays aid in simplifying and speeding up financial modeling tasks?\nWhat effect does redimensioning an array have on the NewDynPV function?\nWhy is the guess factor optional in the fIRR function?\nHow do internal arrays make the IRR and NPV calculations faster?\nWhat can the 'Guess' value represent in the fIRR function?",
            "37.9 Arrays as Parameters to Functions\n\nArrays can be used as parameters to functions. The following set of functions\npresents an improved version of D ynPV d iscussed in section 37.6. Notice how\nmuch easier it is to read the main function N ewDynPV , when all the auxiliary\ntasks are relegated to separate functions.\nA function C omputePV(CF()) is used to compute the present value of a\nseries of cash flows contained in an array of Doubles .\nFunction ComputePV(CF())\nTemp = 0\nFor i = LBound(CF) To UBound(CF)\nTemp = Temp + CF(i) / 1.05 \u2227 i\nNext i\nComputePV = Temp\n1013 Variables and Arrays\nNote the fact that in C omputePV(CF()) , CF() has to be declared without\nindex information. Consequently, we use L Bound and U Bound to get index\ninformation.\nThe function GetN(R As Range) returns the number of elements in R:\nFunction GetN(R As Range)\nIf R.Columns.Count = 1 Then \u2018data in column\nGetN = R.Rows.Count\nElseIf R.Rows.Count = 1 Then \u2018data in row\nGetN = R.Columns.Count\nElse\nGetN = 0\nEnd If\nEnd Function\nHere is the main function:\nFunction NewDynPV(R As Range)\nDim n As Integer \u2018 Number of periods\nDim CF() As Double \u2018 Dynamic array for cash fl ows\nn = GetN(R)\nIf (n = 0) Then\nNewDynPV = n\nExit Function\nEnd If\nReDim CF(1 To n) \u2018 re-dimension the array\nFor i = 1 To n\nCF(i) = R(i)\nNext i\nNewDynPV = ComputePV(CF)\n1014 Chapter 37\nA B C D\n1 NEWDYNPV IN ACTION\n2 Cash Flows \u25b6 100 200 300\n3 NewDynPV \u25b6 535.79527 <-- =newDynPV(B2:D2)\nBetter IRR and NPV Functions\nWe can now revisit n IRR and nNPV from section 37.4, and try and make\nthem faster using internal arrays.\nFunction fNPV(Rate, cf)\nTemp = 0\nFor i = LBound(cf, 2) + 1 To UBound(cf, 2)\nTemp = Temp + cf(1, i) / (1 + Rate) \u2227 _\n(i - 1)\nNext i\nfNPV = Temp + cf(1, LBound(cf, 2))\nEnd Function\nFunction fIRR(R, Optional guess = 0.5)\ncf = R.Value\nn = fNPV(guess, cf)\nDo While Abs(npv) > 0.0001\nIf n < 0 Then\nguess = guess - guess / 2\nElse\nguess = guess + guess / 2\nEnd If\nn = fNPV(guess, cf)\nLoop\nfIRR = guess\n1015 Variables and Arrays\nA B C D E F\n1 FIRR IN ACTION\n2 Cash Flows \u25b6 -375 100 100 100 100\n3 Guess \u25b6 5%\n4 IRR \u25b6 2.63247% <-- =IRR($B$2:$F$2,$B$3)\n5 fIRR \u25b6 2.63247% <-- =fIRR($B$2:$F$2,$B$3)\n6 fIRR \u25b6 2.63248% <-- =fIRR($B$2:$F$2)\n7 nNPV \u25b6 7.70797E-11 <-- =nNPV($B$4,$B$2:$F$2)\n8 nNPV \u25b6 9.79546E-06 <-- =nNPV($B$5,$B$2:$F$2)\n9 nNPV \u25b6 -9.54928E-05 <-- =nNPV($B$6,$B$2:$F$2)\nThis works an order of magnitude faster but can be further improved."
        ],
        "37.10": [
            "What are types in VBA?\nHow are all values, variables and functions in VBA categorized?\nWhat is the default type for all variables and functions in VBA?\nWhat variable type includes all other categories?\nWhen can it be useful to give a variable a type other than Variant in VBA?\nHow does giving a variable a type in VBA benefit us?\nHow would you define a typed variable in VBA?\nWhat is an example of defining a typed variable in VBA?\nWhat are the benefits of using typed variables in the function RangeBound?\nWhat hints does the VBA provide when a function has a variable with a type?\nWhat are properties and methods in the context of VBA? \nWhat happens when you type a period after a VBA variable's name?\nWhat information does VBA provide when a selected property has properties of its own?\nHow does VBA assist with selecting properties or methods for a typed variable?",
            "37.10 Using Types\n\nA ll values, variables, and functions in VBA are categorized into types, either\nby default or explicitly. By default all variables and functions in VBA are of\nthe type Variant . Variant is a category of values (type) that includes all other\ncategories. In most cases we can just ignore the type, but sometimes it can be\nvery useful to give a variable a type other than Variant. Variable types allow\nVBA to give us information about the variable as we use it, and this will\nbecome apparent as we start using Excel objects in the following chapters. For\nnow we will just explain the mechanics of defining a typed variable, and\nprovide a short demonstration of the help offered by VBA when dealing with\ntyped variables. A type is given to a variable when it is defined by following\nthe variables name with the word As followed with a type name. For example,\nthe statement \u201cDim x As Integer\u201d defines a variable named x of the type\nInteger.\nT o demonstrate the usefulness of typed variables recall the function\nRangeBound from section 37.4. Here is a new version with the first parameter\nexplicitly given the type Range. Although not necessary (it worked without\nit), it does make life easier. When you type in the function and a variable has\na type, VBA can give you hints as you try to use properties. In our example,\nas soon as you type the period after R, VBA provides a list of possible Proper-\nties or Methods. If the selected property (Rows, in our case) has properties\nof its own, then a period following its name will produce a list for you to\n1016 Chapter 37"
        ],
        "37.11": [
            "What is the function of variables in VBA?\nWhat does it mean to hold all sorts of information in variables?\nWhat are Typed Variables in VBA?\nHow can Typed Variables simplify your programming task?\nWhat is an array in VBA?\nWhat does it mean to say an array is composed of variables of the same type?\nHow are individual variables within an array referenced in VBA?\nWhat type of integer is an array index in VBA?\nBy default, what is the index of the first element in a VBA array?\nHow can the index of the first element in a VBA array be changed to 1?\nWhat is the purpose of the Option Base 1 statement in VBA?\nHow are the size and number of dimensions of an array determined in VBA?\nCan the size of an array in VBA be changed after it's declared?\nWhat are dynamic arrays in VBA?\nWhat is the function of dynamic arrays in VBA?\nCan the number of dimensions in dynamic arrays be set at run time?",
            "37.11 Summary\n\nV BA functions use variables to store information. Variables can hold all sorts\nof information. Declaring and using variables that can hold only a specific\ntype of information (T yped Variables) can make your programming task\n1017 Variables and Arrays\nAn array is a group of variables of the same type, sharing the same name\nand referenced individually using one or more indices. In VBA an array index\nis an integer. By default the index of the first element in an array is 0; this can\nbe changed to 1 for all arrays used in a module by using the Option Base 1\ns tatement. The size and number of dimensions of an array are set at the time\nthe array is declared and have to be known when the program is written.\nDynamic arrays are arrays whose size (but not number of dimensions) can be\nset at run time."
        ]
    },
    "38": {
        "38.1": [
            "What is a subroutine in VBA?\nWhat is the purpose of a subroutine in Excel?\nHow do subroutines assist in automating routine or repetitive operations in Excel?\nIn VBA, what are subroutines sometimes referred to as?\nWhat are modules in the context of VBA?\nCan you describe the purpose of module variables in VBA? \nWhat is the significance of module variables in financial modeling?",
            "38.1 Overview\n\nA subroutine is a VBA user routine used to automate routine or repetitive\noperations in Excel. Subroutines are sometimes called macros. Modules and\nmodule variables are introduced as the last subject of this chapter."
        ],
        "38.2": [
            "What is a subroutine in Visual Basic for Applications (VBA)? \nWhat is the role of the word \"Sub\" in a VBA subroutine definition? \nWhat are the different components of a subroutine in VBA? \nCan you explain the role of parentheses following the subroutine name in VBA?\nWhat does the VBA subroutine MsgBox do?\nHow are the arguments of MsgBox in VBA separated? \nWhat does the second argument in a VBA MsgBox subroutine represent?\nExplain how one subroutine can be activated (or called) from another in VBA?\nWhat happens when a subroutine is run without any parameters in the parentheses? \nHow could you trigger a subroutine in an Excel worksheet?\nWhat does Alt + F8 achieve when working with subroutines in Excel VBA?\nExplain how to activate a subroutine from the Macros button.\nHow can you attach a keyboard shortcut to a subroutine in Excel VBA?\nWhat does recording a subroutine in Excel VBA involve, and why might you want to do it?\nHow can one avoid the accidental overwriting of a non-blank cell in a VBA subroutine?\nHow to run a VBA subroutine from a button on the Excel worksheet?\nExplain how to assign a macro in VBA to a button on an Excel worksheet? \nWhat function does the Developer tab serve in Excel when working with VBA subroutines?\nWhat does the use of relative references indicate when recording a subroutine in Excel VBA?\nWhat does the ActiveCell.FormulaR1C1 line do in a VBA subroutine? \nHow does adding a subroutine to a button on a worksheet differ from running a subroutine from the Developer tab?",
            "38.2 Subroutines\n\nA subroutine looks like a function, but the word \u201cSub\u201d replaces the word\nFunction in the definition. The parentheses following the subroutine name are\nblank (recall that the parentheses following the function name give the func-\ntion \u2019 s parameters). Separating the first and last line are the statements that the\nsubroutine executes. The following is a very simple subroutine that puts a\nmessage on the screen:\nSub SayHi()\nMsgBox \u201cHi\u201d, , \u201cI say Hi\u201d\nEnd Sub\nThe above subroutine introduces a built-in VBA subroutine called M sgBox .\nIt also introduces the way one subroutine is activated (called) from another.\nMsgBox is named as a command on a line followed by its list of arguments\nseparated by commas. Notice the syntax:\nMsgBox \u201cHi\u201d, , \u201cI say Hi\u201d\nThe commas separate the three arguments of every MsgBox :\n\u2022 \u201cHi\u201d is the message which will be displayed.\n\u2022 The second argument is empty: Notice the space between the commas. This\nargument can be used to define buttons for the message box. This topic is\ndiscussed in section 38.3.\n1024 Chapter 38\nA subroutine can be activated (run) from an Excel worksheet in various\nways. The simplest way of running a subroutine is from the M acros button\non the Developer t ab on the Ribbon or by using the keyboard shortcut [Alt]\n+ F8. Either way, the macro selection box appears. 1 The box lists all available\nsubroutines alphabetically. Find our subroutine, click on its name, and click\nthe Run button.\nAnd this is what you will see:\n1. If you don \u2019 t have the Developer tab, go to File|Options|Customize the Ribbon . In the right\n1025 Subroutines and User Interaction\nA t this point Excel is locked up\u2014you have to click the OK button before\nyou can proceed.\nKeyboard Shortcut for Subroutines\nU sing a keyboard shortcut is a faster way to make a subroutine run. To attach\na shortcut to our subroutine:\n\u2022 Select the Options button from the macro selection box.\n\u2022 Type a character in the provided space and click OK .\n\u2022 Close the macro selection box using the corner X .\nY ou can now activate the subroutine using the shortcut ([Ctrl] + h, in\n1026 Chapter 38\nRecording a Subroutine\nOne easy way to start writing subroutines is to record the sequence of actions\nyou want in the subroutine, and then edit the resulting subroutine to produce\nthe final results you need. Something we do a lot in this book is to insert the\nfunction G etformula in a cell to the right of the cell with the interesting\nformula. Let\u2019 s record a subroutine that performs this action (see Figures\n38.1\u201338.3 ).\n1. Select the cell to the right of the cell with the formula we are interested in\n(B4, in our case)\n2. Select the Developer tab on the ribbon.\n3. In the code group click Use Relative References. This causes Excel to\nrecord relative cell addresses in the subroutine rather than its default, which\nis to record the actual cell addresses.\n4. Click Record Macro .\n5. At this point you have the option to name the subroutine as well as all sorts\nof other options. Since we are going to change most of these options in the\nnear future, we ignore all options and finally click OK to start recording.\n6. Type in the formula = Getformula(A4) .\n7. Click Stop Recording (this is the same button that used to be the R ecord\n1027 Subroutines and User Interaction\nRECORDING A SUBROUTINE\u2014SCREENS\nFigure 38.1\nIndicating recording with relative references.\nFigure 38.2\nStart recording the subroutine.\nFigure 38.3\n1028 Chapter 38\nI f we now go to the VBA editor we can see that a new module has been\nadded to the workbook. The module contains M acro1 :\nSub Macro1()\nActiveCell.FormulaR1C1 = _\n\u201c = getformula(RC[-1])\u201d\nEnd Sub\nWe can add some bells and whistles to this recorded subroutine. In the\nrecorded subroutine below, we changed the name and put in a line to prevent\nthe accidental overwriting of a non-blank cell.\nSub RecordGetformula()\n\u2018 Puts in Getformula, points to cell\n\u2018 to the left\nIf IsEmpty(ActiveCell) Then\nActiveCell.FormulaR1C1 = _\n\u201c = getformula(RC[-1])\u201d\nEnd If\nEnd Sub\nRunning a Subroutine from a Button on the Worksheet\nInstead of running the subroutine from the D eveloper tab or running it from\na key combination, we can also insert a button on the worksheet to run a\nsubroutine on that worksheet. To illustrate, we insert a button that runs the\nsubroutine R ecordGetformula :\n1. Select the Developer tab on the ribbon.\n2. In the Controls group, click I nsert .\n1029 Subroutines and User Interaction\n4. Drag the crosshair on the sheet to draw the button.\n5. Once you release the mouse button, the A ssign Macro dialogue will appear.\n1030 Chapter 38\n7 . T he button should be selected (control handles all round) and you can now\nedit the text that appears on the button. If the button is not selected, right-\nclicking on it will open a local menu enabling you to change the text or the\nsubroutine assigned to the button."
        ],
        "38.3": [
            "What is the purpose of using subroutines in user interaction within a spreadsheet?\nWhat function is demonstrated in the subroutine 'MsgBoxDefault'?\nWhat is the default configuration of MsgBox?\nWhat is the value returned by MsgBox when the OK button is clicked?\nWhat does the argument 'vbOKCancel' do in the MsgBox function?\nWhat does the subroutine 'MsgBoxOKCancel' demonstrate?\nWhat does the InputBox function do in Visual Basic for Applications (VBA)?\nWhat is the purpose of the subroutine PVCalculator?\nWhat are the three arguments required in the 'InputBox' function in the subroutine 'PVCalculator'?\nWhat is the significance of the 'Enter the cash flow value' argument in 'InputBox'?\nWhat happens when you do not replace the default string in the 'InputBox' function?\nWhat is the result of clicking the 'OK' button after replacing '100' with another number in the 'InputBox' function?  \nWhat function does the 'Round(Application.PV(0.05, 10, -CF)' argument serve in the subroutine 'PVCalculator'?",
            "38.3 User Interaction\n\nIn this section we show how to use subroutines to elicit data from the user of\nthe spreadsheet. We illustrate with the MsgBox command, which (as discussed\nabove) displays a message on the screen and returns a value based on the\nbutton clicked. Some of the different options available with this function are\ndemonstrated in the following subroutines:\nSub MsgBoxDefault()\nDim Temp As Integer\nTemp = MsgBox(\u201cDefault Message\u201d, , _\n\u201cDefault Title\u201d)\nMsgBox _\n\u201cThe value returned by MsgBox is: \u201c _\n& Temp\n1031 Subroutines and User Interaction\nNote: The default configuration of M sgBox produces one O K button. The\ndefault title is \u201cMicrosoft Excel.\u201d Clicking the OK button makes MsgBox\nreturn the value 1.\nSub MsgBoxOKCancel()\nDim Temp As Integer\nTemp = MsgBox(\u201cDefault Message\u201d, _\nvbOKCancel)\nMsgBox _\n\u201cThe value returned by MsgBox is: \u201c _\n& Temp\nEnd Sub\nA s previously noted, the second argument to MsgBox determines which\nbuttons are displayed. This incarnation of the demo subroutine uses the con-\nstant vbOKCancel to produce the two buttons OK and Cancel. Note that if\n1032 Chapter 38\nInputBox: Getting Data from the User\nInputBox is an internal VBA function used to get textual information from\nthe user into a variable in a subroutine. The workings of the function\nare demonstrated in the following present value calculator subroutine. The\n\u221110 CF\nsubroutine PVCalculator calculates , where CF is a number input-\n( 1.05)t\nted by the user: t=1\nSub PVCalculator()\nDim CF\nCF = InputBox(\u201cEnter the cash fl ow value\u201d, _\n\u201cPV calculator\u201d, \u201c100\u201d)\nMsgBox \u201cThe present value of 4\u201d & CF & _\n\u201cAt 5% for 10 periods is: \u201c & _\nRound(Application.PV(0.05, 10, -CF), _\n2), vbInformation, \u201cPV calculator\u201d\nEnd Sub\nNote the syntax:\nCF = InputBox(\u201cEnter the cash fl ow value\u201d, _\n\u201cPV calculator\u201d, \u201c100\u201d)\n\u2022 \u201cEnter \u2026 please,\u201d the first argument in I nputBox , is the message to display.\n\u2022 \u201cPV calculator,\u201d the second argument, is the title for the box.\n\u2022 \u201c 100,\u201d the third argument, is the default string to place in the box. If you do\nnot replace this by some other value, this will also be the returned value from\nthe function.\n1033 Subroutines and User Interaction\nAt this point you can replace \u201c100\u201d by some other number (in this\nexample, we \u2019 ve chosen to leave it). Clicking on the O K button results in the\nfollowing box:"
        ],
        "38.4": [
            "What are subroutines in the context of Excel workbooks?\nIn financial modeling, how can subroutines be used to make changes to a spreadsheet?\nWhat does the command \"ActiveCell.CurrentRegion.NumberFormat = \u201c#,##0\u201d invoke in Excel?\nWhat is the function of ActiveCell.CurrentRegion in Excel?\nWhat is the result of pressing [Ctrl] + A in an Excel worksheet?\nHow can you modify the actual data in ActiveCell.CurrentRegion to display values in thousands?\nWhat is the role of the rounding function in the subroutine \"ConvertToThousands()\"?\nWhat does this command imply: \"ActiveCell.CurrentRegion(i).Value = Round(ActiveCell.CurrentRegion(i).Value / 1000, 0)\"?\nHow would you count the number of cells in ActiveCell.CurrentRegion?\nWhat does the subroutine 'ConvertToThousands' achieve?",
            "38.4 Using Subroutines to Change the Excel Workbook\n\nSubroutines can be used to make changes to a spreadsheet. Here \u2019 s a small\nexample, very similar to the example presented at the end of Chapter 35. In\nthis version of the subroutine we change the current region \u2019 s format to numbers\n1034 Chapter 38\nSub Format()\nActiveCell.CurrentRegion.NumberFormat _\n= \u201c#,##0\u201d\nEnd Sub\nActiveCell.CurrentRegion is the range around the active cell (B5 in the\nscreen snaps), the same range that would be selected by pressing [Ctrl] + A\nin the worksheet (A3:C7 in the screen shots).\n1035 Subroutines and User Interaction\nT he next subroutine changes the actual data in ActiveCell.CurrentRegion\nto thousands by dividing each number in the range by 1,000 and rounding it\nto the nearest integer.\nSub ConvertToThousands()\ns = ActiveCell.CurrentRegion.Cells.Count\nFor i = 1 To s\nActiveCell.CurrentRegion(i).Value = _\nRound(ActiveCell.CurrentRegion(i). _\nValue / 1000, 0)\nNext i\nEnd Sub\n1036 Chapter 38"
        ],
        "38.5": [
            "What are modules in VBA?\nHow many modules can a VBA project have?\nWhy might one need to rename a module in VBA?\nWhat are the naming restrictions of a module in VBA?\nHow does one rename a module in VBA?\nWhat happens if a module and a function within it have the same name?\nWhat is a common practice of naming modules in VBA?\nWhat is the purpose of 'Dim' statement in VBA?\nWhat are module variables in VBA?\nHow can module variables be used in VBA?\nWhat is the function of 'Application.Volatile' statement in VBA?\nWhat triggers function recalculation when 'Application.Volatile' statement is used in VBA? \nHow is function 'MyStatusIs' different from 'MyStatusIsVolatile' in terms of recalculation in VBA?\nWhat is the significance of 'SetMyStatus', 'MyStatusIs', 'ShowMyStatus', 'MyStatusIsVolatile' subroutines and functions in the context of module variables in a VBA project?",
            "38.5 Modules\n\nVBA organizes user-defined functions and subroutines in units called modules.\nWe can (and sometimes should) have more than one module in a VBA project\n(i.e., the part of the workbook that has our functions and subroutines). Modules\nhave names: By default VBA uses the name \u201cModule\u201d followed by a number\nto indicate the module \u2019 s name, but you might find it useful to give them a\nsomewhat more descriptive name.\nTo rename a module (in the VBA Editor), select the module on the P roject\n1037 Subroutines and User Interaction\nIf the Project Explorer pane is not visible, select P roject Explorer from the\nView menu.\nO nce a module is selected, the module\u2019 s list of properties should appear in\nthe P roperties Pane . If the P roperties Pane is not visible, select Properties\nWindow from the V iew menu. Click on the module \u2019 s name (it should be the\nonly property available) and change it. A module name should start with an\nalphabetic character and consist of only alphabetic characters, digits, and the\nunderscore character (_); no other characters should be used.\nOnce you tap the Enter key, the name is changed. Notice the change in the\n1038 Chapter 38\nModules must have unique names, and they cannot be named after subrou-\ntines and functions. If a module called Tom has a function called Tom in it,\nthe function Tom will not be available to the workbook. One common practice\nis to start module names (and only module names) with M.\nModule Variables\nThe Dim statement can be used before any routine in the module to define a\nmodule variable. Module variables are recognized anywhere in the module and\nkeep their value until the workbook is closed. Module variables can be used\nto store information relevant to more than one routine without the need to pass\nthe information via the parameters. Module variables are more commonly used\nin large modules with many interacting routines, so the following demonstra-\ntion is, of necessity, somewhat trivial:\nDim MyStatus\nSub SetMyStatus()\nMyStatus = InputBox _\n(\u201cEnter value for my status\u201d, , \u201cOK\u201d)\nCalculate\nEnd Sub\nFunction MyStatusIs()\nMyStatusIs = MyStatus\nEnd Function\nSub ShowMyStatus()\nMsgBox \u201cMyStatus is: \u201c & MyStatus\nEnd Sub\nFunction MyStatusIsVolatile()\nApplication.Volatile\nMyStatusIsVolatile = MyStatus\n1039 Subroutines and User Interaction\nWhen you first open the workbook, here is what you see:\nIf you click on you get the Input Box :\nAnd a click on the OK button will produce the following:\nWe now know that the variable MyStatus has the value \u201cOK.\u201d So why is\nthe function MyStatusIs returning a zero, or for that matter, why is\n1040 Chapter 38\nApplication.Volatile\nT he answer to the question above lies with the Application.Volatile statement\nin MyStatusIsVolatile . When Application.Volatile is used as the first state-\nment in a function used in a worksheet, the function gets recalculated when-\never something gets recalculated on the worksheet. M yStatusIs will only\nrecalculate if its (nonexisting) parameter changes, in this case only if we edit\nthe cell and press Enter. So if we if we select cell A3, press F2 (for Edit Cell),\nand press Enter we get\nMODULE VARIABLES IN ACTION\nSet MyStatus\nOK <-- =MyStatusIs() Show MyStatus\nOK <-- =MyStatusIsVolatile()"
        ],
        "38.6": [
            "What is a subroutine in VBA?\nWhat is the purpose of a subroutine in VBA?\nWhat are the important functions provided by VBA for user interaction?\nWhat is the role of MsgBox and InputBox in user interaction in VBA?\nHow does VBA categorize and group subroutines and functions?\nWhy is the practice of keeping related functions and subroutines in one module useful in VBA?\nHow can VBA subroutines and functions be beneficial for financial programming in Excel?\nWhat are the key topics to consider for financial programming in Excel using VBA?",
            "38.6 Summary\n\nA subroutine is a VBA user routine used to automate routine or repetitive\noperations in Excel. VBA provides two important and very flexible functions\nfor user interaction: M sgBox and I nputBox. VBA groups subroutines and\nfunctions into units called modules; keeping related functions and subroutines\ngrouped is useful when dealing with large projects. All of these topics, explored\nin this chapter, will help you with financial programming in Excel."
        ]
    },
    "39": {
        "39.1": [
            "What is VBA in the context of financial modeling?\nWhat does the Excel Object Model in VBA pertain to?\nWhat are the different ways of dealing with useful Excel objects in VBA?\nWhat is the role of Names in making worksheets more clear and readable?\nWhat is discussed in section 39.6 of the chapter on VBA?\nWhat are Excel Add-Ins in VBA?\nHow do Excel Add-Ins make self-crafted functions automatically available across workbooks?\nWhat advanced subjects are discussed in the chapter on VBA?\nHow does VBA aid in making worksheets clearer and more readable?\nWhat is the use of Excel Add-Ins in financial modeling?",
            "39.1 Overview\n\nT his chapter deals with several more advanced subjects in VBA. Most of these\nsubjects relate to the Excel Object Model. The bulk of the chapter describes\nsome useful Excel objects and ways of dealing with them. Names, a way to\nmake worksheets clearer and more readable, are presented in section 39.6. The\nchapter closes with a discussion of Excel Add-Ins, one easy way to make self-\ncrafted functions automatically available across workbooks."
        ],
        "39.2": [
            "What are the basic building blocks of VBA?\nCan you define an object in the context of VBA?\nWhat are components of Excel represented by in the VBA Object Hierarchy?\nWhat are the special variables that hold an object's data in VBA called?\nHow are properties in VBA accessed?\nWhat is the Range object in VBA?\nWhat is defined by the ActiveCell in VBA?\nWhat does the Formula property hold in the context of a cell in Excel VBA?\nCan you describe a subroutine used to replace the contents of the active cell with a string representation of the contents in Excel VBA?\nWhat does the Selection variable represent in Excel VBA?\nIs Selection limited to a range in Excel VBA?\nHow would you check the type of a Selection using the TypeName function in VBA? \nCan you define Methods in the VBA context?\nWhat's the difference between methods and properties in VBA?\nCan you provide an example of a subroutine that demonstrates some methods of the Range Object in Excel VBA?\nWhat method is used to return a range containing all the blank cells in the current selection in Excel VBA?",
            "39.2 Introduction to Worksheet Objects\n\nObjects are the basic building blocks of VBA. Although you may not be aware\nthat you are using objects, most things you do in VBA require the manipulation\nof objects. We can think of an object as a sort of a container with variables,\nfunctions, and subroutines inside. All of Excel\u2019 s components (workbooks,\nworksheets, ranges, etc.) are represented by an object in the VBA Object\nHierarchy. The object\u2019 s data are held in special variables called properties that\ncan be accessed using the Dot ( .) operator. One of the most important object\ntypes in VBA is the R ange Object. A worksheet cell and a range of cells are\nall objects of the type Range. The following subsection introduces some pre-\ndefined Range Object variables.\nThe Active Cell\nVBA has many variables predefined for our use; one of the more useful is\nActiveCell . ActiveCell is a predefined Range Object variable that\nrepresents the cell in the worksheet with the cursor box around it. The follow-\ning function replaces the contents of the active cell with a string representation\nof the contents. We use the property Formula; this property holds the text in\nthe cell as a string and can be changed.\nSub ToString()\nActiveCell.Formula = \u201c\u2019\u201d & _\nActiveCell.Formula\n1048 Chapter 39\nBefore\nAfter\nThe Selection\nA nother very useful predefined variable is the Selection . This variable\nrepresents the currently selected item in Excel. Unlike the A ctiveCell\nvariable, Selection is not limited to a range and can be any selection\n(range, chart, and many more). We suggest that you check the type using the\nTypeName function. Methods are functions contained within an object.\nMethods are used to manipulate the object. Like properties, methods can be\naccessed using the Dot ( .) operator. The line between methods and properties\nis sometimes very fuzzy. The following subroutine demonstrates some methods\nof the Range Object , and use of the predefined variable S election :\nSub SelectBlank()\nIf UCase(TypeName(Selection)) < > \u201cRANGE\u201d _\nThen Exit Sub\nSelection.SpecialCells(xlCellTypeBlanks). _\nSelect\nEnd Sub\nThe first line checks to see if the current selection is a range and stops the\nsubroutine if it is not; a message would have been appropriate under non-\n1049 Objects and Add-Ins\nThe first part of the second line Selection.SpecialCells\n(xlCellTypeBlanks) uses the SpecialCells method of the Range\nObject to return a R ange containing all the blank cells in the current\nselection.\nThe Select method of the returned Range is activated to select it.\nBefore\nAfter"
        ],
        "39.3": [
            "What is a Range Object in VBA?\nHow is a Range used as a parameter to a Function in VBA?\nCan a Range Object variable be predefined?\nWhat is the purpose of the MeanReturn function in VBA?\nHow is return of an asset for period t calculated?\nHow is the mean return of an asset calculated?\nWhat is the function of AssetReturn in calculation of return?\nWhat is the significance of NumRows in VBA?\nWhat is the role of the Dot operator in VBA?\nHow does a Range object function in terms of a Collection type?\nWhat does the Count property signify in VBA?\nWhat is the property Value of a Range object in VBA?\nWhat is the structure of the Value property when the range is more than one cell in size?\nWhat is the Range property and how is it applied on a worksheet in VBA?\nWhat does the ActiveSheet.Range function do in VBA?\nHow are subroutines used in VBA?\nWhat does the subroutine RangeDemo() do?\nHow does the formula of each cell in a range get changed in VBA?\nWhat different ways of addressing a range of cells using the Range property exist in VBA?\nHow does the subroutine RangeDemo2() work?\nIs Range also a property of the Range object?\nHow does the subroutine RangeDemo3() function?\nWhat will be the result of Range(\"B2\").Range(\"B2\") in VBA?\nHow does the subroutine RangeDemo4() function?\nWhat does Range(\"C2\").Range(\"A1\", \"B2\") mean in VBA?",
            "39.3 The Range Object\n\nIn the previous section we encountered some predefined Range Object vari-\nables. This section demonstrates the use of ranges in VBA and presents more\nof the properties and methods of the R ange Object .\nA Range as a Parameter to a Function\nI n this subsection we build a function that accepts a Range as a parameter.\nOur new function, named MeanReturn, accepts a column range of asset\nprices as a parameter and computes and returns the mean return of the\nassets in the column. Recall that the return of an asset for period t is\nr =\nPrice\nt\n\u2212Price\nt\u22121 and the mean return of an asset is r =\n1 \u2211N\nr . An\nt Price N t\nt\u22121 t=1\nauxiliary function AssetReturn is used to compute r .\n1050 Chapter 39\nFunction MeanReturn(Rng)\nNumRows = Rng.Rows.Count\nPrices = Rng.Value\nT = 0\nFor i = 2 To NumRows\nT = T + AssetReturn(Prices(i - 1, 1), _\nPrices(i, 1))\nNext i\nMeanReturn = T / (NumRows - 1)\nEnd Function\nLines of note:\n\u2022 NumRows = Rng.Rows.Count\nIn this line the D ot operator is used twice. R ng is our Range object.\nRows is property of the Range object so Rng.Rows is an object of the\nCollection type that represents all the rows in our range. C ount is a\nproperty of Collection type objects that stores the number of members in\nthe collection, so Rng.Rows.Count is a variable that stores the number of\nrows in our range.\n\u2022 Prices = Rng.Value\nValue is a property of the R ange object containing the values of all the\ncells in the range. Value is of the type Variant. If the range is more than\none cell in size V alue is a two-dimensional array. The first index of Value\nis the row index starting from 1, and the second index is the column index\n1051 Objects and Add-Ins\nA B C\n1 MEANRETURN IN ACTION\n2 100\n3 110 10.00%<-- =(A3-A2)/A2\n4 121 10.00%<-- =(A4-A3)/A3\n5 145 19.83%<-- =(A5-A4)/A4\n6 174 20.00%<-- =(A6-A5)/A5\n7 14.96%<-- =AVERAGE(B3:B6)\n8 14.96%<-- =MeanReturn(A2:A6)\nThe Range Property\nThe Range property is one way to access a range on a worksheet. Range is\na property of many Excel objects. When used on its own, as in the next sub-\nroutine, Range is a short way of writing ActiveSheet.Range .\nSub RangeDemo()\nRange(\u201cA2\u201d).Formula = 23\nEnd Sub\nAs expected, the subroutine will set the formula in cell A2 of the active\nworksheet to 23.\nBefore\n1052 Chapter 39\nT he next subroutine sets the formula of each cell in the range A2:C3 of the\nactive worksheet to 23.\nSub RangeDemo1()\nRange(\u201cA2:C3\u201d).Formula = 23\nEnd Sub\nAnother way of addressing a range of cells using the Range property is\ndemonstrated by the next subroutine. The subroutine sets the formula of each\ncell in the range A2:C3 of the active worksheet to 23. The first argument to\nRange is the cell in the top left corner of the range, and the second is the cell\nin the bottom right corner of the range.\nSub RangeDemo2()\nRange(\u201cA2\u201d, \u201cC3\u201d).Formula = 23\nEnd Sub\nRange is also a property of the R ange object. The range returned by\nRange when used this way is relative to the Range object. The next subrou-\ntine sets the formula of the cell C3 of the active worksheet to 999.\nSub RangeDemo3()\nRange(\u201cB2\u201d).Range(\u201cB2\u201d).Formula = 999\n1053 Objects and Add-Ins\nNote: Range(\u201cB2\u201d) returns the range (or cell) B2 of the active worksheet.\nRange(\u201cB2\u201d).Range(\u201cB2\u201d) returns the cell B2 of the range that has B2\nas the top left corner. In worksheet terms, Range(\u201cB2\u201d).Range(\u201cB2\u201d)\nreturns the cell C3.\nT he next subroutine sets the formula of each cell in the range C2:D3\nof the active worksheet to 23. The subroutine uses the cell C2 as a starting\npoint.\nSub RangeDemo4()\nRange(\u201cC2\u201d).Range(\u201cA1\u201d, \u201cB2\u201d).Formula = 23\nEnd Sub\nNote: Range(\u201cC2\u201d) is the same as R ange(\u201cC2\u201d).Range(\u201cA1\u201d)\nand refers to the cell C2 in the worksheet. Range(\u201cC2\u201d).Range(\u201cB2\u201d)\nrefers to the cell D3 in the worksheet, B2 means one column to the left and\none line down. And so Range(\u201cC2\u201d).Range(\u201cA1\u201d, \u201cB2\u201d) is the same\nas Range(\u201cC2\u201d, \u201cD3\u201d) ."
        ],
        "39.4": [
            "What is the purpose of the With statement in Visual Basic for Applications (VBA)?\nCan you explain how the With statement can make procedures run faster in VBA?\nWhat does the Dot (.) operator do before the properties in the With statement in VBA?\nHow does using the With statement help in avoiding repetitive typing in VBA?\nHow does the With statement work when altering properties of an object?\nWhat does ActiveCell.CurrentRegion refer to in VBA?\nWhat actions does the contrived subroutine perform on the font of a cell in the top left-hand corner of the current region?\nWhat is the significance of 'ActiveCell.CurrentRegion.Range(\u201cA1\u201d) in VBA? \nWhat properties of the font of a cell are changed in the given subroutine?\nWhat is the difference between the subroutine using \u2018With Statement\u2019 and the one not using it?\nCan you illustrate how to write a subroutine using the With statement in VBA?",
            "39.4 The With Statement\n\nThe With statement allows you to perform a series of statements on a speci-\nfied object without restating the obvious (the object \u2019 s name and its pedigree,\nwhich can be very long). If you have more than one property to change or\nmore than one method to use for a single object, use the W ith statement.\nWith statements make your procedures run faster, and help you avoid repeti-\ntive typing. The following, somewhat contrived, subroutine sets some proper-\nties of the font of the cell in the top left-hand corner of the current region of\n1054 Chapter 39\nSub WithoutDemo()\nActiveCell.CurrentRegion.Range(\u201cA1\u201d). _\nFont.Bold = True\nActiveCell.CurrentRegion.Range(\u201cA1\u201d). _\nFont.Name = \u201cArial\u201d\nActiveCell.CurrentRegion.Range(\u201cA1\u201d). _\nFont.size = 15\nEnd Sub\nAnd here is the same subroutine using the With statement:\nSub WithDemo()\nWith ActiveCell.CurrentRegion. _\nRange(\u201cA1\u201d).Font\n.Bold = True\n.Name = \u201cArial\u201d\n.size = 15\nEnd With\nEnd Sub\nNotice the D ot (.) operator before the properties in the W ith statement.\nRecall from Chapter 38 that A ctiveCell.CurrentRegion is the con-\ntiguous range of non-empty cells around the active cell (C3 in the screen\nshots), the same range that would be selected by pressing [Ctrl] + A in the\nworksheet (A1:D4 in the screen shots).\n1055 Objects and Add-Ins\nAfter"
        ],
        "39.5": [
            "What is a Collection in Visual Basic for Applications (VBA)?\nWhat is the purpose of the Add method in a Collection in VBA?\nHow is the Remove method used in a Collection in VBA?\nHow can specific members of a Collection be referred to in VBA?\nWhat is the role of the Count method when working with a Collection in VBA?\nCould you explain what is the Excel Object Model and how it is related to Collections?\nWhat are some examples of Collections that are part of the Excel Object Model?\nWhat is the For Each Statement in VBA and how is it used with Arrays and Collections?\nWhat are the key differences between the two versions of the For Each statement in VBA?\nHow can the For Each statement be used to loop over Collections?\nWhat is a Workbook object and how is it represented in the Workbooks Collection in VBA?\nWhat is the Worksheets Collection in VBA, and how is it related to Worksheet objects?\nWhat is the significance of the Set statement in VBA when used with Collections?\nWhat does the specific type of element a Collection is made of represent in VBA?\nWhat are the different types a Cell can be in VBA when working with Collections?\nHow does changing the Cell reflect in the Collection in VBA?\nWhat is the use of the FormatDateTime function in VBA?\nWhat is the Workbook object in VBA and how is it related to the Workbooks Collection?\nWhat does the FullName property of the Workbook object contain in VBA?",
            "39.5 Collections\n\nA Collection is a set of items that can be referred to as a unit. Members\ncan be added using the A dd method and removed using the Remove method.\nSpecific members can be referred to using an integer index. The number of\nmembers currently in a C ollection is available via the C ount method.\nOur use of C ollections will be restricted to using the (quite numerous)\narsenal of C ollections that are part of the Excel Object Model, to name\nbut a few, Range is a collection of cells, Worksheets is a collection of all the\nworksheets in a workbook, and Workbooks is a collection of all the open\nworkbooks in Excel.\nThe For Each Statement in Use with Arrays and Collections\nThe For Each statement is a variation of the For loop. This statement comes\nin two distinct flavors. The first variation uses the statement to loop over a\n1056 Chapter 39\nSub ForEachDemo()\nDim A(4)\nFor i = 0 To 4: A(i) = i * i: Next i\nx = \u201cx is: \u201c\ny = \u201cy is: \u201c\nFor Each Element In A\nx = x & vbTab & Element\nElement = Element * 2\nNext Element\nFor Each Element In A\ny = y & vbTab & Element\nNext Element\nMsgBox x & vbCrLf & y, , \u201cFor Each Demo\u201d\nEnd Sub\nPoints of note:\n1. The current member of the array is available to the statements within the\nloop body through the loop variable (E lement in the above function).\n2. The loop variable ( Element in the above example) has to be of the type\nVariant irrespective of the array type.\n3. Changes to Element will n ot be refl ected in the actual array. Notice that\nthe changes to E lement in line 8 are not refl ected in y .\n4 . Y ou don\u2019 t need to know the number of dimensions or the range of indices\n1057 Objects and Add-Ins\nThe For Each Statement in Use with Collections\nThe second version of the For Each statement loops over Collections :\nSub ZeroRange()\nSet Rng = ActiveCell.CurrentRegion\nFor Each Cell In Rng\nCell.Formula = 0\nNext Cell\nEnd Sub\n1058 Chapter 39\nBefore\nAfter\nPoints of note:\n1. Ranges are collections and so the variable R ng is a collection of all the\ncells in the current region of the active cell (C3:D15 in our example).\n2. C ell is a variable used to iterate over a ll the members of the collection.\n3. C ell has to be one of the following types: V ariant , Object , or the\nspecific type of element the Collection is made of. (Recall that all vari-\nables are of type Variant unless specifically defined.)\n4. C ell refers to the actual member of the Collection, and changes to\nCell will be reflected in the C ollection .\n5. A complete explanation of the use of the S et statement is beyond the scope\nof this book. For our purposes, just prefix the reserved word Set to all object\n1059 Objects and Add-Ins\nThe Workbooks Collection and the Workbook Object\nA ll the currently open workbooks are represented by a Workbook object in\nthe W orkbooks Collection . The following subroutine lists all open\nworkbooks:\nSub ListOpenWorkbooks()\nTemp = \u201cList of open Workbooks\u201d & _\n\u201c Created on:\u201d & FormatDateTime(Date, _\nvbLongDate) _\n& \u201c At: \u201c & FormatDateTime(Time, _\nvbLongTime)\nFor Each Element In Workbooks\nTemp = Temp & vbCrLf & Element.FullName\nNext Element\nMsgBox Temp, vbOKOnly, \u201cList of open _\nWorkbooks\u201d\n1060 Chapter 39\nLines of note:\nTemp = \u201cList of open Workbooks\u201d & _\n\u201c Created on:\u201d & _\nFormatDateTime(Date, vbLongDate) _\n& \u201c At: \u201c & _\nFormatDateTime(Time, vbLongTime)\n\u2022 The Date function returns the current system date.\n\u2022 The Time function returns the current system time.\n\u2022 The FormatDateTime function formats D ate and Time variables for\ndisplay.\nFor Each Element In Workbooks\nTemp = Temp & vbCrLf & Element.FullName\nNext Element\nThe For statement loops over the entire Workbooks Collection .\nOn each iteration, Element is one of the Workbook objects in the\nCollection . FullName is a property of the W orkbook object containing\nthe full path name of the workbook.\nThe Worksheets Collection and the Worksheet Object\nA ll the worksheets in a workbook are W orksheet objects in the\nWorksheets Collection that is a property of the Workbook object.\nWe can use the Worksheets Collection without an object as a short\n1061 Objects and Add-Ins"
        ],
        "39.6": [
            "What is the purpose of using user-defined names in Excel?\nHow can using names in Excel make formulas easier to read?\nWhat is a subroutine in the context of Excel VBA?\nHow can you name a range using a subroutine in Excel VBA?\nWhat is the 'Names' Collection in Excel VBA?\nWhat is the 'Add' method in the Names Collection in Excel VBA used for?\nWhat are the first two parameters of the 'Add' method in the Names collection of Excel VBA?\nWhat does the first parameter represent in the 'Add' method of the Names Collection in Excel VBA?\nWhat does the second parameter represent in the 'Add' method of the Names Collection in Excel VBA?\nHow can the defined name be used in the workbook in Excel VBA?\nWhy is the name not directly available in VBA?\nHow is the function 'Application.Evaluate' used in Excel VBA?\nWhat is an Array Function in the context of Excel VBA?\nWhat is the purpose of 'Application.Volatile' in Excel VBA?\nHow can you refer to a named range in Excel VBA?",
            "39.6 Names\n\nIn Excel you can use user-defined names to refer to a cell or a range of cells.\nUse easy-to-understand names, such as Products, to refer to hard-to-\nunderstand ranges, such as S ales!C20:C30 . Using names can make for-\nmulas easy to read: Compare the formula = sum(\u2018sheet12\u2019!a10:a10)\nto = sum(lastYearSales). This section deals with the VBA side of\nnames.\nNaming a Range Using a Subroutine\nThe following subroutine gives the name \u201cJon\u201d to the cells selected.\nSub NameSelection()\nNames.Add \u201cJon\u201d, \u201c = \u201d & _\nSelection.Address\nEnd Sub\nSelect cells A2:B3 and run the subroutine. The next two screenshots show\nthe Excel name box before and after we operate the NameSelection\nsubroutine:\n1062 Chapter 39\nAfter\nNames is a C ollection of all the names in the active workbook. A dd\nis a method of the Names Collection used to add members to the collec-\ntion. We use only the first two parameters of the method. The first parameter\n\u201cJon\u201d is the name to add to the Names Collection. The second param-\neter is a string containing the address, formula, or value to which the added\nname refers, preceded by = .\nLooking for Defined Names\nThe name \u201cJon\u201d has just now been defined, and we can use it in the workbook\nas demonstrated in the following screen shot. Notice that whatever capitaliza-\ntion you use, Excel reverts to the original \u201cJon.\u201d\nT he name \u201cJon\u201d is not directly available in VBA as demonstrated by the fol-\n1063 Objects and Add-Ins\nFunction SumJon()\nSumJon = Application.WorksheetFunction. _\nSum(Jon)\nEnd Function\nA B C\n1 SUM(Jon) IN ACTION\n2 10<-- =SUM(Jon)\n3 0<-- =SumJon()\nReferring to a Named Range\nT o get to values in a named range we can use the built-in function\nApplication.Evaluate , as demonstrated by the next function. Note that\nthe function is designed to be used as an Array Function and the use of\nApplication.Volatile to make sure the value gets updated whenever\na change is made to the workbook.\nFunction JonAsArray()\nApplication.Volatile\nJonAsArray = Application.Evaluate(\u201cJon\u201d)\nEnd Function\nA B C\n1 JonASARRAY IN ACTION\n2 1 3<-- {=JonAsArray()}\n3 2 4<-- {=JonAsArray()}\nR eferring to the actual range the name refers to is beyond the scope of\n1064 Chapter 39"
        ],
        "39.7": [
            "What is an Excel Add-In?\nWhat functionality does an Excel Add-In provide and how does it increase Excel's power?\nWhat is the ideal vehicle for distributing custom functions in Excel?\nWhat are the two main tasks in integrating an Add-In into Excel?\nWhat is the first step in creating an Excel Add-In?\nWhy is it essential to keep the original workbook intact when creating an Add-In?\nWhat is the significance of debugging the base workbook before converting it into an Add-In?\nHow do you save a workbook as an Add-In in Excel?\nWhat changes occur when you switch the \"Save as type\" option to \"Excel Add-In (*.xlam)\" in Excel?\nWhat factors should be considered when deciding the location to save an Add-In?\nHow is an Add-In installed and used from an Excel worksheet?\nWhat is the process of installing an Add-In on a computer basis?\nHow can you verify that the functions in the Add-In are now available to all workbooks in Excel?\nWhat is the outcome when you insert a formula in a cell, select the neighboring cell, and press [Alt] + F8?\nWhat happens when you type \"annotate\" in the Macro name box?",
            "39.7 Add-Ins and Integration\n\nA n Excel Add-In is a file that Excel can load when it starts up. The file contains\nVBA code that adds additional functionality to Excel, usually in the form of\nnew functions. Add-Ins provide an excellent way of increasing the power of\nExcel and they are the ideal vehicle for distributing your custom functions.\nThis section shows you how to convert an Excel Workbook containing VBA\nfunctions to an Add-In, and how to load and use Add-Ins in Excel and VBA.\nThe process is somewhat arcane and the steps below should be followed in\nthe order in which they are presented.\nCreate and Debug Your Base Workbook\nA s editing an Add-In once it\u2019 s created is very difficult, it is important that the\noriginal workbook on which the Add-In is based is kept intact and as a work-\nbook. For this demonstration we have created a workbook containing one\nworksheet and a VBA project containing one module with one function and\n1065 Objects and Add-Ins\nConvert the Base Workbook to an Add-In\nTo make the Add-In, save the workbook as an Add-In. Select S ave As\nfrom the Excel file menu and change Save as type to \u201cExcel Add-In (*.xlam).\u201d\nThe Save in location will change to the Add-Ins directory on your computer.\nYou may want to navigate to a different location (we tend to keep files\ntogether). Now click Save. You may want to use a new name for the Add-In\n1066 Chapter 39\nInstall and Use an Add-In from an Excel Worksheet\nI nstalling an Add-In is done on a per computer basis (actually per computer\nuser basis). So we do not get confused with the chapter we suggest you close\nExcel and reopen it with a brand new Excel workbook. Select Developer |\n1067 Objects and Add-Ins\nClick Browse and navigate to the location of your Add-In. Select it and\nclick OK .\nNotice that a new Add-In is available and activated. Click O K to close the\nAdd-Ins dialogue. All the functions in our Add-in are now available to all\nworkbooks in Excel. To verify insert a formula in a cell (A1), select the cell\nnext to the cell with the formula (B1), and press [Alt] + F8.\nYou should get the M acro dialogue box. Notice that, sadly, annotate is not\non the list, but if you type \u201cannotate\u201d in the Macro name box, then the Run\nbutton will become available and when pressed will produce the expected\n1068 Chapter 39"
        ],
        "39.8": [
            "What is the concept of objects in VBA programming?\nHow do objects enhance VBA programming?\nWhat does being parsimonious in expressing programming references mean?\nCan you explain how to build Add-Ins in Excel?\nWhat is the purpose of using Add-Ins in Excel?\nWhat are the two separate topics discussed in the context of VBA?\nHow do objects underlie the VBA programming concept?\nWhat is the importance of VBA programming in financial modelling? \nCan you explain the role of objects in expressing programming references according to the principle of parsimony?",
            "39.8 Summary\n\nT his chapter discussed two separate topics. We started with a more extensive\ndiscussion of objects, which underlie the VBA programming concept. Objects\nallow you to be much more parsimonious in expressing your programming\nreferences. We finished the chapter with a discussion of how to build Add-Ins\nin Excel."
        ]
    }
}